<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/default.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
</head>

<body class="markdown-body">
    <h1 dir="auto" id="oit-order-independent-transparency-1">OIT (Order Independent Transparency)</h1>
    <h2 dir="auto" id="1-alpha-channel-1">1. Alpha Channel</h2>
    <p dir="auto">Porter proposed the &quot;Alpha channel&quot;(1.[Porter 1984]) in 1984 which is widely established in
        real-time rendering to simulate the transparent effect.</p>
    <p dir="auto">We assume that one &quot;pixel&quot; corresponds to a series of &quot;fragments&quot; which can be
        treated as the triples <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mrow>
                                        <mo fence="true">[</mo>
                                        <mtable rowspacing="0.1600em" columnalign="center center center"
                                            columnspacing="1em">
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <msub>
                                                            <mi>C</mi>
                                                            <mi>i</mi>
                                                        </msub>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <msub>
                                                            <mi>A</mi>
                                                            <mi>i</mi>
                                                        </msub>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <msub>
                                                            <mi>Z</mi>
                                                            <mi>i</mi>
                                                        </msub>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                        </mtable>
                                        <mo fence="true">]</mo>
                                    </mrow>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \begin{bmatrix} C_i &amp; A_i &amp;
                                Z_i \end{bmatrix}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span
                                class="mopen delimcenter" style="top:0em;"><span
                                    class="delimsizing size1">[</span></span><span class="mord"><span
                                    class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span
                                                class="vlist-r"><span class="vlist"
                                                    style="height:0.8500000000000001em;"><span
                                                        style="top:-3.01em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord"><span class="mord mathnormal"
                                                                    style="margin-right:0.07153em;">C</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.31166399999999994em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.35000000000000003em;"><span></span></span></span></span></span><span
                                        class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep"
                                        style="width:0.5em;"></span><span class="col-align-c"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.8500000000000001em;"><span
                                                        style="top:-3.01em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord"><span class="mord mathnormal">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.31166399999999994em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.35000000000000003em;"><span></span></span></span></span></span><span
                                        class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep"
                                        style="width:0.5em;"></span><span class="col-align-c"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.8500000000000001em;"><span
                                                        style="top:-3.01em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord"><span class="mord mathnormal"
                                                                    style="margin-right:0.07153em;">Z</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.31166399999999994em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span
                                class="mclose delimcenter" style="top:0em;"><span
                                    class="delimsizing size1">]</span></span></span></span></span></span></eq> (C-Color
        A-Alpha Z-Depth), as shown in the following figure:<br>
        <img src="Order-Independent-Transparency-1.png" alt="" data-src="Order-Independent-Transparency-1.png"><br>
        Then the final color of the pixel can be calculated as <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>C</mi>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                        </mstyle>
                                    </msub>
                                    <mo>=</mo>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mstyle>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>n</mi>
                                        </mstyle>
                                    </munderover>
                                    <mo stretchy="false">(</mo>
                                    <munder>
                                        <mo>∏</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <msub>
                                                <mi>Z</mi>
                                                <mi>j</mi>
                                            </msub>
                                            <mi>N</mi>
                                            <mi>e</mi>
                                            <mi>a</mi>
                                            <mi>r</mi>
                                            <mi>e</mi>
                                            <mi>r</mi>
                                            <msub>
                                                <mi>Z</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mstyle>
                                    </munder>
                                    <mo stretchy="false">(</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>j</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle C_{\displaystyle Final} =
                                \sum_{\displaystyle i = 0}^{\displaystyle n} (\prod_{\displaystyle Z_j Nearer Z_i}(1 -
                                A_j)) A_i C_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.0329699999999997em;vertical-align:-0.34963999999999984em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.3448em;"><span
                                                style="top:-2.65036em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:3em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal sizing reset-size3 size6"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord mathnormal sizing reset-size3 size6">ina</span><span
                                                            class="mord mathnormal sizing reset-size3 size6"
                                                            style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.34963999999999984em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut"
                            style="height:3.5660080000000005em;vertical-align:-1.7854430000000001em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.7805650000000004em;"><span
                                            style="top:-1.674475em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal sizing reset-size3 size6">i</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                        class="mrel sizing reset-size3 size6">=</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                        class="mord sizing reset-size3 size6">0</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal sizing reset-size3 size6">n</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.475525em;"><span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:1.050005em;"><span
                                            style="top:-1.6506649999999998em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord sizing reset-size3 size6"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.311664em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight"
                                                                                    style="margin-right:0.05724em;">j</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.286108em;"><span></span></span></span></span></span></span><span
                                                        class="mord mathnormal sizing reset-size3 size6"
                                                        style="margin-right:0.10903em;">N</span><span
                                                        class="mord mathnormal sizing reset-size3 size6">e</span><span
                                                        class="mord mathnormal sizing reset-size3 size6">a</span><span
                                                        class="mord mathnormal sizing reset-size3 size6"
                                                        style="margin-right:0.02778em;">rer</span><span
                                                        class="mord sizing reset-size3 size6"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            style="top:-3.0500049999999996em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∏</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.7854430000000001em;"><span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.
    </p>
    <p dir="auto">The <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <munder>
                                        <mo>∏</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <msub>
                                                <mi>Z</mi>
                                                <mi>j</mi>
                                            </msub>
                                            <mi>N</mi>
                                            <mi>e</mi>
                                            <mi>a</mi>
                                            <mi>r</mi>
                                            <mi>e</mi>
                                            <mi>r</mi>
                                            <msub>
                                                <mi>Z</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mstyle>
                                    </munder>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>j</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V} ( Z_i ) =
                                \prod_{\displaystyle Z_j Nearer Z_i} 1 - A_j</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.8354480000000004em;vertical-align:-1.7854430000000001em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.050005em;"><span
                                            style="top:-1.6506649999999998em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord sizing reset-size3 size6"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.311664em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight"
                                                                                    style="margin-right:0.05724em;">j</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.286108em;"><span></span></span></span></span></span></span><span
                                                        class="mord mathnormal sizing reset-size3 size6"
                                                        style="margin-right:0.10903em;">N</span><span
                                                        class="mord mathnormal sizing reset-size3 size6">e</span><span
                                                        class="mord mathnormal sizing reset-size3 size6">a</span><span
                                                        class="mord mathnormal sizing reset-size3 size6"
                                                        style="margin-right:0.02778em;">rer</span><span
                                                        class="mord sizing reset-size3 size6"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            style="top:-3.0500049999999996em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∏</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.7854430000000001em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is also called the visibility function which will be explained later.<br>
        Then the above equation can also be written as <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>C</mi>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                        </mstyle>
                                    </msub>
                                    <mo>=</mo>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mstyle>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>n</mi>
                                        </mstyle>
                                    </munderover>
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle C_{\displaystyle Final} =
                                \sum_{\displaystyle i = 0}^{\displaystyle n} \operatorname{V} ( Z_i ) A_i C_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.0329699999999997em;vertical-align:-0.34963999999999984em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.3448em;"><span
                                                style="top:-2.65036em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:3em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal sizing reset-size3 size6"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord mathnormal sizing reset-size3 size6">ina</span><span
                                                            class="mord mathnormal sizing reset-size3 size6"
                                                            style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.34963999999999984em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:3.2560900000000004em;vertical-align:-1.475525em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.7805650000000004em;"><span
                                            style="top:-1.674475em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal sizing reset-size3 size6">i</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                        class="mrel sizing reset-size3 size6">=</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                        class="mord sizing reset-size3 size6">0</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal sizing reset-size3 size6">n</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.475525em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.</p>
    <p dir="auto">Note that the physical meaning of the Alpha is the &quot;partial coverage&quot; rather than the
        &quot;transmittance&quot;.</p>
    <p dir="auto">The Alpha stands for the ratio of the area covered by the fragments to the area covered by the pixel.
        That's why we use the scalar &quot;float&quot; instead of the vector &quot;RGB&quot; to represent the Alpha.
        This circumstance is also called the &quot;Wavelength Independent&quot; in some literatures.<br>
        For example, when we observe a red brick through a blue silk scarf, the color of the brick appears to be the
        &quot;addition&quot; of the blue and red. The fibers of silk scarf are intrinsically opaque but there exist gaps
        between the fibers. We see the brick through the gaps. Namely, the silk scarf &quot;partially covers&quot; the
        brick.</p>
    <p dir="auto">However, the transmittance is &quot;Wavelengh Dependent&quot;. If we observe a red brick through a
        blue plastic film, the color of the brick appears to be black (the &quot;Multiplication&quot; of the blue and
        red). The red brick only reflects the red light while the blue plastic film only allows blue light to pass
        through. All the reflected light of the red brick is absorbed by the blue plastic film and then the red brick
        appears to be black.</p>
    <p dir="auto">You can do the above two experiments by yourself.</p>
    <p dir="auto">If we demand the transmittance effect, the techniques related to the &quot;Participating
        Media&quot;(2.[Yusor 2013]、3.[Hoobler 2016]) should be used.</p>
    <p dir="auto">By the physical meaning of the Alpha, we can comprehend the visibility function <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> evidently since a fragment can only be
        (partially) covered by the fragments nearer than it.<br>
        Some literatures treat the visibility function <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> as the &quot;transmittance&quot;.
        Technically, that's wrong.</p>
    <h2 dir="auto" id="2-ordered-transparency-1">2. Ordered Transparency</h2>
    <p dir="auto">In real time rendering, the classic method is to sort the transparent geometries and use the
        &quot;Over/Under Operation&quot;(1.[Porter 1984]、4. [Dunn 2014]) to calculate the final color <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>C</mi>
                                    <mrow>
                                        <mi>F</mi>
                                        <mi>i</mi>
                                        <mi>n</mi>
                                        <mi>a</mi>
                                        <mi>l</mi>
                                    </mrow>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">C_{Final}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord mathnormal mtight">ina</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> recursively:</p>
    <blockquote dir="auto">
        <p dir="auto">1.OpaquePass<br>
            draw the opaque geometries and have the BackgroundColor and the BackgroundDepth.</p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">2.TransparencyPass<br>
            use the BackgroundDepth for depth test (without depth write), sort the geometries from far to near/from near
            to far and use Over/Under Operation to calculate recursively.</p>
        <p dir="auto">Over Operation<br>
            sort the fragments from far to near to use the Over Operation<br>
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>C</mi>
                                        <mrow>
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                            <mi mathvariant="normal">_</mi>
                                            <mn>0</mn>
                                        </mrow>
                                    </msub>
                                    <mo>=</mo>
                                    <mi>B</mi>
                                    <mi>a</mi>
                                    <mi>c</mi>
                                    <mi>k</mi>
                                    <mi>g</mi>
                                    <mi>r</mi>
                                    <mi>o</mi>
                                    <mi>u</mi>
                                    <mi>n</mi>
                                    <mi>d</mi>
                                    <mi>C</mi>
                                    <mi>o</mi>
                                    <mi>l</mi>
                                    <mi>o</mi>
                                    <mi>r</mi>
                                </mrow>
                                <annotation encoding="application/x-tex">C_{Final\_0}=BackgroundColor</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.05033em;vertical-align:-0.367em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span><span
                                                                class="mord mtight">_0</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.367em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                class="mrel">=</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                                class="strut"
                                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord mathnormal" style="margin-right:0.05017em;">B</span><span
                                class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span
                                class="mord mathnormal" style="margin-right:0.03148em;">k</span><span
                                class="mord mathnormal" style="margin-right:0.03588em;">g</span><span
                                class="mord mathnormal">ro</span><span class="mord mathnormal">u</span><span
                                class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span
                                class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="mord mathnormal">o</span><span class="mord mathnormal"
                                style="margin-right:0.01968em;">l</span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">or</span></span></span></span></eq><br>
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>C</mi>
                                        <mrow>
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                            <mi mathvariant="normal">_</mi>
                                            <mi>n</mi>
                                        </mrow>
                                    </msub>
                                    <mo>=</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>n</mi>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mi>n</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>+</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>n</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <msub>
                                        <mi>C</mi>
                                        <mrow>
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                            <mi mathvariant="normal">_</mi>
                                            <mi>n</mi>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msub>
                                </mrow>
                                <annotation encoding="application/x-tex">C_{Final\_n}=(A_nC_n)+(1-A_n) C_{Final\_n-1}
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.05033em;vertical-align:-0.367em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span><span
                                                                class="mord mtight"
                                                                style="margin-right:0.02778em;">_</span><span
                                                                class="mord mathnormal mtight">n</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.367em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                class="mrel">=</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mopen">(</span><span class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:1.117em;vertical-align:-0.367em;"></span><span class="mord"><span
                                    class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mord"><span class="mord mathnormal"
                                    style="margin-right:0.07153em;">C</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span><span
                                                                class="mord mtight"
                                                                style="margin-right:0.02778em;">_</span><span
                                                                class="mord mathnormal mtight">n</span><span
                                                                class="mbin mtight">−</span><span
                                                                class="mord mtight">1</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.367em;"><span></span></span></span></span></span></span></span></span></span>
            </eq>
        </p>
        <p dir="auto">Under Operation<br>
            sort the fragments from near to far to use the Under Operation<br>
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>C</mi>
                                        <mrow>
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                            <mi mathvariant="normal">_</mi>
                                            <mn>0</mn>
                                        </mrow>
                                    </msub>
                                    <mo>=</mo>
                                    <mn>0</mn>
                                </mrow>
                                <annotation encoding="application/x-tex">C_{Final\_0}=0</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.05033em;vertical-align:-0.367em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span><span
                                                                class="mord mtight">_0</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.367em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                class="mrel">=</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                                class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                                class="mord">0</span></span></span></span></eq><br>
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>A</mi>
                                        <mrow>
                                            <mi>T</mi>
                                            <mi>o</mi>
                                            <mi>t</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                            <mi mathvariant="normal">_</mi>
                                            <mn>0</mn>
                                        </mrow>
                                    </msub>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mrow>
                                <annotation encoding="application/x-tex">A_{Total\_0}=1</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.05033em;vertical-align:-0.367em;"></span><span class="mord"><span
                                    class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">T</span><span
                                                                class="mord mathnormal mtight">o</span><span
                                                                class="mord mathnormal mtight">t</span><span
                                                                class="mord mathnormal mtight">a</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span><span
                                                                class="mord mtight">_0</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.367em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                class="mrel">=</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                                class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                                class="mord">1</span></span></span></span></eq><br>
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>C</mi>
                                        <mrow>
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                            <mi mathvariant="normal">_</mi>
                                            <mi>n</mi>
                                        </mrow>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mrow>
                                            <mi>T</mi>
                                            <mi>o</mi>
                                            <mi>t</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                            <mi mathvariant="normal">_</mi>
                                            <mi>n</mi>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msub>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>n</mi>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mi>n</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>+</mo>
                                    <msub>
                                        <mi>C</mi>
                                        <mrow>
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                            <mi mathvariant="normal">_</mi>
                                            <mi>n</mi>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msub>
                                </mrow>
                                <annotation encoding="application/x-tex">C_{Final\_n}=A_{Total\_n-1}(
                                    A_nC_n)+C_{Final\_n-1}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.05033em;vertical-align:-0.367em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span><span
                                                                class="mord mtight"
                                                                style="margin-right:0.02778em;">_</span><span
                                                                class="mord mathnormal mtight">n</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.367em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                class="mrel">=</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                                class="strut" style="height:1.117em;vertical-align:-0.367em;"></span><span
                                class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">T</span><span
                                                                class="mord mathnormal mtight">o</span><span
                                                                class="mord mathnormal mtight">t</span><span
                                                                class="mord mathnormal mtight">a</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span><span
                                                                class="mord mtight"
                                                                style="margin-right:0.02778em;">_</span><span
                                                                class="mord mathnormal mtight">n</span><span
                                                                class="mbin mtight">−</span><span
                                                                class="mord mtight">1</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.367em;"><span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:1.05033em;vertical-align:-0.367em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span><span
                                                                class="mord mtight"
                                                                style="margin-right:0.02778em;">_</span><span
                                                                class="mord mathnormal mtight">n</span><span
                                                                class="mbin mtight">−</span><span
                                                                class="mord mtight">1</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.367em;"><span></span></span></span></span></span></span></span></span></span>
            </eq><br>
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>A</mi>
                                        <mrow>
                                            <mi>T</mi>
                                            <mi>o</mi>
                                            <mi>t</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                            <mi mathvariant="normal">_</mi>
                                            <mi>n</mi>
                                        </mrow>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mrow>
                                            <mi>T</mi>
                                            <mi>o</mi>
                                            <mi>t</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                            <mi mathvariant="normal">_</mi>
                                            <mi>n</mi>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msub>
                                    <mo stretchy="false">(</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>n</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <annotation encoding="application/x-tex">A_{Total\_n}=A_{Total\_n-1}( 1-A_n)
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.05033em;vertical-align:-0.367em;"></span><span class="mord"><span
                                    class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">T</span><span
                                                                class="mord mathnormal mtight">o</span><span
                                                                class="mord mathnormal mtight">t</span><span
                                                                class="mord mathnormal mtight">a</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span><span
                                                                class="mord mtight"
                                                                style="margin-right:0.02778em;">_</span><span
                                                                class="mord mathnormal mtight">n</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.367em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                class="mrel">=</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                                class="strut" style="height:1.117em;vertical-align:-0.367em;"></span><span
                                class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">T</span><span
                                                                class="mord mathnormal mtight">o</span><span
                                                                class="mord mathnormal mtight">t</span><span
                                                                class="mord mathnormal mtight">a</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span><span
                                                                class="mord mtight"
                                                                style="margin-right:0.02778em;">_</span><span
                                                                class="mord mathnormal mtight">n</span><span
                                                                class="mbin mtight">−</span><span
                                                                class="mord mtight">1</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.367em;"><span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span></span></span></eq><br>
            Note that the <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>A</mi>
                                        <mrow>
                                            <mi>T</mi>
                                            <mi>o</mi>
                                            <mi>t</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                        </mrow>
                                    </msub>
                                </mrow>
                                <annotation encoding="application/x-tex">A_{Total}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">T</span><span
                                                                class="mord mathnormal mtight">o</span><span
                                                                class="mord mathnormal mtight">t</span><span
                                                                class="mord mathnormal mtight">a</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq> in Under Operation is exactly the visibility function <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <annotation encoding="application/x-tex">\operatorname{V} ( Z_i )</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                                class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                    style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span></span></span></eq> above.<br>
            At last, the result image of the OpaquePass is treated as the fragments with &quot;A=1
            C=BackgroundColor&quot; and added to the final color by the Under Operation.
        </p>
    </blockquote>
    <p dir="auto">By the mathematical induction, we can prove that the Over Operation and the Under Operation are
        equivalent. Both can calculate the final color <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>C</mi>
                                    <mrow>
                                        <mi>F</mi>
                                        <mi>i</mi>
                                        <mi>n</mi>
                                        <mi>a</mi>
                                        <mi>l</mi>
                                    </mrow>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">C_{Final}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord mathnormal mtight">ina</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> correctly by <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∑</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mstyle>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>n</mi>
                                        </mstyle>
                                    </munderover>
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \sum_{\displaystyle i =
                                0}^{\displaystyle n} \operatorname{V} ( Z_i ) A_i C_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:3.2560900000000004em;vertical-align:-1.475525em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.7805650000000004em;"><span
                                            style="top:-1.674475em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal sizing reset-size3 size6">i</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                        class="mrel sizing reset-size3 size6">=</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                        class="mord sizing reset-size3 size6">0</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal sizing reset-size3 size6">n</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.475525em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.</p>
    <p dir="auto">Technically, the correctness of the Over/Under Operation can only be guaranteed by sorting the
        &quot;fragments&quot; from far to near/from near to far. However, in real time rendering, the sorting is based
        on the geometries not the fragments. If there exists interlacing inside the geometry, the order of the fragments
        will not follow and thus we have to explore the OIT(Order Independent Transparency) algorithm to settle this
        problem.</p>
    <p dir="auto">Note that keeping the geometries orderly also prohibits the batching of the geometries with the same
        material and thus results in extra state changing which is hostile to the performance.</p>
    <h2 dir="auto" id="3-1-depth-peeling-1">3-1. Depth Peeling</h2>
    <p dir="auto">Depth Peeling(5.[Everitt 2001]) is an archaic method which might be used in real time rendering.</p>
    <h3 dir="auto" id="3-1-1-render-pass-1">3-1-1. Render Pass</h3>
    <blockquote dir="auto">
        <p dir="auto">1.OpaquePass<br>
            draw opaque geometries and have the BackgroundColor and the BackgroundDepth.</p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">2.NearestLayerPass //GeometryPass<br>
            copy the BackgroundDepth to initialize the depth buffer<br>
            with depth test(NearerOrEqual) and depth write, sort the transparent geometries by [material, front-to-back]
            and draw them, having the NearestLayerColor and the NearestLayerDepth<br>
            add the NearestLayerColor to the final color <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>C</mi>
                                        <mrow>
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                        </mrow>
                                    </msub>
                                </mrow>
                                <annotation encoding="application/x-tex">C_{Final}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq> by Under Operation<br>
            //Note that the depth peeling doesn't depend on the order of the fragments and we sort the geometries from
            near to far is merely to improve the performance by the EarlyDepthTest.</p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">3.SecondNearestLayerPass //GeometryPass
            copy the BackgroundDepth to initialize the depth buffer<br>
            with depth test(NearerOrEqual) and depth write, sort the transparent geometries by [material,
            front-to-back], bind the NearestLayerDepth to the SampledTextureUnit and draw them with discarding the
            fragments NearerOrEqual than the NearestLayerDepth explicitly in the fragment shader, having the
            SecondNearestLayerColor and the SecondNearestLayerDepth<br>
            add the SecondNearestLayerColor to the final color <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>C</mi>
                                        <mrow>
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                        </mrow>
                                    </msub>
                                </mrow>
                                <annotation encoding="application/x-tex">C_{Final}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq> by Under Operation<br>
            //Note that the depth peeling doesn't depend on the order of the fragments and we sort the geometries from
            near to far is merely to improve the performance by the EarlyDepthTest.</p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">4.ThirdNearestLayerPass //GeometryPass
            copy the BackgroundDepth to initialize the depth buffer<br>
            with depth test(NearerOrEqual) and depth write, sort the transparent geometries by [material,
            front-to-back], bind the SecondNearestLayerDepth to the SampledTextureUnit and ...<br>
            //Note that the depth peeling doesn't depend on the order of the fragments and we sort the geometries from
            near to far is merely to improve the performance by the EarlyDepthTest.</p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">The subsequent operations are similar to the above, omitted... //we can peel N layers by N
            geometry passes. The application can choose the proper N according to the requirements.</p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">N+2.CompositePass //FullScreenTrianglePass<br>
            At last, the BackgroundColor by OpaquePass is added to the final color by the Under Operation.</p>
    </blockquote>
    <p dir="auto">Technically, it's legal to peel the layers from far to near and add them to the final color by the
        Over Operation.<br>
        However, if the number of the geometry passes N is too low to peel all layers, the farthest/nearest layers will
        be ignored when we use the Under/Over Operation.<br>
        Evidently, the visibility function <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is monotonically decreasing. It follows
        that the farthest layers generally contribute little to the final color and introduce little error if they are
        ignored. That's why we prefer the Under Operation to the Over Operation.</p>
    <h3 dir="auto" id="3-1-2-conclusion-1">3-1-2. Conclusion</h3>
    <p dir="auto">Evidently, the depth peeling has a fatal disadvantage that the number of the geometry passes is too
        high and the performance is too low and thus the depth peeling has never been popular since proposed decades
        ago.</p>
    <h2 dir="auto" id="3-2-stochastic-transparency-1">3-2. Stochastic Transparency</h2>
    <p dir="auto">The estimation of the visibility function <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> depends on the order of the fragments.
        This results in that the estimation of the final color <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>C</mi>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                        </mstyle>
                                    </msub>
                                    <mo>=</mo>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mstyle>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>n</mi>
                                        </mstyle>
                                    </munderover>
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle C_{\displaystyle Final} =
                                \sum_{\displaystyle i = 0}^{\displaystyle n} \operatorname{V} ( Z_i ) A_i C_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.0329699999999997em;vertical-align:-0.34963999999999984em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.3448em;"><span
                                                style="top:-2.65036em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:3em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal sizing reset-size3 size6"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord mathnormal sizing reset-size3 size6">ina</span><span
                                                            class="mord mathnormal sizing reset-size3 size6"
                                                            style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.34963999999999984em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:3.2560900000000004em;vertical-align:-1.475525em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.7805650000000004em;"><span
                                            style="top:-1.674475em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal sizing reset-size3 size6">i</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                        class="mrel sizing reset-size3 size6">=</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                        class="mord sizing reset-size3 size6">0</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal sizing reset-size3 size6">n</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.475525em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> depends on the order.<br>
        By this fact, Enderton proposed the &quot;stochastic transparency&quot;(6.[Enderton 2010]) in 2010 which is
        based on the the principles of statistics and uses MSAA hardware to random sampling to estimate the visibility
        function <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">\operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> order independently.</p>
    <h3 dir="auto" id="3-2-1-stochastic-depth-1">3-2-1. Stochastic Depth</h3>
    <p dir="auto">With the MSAA on, we assume the relationship among the &quot;pixel&quot;, &quot;fragment&quot; and
        &quot;sample&quot; as the following figure:<br>
        <img src="Order-Independent-Transparency-2.png" alt="" data-src="Order-Independent-Transparency-2.png"><br>
        one pixel corresponds to several samples (for example, in the above figure, one pixel corresponds to 4 samples,
        namely, 4X MSAA) and at the same time one pixel corresponds to a series of fragments.<br>
        However, the same sample corresponding to the same pixel can only be occupied by one fragment of these fragments
        corresponding to the same pixel(The storage is limited, which can hold only one fragment. That's evident).
    </p>
    <p dir="auto">At the same time, we assume that:<br>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>j</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_j</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> denotes one fragment of the fragments<eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mn>0</mn>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_0</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mn>1</mn>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mn>2</mn>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_2</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">2</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> ... <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>n</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_n</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> corresponding to the same pixel.<br>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>s</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_s</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">s</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> denotes the fragment which occupies the sample in the final result depth image(the StochasticDepth in the
        implementation). As we have explained above, by the limit of the storage, the sample can only be occupied by one
        fragment.<br>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> denotes the fragment which is being discussed(which can be considered as the fragment being executed by
        the fragment shader in the implementation).
    </p>
    <p dir="auto">In addition, we assume that:<br>
        By setting the value of gl_SampleMask/SV_Coverage, we ensure that the probability of each sample be occupied by
        the fragment [ <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>C</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">C_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">A_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> ] is <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">A_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.<br>
        With depth test and depth write, we ensure that the nearer fragment must overwrite the farther fragment and the
        sample is occupied by the nearest fragment.<br>
        The probabilities of different fragments are uncorrelated.
    </p>
    <p dir="auto">We claim that for each sample [ <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>C</mi>
                                    <mi>s</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">C_s</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">s</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>A</mi>
                                    <mi>s</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">A_s</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">s</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>s</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_s</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">s</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> ] in the final result depth image, for each fragment [ <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>C</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">C_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">A_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> ] among the fragments corresponding to the same pixel, the probability of &quot;<eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is Near-or-Equal than <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>s</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_s</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">s</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>&quot; is exactly the visibility function <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <munder>
                                        <mo>∏</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <msub>
                                                <mi>Z</mi>
                                                <mi>j</mi>
                                            </msub>
                                            <mi>N</mi>
                                            <mi>e</mi>
                                            <mi>a</mi>
                                            <mi>r</mi>
                                            <mi>e</mi>
                                            <mi>r</mi>
                                            <msub>
                                                <mi>Z</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mstyle>
                                    </munder>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>j</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V} ( Z_i ) =
                                \prod_{\displaystyle Z_j Nearer Z_i} 1 - A_j</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.8354480000000004em;vertical-align:-1.7854430000000001em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.050005em;"><span
                                            style="top:-1.6506649999999998em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord sizing reset-size3 size6"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.311664em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight"
                                                                                    style="margin-right:0.05724em;">j</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.286108em;"><span></span></span></span></span></span></span><span
                                                        class="mord mathnormal sizing reset-size3 size6"
                                                        style="margin-right:0.10903em;">N</span><span
                                                        class="mord mathnormal sizing reset-size3 size6">e</span><span
                                                        class="mord mathnormal sizing reset-size3 size6">a</span><span
                                                        class="mord mathnormal sizing reset-size3 size6"
                                                        style="margin-right:0.02778em;">rer</span><span
                                                        class="mord sizing reset-size3 size6"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            style="top:-3.0500049999999996em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∏</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.7854430000000001em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.
    </p>
    <p dir="auto">Proof:<br>
        Since &quot;the nearer fragment must overwrite the farther fragment&quot;, if &quot;<eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is Near-or-Equal than <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>s</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_s</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">s</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>&quot;, then we have that the sample in the final result depth image is occupied by [ <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>C</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">C_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">A_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> ] or the farther fragments corresponding to the same pixel.<br>
        Namely, the sample is not be occupied by the nearer fragments corresponding to the same pixel.<br>
        Evidently, the probability of &quot;the sample is not be occupied by one fragment <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>j</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_j</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> among these nearer fragments&quot; is <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>j</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">1 - A_j</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.<br>
        Since &quot;the probabilities of different fragments are uncorrelated&quot;, by the multiplication principle,
        the probability of &quot;the sample is not be occupied by the nearer fragments corresponding to the same
        pixel&quot; is <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munder>
                                        <mo>∏</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <msub>
                                                <mi>Z</mi>
                                                <mi>j</mi>
                                            </msub>
                                            <mi>N</mi>
                                            <mi>e</mi>
                                            <mi>a</mi>
                                            <mi>r</mi>
                                            <mi>e</mi>
                                            <mi>r</mi>
                                            <msub>
                                                <mi>Z</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mstyle>
                                    </munder>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>j</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \prod_{\displaystyle Z_j Nearer Z_i}
                                1 - A_j</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.8354480000000004em;vertical-align:-1.7854430000000001em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.050005em;"><span
                                            style="top:-1.6506649999999998em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord sizing reset-size3 size6"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.311664em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight"
                                                                                    style="margin-right:0.05724em;">j</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.286108em;"><span></span></span></span></span></span></span><span
                                                        class="mord mathnormal sizing reset-size3 size6"
                                                        style="margin-right:0.10903em;">N</span><span
                                                        class="mord mathnormal sizing reset-size3 size6">e</span><span
                                                        class="mord mathnormal sizing reset-size3 size6">a</span><span
                                                        class="mord mathnormal sizing reset-size3 size6"
                                                        style="margin-right:0.02778em;">rer</span><span
                                                        class="mord sizing reset-size3 size6"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            style="top:-3.0500049999999996em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∏</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.7854430000000001em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> which is exactly the visibility function <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.
    </p>
    <p dir="auto">Besides, we assume that:<br>
        One pixel corresponds to S samples, namely, S-X MSAA.</p>
    <p dir="auto">We claim that if the count of the samples such that &quot;<eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is Near-or-Equal than <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>s</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_s</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">s</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>&quot; is <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi mathvariant="normal">Count</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">\operatorname{Count} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">Count</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>, let <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">SV</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">Count</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <msub>
                                                <mi>Z</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>S</mi>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{SV}( Z_i ) = \frac{
                                \operatorname{Count} ( Z_i ) }{S}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">SV</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.05764em;">S</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">Count</span></span><span
                                                        class="mopen">(</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>, we have that the
        expected value of the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">SV</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{SV}( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">SV</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is the visibility function <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.</p>
    <p dir="auto">Proof:
        Evidently, this is immediate from the above proposition.</p>
    <p dir="auto">Since we can get the value of <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi mathvariant="normal">Count</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">\operatorname{Count} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">Count</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> by sampling texture, we can use <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">SV</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{SV}( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">SV</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> to estimate the visibility function <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span>
        </eq>.<br>
        Note that the extension &quot;ARB_texture_multisample&quot; should be enabled to use texelFetch on sampler2DMS
        in OpenGL.<br>
        We should use the knowledge of statistics to prove why we can estimate and thus the proof is omitted.</p>
    <h3 dir="auto" id="3-2-2-alpha-correction-1">3-2-2. Alpha Correction</h3>
    <p dir="auto">We claim that <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <mo>=</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∏</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">{\displaystyle{\sum_{i = 0}^n}} ( \operatorname{V}
                                ( Z_i ) A_i ) = 1 - {\displaystyle{\prod_{i = 0}^n}} ( 1 - A_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span
                                class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist"
                                                style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop"><span class="mord mathrm"
                                style="margin-right:0.01389em;">V</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span
                            class="mord"><span class="mord"><span class="mop op-limits"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∏</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.</p>
    <p dir="auto">Proof:<br>
        Prove by the mathematical induction.<br>
        1.basis:<br>
        when n=0:<br>
        left = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mn>0</mn>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">{\displaystyle{\sum_{i = 0}^0}} ( \operatorname{V}
                                ( Z_i ) A_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:3.0787820000000004em;vertical-align:-1.277669em;"></span><span
                            class="mord"><span class="mord"><span class="mop op-limits"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.8011130000000004em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight">0</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop"><span class="mord mathrm"
                                style="margin-right:0.01389em;">V</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq><br>
        = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mn>0</mn>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mn>0</mn>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">\operatorname{V} ( Z_0 ) A_0</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq><br>
        = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mn>1</mn>
                                <mo>⋅</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mn>0</mn>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">1 \cdot A_0</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq><br>
        = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>A</mi>
                                    <mn>0</mn>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">A_0</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq><br>
        right = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mn>1</mn>
                                <mo>−</mo>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∏</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mn>0</mn>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">1 - {\displaystyle{\prod_{i = 0}^0}} ( 1 - A_i )
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:3.0787820000000004em;vertical-align:-1.277669em;"></span><span
                            class="mord"><span class="mord"><span class="mop op-limits"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.8011130000000004em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∏</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight">0</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq><br>
        = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mn>1</mn>
                                <mo>−</mo>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mn>0</mn>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">1 - ( 1 - A_0 )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq><br>
        = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>A</mi>
                                    <mn>0</mn>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">A_0</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq><br>
        left = right the equation holds<br>
        2.inductive step:<br>
        we assume that the proposition holds for n=k.<br>
        when n=k+1:<br>
        left = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mrow>
                                            <mi>k</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">{\displaystyle{\sum_{i = 0}^{k + 1}}} (
                                \operatorname{V} ( Z_i ) A_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span
                            class="mord"><span class="mord"><span class="mop op-limits"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.8361130000000003em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                    style="top:-4.300005em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03148em;">k</span><span
                                                                class="mbin mtight">+</span><span
                                                                class="mord mtight">1</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop"><span class="mord mathrm"
                                style="margin-right:0.01389em;">V</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq><br>
        = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>k</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <mo>+</mo>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mrow>
                                        <mi>k</mi>
                                        <mo>+</mo>
                                        <mn>1</mn>
                                    </mrow>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mrow>
                                        <mi>k</mi>
                                        <mo>+</mo>
                                        <mn>1</mn>
                                    </mrow>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">{\displaystyle{\sum_{i = 0}^k}} ( \operatorname{V}
                                ( Z_i ) A_i ) + \operatorname{V} ( Z_{k+1} ) A_{k+1}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span
                            class="mord"><span class="mord"><span class="mop op-limits"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.8361130000000003em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03148em;">k</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop"><span class="mord mathrm"
                                style="margin-right:0.01389em;">V</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.3361079999999999em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.03148em;">k</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.3361079999999999em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.03148em;">k</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>
        </eq><br>
        = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mn>1</mn>
                                <mo>−</mo>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∏</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>k</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <mo>+</mo>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mrow>
                                        <mi>k</mi>
                                        <mo>+</mo>
                                        <mn>1</mn>
                                    </mrow>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mrow>
                                        <mi>k</mi>
                                        <mo>+</mo>
                                        <mn>1</mn>
                                    </mrow>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">1 - {\displaystyle{\prod_{i = 0}^k}} ( 1 - A_i ) +
                                \operatorname{V} ( Z_{k+1} ) A_{k+1}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span
                            class="mord"><span class="mord"><span class="mop op-limits"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.8361130000000003em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∏</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03148em;">k</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.3361079999999999em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.03148em;">k</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.3361079999999999em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.03148em;">k</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>
        </eq><br>
        = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mn>1</mn>
                                <mo>−</mo>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∏</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>k</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <mo>+</mo>
                                <mo stretchy="false">(</mo>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∏</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>k</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <mo stretchy="false">)</mo>
                                <mo>⋅</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mrow>
                                        <mi>k</mi>
                                        <mo>+</mo>
                                        <mn>1</mn>
                                    </mrow>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">1 - {\displaystyle{\prod_{i = 0}^k}} ( 1 - A_i ) +
                                ( {\displaystyle{\prod_{i=0}^k}} ( 1 - A_i ) ) \cdot A_{k+1}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span
                            class="mord"><span class="mord"><span class="mop op-limits"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.8361130000000003em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∏</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03148em;">k</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span
                            class="mopen">(</span><span class="mord"><span class="mord"><span
                                    class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.8361130000000003em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∏</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03148em;">k</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.3361079999999999em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.03148em;">k</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>
        </eq><br>
        = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mn>1</mn>
                                <mo>−</mo>
                                <mo stretchy="false">(</mo>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∏</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>k</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <mo stretchy="false">)</mo>
                                <mo>⋅</mo>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mrow>
                                        <mi>k</mi>
                                        <mo>+</mo>
                                        <mn>1</mn>
                                    </mrow>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">1 - ( {\displaystyle{\prod_{i = 0}^k}} ( 1 - A_i ))
                                \cdot ( 1 - A_{k+1} )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span
                            class="mopen">(</span><span class="mord"><span class="mord"><span
                                    class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.8361130000000003em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∏</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03148em;">k</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.3361079999999999em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.03148em;">k</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq><br>
        = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mn>1</mn>
                                <mo>−</mo>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∏</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mrow>
                                            <mi>k</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">1 - {\displaystyle{\prod_{i = 0}^{k + 1}}} ( 1 -
                                A_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span
                            class="mord"><span class="mord"><span class="mop op-limits"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.8361130000000003em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∏</span></span></span><span
                                                    style="top:-4.300005em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03148em;">k</span><span
                                                                class="mbin mtight">+</span><span
                                                                class="mord mtight">1</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq><br>
        right = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mn>1</mn>
                                <mo>−</mo>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∏</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mrow>
                                            <mi>k</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">1 - {\displaystyle{\prod_{i = 0}^{k + 1}}} ( 1 -
                                A_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span
                            class="mord"><span class="mord"><span class="mop op-limits"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.8361130000000003em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∏</span></span></span><span
                                                    style="top:-4.300005em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03148em;">k</span><span
                                                                class="mbin mtight">+</span><span
                                                                class="mord mtight">1</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq><br>
        left = right the equation holds</p>
    <p dir="auto">Evidently, the expected value of <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mi mathvariant="normal">SV</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">{\displaystyle{\sum_{i = 0}^n}} ( \operatorname{SV}
                                ( Z_i ) A_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span
                                class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist"
                                                style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop"><span class="mord mathrm"
                                style="margin-right:0.01389em;">SV</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">{\displaystyle{\sum_{i = 0}^n}} ( \operatorname{V}
                                ( Z_i ) A_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span
                                class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist"
                                                style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop"><span class="mord mathrm"
                                style="margin-right:0.01389em;">V</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.<br>
        Since <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <mo>=</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∏</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">{\displaystyle{\sum_{i = 0}^n}} ( \operatorname{V}
                                ( Z_i ) A_i ) = 1 - {\displaystyle{\prod_{i = 0}^n}} ( 1 - A_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span
                                class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist"
                                                style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop"><span class="mord mathrm"
                                style="margin-right:0.01389em;">V</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span
                            class="mord"><span class="mord"><span class="mop op-limits"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∏</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>, we have that the expected value of <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mi mathvariant="normal">SV</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">{\displaystyle{\sum_{i = 0}^n}} ( \operatorname{SV}
                                ( Z_i ) A_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span
                                class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist"
                                                style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop"><span class="mord mathrm"
                                style="margin-right:0.01389em;">SV</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span>
        </eq> is <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mo>∏</mo>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">1-\prod_i ( 1-A_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut"
                            style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span
                            class="mop"><span class="mop op-symbol small-op"
                                style="position:relative;top:-0.0000050000000000050004em;">∏</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.16195399999999993em;"><span
                                                style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.</p>
    <p dir="auto">The Alpha correction can be considered as the normalizing of the <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi mathvariant="normal">SV</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">\operatorname{SV} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">SV</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.<br>
        This means that we assume that <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mfrac>
                                    <mrow>
                                        <mi mathvariant="normal">SV</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                    <mrow>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <munderover>
                                                <mo>∑</mo>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>=</mo>
                                                    <mn>0</mn>
                                                </mrow>
                                                <mi>n</mi>
                                            </munderover>
                                        </mstyle>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">SV</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                </mfrac>
                                <mo>=</mo>
                                <mfrac>
                                    <mrow>
                                        <mi mathvariant="normal">V</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                    <mrow>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <munderover>
                                                <mo>∑</mo>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>=</mo>
                                                    <mn>0</mn>
                                                </mrow>
                                                <mi>n</mi>
                                            </munderover>
                                        </mstyle>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">V</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                </mfrac>
                            </mrow>
                            <annotation encoding="application/x-tex">\frac{\operatorname{SV} ( Z_i )}{
                                {\displaystyle{\sum_{i = 0}^n}} ( \operatorname{SV} ( Z_i ) A_i )} =
                                \frac{\operatorname{V} ( Z_i )}{ {\displaystyle{\sum_{i = 0}^n}} ( \operatorname{V} (
                                Z_i ) A_i ) }</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:3.749066em;vertical-align:-2.7390660000000002em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.01em;"><span style="top:-2.19em;"><span class="pstrut"
                                                    style="height:3.6513970000000002em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord sizing reset-size3 size6"><span
                                                                    class="mop op-limits"><span
                                                                        class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.6513970000000002em;"><span
                                                                                    style="top:-1.872331em;margin-left:0em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">i</span><span
                                                                                                class="mrel mtight">=</span><span
                                                                                                class="mord mtight">0</span></span></span></span><span
                                                                                    style="top:-3.050005em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span><span
                                                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                                                            class="mopen mtight">(</span><span class="mop mtight"><span
                                                                class="mord mathrm mtight"
                                                                style="margin-right:0.01389em;">SV</span></span><span
                                                            class="mopen mtight">(</span><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">A</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span></span></span></span><span
                                                style="top:-3.881397em;"><span class="pstrut"
                                                    style="height:3.6513970000000002em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-4.1363970000000005em;"><span class="pstrut"
                                                    style="height:3.6513970000000002em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mop mtight"><span
                                                                class="mord mathrm mtight"
                                                                style="margin-right:0.01389em;">SV</span></span><span
                                                            class="mopen mtight">(</span><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:2.7390660000000002em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:3.749066em;vertical-align:-2.7390660000000002em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.01em;"><span style="top:-2.19em;"><span class="pstrut"
                                                    style="height:3.6513970000000002em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord sizing reset-size3 size6"><span
                                                                    class="mop op-limits"><span
                                                                        class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.6513970000000002em;"><span
                                                                                    style="top:-1.872331em;margin-left:0em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">i</span><span
                                                                                                class="mrel mtight">=</span><span
                                                                                                class="mord mtight">0</span></span></span></span><span
                                                                                    style="top:-3.050005em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span><span
                                                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                                                            class="mopen mtight">(</span><span class="mop mtight"><span
                                                                class="mord mathrm mtight"
                                                                style="margin-right:0.01389em;">V</span></span><span
                                                            class="mopen mtight">(</span><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">A</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span></span></span></span><span
                                                style="top:-3.881397em;"><span class="pstrut"
                                                    style="height:3.6513970000000002em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-4.1363970000000005em;"><span class="pstrut"
                                                    style="height:3.6513970000000002em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mop mtight"><span
                                                                class="mord mathrm mtight"
                                                                style="margin-right:0.01389em;">V</span></span><span
                                                            class="mopen mtight">(</span><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:2.7390660000000002em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq> and we have that
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mrow>
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <mo>=</mo>
                                <mrow>
                                    <mi mathvariant="normal">SV</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <mfrac>
                                    <mrow>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <munderover>
                                                <mo>∑</mo>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>=</mo>
                                                    <mn>0</mn>
                                                </mrow>
                                                <mi>n</mi>
                                            </munderover>
                                        </mstyle>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">V</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                    <mrow>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <munderover>
                                                <mo>∑</mo>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>=</mo>
                                                    <mn>0</mn>
                                                </mrow>
                                                <mi>n</mi>
                                            </munderover>
                                        </mstyle>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">SV</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mtext>）</mtext>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mtext>）</mtext>
                                    </mrow>
                                </mfrac>
                                <mo>=</mo>
                                <mrow>
                                    <mi mathvariant="normal">SV</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <mfrac>
                                    <mrow>
                                        <mn>1</mn>
                                        <mo>−</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <munderover>
                                                <mo>∏</mo>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>=</mo>
                                                    <mn>0</mn>
                                                </mrow>
                                                <mi>n</mi>
                                            </munderover>
                                        </mstyle>
                                        <mo stretchy="false">(</mo>
                                        <mn>1</mn>
                                        <mo>−</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                    <mrow>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <munderover>
                                                <mo>∑</mo>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>=</mo>
                                                    <mn>0</mn>
                                                </mrow>
                                                <mi>n</mi>
                                            </munderover>
                                        </mstyle>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">SV</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                </mfrac>
                            </mrow>
                            <annotation encoding="application/x-tex">{\operatorname{V} ( Z_i )} = {\operatorname{SV} (
                                Z_i )}{\frac{ {\displaystyle{\sum_{i = 0}^n}} ( \operatorname{V} ( Z_i ) A_i ) }{
                                {\displaystyle{\sum_{i = 0}^n}} ( \operatorname{SV} ( Z_i ） A_i ）}} = {
                                \operatorname{SV}( Z_i )}{\frac{1 - {\displaystyle{\prod_{i = 0}^n}} ( 1-A_i )}{
                                {\displaystyle{\sum_{i = 0}^n}} ( \operatorname{SV} ( Z_i ) A_i )}}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                                class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                    style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:5.9781320000000004em;vertical-align:-2.7390660000000002em;"></span><span
                            class="mord"><span class="mop"><span class="mord mathrm"
                                    style="margin-right:0.01389em;">SV</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span><span class="mord"><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:3.2390660000000002em;"><span style="top:-2.19em;"><span
                                                        class="pstrut" style="height:3.6513970000000002em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight"><span
                                                                    class="mord sizing reset-size3 size6"><span
                                                                        class="mop op-limits"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.6513970000000002em;"><span
                                                                                        style="top:-1.872331em;margin-left:0em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:3.05em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mtight"><span
                                                                                                    class="mord mathnormal mtight">i</span><span
                                                                                                    class="mrel mtight">=</span><span
                                                                                                    class="mord mtight">0</span></span></span></span><span
                                                                                        style="top:-3.050005em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:3.05em;"></span><span><span
                                                                                                class="mop op-symbol large-op">∑</span></span></span><span
                                                                                        style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:3.05em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mop mtight"><span class="mord mathrm mtight"
                                                                    style="margin-right:0.01389em;">SV</span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mord mtight"><span class="mord mathnormal mtight"
                                                                    style="margin-right:0.07153em;">Z</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mord cjk_fallback mtight">）</span><span
                                                                class="mord mtight"><span
                                                                    class="mord mathnormal mtight">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mord cjk_fallback mtight">）</span></span></span></span><span
                                                    style="top:-3.881397em;"><span class="pstrut"
                                                        style="height:3.6513970000000002em;"></span><span
                                                        class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-5.239066em;"><span class="pstrut"
                                                        style="height:3.6513970000000002em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight"><span
                                                                    class="mord sizing reset-size3 size6"><span
                                                                        class="mop op-limits"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.6513970000000002em;"><span
                                                                                        style="top:-1.872331em;margin-left:0em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:3.05em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mtight"><span
                                                                                                    class="mord mathnormal mtight">i</span><span
                                                                                                    class="mrel mtight">=</span><span
                                                                                                    class="mord mtight">0</span></span></span></span><span
                                                                                        style="top:-3.050005em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:3.05em;"></span><span><span
                                                                                                class="mop op-symbol large-op">∑</span></span></span><span
                                                                                        style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:3.05em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mop mtight"><span class="mord mathrm mtight"
                                                                    style="margin-right:0.01389em;">V</span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mord mtight"><span class="mord mathnormal mtight"
                                                                    style="margin-right:0.07153em;">Z</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mclose mtight">)</span><span
                                                                class="mord mtight"><span
                                                                    class="mord mathnormal mtight">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mclose mtight">)</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:2.7390660000000002em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:5.9781320000000004em;vertical-align:-2.7390660000000002em;"></span><span
                            class="mord"><span class="mop"><span class="mord mathrm"
                                    style="margin-right:0.01389em;">SV</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span><span class="mord"><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:3.2390660000000002em;"><span style="top:-2.19em;"><span
                                                        class="pstrut" style="height:3.6513970000000002em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight"><span
                                                                    class="mord sizing reset-size3 size6"><span
                                                                        class="mop op-limits"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.6513970000000002em;"><span
                                                                                        style="top:-1.872331em;margin-left:0em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:3.05em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mtight"><span
                                                                                                    class="mord mathnormal mtight">i</span><span
                                                                                                    class="mrel mtight">=</span><span
                                                                                                    class="mord mtight">0</span></span></span></span><span
                                                                                        style="top:-3.050005em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:3.05em;"></span><span><span
                                                                                                class="mop op-symbol large-op">∑</span></span></span><span
                                                                                        style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:3.05em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mop mtight"><span class="mord mathrm mtight"
                                                                    style="margin-right:0.01389em;">SV</span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mord mtight"><span class="mord mathnormal mtight"
                                                                    style="margin-right:0.07153em;">Z</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mclose mtight">)</span><span
                                                                class="mord mtight"><span
                                                                    class="mord mathnormal mtight">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mclose mtight">)</span></span></span></span><span
                                                    style="top:-3.881397em;"><span class="pstrut"
                                                        style="height:3.6513970000000002em;"></span><span
                                                        class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-5.239066em;"><span class="pstrut"
                                                        style="height:3.6513970000000002em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight">1</span><span
                                                                class="mbin mtight">−</span><span
                                                                class="mord mtight"><span
                                                                    class="mord sizing reset-size3 size6"><span
                                                                        class="mop op-limits"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.6513970000000002em;"><span
                                                                                        style="top:-1.872331em;margin-left:0em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:3.05em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mtight"><span
                                                                                                    class="mord mathnormal mtight">i</span><span
                                                                                                    class="mrel mtight">=</span><span
                                                                                                    class="mord mtight">0</span></span></span></span><span
                                                                                        style="top:-3.050005em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:3.05em;"></span><span><span
                                                                                                class="mop op-symbol large-op">∏</span></span></span><span
                                                                                        style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:3.05em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mord mtight">1</span><span
                                                                class="mbin mtight">−</span><span
                                                                class="mord mtight"><span
                                                                    class="mord mathnormal mtight">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mclose mtight">)</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:2.7390660000000002em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></span></eq>.
    </p>
    <p dir="auto">We should use the knowledge of statistics to explain the meaning of the Alpha correction and thus the
        explanation is omitted.</p>
    <h3 dir="auto" id="3-2-3-render-pass-1">3-2-3. Render Pass</h3>
    <blockquote dir="auto">
        <p dir="auto">1.OpaquePass<br>
            draw the opaque geometries and have the BackgroundColor and the BackgroundDepth.</p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">2.StochasticDepthPass //GeometryPass<br>
            copy the BackgroundDepth to initialize the depth buffer<br>
            with MSAA, with depth test(NearerOrEqual) and depth write, sort the transparent geometries by [material,
            front-to-back] and draw them with setting the pseudo random value of gl_SampleMask/SV_Coverage by the <eq>
                <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mrow>
                                <annotation encoding="application/x-tex">A_i</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq> of [ <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>C</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mrow>
                                <annotation encoding="application/x-tex">C_i</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq>
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mrow>
                                <annotation encoding="application/x-tex">A_i</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq>
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mrow>
                                <annotation encoding="application/x-tex">Z_i</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq> ], having the StochasticDepth<br>
            Note that:<br>
            2-1.The stochastic transparency doesn't depend on the order of the fragments and we sort the geometries from
            near to far is merely to improve the performance by the EarlyDepthTest.<br>
            2-2.Turning on MSAA in StochasticDepthPass is to random sample and the stochastic transparency intrinsically
            doesn't demand other passes to turn on the MSAA.<br>
            If the application demands the effect of &quot;Spatial AntiAliasing&quot;, the application can turn on MASS
            in other passes(Evidently, the application use arbitrary algorithms(for example, the FAXX) in other
            passes).<br>
            These's no relationship between the MSAA used for random sampling (in StochasticDepthPass) and the MSAA used
            for spatial antialiasing (in other passes). For example, we can use 8X MASS in StochasticDepthPass while use
            4X MSAA in other passes.<br>
            2-3.To ensure the uncorrelation among fragments, we must use pseudo random value rather than the
            &quot;AlphaToCoverage&quot; hardware feature.<br>
            2-4.The depth value used in AccumulatePass is the value of the shading position not the value of the
            sampling position. To be consistant, we prefer to write the depth (value of the shading position) to
            gl_FragDepth/SV_Depth in the fragment shader.<br>
            2-5.By the limit of the hardware, the maximum sample count of MSAA is 8X MSAA. The author (6.[Enderton
            2010]) proposed that we can use multiple passes to simulate more sample counts. Due to the performance
            issue, we only use one pass.
        </p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">3.AccumulateAndTotalAlphaPass //GeometryPass<br>
            copy the BackgroundDepth to initialize the depth buffer<br>
            with depth test without depth write, with MRT and SeparateBlend/IndependentBlend, sort the transparent
            geometries by [material], bind the StochasticDepth to the SampledTextureUnit and draw them with estimate
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mi mathvariant="normal">SV</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <annotation encoding="application/x-tex">\operatorname{SV} ( Z_i )</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.01389em;">SV</span></span><span
                                class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                    style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span></span></span></eq> by sampling the texture in fragment
            shader, having the StochasticColor, CorrectAlphaTotal and StochasticTotalAlpha<br>
            Note that:<br>
            3-1.Since the depth write is turned off, the order of the geometries doesn't impact on the performance and
            thus we sort the geometries only by the material.<br>
            3-2.We have that &quot;StochasticColor = <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <munderover>
                                            <mo>∑</mo>
                                            <mrow>
                                                <mi>i</mi>
                                                <mo>=</mo>
                                                <mn>0</mn>
                                            </mrow>
                                            <mi>n</mi>
                                        </munderover>
                                    </mstyle>
                                    <mi mathvariant="normal">SV</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mrow>
                                <annotation encoding="application/x-tex">{\displaystyle\sum_{i = 0}^n} \operatorname{SV}
                                    ( Z_i ) A_i C_i</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span
                                    class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mop"><span class="mord mathrm"
                                    style="margin-right:0.01389em;">SV</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq>&quot;, &quot;CorrectAlphaTotal = <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <munderover>
                                            <mo>∏</mo>
                                            <mrow>
                                                <mi>i</mi>
                                                <mo>=</mo>
                                                <mn>0</mn>
                                            </mrow>
                                            <mi>n</mi>
                                        </munderover>
                                    </mstyle>
                                    <mo stretchy="false">(</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <annotation encoding="application/x-tex">1 - {\displaystyle\prod_{i = 0}^n} ( 1 - A_i )
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                                class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span
                                    class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∏</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span></span></span></eq>&quot; and &quot;StochasticTotalAlpha =
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <munderover>
                                            <mo>∑</mo>
                                            <mrow>
                                                <mi>i</mi>
                                                <mo>=</mo>
                                                <mn>0</mn>
                                            </mrow>
                                            <mi>n</mi>
                                        </munderover>
                                    </mstyle>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">SV</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <annotation encoding="application/x-tex">{\displaystyle\sum_{i = 0}^n} (
                                    \operatorname{SV} ( Z_i ) A_i )</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span
                                    class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mop"><span class="mord mathrm"
                                    style="margin-right:0.01389em;">SV</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span></span></span></eq>&quot;.<br>
            3-3.The relationship between the AlphaTotal and the TotalAlpha is TotalAlpha = 1 – AlphaTotal. The term
            &quot;TotalAlpha&quot; is from the stochastic transparency(6.[Enderton 2010]) while the term
            &quot;AlphaTotal&quot; is from the Under Operation(1.[Porter 1984]、4. [Dunn 2014]).<br>
            3-4.The StochasticTotalAlpha is only used when the Alpha correction is turned on. This means that we can
            reduce one RT if we don't turn on the Alpha correction.<br>
            3-5.The author(6.[Enderton 2010]) use two separate passes AccumulatePass(which calculates the
            StochasticColor and the StochasticTotalAlpha) and TotalAlphaPass(which calculates CorrectAlphaTotal).
            However, we can totally merge them into a single pass. Maybe the SeparateBlend/IndependentBlend was not
            supported by the hardware when the author published the paper.
        </p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">4.CompositePass //FullScreenTrianglePass<br>
            Without the Alpha correction, the total contribution of the transparent geometries:<br>
            TransparentColor = <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <munderover>
                                            <mo>∑</mo>
                                            <mrow>
                                                <mi>i</mi>
                                                <mo>=</mo>
                                                <mn>0</mn>
                                            </mrow>
                                            <mi>n</mi>
                                        </munderover>
                                        <mi mathvariant="normal">SV</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <msub>
                                            <mi>C</mi>
                                            <mi>i</mi>
                                        </msub>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle { \sum_{i = 0}^n}
                                    \operatorname{SV} ( Z_i ) A_i C_i</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span
                                    class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mop"><span class="mord mathrm"
                                    style="margin-right:0.01389em;">SV</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq> = StochasticColor<br>
            With the Alpha correction, the total contribution of the transparent geometries:<br>
            TransparentColor = <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mo fence="true">{</mo>
                                    <mtable rowspacing="0.3600em" columnalign="left left" columnspacing="1em">
                                        <mtr>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mrow>
                                                        <mstyle scriptlevel="0" displaystyle="true">
                                                            <munderover>
                                                                <mo>∑</mo>
                                                                <mrow>
                                                                    <mi>i</mi>
                                                                    <mo>=</mo>
                                                                    <mn>0</mn>
                                                                </mrow>
                                                                <mi>n</mi>
                                                            </munderover>
                                                        </mstyle>
                                                        <mrow>
                                                            <mo stretchy="false">(</mo>
                                                            <mi mathvariant="normal">SV</mi>
                                                            <mo>⁡</mo>
                                                            <mo stretchy="false">(</mo>
                                                            <msub>
                                                                <mi>Z</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                            <mo stretchy="false">)</mo>
                                                            <mfrac>
                                                                <mrow>
                                                                    <mn>1</mn>
                                                                    <mo>−</mo>
                                                                    <mstyle scriptlevel="0" displaystyle="true">
                                                                        <munderover>
                                                                            <mo>∏</mo>
                                                                            <mrow>
                                                                                <mi>i</mi>
                                                                                <mo>=</mo>
                                                                                <mn>0</mn>
                                                                            </mrow>
                                                                            <mi>n</mi>
                                                                        </munderover>
                                                                    </mstyle>
                                                                    <mo stretchy="false">(</mo>
                                                                    <mn>1</mn>
                                                                    <mo>−</mo>
                                                                    <msub>
                                                                        <mi>A</mi>
                                                                        <mi>i</mi>
                                                                    </msub>
                                                                    <mo stretchy="false">)</mo>
                                                                </mrow>
                                                                <mrow>
                                                                    <mstyle scriptlevel="0" displaystyle="true">
                                                                        <munderover>
                                                                            <mo>∑</mo>
                                                                            <mrow>
                                                                                <mi>i</mi>
                                                                                <mo>=</mo>
                                                                                <mn>0</mn>
                                                                            </mrow>
                                                                            <mi>n</mi>
                                                                        </munderover>
                                                                    </mstyle>
                                                                    <mo stretchy="false">(</mo>
                                                                    <mi mathvariant="normal">SV</mi>
                                                                    <mo>⁡</mo>
                                                                    <mo stretchy="false">(</mo>
                                                                    <msub>
                                                                        <mi>Z</mi>
                                                                        <mi>i</mi>
                                                                    </msub>
                                                                    <mo stretchy="false">)</mo>
                                                                    <msub>
                                                                        <mi>A</mi>
                                                                        <mi>i</mi>
                                                                    </msub>
                                                                    <mo stretchy="false">)</mo>
                                                                </mrow>
                                                            </mfrac>
                                                            <mo stretchy="false">)</mo>
                                                            <msub>
                                                                <mi>A</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                            <msub>
                                                                <mi>C</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                        </mrow>
                                                    </mrow>
                                                </mstyle>
                                            </mtd>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mrow>
                                                        <mi>i</mi>
                                                        <mi>f</mi>
                                                        <mtext>  </mtext>
                                                        <mstyle scriptlevel="0" displaystyle="true">
                                                            <munderover>
                                                                <mo>∑</mo>
                                                                <mrow>
                                                                    <mi>i</mi>
                                                                    <mo>=</mo>
                                                                    <mn>0</mn>
                                                                </mrow>
                                                                <mi>n</mi>
                                                            </munderover>
                                                        </mstyle>
                                                        <mrow>
                                                            <mi mathvariant="normal">SV</mi>
                                                            <mo>⁡</mo>
                                                            <mo stretchy="false">(</mo>
                                                            <msub>
                                                                <mi>Z</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                            <mo stretchy="false">)</mo>
                                                            <msub>
                                                                <mi>A</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                            <mo stretchy="false">)</mo>
                                                        </mrow>
                                                        <mo>&gt;</mo>
                                                        <mn>0</mn>
                                                    </mrow>
                                                </mstyle>
                                            </mtd>
                                        </mtr>
                                        <mtr>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mn>0</mn>
                                                </mstyle>
                                            </mtd>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mrow>
                                                        <mi>i</mi>
                                                        <mi>f</mi>
                                                        <mtext>  </mtext>
                                                        <mstyle scriptlevel="0" displaystyle="true">
                                                            <munderover>
                                                                <mo>∑</mo>
                                                                <mrow>
                                                                    <mi>i</mi>
                                                                    <mo>=</mo>
                                                                    <mn>0</mn>
                                                                </mrow>
                                                                <mi>n</mi>
                                                            </munderover>
                                                        </mstyle>
                                                        <mi mathvariant="normal">SV</mi>
                                                        <mo>⁡</mo>
                                                        <mo stretchy="false">(</mo>
                                                        <msub>
                                                            <mi>Z</mi>
                                                            <mi>i</mi>
                                                        </msub>
                                                        <mo stretchy="false">)</mo>
                                                        <msub>
                                                            <mi>A</mi>
                                                            <mi>i</mi>
                                                        </msub>
                                                        <mo>=</mo>
                                                        <mn>0</mn>
                                                    </mrow>
                                                </mstyle>
                                            </mtd>
                                        </mtr>
                                    </mtable>
                                </mrow>
                                <annotation encoding="application/x-tex">{\begin{cases} {\displaystyle\sum_{i = 0}^n} {
                                    ( \operatorname{SV} ( Z_i ) \frac{1- {\displaystyle\prod_{i = 0}^n} ( 1 - A_i ) }{
                                    {\displaystyle\sum_{i = 0}^n} ( \operatorname{SV}( Z_i ) A_i )} ) A_i C_i } &amp;{if
                                    \; {\displaystyle\sum_{i = 0}^n} {\operatorname{SV}( Z_i ) A_i)} &gt; 0} \\0
                                    &amp;{if \; {\displaystyle\sum_{i = 0}^n} \operatorname{SV}( Z_i ) A_i = 0}
                                    \end{cases}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:9.000039999999998em;vertical-align:-4.250019999999999em;"></span><span
                                class="mord"><span class="minner"><span class="mopen"><span
                                            class="delimsizing mult"><span class="vlist-t vlist-t2"><span
                                                    class="vlist-r"><span class="vlist"
                                                        style="height:4.750019999999999em;"><span
                                                            style="top:-1.36599em;"><span class="pstrut"
                                                                style="height:4.715999999999999em;"></span><span
                                                                class="delimsizinginner delim-size4"><span>⎩</span></span></span><span
                                                            style="top:-1.35799em;"><span class="pstrut"
                                                                style="height:4.715999999999999em;"></span><span
                                                                style="height:2.7159999999999993em;width:0.889em;"><svg
                                                                    width='0.889em' height='2.7159999999999993em'
                                                                    style='width:0.889em' viewBox='0 0 889 2716'
                                                                    preserveAspectRatio='xMinYMin'>
                                                                    <path
                                                                        d='M384 0 H504 V2716 H384z M384 0 H504 V2716 H384z' />
                                                                </svg></span></span><span
                                                            style="top:-4.716009999999999em;"><span class="pstrut"
                                                                style="height:4.715999999999999em;"></span><span
                                                                class="delimsizinginner delim-size4"><span>⎨</span></span></span><span
                                                            style="top:-5.858009999999999em;"><span class="pstrut"
                                                                style="height:4.715999999999999em;"></span><span
                                                                style="height:2.7159999999999993em;width:0.889em;"><svg
                                                                    width='0.889em' height='2.7159999999999993em'
                                                                    style='width:0.889em' viewBox='0 0 889 2716'
                                                                    preserveAspectRatio='xMinYMin'>
                                                                    <path
                                                                        d='M384 0 H504 V2716 H384z M384 0 H504 V2716 H384z' />
                                                                </svg></span></span><span
                                                            style="top:-8.566019999999998em;"><span class="pstrut"
                                                                style="height:4.715999999999999em;"></span><span
                                                                class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:4.250019999999999em;"><span></span></span></span></span></span></span><span
                                        class="mord"><span class="mtable"><span class="col-align-l"><span
                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                            style="height:4.7035990000000005em;"><span
                                                                style="top:-6.7035990000000005em;"><span class="pstrut"
                                                                    style="height:5.239066em;"></span><span
                                                                    class="mord"><span class="mord"><span
                                                                            class="mop op-limits"><span
                                                                                class="vlist-t vlist-t2"><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:1.6513970000000002em;"><span
                                                                                            style="top:-1.872331em;margin-left:0em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3.05em;"></span><span
                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                    class="mord mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span><span
                                                                                                        class="mrel mtight">=</span><span
                                                                                                        class="mord mtight">0</span></span></span></span><span
                                                                                            style="top:-3.050005em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3.05em;"></span><span><span
                                                                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                                                                            style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3.05em;"></span><span
                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                    class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                        class="vlist-s">​</span></span><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                        class="mord"><span class="mopen">(</span><span
                                                                            class="mop"><span class="mord mathrm"
                                                                                style="margin-right:0.01389em;">SV</span></span><span
                                                                            class="mopen">(</span><span
                                                                            class="mord"><span class="mord mathnormal"
                                                                                style="margin-right:0.07153em;">Z</span><span
                                                                                class="msupsub"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.31166399999999994em;"><span
                                                                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:2.7em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                            class="mclose">)</span><span
                                                                            class="mord"><span
                                                                                class="mopen nulldelimiter"></span><span
                                                                                class="mfrac"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:3.2390660000000002em;"><span
                                                                                                style="top:-2.19em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.6513970000000002em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mop op-limits sizing reset-size3 size6"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:1.6513970000000002em;"><span
                                                                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:3.05em;"></span><span
                                                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                                                        class="mord mtight"><span
                                                                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                                                                            class="mrel mtight">=</span><span
                                                                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                                                                style="top:-3.050005em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:3.05em;"></span><span><span
                                                                                                                                        class="mop op-symbol large-op">∑</span></span></span><span
                                                                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:3.05em;"></span><span
                                                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                                                            class="mopen mtight">(</span><span
                                                                                                            class="mop mtight"><span
                                                                                                                class="mord mathrm mtight"
                                                                                                                style="margin-right:0.01389em;">SV</span></span><span
                                                                                                            class="mopen mtight">(</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mord mathnormal mtight"
                                                                                                                style="margin-right:0.07153em;">Z</span><span
                                                                                                                class="msupsub"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.3280857142857143em;"><span
                                                                                                                                style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:2.5em;"></span><span
                                                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                                                            class="mclose mtight">)</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mord mathnormal mtight">A</span><span
                                                                                                                class="msupsub"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.3280857142857143em;"><span
                                                                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:2.5em;"></span><span
                                                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                                                            class="mclose mtight">)</span></span></span></span><span
                                                                                                style="top:-3.881397em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.6513970000000002em;"></span><span
                                                                                                    class="frac-line"
                                                                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                                                                style="top:-5.239066em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.6513970000000002em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mtight">1</span><span
                                                                                                            class="mbin mtight">−</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mop op-limits sizing reset-size3 size6"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:1.6513970000000002em;"><span
                                                                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:3.05em;"></span><span
                                                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                                                        class="mord mtight"><span
                                                                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                                                                            class="mrel mtight">=</span><span
                                                                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                                                                style="top:-3.050005em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:3.05em;"></span><span><span
                                                                                                                                        class="mop op-symbol large-op">∏</span></span></span><span
                                                                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:3.05em;"></span><span
                                                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                                                            class="mopen mtight">(</span><span
                                                                                                            class="mord mtight">1</span><span
                                                                                                            class="mbin mtight">−</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mord mathnormal mtight">A</span><span
                                                                                                                class="msupsub"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.3280857142857143em;"><span
                                                                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:2.5em;"></span><span
                                                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                                                            class="mclose mtight">)</span></span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:2.7390660000000002em;"><span></span></span></span></span></span><span
                                                                                class="mclose nulldelimiter"></span></span><span
                                                                            class="mclose">)</span><span
                                                                            class="mord"><span
                                                                                class="mord mathnormal">A</span><span
                                                                                class="msupsub"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.31166399999999994em;"><span
                                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:2.7em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                            class="mord"><span class="mord mathnormal"
                                                                                style="margin-right:0.07153em;">C</span><span
                                                                                class="msupsub"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.31166399999999994em;"><span
                                                                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:2.7em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                                                style="top:-2.3131359999999996em;"><span class="pstrut"
                                                                    style="height:5.239066em;"></span><span
                                                                    class="mord"><span
                                                                        class="mord">0</span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:4.2035990000000005em;"><span></span></span></span></span></span><span
                                                class="arraycolsep" style="width:1em;"></span><span
                                                class="col-align-l"><span class="vlist-t vlist-t2"><span
                                                        class="vlist-r"><span class="vlist"
                                                            style="height:4.7035990000000005em;"><span
                                                                style="top:-6.7035990000000005em;"><span class="pstrut"
                                                                    style="height:5.239066em;"></span><span
                                                                    class="mord"><span class="mord"><span
                                                                            class="mord mathnormal">i</span><span
                                                                            class="mord mathnormal"
                                                                            style="margin-right:0.10764em;">f</span><span
                                                                            class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mord"><span
                                                                                class="mop op-limits"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.6513970000000002em;"><span
                                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                                            class="mrel mtight">=</span><span
                                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                                style="top:-3.050005em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span><span
                                                                                                        class="mop op-symbol large-op">∑</span></span></span><span
                                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                            class="mord"><span class="mop"><span
                                                                                    class="mord mathrm"
                                                                                    style="margin-right:0.01389em;">SV</span></span><span
                                                                                class="mopen">(</span><span
                                                                                class="mord"><span
                                                                                    class="mord mathnormal"
                                                                                    style="margin-right:0.07153em;">Z</span><span
                                                                                    class="msupsub"><span
                                                                                        class="vlist-t vlist-t2"><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.31166399999999994em;"><span
                                                                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                                        class="pstrut"
                                                                                                        style="height:2.7em;"></span><span
                                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                class="vlist-s">​</span></span><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                class="mclose">)</span><span
                                                                                class="mord"><span
                                                                                    class="mord mathnormal">A</span><span
                                                                                    class="msupsub"><span
                                                                                        class="vlist-t vlist-t2"><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.31166399999999994em;"><span
                                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                                        class="pstrut"
                                                                                                        style="height:2.7em;"></span><span
                                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                class="vlist-s">​</span></span><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                class="mclose">)</span></span><span
                                                                            class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mrel">&gt;</span><span class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mord">0</span></span></span></span><span
                                                                style="top:-2.3131359999999996em;"><span class="pstrut"
                                                                    style="height:5.239066em;"></span><span
                                                                    class="mord"><span class="mord"><span
                                                                            class="mord mathnormal">i</span><span
                                                                            class="mord mathnormal"
                                                                            style="margin-right:0.10764em;">f</span><span
                                                                            class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mord"><span
                                                                                class="mop op-limits"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.6513970000000002em;"><span
                                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                                            class="mrel mtight">=</span><span
                                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                                style="top:-3.050005em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span><span
                                                                                                        class="mop op-symbol large-op">∑</span></span></span><span
                                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                            class="mspace"
                                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                                            class="mop"><span class="mord mathrm"
                                                                                style="margin-right:0.01389em;">SV</span></span><span
                                                                            class="mopen">(</span><span
                                                                            class="mord"><span class="mord mathnormal"
                                                                                style="margin-right:0.07153em;">Z</span><span
                                                                                class="msupsub"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.31166399999999994em;"><span
                                                                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:2.7em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                            class="mclose">)</span><span
                                                                            class="mord"><span
                                                                                class="mord mathnormal">A</span><span
                                                                                class="msupsub"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.31166399999999994em;"><span
                                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:2.7em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                            class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mrel">=</span><span class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mord">0</span></span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:4.2035990000000005em;"><span></span></span></span></span></span></span></span><span
                                        class="mclose nulldelimiter"></span></span></span></span></span></span></eq><br>
            = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mo fence="true">{</mo>
                                    <mtable rowspacing="0.3600em" columnalign="left left" columnspacing="1em">
                                        <mtr>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mrow>
                                                        <mrow>
                                                            <mo stretchy="false">(</mo>
                                                            <mstyle scriptlevel="0" displaystyle="true">
                                                                <munderover>
                                                                    <mo>∑</mo>
                                                                    <mrow>
                                                                        <mi>i</mi>
                                                                        <mo>=</mo>
                                                                        <mn>0</mn>
                                                                    </mrow>
                                                                    <mi>n</mi>
                                                                </munderover>
                                                            </mstyle>
                                                            <mrow>
                                                                <mi mathvariant="normal">SV</mi>
                                                                <mo>⁡</mo>
                                                                <mo stretchy="false">(</mo>
                                                                <msub>
                                                                    <mi>Z</mi>
                                                                    <mi>i</mi>
                                                                </msub>
                                                                <mo stretchy="false">)</mo>
                                                            </mrow>
                                                            <msub>
                                                                <mi>A</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                            <msub>
                                                                <mi>C</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                            <mo stretchy="false">)</mo>
                                                        </mrow>
                                                        <mfrac>
                                                            <mrow>
                                                                <mn>1</mn>
                                                                <mo>−</mo>
                                                                <mstyle scriptlevel="0" displaystyle="true">
                                                                    <munderover>
                                                                        <mo>∏</mo>
                                                                        <mrow>
                                                                            <mi>i</mi>
                                                                            <mo>=</mo>
                                                                            <mn>0</mn>
                                                                        </mrow>
                                                                        <mi>n</mi>
                                                                    </munderover>
                                                                </mstyle>
                                                                <mo stretchy="false">(</mo>
                                                                <mn>1</mn>
                                                                <mo>−</mo>
                                                                <msub>
                                                                    <mi>A</mi>
                                                                    <mi>i</mi>
                                                                </msub>
                                                                <mo stretchy="false">)</mo>
                                                            </mrow>
                                                            <mrow>
                                                                <mstyle scriptlevel="0" displaystyle="true">
                                                                    <munderover>
                                                                        <mo>∑</mo>
                                                                        <mrow>
                                                                            <mi>i</mi>
                                                                            <mo>=</mo>
                                                                            <mn>0</mn>
                                                                        </mrow>
                                                                        <mi>n</mi>
                                                                    </munderover>
                                                                </mstyle>
                                                                <mo stretchy="false">(</mo>
                                                                <mi mathvariant="normal">SV</mi>
                                                                <mo>⁡</mo>
                                                                <mo stretchy="false">(</mo>
                                                                <msub>
                                                                    <mi>Z</mi>
                                                                    <mi>i</mi>
                                                                </msub>
                                                                <mo stretchy="false">)</mo>
                                                                <msub>
                                                                    <mi>A</mi>
                                                                    <mi>i</mi>
                                                                </msub>
                                                                <mo stretchy="false">)</mo>
                                                            </mrow>
                                                        </mfrac>
                                                    </mrow>
                                                </mstyle>
                                            </mtd>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mrow>
                                                        <mi>i</mi>
                                                        <mi>f</mi>
                                                        <mtext>  </mtext>
                                                        <mstyle scriptlevel="0" displaystyle="true">
                                                            <munderover>
                                                                <mo>∑</mo>
                                                                <mrow>
                                                                    <mi>i</mi>
                                                                    <mo>=</mo>
                                                                    <mn>0</mn>
                                                                </mrow>
                                                                <mi>n</mi>
                                                            </munderover>
                                                        </mstyle>
                                                        <mo stretchy="false">(</mo>
                                                        <mi mathvariant="normal">SV</mi>
                                                        <mo>⁡</mo>
                                                        <mo stretchy="false">(</mo>
                                                        <msub>
                                                            <mi>Z</mi>
                                                            <mi>i</mi>
                                                        </msub>
                                                        <mo stretchy="false">)</mo>
                                                        <msub>
                                                            <mi>A</mi>
                                                            <mi>i</mi>
                                                        </msub>
                                                        <mo stretchy="false">)</mo>
                                                        <mo>&gt;</mo>
                                                        <mn>0</mn>
                                                    </mrow>
                                                </mstyle>
                                            </mtd>
                                        </mtr>
                                        <mtr>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mn>0</mn>
                                                </mstyle>
                                            </mtd>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mrow>
                                                        <mi>i</mi>
                                                        <mi>f</mi>
                                                        <mtext>  </mtext>
                                                        <mstyle scriptlevel="0" displaystyle="true">
                                                            <munderover>
                                                                <mo>∑</mo>
                                                                <mrow>
                                                                    <mi>i</mi>
                                                                    <mo>=</mo>
                                                                    <mn>0</mn>
                                                                </mrow>
                                                                <mi>n</mi>
                                                            </munderover>
                                                        </mstyle>
                                                        <mrow>
                                                            <mo stretchy="false">(</mo>
                                                            <mrow>
                                                                <mi mathvariant="normal">SV</mi>
                                                                <mo>⁡</mo>
                                                                <mo stretchy="false">(</mo>
                                                                <msub>
                                                                    <mi>Z</mi>
                                                                    <mi>i</mi>
                                                                </msub>
                                                                <mo stretchy="false">)</mo>
                                                            </mrow>
                                                            <msub>
                                                                <mi>A</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                            <mo stretchy="false">)</mo>
                                                        </mrow>
                                                        <mo>=</mo>
                                                        <mn>0</mn>
                                                    </mrow>
                                                </mstyle>
                                            </mtd>
                                        </mtr>
                                    </mtable>
                                </mrow>
                                <annotation encoding="application/x-tex">{\begin{cases} {({\displaystyle\sum_{i =
                                    0}^n}{\operatorname{SV}( Z_i )} A_i C_i)}{\frac{1 - {\displaystyle\prod_{i = 0}^n}(
                                    1 - A_i )}{{\displaystyle\sum_{i = 0}^n}(\operatorname{SV}( Z_i ) A_i)}}
                                    &amp;{if\;{\displaystyle\sum_{i = 0}^n} ( \operatorname{SV}( Z_i ) A_i ) &gt; 0} \\0
                                    &amp;{if\;{\displaystyle\sum_{i = 0}^n}{({\operatorname{SV}( Z_i)}A_i)}=0}
                                    \end{cases}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:9.000039999999998em;vertical-align:-4.250019999999999em;"></span><span
                                class="mord"><span class="minner"><span class="mopen"><span
                                            class="delimsizing mult"><span class="vlist-t vlist-t2"><span
                                                    class="vlist-r"><span class="vlist"
                                                        style="height:4.750019999999999em;"><span
                                                            style="top:-1.36599em;"><span class="pstrut"
                                                                style="height:4.715999999999999em;"></span><span
                                                                class="delimsizinginner delim-size4"><span>⎩</span></span></span><span
                                                            style="top:-1.35799em;"><span class="pstrut"
                                                                style="height:4.715999999999999em;"></span><span
                                                                style="height:2.7159999999999993em;width:0.889em;"><svg
                                                                    width='0.889em' height='2.7159999999999993em'
                                                                    style='width:0.889em' viewBox='0 0 889 2716'
                                                                    preserveAspectRatio='xMinYMin'>
                                                                    <path
                                                                        d='M384 0 H504 V2716 H384z M384 0 H504 V2716 H384z' />
                                                                </svg></span></span><span
                                                            style="top:-4.716009999999999em;"><span class="pstrut"
                                                                style="height:4.715999999999999em;"></span><span
                                                                class="delimsizinginner delim-size4"><span>⎨</span></span></span><span
                                                            style="top:-5.858009999999999em;"><span class="pstrut"
                                                                style="height:4.715999999999999em;"></span><span
                                                                style="height:2.7159999999999993em;width:0.889em;"><svg
                                                                    width='0.889em' height='2.7159999999999993em'
                                                                    style='width:0.889em' viewBox='0 0 889 2716'
                                                                    preserveAspectRatio='xMinYMin'>
                                                                    <path
                                                                        d='M384 0 H504 V2716 H384z M384 0 H504 V2716 H384z' />
                                                                </svg></span></span><span
                                                            style="top:-8.566019999999998em;"><span class="pstrut"
                                                                style="height:4.715999999999999em;"></span><span
                                                                class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:4.250019999999999em;"><span></span></span></span></span></span></span><span
                                        class="mord"><span class="mtable"><span class="col-align-l"><span
                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                            style="height:4.7035990000000005em;"><span
                                                                style="top:-6.7035990000000005em;"><span class="pstrut"
                                                                    style="height:5.239066em;"></span><span
                                                                    class="mord"><span class="mord"><span
                                                                            class="mopen">(</span><span
                                                                            class="mord"><span
                                                                                class="mop op-limits"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.6513970000000002em;"><span
                                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                                            class="mrel mtight">=</span><span
                                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                                style="top:-3.050005em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span><span
                                                                                                        class="mop op-symbol large-op">∑</span></span></span><span
                                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                            class="mord"><span class="mop"><span
                                                                                    class="mord mathrm"
                                                                                    style="margin-right:0.01389em;">SV</span></span><span
                                                                                class="mopen">(</span><span
                                                                                class="mord"><span
                                                                                    class="mord mathnormal"
                                                                                    style="margin-right:0.07153em;">Z</span><span
                                                                                    class="msupsub"><span
                                                                                        class="vlist-t vlist-t2"><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.31166399999999994em;"><span
                                                                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                                        class="pstrut"
                                                                                                        style="height:2.7em;"></span><span
                                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                class="vlist-s">​</span></span><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                class="mclose">)</span></span><span
                                                                            class="mord"><span
                                                                                class="mord mathnormal">A</span><span
                                                                                class="msupsub"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.31166399999999994em;"><span
                                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:2.7em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                            class="mord"><span class="mord mathnormal"
                                                                                style="margin-right:0.07153em;">C</span><span
                                                                                class="msupsub"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.31166399999999994em;"><span
                                                                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:2.7em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                            class="mclose">)</span></span><span
                                                                        class="mord"><span class="mord"><span
                                                                                class="mopen nulldelimiter"></span><span
                                                                                class="mfrac"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:3.2390660000000002em;"><span
                                                                                                style="top:-2.19em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.6513970000000002em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mop op-limits sizing reset-size3 size6"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:1.6513970000000002em;"><span
                                                                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:3.05em;"></span><span
                                                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                                                        class="mord mtight"><span
                                                                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                                                                            class="mrel mtight">=</span><span
                                                                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                                                                style="top:-3.050005em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:3.05em;"></span><span><span
                                                                                                                                        class="mop op-symbol large-op">∑</span></span></span><span
                                                                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:3.05em;"></span><span
                                                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                                                            class="mopen mtight">(</span><span
                                                                                                            class="mop mtight"><span
                                                                                                                class="mord mathrm mtight"
                                                                                                                style="margin-right:0.01389em;">SV</span></span><span
                                                                                                            class="mopen mtight">(</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mord mathnormal mtight"
                                                                                                                style="margin-right:0.07153em;">Z</span><span
                                                                                                                class="msupsub"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.3280857142857143em;"><span
                                                                                                                                style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:2.5em;"></span><span
                                                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                                                            class="mclose mtight">)</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mord mathnormal mtight">A</span><span
                                                                                                                class="msupsub"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.3280857142857143em;"><span
                                                                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:2.5em;"></span><span
                                                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                                                            class="mclose mtight">)</span></span></span></span><span
                                                                                                style="top:-3.881397em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.6513970000000002em;"></span><span
                                                                                                    class="frac-line"
                                                                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                                                                style="top:-5.239066em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.6513970000000002em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mtight">1</span><span
                                                                                                            class="mbin mtight">−</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mop op-limits sizing reset-size3 size6"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:1.6513970000000002em;"><span
                                                                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:3.05em;"></span><span
                                                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                                                        class="mord mtight"><span
                                                                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                                                                            class="mrel mtight">=</span><span
                                                                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                                                                style="top:-3.050005em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:3.05em;"></span><span><span
                                                                                                                                        class="mop op-symbol large-op">∏</span></span></span><span
                                                                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:3.05em;"></span><span
                                                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                                                            class="mopen mtight">(</span><span
                                                                                                            class="mord mtight">1</span><span
                                                                                                            class="mbin mtight">−</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mord mathnormal mtight">A</span><span
                                                                                                                class="msupsub"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.3280857142857143em;"><span
                                                                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:2.5em;"></span><span
                                                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                                                            class="mclose mtight">)</span></span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:2.7390660000000002em;"><span></span></span></span></span></span><span
                                                                                class="mclose nulldelimiter"></span></span></span></span></span><span
                                                                style="top:-2.3131359999999996em;"><span class="pstrut"
                                                                    style="height:5.239066em;"></span><span
                                                                    class="mord"><span
                                                                        class="mord">0</span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:4.2035990000000005em;"><span></span></span></span></span></span><span
                                                class="arraycolsep" style="width:1em;"></span><span
                                                class="col-align-l"><span class="vlist-t vlist-t2"><span
                                                        class="vlist-r"><span class="vlist"
                                                            style="height:4.7035990000000005em;"><span
                                                                style="top:-6.7035990000000005em;"><span class="pstrut"
                                                                    style="height:5.239066em;"></span><span
                                                                    class="mord"><span class="mord"><span
                                                                            class="mord mathnormal">i</span><span
                                                                            class="mord mathnormal"
                                                                            style="margin-right:0.10764em;">f</span><span
                                                                            class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mord"><span
                                                                                class="mop op-limits"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.6513970000000002em;"><span
                                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                                            class="mrel mtight">=</span><span
                                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                                style="top:-3.050005em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span><span
                                                                                                        class="mop op-symbol large-op">∑</span></span></span><span
                                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                            class="mopen">(</span><span
                                                                            class="mop"><span class="mord mathrm"
                                                                                style="margin-right:0.01389em;">SV</span></span><span
                                                                            class="mopen">(</span><span
                                                                            class="mord"><span class="mord mathnormal"
                                                                                style="margin-right:0.07153em;">Z</span><span
                                                                                class="msupsub"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.31166399999999994em;"><span
                                                                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:2.7em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                            class="mclose">)</span><span
                                                                            class="mord"><span
                                                                                class="mord mathnormal">A</span><span
                                                                                class="msupsub"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.31166399999999994em;"><span
                                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:2.7em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                            class="mclose">)</span><span class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mrel">&gt;</span><span class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mord">0</span></span></span></span><span
                                                                style="top:-2.3131359999999996em;"><span class="pstrut"
                                                                    style="height:5.239066em;"></span><span
                                                                    class="mord"><span class="mord"><span
                                                                            class="mord mathnormal">i</span><span
                                                                            class="mord mathnormal"
                                                                            style="margin-right:0.10764em;">f</span><span
                                                                            class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mord"><span
                                                                                class="mop op-limits"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.6513970000000002em;"><span
                                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                                            class="mrel mtight">=</span><span
                                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                                style="top:-3.050005em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span><span
                                                                                                        class="mop op-symbol large-op">∑</span></span></span><span
                                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                            class="mord"><span
                                                                                class="mopen">(</span><span
                                                                                class="mord"><span class="mop"><span
                                                                                        class="mord mathrm"
                                                                                        style="margin-right:0.01389em;">SV</span></span><span
                                                                                    class="mopen">(</span><span
                                                                                    class="mord"><span
                                                                                        class="mord mathnormal"
                                                                                        style="margin-right:0.07153em;">Z</span><span
                                                                                        class="msupsub"><span
                                                                                            class="vlist-t vlist-t2"><span
                                                                                                class="vlist-r"><span
                                                                                                    class="vlist"
                                                                                                    style="height:0.31166399999999994em;"><span
                                                                                                        style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                                            class="pstrut"
                                                                                                            style="height:2.7em;"></span><span
                                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                    class="vlist-s">​</span></span><span
                                                                                                class="vlist-r"><span
                                                                                                    class="vlist"
                                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                    class="mclose">)</span></span><span
                                                                                class="mord"><span
                                                                                    class="mord mathnormal">A</span><span
                                                                                    class="msupsub"><span
                                                                                        class="vlist-t vlist-t2"><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.31166399999999994em;"><span
                                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                                        class="pstrut"
                                                                                                        style="height:2.7em;"></span><span
                                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                class="vlist-s">​</span></span><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                class="mclose">)</span></span><span
                                                                            class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mrel">=</span><span class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mord">0</span></span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:4.2035990000000005em;"><span></span></span></span></span></span></span></span><span
                                        class="mclose nulldelimiter"></span></span></span></span></span></span></eq><br>
            = <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mo fence="true">{</mo>
                                    <mtable rowspacing="0.3600em" columnalign="left left" columnspacing="1em">
                                        <mtr>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mrow>
                                                        <mtext>StochasticColor</mtext>
                                                        <mfrac>
                                                            <mrow>
                                                                <mn>1</mn>
                                                                <mo>−</mo>
                                                                <mtext>CorrectAlphaTotal</mtext>
                                                            </mrow>
                                                            <mtext>StochasticTotalAlpha</mtext>
                                                        </mfrac>
                                                    </mrow>
                                                </mstyle>
                                            </mtd>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mrow>
                                                        <mi>i</mi>
                                                        <mi>f</mi>
                                                        <mtext>  </mtext>
                                                        <mstyle scriptlevel="0" displaystyle="true">
                                                            <munderover>
                                                                <mo>∑</mo>
                                                                <mrow>
                                                                    <mi>i</mi>
                                                                    <mo>=</mo>
                                                                    <mn>0</mn>
                                                                </mrow>
                                                                <mi>n</mi>
                                                            </munderover>
                                                        </mstyle>
                                                        <mrow>
                                                            <mo stretchy="false">(</mo>
                                                            <mrow>
                                                                <mi mathvariant="normal">SV</mi>
                                                                <mo>⁡</mo>
                                                                <mo stretchy="false">(</mo>
                                                                <msub>
                                                                    <mi>Z</mi>
                                                                    <mi>i</mi>
                                                                </msub>
                                                                <mo stretchy="false">)</mo>
                                                            </mrow>
                                                            <msub>
                                                                <mi>A</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                            <mo stretchy="false">)</mo>
                                                        </mrow>
                                                        <mo>&gt;</mo>
                                                        <mn>0</mn>
                                                    </mrow>
                                                </mstyle>
                                            </mtd>
                                        </mtr>
                                        <mtr>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mn>0</mn>
                                                </mstyle>
                                            </mtd>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mrow>
                                                        <mi>i</mi>
                                                        <mi>f</mi>
                                                        <mtext>  </mtext>
                                                        <mstyle scriptlevel="0" displaystyle="true">
                                                            <munderover>
                                                                <mo>∑</mo>
                                                                <mrow>
                                                                    <mi>i</mi>
                                                                    <mo>=</mo>
                                                                    <mn>0</mn>
                                                                </mrow>
                                                                <mi>n</mi>
                                                            </munderover>
                                                        </mstyle>
                                                        <mo stretchy="false">(</mo>
                                                        <mi mathvariant="normal">SV</mi>
                                                        <mo>⁡</mo>
                                                        <mo stretchy="false">(</mo>
                                                        <msub>
                                                            <mi>Z</mi>
                                                            <mi>i</mi>
                                                        </msub>
                                                        <mo stretchy="false">)</mo>
                                                        <msub>
                                                            <mi>A</mi>
                                                            <mi>i</mi>
                                                        </msub>
                                                        <mo stretchy="false">)</mo>
                                                        <mo>=</mo>
                                                        <mn>0</mn>
                                                    </mrow>
                                                </mstyle>
                                            </mtd>
                                        </mtr>
                                    </mtable>
                                </mrow>
                                <annotation encoding="application/x-tex">{\begin{cases} \text{StochasticColor} \frac{ 1
                                    - \text{CorrectAlphaTotal}}{\text{StochasticTotalAlpha}}
                                    &amp;{if\;{\displaystyle\sum_{i = 0}^n}{({\operatorname{SV}( Z_i )}A_i)} &gt; 0} \\0
                                    &amp;{if\;{\displaystyle\sum_{i = 0}^n} ( \operatorname{SV}( Z_i ) A_i ) = 0}
                                    \end{cases}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:5.8581319999999995em;vertical-align:-2.6790659999999997em;"></span><span
                                class="mord"><span class="minner"><span class="mopen"><span
                                            class="delimsizing mult"><span class="vlist-t vlist-t2"><span
                                                    class="vlist-r"><span class="vlist" style="height:2.95002em;"><span
                                                            style="top:-1.59999em;"><span class="pstrut"
                                                                style="height:3.15em;"></span><span
                                                                class="delimsizinginner delim-size4"><span>⎩</span></span></span><span
                                                            style="top:-1.59199em;"><span class="pstrut"
                                                                style="height:3.15em;"></span><span
                                                                style="height:0.9159999999999999em;width:0.889em;"><svg
                                                                    width='0.889em' height='0.9159999999999999em'
                                                                    style='width:0.889em' viewBox='0 0 889 916'
                                                                    preserveAspectRatio='xMinYMin'>
                                                                    <path
                                                                        d='M384 0 H504 V916 H384z M384 0 H504 V916 H384z' />
                                                                </svg></span></span><span style="top:-3.15001em;"><span
                                                                class="pstrut" style="height:3.15em;"></span><span
                                                                class="delimsizinginner delim-size4"><span>⎨</span></span></span><span
                                                            style="top:-4.292009999999999em;"><span class="pstrut"
                                                                style="height:3.15em;"></span><span
                                                                style="height:0.9159999999999999em;width:0.889em;"><svg
                                                                    width='0.889em' height='0.9159999999999999em'
                                                                    style='width:0.889em' viewBox='0 0 889 916'
                                                                    preserveAspectRatio='xMinYMin'>
                                                                    <path
                                                                        d='M384 0 H504 V916 H384z M384 0 H504 V916 H384z' />
                                                                </svg></span></span><span
                                                            style="top:-5.200019999999999em;"><span class="pstrut"
                                                                style="height:3.15em;"></span><span
                                                                class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:2.45002em;"><span></span></span></span></span></span></span><span
                                        class="mord"><span class="mtable"><span class="col-align-l"><span
                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                            style="height:3.1790659999999997em;"><span
                                                                style="top:-5.179066em;"><span class="pstrut"
                                                                    style="height:3.6513970000000002em;"></span><span
                                                                    class="mord"><span class="mord text"><span
                                                                            class="mord">StochasticColor</span></span><span
                                                                        class="mord"><span
                                                                            class="mopen nulldelimiter"></span><span
                                                                            class="mfrac"><span
                                                                                class="vlist-t vlist-t2"><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.9322159999999999em;"><span
                                                                                            style="top:-2.6550000000000002em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                    class="mord mtight"><span
                                                                                                        class="mord text mtight"><span
                                                                                                            class="mord mtight">StochasticTotalAlpha</span></span></span></span></span><span
                                                                                            style="top:-3.23em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="frac-line"
                                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                                            style="top:-3.446108em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                    class="mord mtight"><span
                                                                                                        class="mord mtight">1</span><span
                                                                                                        class="mbin mtight">−</span><span
                                                                                                        class="mord text mtight"><span
                                                                                                            class="mord mtight">CorrectAlphaTotal</span></span></span></span></span></span><span
                                                                                        class="vlist-s">​</span></span><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.481108em;"><span></span></span></span></span></span><span
                                                                            class="mclose nulldelimiter"></span></span></span></span><span
                                                                style="top:-2.2500000000000004em;"><span class="pstrut"
                                                                    style="height:3.6513970000000002em;"></span><span
                                                                    class="mord"><span
                                                                        class="mord">0</span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:2.6790659999999997em;"><span></span></span></span></span></span><span
                                                class="arraycolsep" style="width:1em;"></span><span
                                                class="col-align-l"><span class="vlist-t vlist-t2"><span
                                                        class="vlist-r"><span class="vlist"
                                                            style="height:3.1790659999999997em;"><span
                                                                style="top:-5.179066em;"><span class="pstrut"
                                                                    style="height:3.6513970000000002em;"></span><span
                                                                    class="mord"><span class="mord"><span
                                                                            class="mord mathnormal">i</span><span
                                                                            class="mord mathnormal"
                                                                            style="margin-right:0.10764em;">f</span><span
                                                                            class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mord"><span
                                                                                class="mop op-limits"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.6513970000000002em;"><span
                                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                                            class="mrel mtight">=</span><span
                                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                                style="top:-3.050005em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span><span
                                                                                                        class="mop op-symbol large-op">∑</span></span></span><span
                                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                            class="mord"><span
                                                                                class="mopen">(</span><span
                                                                                class="mord"><span class="mop"><span
                                                                                        class="mord mathrm"
                                                                                        style="margin-right:0.01389em;">SV</span></span><span
                                                                                    class="mopen">(</span><span
                                                                                    class="mord"><span
                                                                                        class="mord mathnormal"
                                                                                        style="margin-right:0.07153em;">Z</span><span
                                                                                        class="msupsub"><span
                                                                                            class="vlist-t vlist-t2"><span
                                                                                                class="vlist-r"><span
                                                                                                    class="vlist"
                                                                                                    style="height:0.31166399999999994em;"><span
                                                                                                        style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                                            class="pstrut"
                                                                                                            style="height:2.7em;"></span><span
                                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                    class="vlist-s">​</span></span><span
                                                                                                class="vlist-r"><span
                                                                                                    class="vlist"
                                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                    class="mclose">)</span></span><span
                                                                                class="mord"><span
                                                                                    class="mord mathnormal">A</span><span
                                                                                    class="msupsub"><span
                                                                                        class="vlist-t vlist-t2"><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.31166399999999994em;"><span
                                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                                        class="pstrut"
                                                                                                        style="height:2.7em;"></span><span
                                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                class="vlist-s">​</span></span><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                class="mclose">)</span></span><span
                                                                            class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mrel">&gt;</span><span class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mord">0</span></span></span></span><span
                                                                style="top:-2.2500000000000004em;"><span class="pstrut"
                                                                    style="height:3.6513970000000002em;"></span><span
                                                                    class="mord"><span class="mord"><span
                                                                            class="mord mathnormal">i</span><span
                                                                            class="mord mathnormal"
                                                                            style="margin-right:0.10764em;">f</span><span
                                                                            class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mord"><span
                                                                                class="mop op-limits"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.6513970000000002em;"><span
                                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                                            class="mrel mtight">=</span><span
                                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                                style="top:-3.050005em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span><span
                                                                                                        class="mop op-symbol large-op">∑</span></span></span><span
                                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3.05em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                            class="mopen">(</span><span
                                                                            class="mop"><span class="mord mathrm"
                                                                                style="margin-right:0.01389em;">SV</span></span><span
                                                                            class="mopen">(</span><span
                                                                            class="mord"><span class="mord mathnormal"
                                                                                style="margin-right:0.07153em;">Z</span><span
                                                                                class="msupsub"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.31166399999999994em;"><span
                                                                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:2.7em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                            class="mclose">)</span><span
                                                                            class="mord"><span
                                                                                class="mord mathnormal">A</span><span
                                                                                class="msupsub"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.31166399999999994em;"><span
                                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:2.7em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                            class="mclose">)</span><span class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mrel">=</span><span class="mspace"
                                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                                            class="mord">0</span></span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:2.6790659999999997em;"><span></span></span></span></span></span></span></span><span
                                        class="mclose nulldelimiter"></span></span></span></span></span></span></eq><br>
            Note that the StochasticTotalAlpha of opaque geometries is evidently zero. However, due to the random
            sampling, the StochasticTotalAlpha of the transparent geometries can be zero as well.</p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">Then, add the TransparentColor to the final color <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <msub>
                                            <mi>C</mi>
                                            <mrow>
                                                <mi>F</mi>
                                                <mi>i</mi>
                                                <mi>n</mi>
                                                <mi>a</mi>
                                                <mi>l</mi>
                                            </mrow>
                                        </msub>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle C_{Final}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq> by the Over Operation:<br>
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <msub>
                                            <mi>C</mi>
                                            <mrow>
                                                <mi>F</mi>
                                                <mi>i</mi>
                                                <mi>n</mi>
                                                <mi>a</mi>
                                                <mi>l</mi>
                                            </mrow>
                                        </msub>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle C_{Final}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq> = TransparentColor + CorrectAlphaTotal × BackgroundColor<br>
            Note that the BackgroundColor has been added to the color buffer. We can output the TransparentColor and
            CorrectAlphaTotal in the fragment shader and use the Alpha blend hardware feature to implement the Over
            Operation.
        </p>
    </blockquote>
    <h3 dir="auto" id="3-2-4-tileon-chip-memory-1">3-2-4. Tile/On-Chip Memory</h3>
    <p dir="auto">The stochastic transparency is intrinsically suitable to mobile GPU.</p>
    <p dir="auto">In the traditional desktop GPU, the performance bottleneck is the MSAA. Since one pixel corresponds to
        S samples, the bandwidth is increased by S times.</p>
    <p dir="auto">However, in the mobile GPU, this problem has been solved effectively. We can keep the MSAA image in
        the Tile/On-Chip Memory and discard the MSAA image when the renderpass ends without writing to the main memory.
        This means that the bandwidth can be decreased to almost zero.</p>
    <p dir="auto">The Vulkan/Metal API allows the application to set this configuration explicitly:<br>
        Use the &quot;VK_IMAGE_USAGE_TRANSIENT_ATTACHMENT_BIT&quot;/&quot;MTLStorageModeMemoryless&quot; to set the
        storage mode of the image to the Tile/On-Chip Memory explicitly.<br>
        And the images with this storage mode prohibit to be read by the traditional sampled texture unit in the
        fragment shader and must be read by the &quot;Subpass Input&quot;/&quot;[color(m)]Attribute&quot;.</p>
    <p dir="auto">The OpenGL API doesn't allow the application to set this configuration explicitly but we can use
        &quot;FrameBufferFetch&quot;/&quot;PixelLocalStorage&quot;(16.[Bjorge 2014]) to indicate our purpose.</p>
    <h4 dir="auto" id="3-2-4-1-vulkan-1">3-2-4-1. Vulkan</h4>
    <p dir="auto">In Vulkan, one &quot;RenderPass&quot; consists of several &quot;SubPass&quot;. The MSAA simple count
        of different attachments of the same RenderPass may not be the same. However, the MSAA sample count of the
        attachments refered by the same SubPass must be the same and the MSAA sample count is also expected to be the
        same as the count in MultisampleState of the PipelineState when issuing DrawCall.</p>
    <p dir="auto">The stochastic transparency can be implemented in one renderPass as the following: //We suppose the
        application doesn't turn on the MSAA for &quot;Spatial AntiAliasing&quot;.</p>
    <pre><code dir="auto"><code><div>RenderPass  
    Attachments  
        0.FinalColor
        1.BackgroundDepth  
        2.StochasticDepth (MSAA)
        3.StochasticColor
        4.CorrectAlphaTotal
        5.StochasticTotalAlpha
    SubPasses
        0.OpaquePass
            ColorAttachments
                0.FinalColor //BackgroundColor-&gt;FinalColor
            DepthStencilAttachment
                1.BackgroundDepth
        1.CopyPass //Mentioned in StochasticDepthPass //Rasterization MSAA
            InputAttachments
                1.BackGroupDepth
            ColorAttachments
                2.StochasticDepth (MSAA)
        2.StochasticDepthPass //Rasterization MSAA
            DepthStencilAttachments
                2.StochasticDepth (MSAA)  
        3.AccumulateAndTotalAlphaPass
            InputAttachments
                2.StochasticDepth (MSAA)
            ColorAttachments
                3.StochasticColor
                4.CorrectAlphaTotal
                5.StochasticTotalAlpha
            DepthStencilAttachments
                1.BackGroupDepth
        4.CompositePass
            InputAttachments
                3.StochasticColor
                4.CorrectAlphaTotal
                5.StochasticTotalAlpha
            ColorAttachments
                0.FinalColor  //TransparentColor
                (+=(CorrectAlphaTotal×BackgroundColor))-&gt;FinalColor //implement the Over Operation by the Alpha blend hardware feature
    Dependency:
        0.SrcSubPass:0-&gt;DstSubPass:1
            //DepthStencilAttachment-&gt;InputAttachment: 1.BackGroupDepth
        1.SrcSubPass:1-&gt;DstSubPass:2
            //ColorAttachment-&gt;DepthStencilAttachment: 2.StochasticDepth (MSAA)
        2.SrcSubPass:2-&gt;DstSubPass:3
            //DepthStencilAttachment-&gt;InputAttachment: 2.StochasticDepth (MSAA)
        3.SrcSubPass:3-&gt;DstSubPass:4
            //ColorAttachment-&gt;ColorAttachment: 0.FinalColor
            //ColorAttachment-&gt;InputAttachment: 3.StochasticColor
            //ColorAttachment-&gt;InputAttachment: 4.CorrectAlphaTotal
            //ColorAttachment-&gt;InputAttachment: 5.StochasticTotalAlpha
    //SubPassDependencyChain: 0-&gt;1-&gt;2-&gt;3-&gt;4  
</div></code></code></pre>
    <h4 dir="auto" id="3-2-4-2-metal-1">3-2-4-2. Metal</h4>
    <p dir="auto">In Metal, there is no such thing like InputAttachment. We instead use the [color(m)]Attribute in
        fragment shader to read the ColorAttachment.<br>
        However, this design introduces the limit that the [color(m)]Attribute only permits us to read the
        ColorAttachment in the fragment shader and we have no method to read the DepthAttachment. We have to use an
        extra ColorAttachment to store the Depth(17.[Apple]) although this may allow us to save the bandwidth by writing
        the lower precise depth to the ColorAttachment and discarding the DepthAttachment.
        This limit may be related to the explanation of the
        &quot;D3D12_RESOURCE_FLAG_DENY_SHADER_RESOURCE&quot;(18.[Microsoft]). This means that for Apple's GPU, the
        performance may be improved by prohibiting reading the DepthAttachment.</p>
    <p dir="auto">Besides, there is no equivalent of &quot;subpassInputMS&quot; in Metal. While turning on the MSAA in
        Metal, the fragment shader is excuted isolatedly for each sample, we can only use the [color(m)]Attribute to
        read the value of one sample not all samples in the pixel and thus we can't calculate the <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi mathvariant="normal">SV</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">\operatorname{SV}( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">SV</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.</p>
    <p dir="auto">However, we may simulate the &quot;subpassInputMS&quot; by multiple ColorAttachments without MSAA.
        Since we turn off the MSAA, there exists only one sample in the DepthAttachment and thus we can't perform MSAA
        depth test by the hardware feature. This means that we have to simulate the depth test by programmable blending
        which will be explained later in the K-Buffer.</p>
    <p dir="auto">Evidently, the simulation is expected to be hostile to the performance and I don't suggest using this
        method in Metal.</p>
    <h3 dir="auto" id="3-2-5-conclusion-1">3-2-5. Conclusion</h3>
    <p dir="auto">Since MSAA is efficient on mobile GPU, the stochastic transparency is intrinsically suitable to mobile
        GPU. We can use the modern Vulkan API to fully explore the advantages of the mobile GPU.</p>
    <p dir="auto">However, due to the limit by the design of the Metal, I don't suggest using the stochastic
        transparency in Metal.</p>
    <p dir="auto">Evidently, the vertex shader doesn't read or write the ColorAttachment and thus doesn't benifit from
        the Tile/On-Chip Memory of the mobile GPU. The mobile GPU prefers the fragment processing to the vertex
        processing(10.[Harris 2019]).<br>
        The stochastic transparency still need to be improved since we still have two geometry
        passes(StochasticDepthPass and AccumulateAndTotalAlphaPass) which may cause the vertex processing to be the
        performance bottleneck.</p>
    <p dir="auto">The stochastic transparency introduces error by itself due to the random sampling while the Alpha
        correction eliminates the noise effectively and thus the noise impacts little.</p>
    <h3 dir="auto" id="3-2-6-demo-1">3-2-6. Demo</h3>
    <p dir="auto">The github address <a
            href="https://github.com/YuqiaoZhang/StochasticTransparency">https://github.com/YuqiaoZhang/StochasticTransparency</a>
    </p>
    <p dir="auto">The demo was originally the &quot;StochasticTransparency&quot; of the &quot;NVIDIA SDK11
        Samples&quot;(9.[Bavoil 2011]). However, there are three fatal problems in the original code provide by the
        NVIDIA:<br>
        1.&quot;Turning on MSAA in StochasticDepthPass is to random sample and the stochastic transparency intrinsically
        doesn't demand other passes to turn on the MSAA.&quot; The original code provided by the NVIDIA turns on the
        MSAA in all passes and thus the frame rate of the stochastic transparency is unexpectedly lower than the depth
        peeling. I turn off all the unnecessary MSAA and the frame rate increases from 670 to 1170 while the frame rate
        of deep peeling is 1070.<br>
        2.&quot;The author use two separate passes AccumulatePass and TotalAlphaPass. However, we can totally merge them
        into a single pass.&quot; The original code provided by the NVIDIA follows the author and use two separate
        passes. I merge the separate passes and the frame rate increases from 1170 to 1370.<br>
        3.&quot;The depth value used in AccumulatePass is the value of the shading position not the value of the
        sampling position. To be consistant, we prefer to write the depth (value of the shading position) to
        gl_FragDepth/SV_Depth in the fragment shader.&quot; The original code provided by the NVIDIA doesn't do this.
        However, the Alpha correction fixes the error well and there's little impaction on the effect.</p>
    <h2 dir="auto" id="3-3-k-buffer-1">3-3. K-Buffer</h2>
    <p dir="auto">Carpenter proposed the &quot;A-Buffer&quot; (11.[Carpenter 1984]) in the same year when Porter
        proposed the Alpha channel. In the A-Buffer, each pixel corresponds to a list in which all fragments
        corresponding to this pixel are stored. After sorting the fragments in the list by the depth, evidently we can
        use Over/Under operation to calculate the final color <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>C</mi>
                                        <mrow>
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                        </mrow>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle C_{Final}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord mathnormal mtight">ina</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.<br>
        Although A-Buffer can be implemented by UAV/StorageImage and atomic operations at present, the implementation is
        very tedious and inelegant. Besides, the performance of the list is low since the address of the list is not
        continuous and thus unfriendly to the cache. Thus there is almost no implementation in reality.</p>
    <p dir="auto">Bavoil improved the A-Buffer and proposed K-Buffer (12.[Bavoil 2007]) in 2007. In K-Buffer, we limit
        the number of the fragments corresponding to each pixel to no more than K. With this limit, the K-Buffer can be
        implemented more elegantly and efficiently.</p>
    <h3 dir="auto" id="3-3-1-rmw-read-modify-write-operation-1">3-3-1. RMW (Read Modify Write) Operation</h3>
    <p dir="auto">In the renderpass in which we generate the K-Buffer, the following RMW operation is performed on each
        fragment:<br>
        1. Read: read the (at most K) fragments corresponding to the same pixel from K-Buffer<br>
        2. Modify: use the information of the current fragment and modified the (at most K) fragments which have been
        read from the K-Buffer<br>
        3. Write: write the (at most K) fragments which have been modified to the K-Buffer</p>
    <p dir="auto">For the current hardware, we can immediately implement the RMW operation by the UAV/StorageImage.
        However, things are far from simple. In general, the RMW operations performed on the fragments corresponding to
        the same pixel should be mutually exclusive to ensure the correctness.</p>
    <p dir="auto">Although the API guarantees the order and dependency of different draw calls, the GPU designers always
        tend to full explore the parallelism to improve the performance. In general, the GPU may still execute these
        draw calls in parallel and merely synchronize at some points.</p>
    <p dir="auto">The API doesn't guarantee the order or dependency of the executions of the fragments (corresponding to
        the same pixel) inside the same draw call. Evidently, the executions can be considered to be parallel since the
        GPU is intrinsically parallel.</p>
    <p dir="auto">The desktop GPU is &quot;Sort-Last Fragment&quot; (13.[Ragan-Kelley 2011]). The parallelism of the
        fragments is expected to be high since the synchronization occurs at the &quot;Reorder Buffer&quot;
        (13.[Ragan-Kelley 2011]) which is after the fragment shader and just before the Alpha blend.</p>
    <p dir="auto">The mobile GPU is &quot;Tile-Based Sort-Middle&quot; (13.[Ragan-Kelley 2011]). The executions of the
        fragments corresponding to the same pixel inside the same draw call can be considered to be serial
        (13.[Ragan-Kelley 2011]) since there doesn't exist the &quot;Reorder Buffer&quot;. However, we shouldn't rely on
        this since the API doesn't guarantee that.</p>
    <p dir="auto">Bavoil proposed two hardware proposals the &quot;Fragment Scheduling&quot; and the &quot;Programmable
        Blending&quot; to solve this problem in 2007 (12.[Bavoil 2007]). Both two proposals have been widely supported
        by the hardware in reality at present.</p>
    <h3 dir="auto" id="3-3-2-fragment-scheduling-1">3-3-2. Fragment Scheduling</h3>
    <p dir="auto">The fragment scheduling corresponds to the
        RasterOrderView/FragmentShaderInterlock/RasterOrderGroup(14.[D 2015], 15.[D 2017]) at present which is generally
        suitable to the desktop GPU.</p>
    <p dir="auto">The pseudo code to implement the K-Buffer by the fragment scheduling is generally as the following:
    </p>
    <pre><code class="code-line language-c++" dir="auto"><div>    <span class="hljs-comment">// This part of code doesn&#x27;t need to be mutually exclusive</span>
    calcalte lighting <span class="hljs-keyword">and</span> shading ... 
                                                
    <span class="hljs-comment">// Enter the critical section</span>
    <span class="hljs-meta">#<span class="hljs-keyword">if</span> RasterOrderView <span class="hljs-comment">// Direct3D</span></span>
        read from ROV
    <span class="hljs-meta">#<span class="hljs-keyword">elif</span> FragmentShaderInterlock <span class="hljs-comment">// OpenGL/Vulkan</span></span>
        beginInvocationInterlockARB
    <span class="hljs-meta">#<span class="hljs-keyword">elif</span> RasterOrderGroup <span class="hljs-comment">// Metal</span></span>
        read from ROG
    <span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

    <span class="hljs-comment">// This part of code is within the protection of the critical section</span>
    perform the RMW operation on the K-Buffer ... 

    <span class="hljs-comment">// Leave the critical section</span>
    <span class="hljs-meta">#<span class="hljs-keyword">if</span> RasterOrderView <span class="hljs-comment">// Direct3D</span></span>
        write to ROV
    <span class="hljs-meta">#<span class="hljs-keyword">elif</span> FragmentShaderInterlock <span class="hljs-comment">// OpenGL/Vulkan</span></span>
        endInvocationInterlockARB
    <span class="hljs-meta">#<span class="hljs-keyword">elif</span> RasterOrderGroup <span class="hljs-comment">// Metal</span></span>
        write to ROG
    <span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
</div></code></pre>
    <p dir="auto">In theory, the contents which we read from or write to the ROV/ROG is not important since we merely
        read or write to enter/leave the critical section. Thus the proposal of &quot;FragmentShaderInterlock&quot; is
        more elegant. We don't have to read from or write to the ROV/ROG when we perform the RMW operation on the
        K-Buffer and the regular UAV/StorageImage(14.[D 2017]) can be used since the related code has been within the
        protection of the critical section.</p>
    <h3 dir="auto" id="3-3-3-programmable-blending-1">3-3-3. Programmable Blending</h3>
    <p dir="auto">The programmable blending, which is generally suitable for the mobile GPU, corresponds to the <a
            href="https://github.com/KhronosGroup/VK-GL-CTS/blob/main/modules/gles31/functional/es31fShaderFramebufferFetchTests.cpp">GL_EXT_shader_framebuffer_fetch</a>
        extension in OpenGL, the [[color(m)]] attribute in Metal (&quot;Table 5.5. Attributes for fragment function
        input arguments&quot; of <a
            href="https://developer.apple.com/metal/Metal-Shading-Language-Specification.pdf">Metal Shading Language
            Specification</a>) and the <a
            href="https://github.com/KhronosGroup/VK-GL-CTS/blob/main/external/vulkancts/modules/vulkan/rasterization/vktRasterizationOrderAttachmentAccessTests.cpp">VK_EXT_rasterization_order_attachment_access</a>
        extension in Vulkan.</p>
    <p dir="auto">The programmable blending allows the fragment shader to perform RMW as an atomic operation on the
        color attachment. The hardware guarantees the mutual exclusion of the fragments corresponding to the same pixel
        automatically.</p>
    <p dir="auto">We can enable the MRT and implement the K-Buffer by programmable blending. We assume that one pixel
        corresponds to four [C A Z] fragments in the K-Buffer and the related Metal code is generally as the following:
    </p>
    <pre><code class="code-line language-c++" dir="auto"><div>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">KBuffer_ColorAttachment</span>  
    {
        <span class="hljs-comment">//In general, [[color(0)]] is used to store the CFinal</span>
        half4 C0A0[[<span class="hljs-built_in">color</span>(<span class="hljs-number">1</span>)]]; <span class="hljs-comment">//R8G8B8A8_UNORM</span>
        half4 C1A1[[<span class="hljs-built_in">color</span>(<span class="hljs-number">2</span>)]]; <span class="hljs-comment">//R8G8B8A8_UNORM</span>
        half4 C2A2[[<span class="hljs-built_in">color</span>(<span class="hljs-number">3</span>)]]; <span class="hljs-comment">//R8G8B8A8_UNORM</span>
        half4 C3A3[[<span class="hljs-built_in">color</span>(<span class="hljs-number">4</span>)]]; <span class="hljs-comment">//R8G8B8A8_UNORM</span>
        half4 Z0123[[<span class="hljs-built_in">color</span>(<span class="hljs-number">5</span>)]]; <span class="hljs-comment">//R16G16B16A16_FLOAT</span>
    };
    
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">KBuffer_Local</span>
    {
        half4 CA[<span class="hljs-number">4</span>]
        half Z[<span class="hljs-number">4</span>]
    };

    <span class="hljs-function">fragment KBuffer_ColorAttachment <span class="hljs-title">KBufferPass_FragmentMain</span><span class="hljs-params">(..., KBuffer_ColorAttachment kbuffer_in)</span>
    </span>{
        <span class="hljs-comment">// This part of code doesn&#x27;t need to be mutually exclusive</span>
        CA = <span class="hljs-built_in">CalcalteLighting_And_Shading</span>(...) 
        <span class="hljs-comment">// In general, &quot;Z&quot; denotes position.z</span>
        Z = ... 

        KBuffer_Local kbuffer_local;

        <span class="hljs-comment">// Read K-Buffer</span>
        <span class="hljs-comment">// We enter the critical section automatically when we read the ColorAttachment </span>
        kbuffer_local.Z[<span class="hljs-number">0</span>] = kbuffer_in.Z0123.r; 
        kbuffer_local.Z[<span class="hljs-number">1</span>] = kbuffer_in.Z0123.g;
        kbuffer_local.Z[<span class="hljs-number">2</span>] = kbuffer_in.Z0123.b;
        kbuffer_local.Z[<span class="hljs-number">3</span>] = kbuffer_in.Z0123.a;
        kbuffer_local.CA[<span class="hljs-number">0</span>] = kbuffer_in.C0A0;
        kbuffer_local.CA[<span class="hljs-number">1</span>] = kbuffer_in.C1A1;
        kbuffer_local.CA[<span class="hljs-number">2</span>] = kbuffer_in.C2A2;
        kbuffer_local.CA[<span class="hljs-number">3</span>] = kbuffer_in.C3A3;
        
        <span class="hljs-comment">// Modify K-Buffer</span>
        <span class="hljs-comment">// This part of code is within the protection of the critical section</span>
        ... (The concrete code depends on the requirements of the application) 
        
        <span class="hljs-comment">// Write K-Buffer </span>
        <span class="hljs-comment">// We leave the critical section automatically after we write the ColorAttachment</span>
        KBuffer_ColorAttachment kbuffer_out;
        kbuffer_out.C0A0 = kbuffer_local.CA[<span class="hljs-number">0</span>];
        kbuffer_out.C1A1 = kbuffer_local.CA[<span class="hljs-number">1</span>];
        kbuffer_out.C2A2 = kbuffer_local.CA[<span class="hljs-number">2</span>];
        kbuffer_out.C3A3 = kbuffer_local.CA[<span class="hljs-number">3</span>];
        kbuffer_out.Z0123 = <span class="hljs-built_in">half4</span>(kbuffer_local.Z[<span class="hljs-number">0</span>], kbuffer_local.Z[<span class="hljs-number">1</span>], kbuffer_local.Z[<span class="hljs-number">2</span>], kbuffer_local.Z[<span class="hljs-number">3</span>]); 
        
        <span class="hljs-keyword">return</span> kbuffer_out;
    }
</div></code></pre>
    <h3 dir="auto" id="3-3-4-mlab-mult-layer-alpha-blending-1">3-3-4. MLAB (Mult Layer Alpha Blending)</h3>
    <p dir="auto">Salvi proposed three algorithms which are all based on the K-Buffer in 2010, 2011 and 2014(19.[Salvi
        2010], 20.[Salvi 2011], 21.[Salvi 2014]) and we intend to explain the lastest one which is called the MLAB
        proposed in 2014.</p>
    <h4 dir="auto" id="3-3-4-1-k-buffer-1">3-3-4-1. K-Buffer</h4>
    <p dir="auto">In MLAB, the format of the fragments in K-Buffer is [ <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle A_i C_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> | <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle 1 - A_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> | <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> ].<br>
        The algorithm is generally as the following:<br>
        1. Initializes the fragments in the K-Buffer to the &quot;empty fragment&quot; which is &quot;<eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>C</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle C_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>=0 <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle A_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>=0 <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>=farthest&quot;. // In reality, since the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is in the range from 0 to 1, we only need to ensure that the value of <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is farther than all possible values.<br>
        2. When we generate the K-Buffer, the modify operation performed on the K-Buffer is to sort the fragments from
        near to far based on the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and insert the current fragment (which the fragment shader is executing) into the proper position based on
        the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.<br>
        Evidently we have K+1 fragments at present. Then the modify operation will merge the two farthest fragments into
        one fragment based on the rule of Under operation such that [ <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle A_i C_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> | <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle 1 - A_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> | <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> ] + [ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>A</mi>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle A_{i+1} C_{i+1}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">i</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">i</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> | <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle 1 - A_{i+1}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">i</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> | <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>Z</mi>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle Z_{i+1}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">i</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> ] = [ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo>+</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle A_i C_i + ( 1 - A_i ) A_{i+1} C_{i+1}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">i</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">i</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> | <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mo stretchy="false">(</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle ( 1 - A_i ) ( 1 - A_{i+1} )
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span
                            class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">i</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.208331em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> | <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle Z_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> ] and thus we have K fragments again.<br>
        Evidently, if we insert another fragment nearer than the fragment merged by two fragments, there exists error.
        By Salvi, the error intruduced by the two farthest fragments is the lowest since the visibility function <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span>
        </eq> is monotonically decreasing and the
        farthest fragments generally introduce the lowest error.<br>
        3. Based on the generated K-Buffer, we calculate the total contribution of the transparent geometries to the
        final color <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>C</mi>
                                        <mrow>
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                        </mrow>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle C_{Final}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord mathnormal mtight">ina</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> by the K fragments.</p>
    <h4 dir="auto" id="3-3-4-2-render-pass-1">3-3-4-2. Render Pass</h4>
    <blockquote dir="auto">
        <p dir="auto">1. OpaquePass<br>
            draw the opaque geometries and have the BackgroundColor and the BackgroundDepth.</p>
        <p dir="auto">2. KBufferPass // GeometryPass<br>
            reuse the BackgroundDepth by the OpaquePass<br>
            use clear load_op to initilize the fragments in the K-Buffer to the &quot;empty fragment&quot; [ 0 0
            farthest]<br>
            with depth test without depth write, sort the transparent geometries by [material] and draw them to generate
            the K-Buffer<br>
            Note that since the depth write is turned off, the order of the geometries doesn't impact on the performance
            and thus we sort the geometries only by the material.</p>
        <p dir="auto">3. CompositePass // FullScreenTrianglePass<br>
            Based on the generated K-Buffer, use the Under operation to calculate the total contribution of the
            transparent geometries to the final color <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <msub>
                                            <mi>C</mi>
                                            <mrow>
                                                <mi>F</mi>
                                                <mi>i</mi>
                                                <mi>n</mi>
                                                <mi>a</mi>
                                                <mi>l</mi>
                                            </mrow>
                                        </msub>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle C_{Final}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq>: TransparentColor and AlphaTotal</p>
        <p dir="auto">Then, add the TransparentColor to the final color <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <msub>
                                            <mi>C</mi>
                                            <mrow>
                                                <mi>F</mi>
                                                <mi>i</mi>
                                                <mi>n</mi>
                                                <mi>a</mi>
                                                <mi>l</mi>
                                            </mrow>
                                        </msub>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle C_{Final}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq> by the Over Operation:<br>
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <msub>
                                            <mi>C</mi>
                                            <mrow>
                                                <mi>F</mi>
                                                <mi>i</mi>
                                                <mi>n</mi>
                                                <mi>a</mi>
                                                <mi>l</mi>
                                            </mrow>
                                        </msub>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle C_{Final}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq> = TransparentColor + CorrectAlphaTotal × BackgroundColor)<br>
            Note that the BackgroundColor has been added to the color buffer. We can output the TransparentColor and
            CorrectAlphaTotal in the fragment shader and use the Alpha blend hardware feature to implement the Over
            Operation.
        </p>
    </blockquote>
    <h3 dir="auto" id="3-3-5-tileon-chip-memory-1">3-3-5. Tile/On-Chip Memory</h3>
    <p dir="auto">The K-Buffer is intrinsically suitable to mobile GPU.</p>
    <p dir="auto">In the traditional desktop GPU, the bandwidth is increased by K times due to the K-Buffer.</p>
    <p dir="auto">However, in the mobile GPU, we can keep the K-Buffer in the Tile/On-Chip Memory and discard the
        K-Buffer when the renderpass ends without writing to the main memory. This means that the bandwidth can be
        decreased to almost zero.</p>
    <h4 dir="auto" id="3-3-5-1-vulkan-1">3-3-5-1. Vulkan</h4>
    <p dir="auto">The K-Buffer can be implemented by the <a
            href="https://github.com/KhronosGroup/VK-GL-CTS/blob/main/external/vulkancts/modules/vulkan/rasterization/vktRasterizationOrderAttachmentAccessTests.cpp">VK_EXT_rasterization_order_attachment_access</a>
        extension in Vulkan.</p>
    <p dir="auto">However, this extension has not been widely supported on Android devices.</p>
    <h4 dir="auto" id="3-3-5-2-metal-1">3-3-5-2. Metal</h4>
    <p dir="auto">The K-Buffer can be implemented in one renderPass as the following: // We assume that the K of
        K-Buffer equals four.</p>
    <pre><code dir="auto"><code><div>    RenderPassDescriptor:
        ColorAttachment:
            0.FinalColor // Load:Clear // Store:Store // Format:R10G10B10A2_UNORM  // HDR10
            1.xyz:A0*C0 w:1-A0 //Load:Clear // ClearValue:[ 0 0 0 1 ] //Store:DontCare //Format:R16G16B16A16_FLOAT  
            // The size of the PixelStorage is limited(A7-128bit A8\A9\A10-256bit A11-512bit)  
            // Since the visibility function is monotonically decreasing and the farther fragments generally contribute introduce the lowest error, we prefer to reduce the precision of the farther fragments.
            2.xyz:A1*C1 w:1-A1 // Load:Clear // ClearValue:[ 0 0 0 1 ] // Store:DontCare // Format:R8G8B8A8_UNORM 
            3.xyz:A2*C2 w:1-A2 // Load:Clear // ClearValue:[ 0 0 0 1 ] // Store:DontCare // Format:R8G8B8A8_UNORM
            4.xyz:A3*C3 w:1-A3 // Load:Clear // ClearValue:[ 0 0 0 1 ] // Store:DontCare // Format:R8G8B8A8_UNORM
            5.Z0123 // Load:Clear // ClearValue:[ farthest farthest farthest farthest ] // Store:DontCare // Format:R16G16B16A16_FLOAT
        DepthAttachment:
            Depth // Load:Clear // Store:DontCare
    RenderCommandEncoder:
        0.OpaquePass:
            BackgroundColor-&gt;Color[0]
            BackgroundDepth-&gt;Depth
        1.KBufferPass:
            Read: Color[1]/Color[2]/Color[3]/Color[4]/Color[5] -&gt; 4 Fragments
            Modify: ...
            Write: 4 Fragments -&gt; Color[1]/Color[2]/Color[3]/Color[4]/Color[5]
            // reuse the BackgroundDepth
        3.CompositePass:
            Color[1]/Color[2]/Color[3]/Color[4]/Color[5] -&gt; ...
            ... -&gt; TransparentColor
            ... -&gt; AlphaTotal
            Color[0] -&gt; BackgroundColor
            TransparentColor+AlphaTotal*BackgroundColor -&gt; Color[0]
</div></code></code></pre>
    <h3 dir="auto" id="3-3-6-conclusion-1">3-3-6. Conclusion</h3>
    <p dir="auto">Since the K-Buffer is efficient on mobile GPU, the MLAB is intrinsically suitable to mobile GPU. We
        can use the modern Metal API to fully explore the advantages of the mobile GPU.</p>
    <p dir="auto">Compared to the stochastic transparency, there is only one geometry pass in MLAB. This is beneficial
        to the mobile GPU since the vertex processing is not efficient on the mobile GPU.</p>
    <p dir="auto">Besides, for the mobile GPU, the executions of the fragments corresponding to the same pixel inside
        the same draw call is intrinsically serial (13.[Ragan-Kelley 2011]) and thus the mutual exclusion can be
        considered to introduce little overhead.<br>
        However, for the desktop GPU, mutual exclusion of the RMW operation limits the parallelism of the fragments and
        introduces extra overhead which is related to the &quot;Depth Complexity&quot; of the scene.</p>
    <p dir="auto">When we insert another fragment nearer than the fragment merged by two fragments, we introduce
        error.<br>
        However, since the visibility function <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is monotonically decreasing, the farthest
        fragments generally introduce little error and thus the error impacts little.</p>
    <h3 dir="auto" id="3-3-7-demo-1">3-3-7. Demo</h3>
    <p dir="auto">The github address <a
            href="https://github.com/HanetakaChou/MultiLayerAlphaBlending">https://github.com/HanetakaChou/MultiLayerAlphaBlending</a>
    </p>
    <p dir="auto">The demo was originally the &quot;Order Independent Transparency with Imageblocks&quot; of the
        &quot;Metal Sample Code&quot;(22.[Imbrogno 2017]). However, the original code provide by the Apple depends on
        the feature Imageblock which is only available on A11 and later GPU. The Imageblock is intrinsically to
        customize the format of the framebuffer which is not related to the mutual exclusion of the RMW operation at
        all. Thus I have modified the demo and use the \[[Color(m)]] Attributeto implement the related code and the demo
        can be run on A8 and later GPU.</p>
    <p dir="auto">The relationship of the features between Metal and OpenGL:<br>
        \[[Color(m)]] Attribute &lt;-&gt; FrameBufferFetch // To support the programmable blending<br>
        ImageBlock &lt;-&gt; PixelLocalStorage // To customize the format of the framebuffer</p>
    <h2 dir="auto" id="3-4-weighted-blending-1">3-4. Weighted Blending</h2>
    <p dir="auto">The estimation of the visibility function <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> depends on the order of the fragments.
        This results in that the estimation of the final color <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>C</mi>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>F</mi>
                                            <mi>i</mi>
                                            <mi>n</mi>
                                            <mi>a</mi>
                                            <mi>l</mi>
                                        </mstyle>
                                    </msub>
                                    <mo>=</mo>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mstyle>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>n</mi>
                                        </mstyle>
                                    </munderover>
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msub>
                                        <mi>C</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle C_{\displaystyle Final} =
                                \sum_{\displaystyle i = 0}^{\displaystyle n} \operatorname{V} ( Z_i ) A_i C_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.0329699999999997em;vertical-align:-0.34963999999999984em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.3448em;"><span
                                                style="top:-2.65036em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:3em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal sizing reset-size3 size6"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord mathnormal sizing reset-size3 size6">ina</span><span
                                                            class="mord mathnormal sizing reset-size3 size6"
                                                            style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.34963999999999984em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:3.2560900000000004em;vertical-align:-1.475525em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.7805650000000004em;"><span
                                            style="top:-1.674475em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal sizing reset-size3 size6">i</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                        class="mrel sizing reset-size3 size6">=</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                        class="mord sizing reset-size3 size6">0</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal sizing reset-size3 size6">n</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.475525em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> depends on the order.<br>
        Also by this fact, McGuire proposed the &quot;Weighted Blending&quot;(23.[McGuire 2013], 4.[Dunn 2014]) in 2013
        which uses a predefined weighted function <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">W</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>E</mi>
                                    <mi>y</mi>
                                    <mi>e</mi>
                                    <mi>S</mi>
                                    <mi>p</mi>
                                    <mi>a</mi>
                                    <mi>c</mi>
                                    <mi>e</mi>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{W}( EyeSpaceZ_i, A_i)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">W</span></span><span
                            class="mopen">(</span><span class="mord mathnormal"
                            style="margin-right:0.05764em;">E</span><span class="mord mathnormal">ye</span><span
                            class="mord mathnormal">Sp</span><span class="mord mathnormal">a</span><span
                            class="mord mathnormal">ce</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> which is evidently order independent to
        simulate the visibility function <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">\operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.</p>
    <h3 dir="auto" id="3-4-1-weighted-function-1">3-4-1. Weighted Function</h3>
    <p dir="auto">By McGuire, the nearest fragments might contribute too much to the final color if the weighted
        function only depended on the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi>E</mi>
                                <mi>y</mi>
                                <mi>e</mi>
                                <mi>S</mi>
                                <mi>p</mi>
                                <mi>a</mi>
                                <mi>c</mi>
                                <mi>e</mi>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">EyeSpaceZ_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord mathnormal" style="margin-right:0.05764em;">E</span><span
                            class="mord mathnormal">ye</span><span class="mord mathnormal">Sp</span><span
                            class="mord mathnormal">a</span><span class="mord mathnormal">ce</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>. Thus the weighted function depends on both the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi>E</mi>
                                <mi>y</mi>
                                <mi>e</mi>
                                <mi>S</mi>
                                <mi>p</mi>
                                <mi>a</mi>
                                <mi>c</mi>
                                <mi>e</mi>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">EyeSpaceZ_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord mathnormal" style="margin-right:0.05764em;">E</span><span
                            class="mord mathnormal">ye</span><span class="mord mathnormal">Sp</span><span
                            class="mord mathnormal">a</span><span class="mord mathnormal">ce</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">A_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.</p>
    <p dir="auto">Besides, McGuire proposed three suggested weighted function as the following:<br>
        1.<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mrow>
                                    <mi mathvariant="normal">W</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>E</mi>
                                    <mi>y</mi>
                                    <mi>e</mi>
                                    <mi>S</mi>
                                    <mi>p</mi>
                                    <mi>a</mi>
                                    <mi>c</mi>
                                    <mi>e</mi>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <mo>=</mo>
                                <mi mathvariant="normal">clamp</mi>
                                <mo>⁡</mo>
                                <mrow>
                                    <mo stretchy="false">(</mo>
                                    <mfrac>
                                        <mrow>
                                            <mn>10.0</mn>
                                            <mi>f</mi>
                                        </mrow>
                                        <mrow>
                                            <mn>0.00001</mn>
                                            <mi>f</mi>
                                            <mo>+</mo>
                                            <msup>
                                                <mrow>
                                                    <mo stretchy="false">(</mo>
                                                    <mfrac>
                                                        <mrow>
                                                            <mi>E</mi>
                                                            <mi>y</mi>
                                                            <mi>e</mi>
                                                            <mi>S</mi>
                                                            <mi>p</mi>
                                                            <mi>a</mi>
                                                            <mi>c</mi>
                                                            <mi>e</mi>
                                                            <msub>
                                                                <mi>Z</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                        </mrow>
                                                        <mrow>
                                                            <mn>5.0</mn>
                                                            <mi>f</mi>
                                                        </mrow>
                                                    </mfrac>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                                <mrow>
                                                    <mn>2.0</mn>
                                                    <mi>f</mi>
                                                </mrow>
                                            </msup>
                                            <mo>+</mo>
                                            <msup>
                                                <mrow>
                                                    <mo stretchy="false">(</mo>
                                                    <mfrac>
                                                        <mrow>
                                                            <mi>E</mi>
                                                            <mi>y</mi>
                                                            <mi>e</mi>
                                                            <mi>S</mi>
                                                            <mi>p</mi>
                                                            <mi>a</mi>
                                                            <mi>c</mi>
                                                            <mi>e</mi>
                                                            <msub>
                                                                <mi>Z</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                        </mrow>
                                                        <mrow>
                                                            <mn>200.0</mn>
                                                            <mi>f</mi>
                                                        </mrow>
                                                    </mfrac>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                                <mrow>
                                                    <mn>6.0</mn>
                                                    <mi>f</mi>
                                                </mrow>
                                            </msup>
                                        </mrow>
                                    </mfrac>
                                    <mo separator="true">,</mo>
                                    <mn>0.01</mn>
                                    <mi>f</mi>
                                    <mo separator="true">,</mo>
                                    <mn>3000.0</mn>
                                    <mi>f</mi>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <mo>∗</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">{\operatorname{W}(
                                EyeSpaceZ_i,A_i)}=\operatorname{clamp}{({\frac{10.0f}{0.00001f+{(\frac{EyeSpaceZ_i}{5.0f})}^{2.0f}+{(\frac{EyeSpaceZ_i}{200.0f})}^{6.0f}}},0.01f,3000.0f)}*A_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.01389em;">W</span></span><span
                                class="mopen">(</span><span class="mord mathnormal"
                                style="margin-right:0.05764em;">E</span><span class="mord mathnormal">ye</span><span
                                class="mord mathnormal">Sp</span><span class="mord mathnormal">a</span><span
                                class="mord mathnormal">ce</span><span class="mord"><span class="mord mathnormal"
                                    style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.905931em;vertical-align:-0.9737150000000001em;"></span><span
                            class="mop"><span class="mord mathrm">clamp</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen">(</span><span class="mord"><span class="mord"><span
                                        class="mopen nulldelimiter"></span><span class="mfrac"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.9322159999999999em;"><span
                                                        style="top:-2.3643049999999994em;"><span class="pstrut"
                                                            style="height:3em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mtight"><span
                                                                    class="mord mtight">0.00001</span><span
                                                                    class="mord mathnormal mtight"
                                                                    style="margin-right:0.10764em;">f</span><span
                                                                    class="mbin mtight">+</span><span
                                                                    class="mord mtight"><span class="mord mtight"><span
                                                                            class="mopen mtight">(</span><span
                                                                            class="mord mtight"><span
                                                                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                                                class="mfrac"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.0363928571428573em;"><span
                                                                                                style="top:-2.656em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mtight">5.0</span><span
                                                                                                            class="mord mathnormal mtight"
                                                                                                            style="margin-right:0.10764em;">f</span></span></span></span><span
                                                                                                style="top:-3.2255000000000003em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="frac-line mtight"
                                                                                                    style="border-bottom-width:0.049em;"></span></span><span
                                                                                                style="top:-3.5483000000000002em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mathnormal mtight"
                                                                                                            style="margin-right:0.05764em;">E</span><span
                                                                                                            class="mord mathnormal mtight">ye</span><span
                                                                                                            class="mord mathnormal mtight">Sp</span><span
                                                                                                            class="mord mathnormal mtight">a</span><span
                                                                                                            class="mord mathnormal mtight">ce</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mord mathnormal mtight"
                                                                                                                style="margin-right:0.07153em;">Z</span><span
                                                                                                                class="msupsub"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.3448em;"><span
                                                                                                                                style="top:-2.3448em;margin-left:-0.07153em;margin-right:0.1em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.48288571428571425em;"><span></span></span></span></span></span><span
                                                                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span
                                                                            class="mclose mtight">)</span></span><span
                                                                        class="msupsub"><span class="vlist-t"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.1795642857142858em;"><span
                                                                                        style="top:-3.1835357142857146em;margin-right:0.07142857142857144em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.5em;"></span><span
                                                                                            class="sizing reset-size3 size1 mtight"><span
                                                                                                class="mord mtight"><span
                                                                                                    class="mord mtight">2.0</span><span
                                                                                                    class="mord mathnormal mtight"
                                                                                                    style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span><span
                                                                    class="mbin mtight">+</span><span
                                                                    class="mord mtight"><span class="mord mtight"><span
                                                                            class="mopen mtight">(</span><span
                                                                            class="mord mtight"><span
                                                                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                                                class="mfrac"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.0363928571428573em;"><span
                                                                                                style="top:-2.656em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mtight">200.0</span><span
                                                                                                            class="mord mathnormal mtight"
                                                                                                            style="margin-right:0.10764em;">f</span></span></span></span><span
                                                                                                style="top:-3.2255000000000003em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="frac-line mtight"
                                                                                                    style="border-bottom-width:0.049em;"></span></span><span
                                                                                                style="top:-3.5483000000000002em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mathnormal mtight"
                                                                                                            style="margin-right:0.05764em;">E</span><span
                                                                                                            class="mord mathnormal mtight">ye</span><span
                                                                                                            class="mord mathnormal mtight">Sp</span><span
                                                                                                            class="mord mathnormal mtight">a</span><span
                                                                                                            class="mord mathnormal mtight">ce</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mord mathnormal mtight"
                                                                                                                style="margin-right:0.07153em;">Z</span><span
                                                                                                                class="msupsub"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.3448em;"><span
                                                                                                                                style="top:-2.3448em;margin-left:-0.07153em;margin-right:0.1em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.48288571428571425em;"><span></span></span></span></span></span><span
                                                                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span
                                                                            class="mclose mtight">)</span></span><span
                                                                        class="msupsub"><span class="vlist-t"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.1795642857142858em;"><span
                                                                                        style="top:-3.1835357142857146em;margin-right:0.07142857142857144em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.5em;"></span><span
                                                                                            class="sizing reset-size3 size1 mtight"><span
                                                                                                class="mord mtight"><span
                                                                                                    class="mord mtight">6.0</span><span
                                                                                                    class="mord mathnormal mtight"
                                                                                                    style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span></span></span></span><span
                                                        style="top:-3.23em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="frac-line"
                                                            style="border-bottom-width:0.04em;"></span></span><span
                                                        style="top:-3.446108em;"><span class="pstrut"
                                                            style="height:3em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mtight"><span
                                                                    class="mord mtight">10.0</span><span
                                                                    class="mord mathnormal mtight"
                                                                    style="margin-right:0.10764em;">f</span></span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.9737150000000001em;"><span></span></span></span></span></span><span
                                        class="mclose nulldelimiter"></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord">0.01</span><span
                                class="mord mathnormal" style="margin-right:0.10764em;">f</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord">3000.0</span><span
                                class="mord mathnormal" style="margin-right:0.10764em;">f</span><span
                                class="mclose">)</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq><br>
        2.<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mrow>
                                    <mi mathvariant="normal">W</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>E</mi>
                                    <mi>y</mi>
                                    <mi>e</mi>
                                    <mi>S</mi>
                                    <mi>p</mi>
                                    <mi>a</mi>
                                    <mi>c</mi>
                                    <mi>e</mi>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <mo>=</mo>
                                <mi mathvariant="normal">clamp</mi>
                                <mo>⁡</mo>
                                <mrow>
                                    <mo stretchy="false">(</mo>
                                    <mfrac>
                                        <mrow>
                                            <mn>10.0</mn>
                                            <mi>f</mi>
                                        </mrow>
                                        <mrow>
                                            <mn>0.00001</mn>
                                            <mi>f</mi>
                                            <mo>+</mo>
                                            <msup>
                                                <mrow>
                                                    <mo stretchy="false">(</mo>
                                                    <mfrac>
                                                        <mrow>
                                                            <mi>E</mi>
                                                            <mi>y</mi>
                                                            <mi>e</mi>
                                                            <mi>S</mi>
                                                            <mi>p</mi>
                                                            <mi>a</mi>
                                                            <mi>c</mi>
                                                            <mi>e</mi>
                                                            <msub>
                                                                <mi>Z</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                        </mrow>
                                                        <mrow>
                                                            <mn>10.0</mn>
                                                            <mi>f</mi>
                                                        </mrow>
                                                    </mfrac>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                                <mrow>
                                                    <mn>3.0</mn>
                                                    <mi>f</mi>
                                                </mrow>
                                            </msup>
                                            <mo>+</mo>
                                            <msup>
                                                <mrow>
                                                    <mo stretchy="false">(</mo>
                                                    <mfrac>
                                                        <mrow>
                                                            <mi>E</mi>
                                                            <mi>y</mi>
                                                            <mi>e</mi>
                                                            <mi>S</mi>
                                                            <mi>p</mi>
                                                            <mi>a</mi>
                                                            <mi>c</mi>
                                                            <mi>e</mi>
                                                            <msub>
                                                                <mi>Z</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                        </mrow>
                                                        <mrow>
                                                            <mn>200.0</mn>
                                                            <mi>f</mi>
                                                        </mrow>
                                                    </mfrac>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                                <mrow>
                                                    <mn>6.0</mn>
                                                    <mi>f</mi>
                                                </mrow>
                                            </msup>
                                        </mrow>
                                    </mfrac>
                                    <mo separator="true">,</mo>
                                    <mn>0.01</mn>
                                    <mi>f</mi>
                                    <mo separator="true">,</mo>
                                    <mn>3000.0</mn>
                                    <mi>f</mi>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <mo>∗</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">{\operatorname{W}(
                                EyeSpaceZ_i,A_i)}=\operatorname{clamp}{({\frac{10.0f}{0.00001f+{(\frac{EyeSpaceZ_i}{10.0f})}^{3.0f}+{(\frac{EyeSpaceZ_i}{200.0f})}^{6.0f}}},0.01f,3000.0f)}*A_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.01389em;">W</span></span><span
                                class="mopen">(</span><span class="mord mathnormal"
                                style="margin-right:0.05764em;">E</span><span class="mord mathnormal">ye</span><span
                                class="mord mathnormal">Sp</span><span class="mord mathnormal">a</span><span
                                class="mord mathnormal">ce</span><span class="mord"><span class="mord mathnormal"
                                    style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.905931em;vertical-align:-0.9737150000000001em;"></span><span
                            class="mop"><span class="mord mathrm">clamp</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen">(</span><span class="mord"><span class="mord"><span
                                        class="mopen nulldelimiter"></span><span class="mfrac"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.9322159999999999em;"><span
                                                        style="top:-2.3643049999999994em;"><span class="pstrut"
                                                            style="height:3em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mtight"><span
                                                                    class="mord mtight">0.00001</span><span
                                                                    class="mord mathnormal mtight"
                                                                    style="margin-right:0.10764em;">f</span><span
                                                                    class="mbin mtight">+</span><span
                                                                    class="mord mtight"><span class="mord mtight"><span
                                                                            class="mopen mtight">(</span><span
                                                                            class="mord mtight"><span
                                                                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                                                class="mfrac"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.0363928571428573em;"><span
                                                                                                style="top:-2.656em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mtight">10.0</span><span
                                                                                                            class="mord mathnormal mtight"
                                                                                                            style="margin-right:0.10764em;">f</span></span></span></span><span
                                                                                                style="top:-3.2255000000000003em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="frac-line mtight"
                                                                                                    style="border-bottom-width:0.049em;"></span></span><span
                                                                                                style="top:-3.5483000000000002em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mathnormal mtight"
                                                                                                            style="margin-right:0.05764em;">E</span><span
                                                                                                            class="mord mathnormal mtight">ye</span><span
                                                                                                            class="mord mathnormal mtight">Sp</span><span
                                                                                                            class="mord mathnormal mtight">a</span><span
                                                                                                            class="mord mathnormal mtight">ce</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mord mathnormal mtight"
                                                                                                                style="margin-right:0.07153em;">Z</span><span
                                                                                                                class="msupsub"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.3448em;"><span
                                                                                                                                style="top:-2.3448em;margin-left:-0.07153em;margin-right:0.1em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.48288571428571425em;"><span></span></span></span></span></span><span
                                                                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span
                                                                            class="mclose mtight">)</span></span><span
                                                                        class="msupsub"><span class="vlist-t"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.1795642857142858em;"><span
                                                                                        style="top:-3.1835357142857146em;margin-right:0.07142857142857144em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.5em;"></span><span
                                                                                            class="sizing reset-size3 size1 mtight"><span
                                                                                                class="mord mtight"><span
                                                                                                    class="mord mtight">3.0</span><span
                                                                                                    class="mord mathnormal mtight"
                                                                                                    style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span><span
                                                                    class="mbin mtight">+</span><span
                                                                    class="mord mtight"><span class="mord mtight"><span
                                                                            class="mopen mtight">(</span><span
                                                                            class="mord mtight"><span
                                                                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                                                class="mfrac"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.0363928571428573em;"><span
                                                                                                style="top:-2.656em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mtight">200.0</span><span
                                                                                                            class="mord mathnormal mtight"
                                                                                                            style="margin-right:0.10764em;">f</span></span></span></span><span
                                                                                                style="top:-3.2255000000000003em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="frac-line mtight"
                                                                                                    style="border-bottom-width:0.049em;"></span></span><span
                                                                                                style="top:-3.5483000000000002em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mathnormal mtight"
                                                                                                            style="margin-right:0.05764em;">E</span><span
                                                                                                            class="mord mathnormal mtight">ye</span><span
                                                                                                            class="mord mathnormal mtight">Sp</span><span
                                                                                                            class="mord mathnormal mtight">a</span><span
                                                                                                            class="mord mathnormal mtight">ce</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mord mathnormal mtight"
                                                                                                                style="margin-right:0.07153em;">Z</span><span
                                                                                                                class="msupsub"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.3448em;"><span
                                                                                                                                style="top:-2.3448em;margin-left:-0.07153em;margin-right:0.1em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.48288571428571425em;"><span></span></span></span></span></span><span
                                                                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span
                                                                            class="mclose mtight">)</span></span><span
                                                                        class="msupsub"><span class="vlist-t"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.1795642857142858em;"><span
                                                                                        style="top:-3.1835357142857146em;margin-right:0.07142857142857144em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.5em;"></span><span
                                                                                            class="sizing reset-size3 size1 mtight"><span
                                                                                                class="mord mtight"><span
                                                                                                    class="mord mtight">6.0</span><span
                                                                                                    class="mord mathnormal mtight"
                                                                                                    style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span></span></span></span><span
                                                        style="top:-3.23em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="frac-line"
                                                            style="border-bottom-width:0.04em;"></span></span><span
                                                        style="top:-3.446108em;"><span class="pstrut"
                                                            style="height:3em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mtight"><span
                                                                    class="mord mtight">10.0</span><span
                                                                    class="mord mathnormal mtight"
                                                                    style="margin-right:0.10764em;">f</span></span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.9737150000000001em;"><span></span></span></span></span></span><span
                                        class="mclose nulldelimiter"></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord">0.01</span><span
                                class="mord mathnormal" style="margin-right:0.10764em;">f</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord">3000.0</span><span
                                class="mord mathnormal" style="margin-right:0.10764em;">f</span><span
                                class="mclose">)</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq><br>
        3.<eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mrow>
                                    <mi mathvariant="normal">W</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>E</mi>
                                    <mi>y</mi>
                                    <mi>e</mi>
                                    <mi>S</mi>
                                    <mi>p</mi>
                                    <mi>a</mi>
                                    <mi>c</mi>
                                    <mi>e</mi>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <mo>=</mo>
                                <mi mathvariant="normal">clamp</mi>
                                <mo>⁡</mo>
                                <mrow>
                                    <mo stretchy="false">(</mo>
                                    <mfrac>
                                        <mrow>
                                            <mn>0.03</mn>
                                            <mi>f</mi>
                                        </mrow>
                                        <mrow>
                                            <mn>0.00001</mn>
                                            <mi>f</mi>
                                            <mo>+</mo>
                                            <msup>
                                                <mrow>
                                                    <mo stretchy="false">(</mo>
                                                    <mfrac>
                                                        <mrow>
                                                            <mi>E</mi>
                                                            <mi>y</mi>
                                                            <mi>e</mi>
                                                            <mi>S</mi>
                                                            <mi>p</mi>
                                                            <mi>a</mi>
                                                            <mi>c</mi>
                                                            <mi>e</mi>
                                                            <msub>
                                                                <mi>Z</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                        </mrow>
                                                        <mrow>
                                                            <mn>200.0</mn>
                                                            <mi>f</mi>
                                                        </mrow>
                                                    </mfrac>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                                <mrow>
                                                    <mn>4.0</mn>
                                                    <mi>f</mi>
                                                </mrow>
                                            </msup>
                                        </mrow>
                                    </mfrac>
                                    <mo separator="true">,</mo>
                                    <mn>0.01</mn>
                                    <mi>f</mi>
                                    <mo separator="true">,</mo>
                                    <mn>3000.0</mn>
                                    <mi>f</mi>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <mo>∗</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">{\operatorname{W}(
                                EyeSpaceZ_i,A_i)}=\operatorname{clamp}{({\frac{0.03f}{0.00001f+{(\frac{EyeSpaceZ_i}{200.0f})}^{4.0f}}},0.01f,3000.0f)}*A_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.01389em;">W</span></span><span
                                class="mopen">(</span><span class="mord mathnormal"
                                style="margin-right:0.05764em;">E</span><span class="mord mathnormal">ye</span><span
                                class="mord mathnormal">Sp</span><span class="mord mathnormal">a</span><span
                                class="mord mathnormal">ce</span><span class="mord"><span class="mord mathnormal"
                                    style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.905931em;vertical-align:-0.9737150000000001em;"></span><span
                            class="mop"><span class="mord mathrm">clamp</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen">(</span><span class="mord"><span class="mord"><span
                                        class="mopen nulldelimiter"></span><span class="mfrac"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.9322159999999999em;"><span
                                                        style="top:-2.3643049999999994em;"><span class="pstrut"
                                                            style="height:3em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mtight"><span
                                                                    class="mord mtight">0.00001</span><span
                                                                    class="mord mathnormal mtight"
                                                                    style="margin-right:0.10764em;">f</span><span
                                                                    class="mbin mtight">+</span><span
                                                                    class="mord mtight"><span class="mord mtight"><span
                                                                            class="mopen mtight">(</span><span
                                                                            class="mord mtight"><span
                                                                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                                                class="mfrac"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:1.0363928571428573em;"><span
                                                                                                style="top:-2.656em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mtight">200.0</span><span
                                                                                                            class="mord mathnormal mtight"
                                                                                                            style="margin-right:0.10764em;">f</span></span></span></span><span
                                                                                                style="top:-3.2255000000000003em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="frac-line mtight"
                                                                                                    style="border-bottom-width:0.049em;"></span></span><span
                                                                                                style="top:-3.5483000000000002em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                        class="mord mtight"><span
                                                                                                            class="mord mathnormal mtight"
                                                                                                            style="margin-right:0.05764em;">E</span><span
                                                                                                            class="mord mathnormal mtight">ye</span><span
                                                                                                            class="mord mathnormal mtight">Sp</span><span
                                                                                                            class="mord mathnormal mtight">a</span><span
                                                                                                            class="mord mathnormal mtight">ce</span><span
                                                                                                            class="mord mtight"><span
                                                                                                                class="mord mathnormal mtight"
                                                                                                                style="margin-right:0.07153em;">Z</span><span
                                                                                                                class="msupsub"><span
                                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.3448em;"><span
                                                                                                                                style="top:-2.3448em;margin-left:-0.07153em;margin-right:0.1em;"><span
                                                                                                                                    class="pstrut"
                                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                                            class="vlist-s">​</span></span><span
                                                                                                                        class="vlist-r"><span
                                                                                                                            class="vlist"
                                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.48288571428571425em;"><span></span></span></span></span></span><span
                                                                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span
                                                                            class="mclose mtight">)</span></span><span
                                                                        class="msupsub"><span class="vlist-t"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:1.1795642857142858em;"><span
                                                                                        style="top:-3.1835357142857146em;margin-right:0.07142857142857144em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.5em;"></span><span
                                                                                            class="sizing reset-size3 size1 mtight"><span
                                                                                                class="mord mtight"><span
                                                                                                    class="mord mtight">4.0</span><span
                                                                                                    class="mord mathnormal mtight"
                                                                                                    style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span></span></span></span></span><span
                                                        style="top:-3.23em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="frac-line"
                                                            style="border-bottom-width:0.04em;"></span></span><span
                                                        style="top:-3.446108em;"><span class="pstrut"
                                                            style="height:3em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mtight"><span
                                                                    class="mord mtight">0.03</span><span
                                                                    class="mord mathnormal mtight"
                                                                    style="margin-right:0.10764em;">f</span></span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.9737150000000001em;"><span></span></span></span></span></span><span
                                        class="mclose nulldelimiter"></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord">0.01</span><span
                                class="mord mathnormal" style="margin-right:0.10764em;">f</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord">3000.0</span><span
                                class="mord mathnormal" style="margin-right:0.10764em;">f</span><span
                                class="mclose">)</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq><br>
        Verified by McGuire, the effect seems good when the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi>E</mi>
                                <mi>y</mi>
                                <mi>e</mi>
                                <mi>S</mi>
                                <mi>p</mi>
                                <mi>a</mi>
                                <mi>c</mi>
                                <mi>e</mi>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">EyeSpaceZ_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord mathnormal" style="margin-right:0.05764em;">E</span><span
                            class="mord mathnormal">ye</span><span class="mord mathnormal">Sp</span><span
                            class="mord mathnormal">a</span><span class="mord mathnormal">ce</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is in the range from 0.1 to 500 and the precision of the <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi>E</mi>
                                <mi>y</mi>
                                <mi>e</mi>
                                <mi>S</mi>
                                <mi>p</mi>
                                <mi>a</mi>
                                <mi>c</mi>
                                <mi>e</mi>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">EyeSpaceZ_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord mathnormal" style="margin-right:0.05764em;">E</span><span
                            class="mord mathnormal">ye</span><span class="mord mathnormal">Sp</span><span
                            class="mord mathnormal">a</span><span class="mord mathnormal">ce</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is half float.<br>
        Note that the weighted function may exceed 1 when the fragment is very near while the visibility function is
        evidently less or equal than 1.</p>
    <h3 dir="auto" id="3-4-2-normalization-1">3-4-2. Normalization</h3>
    <p dir="auto">We have proved that <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <mo>=</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <munderover>
                                        <mo>∏</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                </mstyle>
                                <mo stretchy="false">(</mo>
                                <mn>1</mn>
                                <mo>−</mo>
                                <msub>
                                    <mi>A</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">{\displaystyle{\sum_{i = 0}^n}} ( \operatorname{V}
                                ( Z_i ) A_i ) = 1 - {\displaystyle{\prod_{i = 0}^n}} ( 1 - A_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span
                                class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist"
                                                style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop"><span class="mord mathrm"
                                style="margin-right:0.01389em;">V</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord mathnormal">A</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span
                            class="mord"><span class="mord"><span class="mop op-limits"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.6513970000000002em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span><span
                                                                class="mrel mtight">=</span><span
                                                                class="mord mtight">0</span></span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∏</span></span></span><span
                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> in Alpha correction.</p>
    <p dir="auto">The normalization means that we assume that <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mfrac>
                                    <mrow>
                                        <mi mathvariant="normal">W</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>E</mi>
                                        <mi>y</mi>
                                        <mi>e</mi>
                                        <mi>S</mi>
                                        <mi>p</mi>
                                        <mi>a</mi>
                                        <mi>c</mi>
                                        <mi>e</mi>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                    <mrow>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <munderover>
                                                <mo>∑</mo>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>=</mo>
                                                    <mn>0</mn>
                                                </mrow>
                                                <mi>n</mi>
                                            </munderover>
                                        </mstyle>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">W</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>E</mi>
                                        <mi>y</mi>
                                        <mi>e</mi>
                                        <mi>S</mi>
                                        <mi>p</mi>
                                        <mi>a</mi>
                                        <mi>c</mi>
                                        <mi>e</mi>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                </mfrac>
                                <mo>=</mo>
                                <mfrac>
                                    <mrow>
                                        <mi mathvariant="normal">V</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                    <mrow>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <munderover>
                                                <mo>∑</mo>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>=</mo>
                                                    <mn>0</mn>
                                                </mrow>
                                                <mi>n</mi>
                                            </munderover>
                                        </mstyle>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">V</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                </mfrac>
                            </mrow>
                            <annotation encoding="application/x-tex">
                                \frac{\operatorname{W}(EyeSpaceZ_i,A_i)}{{\displaystyle\sum_{i =
                                0}^n}(\operatorname{W}(EyeSpaceZ_i,A_i) A_i)} = \frac{\operatorname{V}(
                                Z_i)}{{\displaystyle\sum_{i = 0}^n}(\operatorname{V}( Z_i) A_i)}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:3.749066em;vertical-align:-2.7390660000000002em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.01em;"><span style="top:-2.19em;"><span class="pstrut"
                                                    style="height:3.6513970000000002em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mop op-limits sizing reset-size3 size6"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:1.6513970000000002em;"><span
                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3.05em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                            class="mrel mtight">=</span><span
                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                style="top:-3.050005em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3.05em;"></span><span><span
                                                                                        class="mop op-symbol large-op">∑</span></span></span><span
                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3.05em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                            class="mopen mtight">(</span><span class="mop mtight"><span
                                                                class="mord mathrm mtight"
                                                                style="margin-right:0.01389em;">W</span></span><span
                                                            class="mopen mtight">(</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.05764em;">E</span><span
                                                            class="mord mathnormal mtight">ye</span><span
                                                            class="mord mathnormal mtight">Sp</span><span
                                                            class="mord mathnormal mtight">a</span><span
                                                            class="mord mathnormal mtight">ce</span><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mpunct mtight">,</span><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">A</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">A</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span></span></span></span><span
                                                style="top:-3.881397em;"><span class="pstrut"
                                                    style="height:3.6513970000000002em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-4.1363970000000005em;"><span class="pstrut"
                                                    style="height:3.6513970000000002em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mop mtight"><span
                                                                class="mord mathrm mtight"
                                                                style="margin-right:0.01389em;">W</span></span><span
                                                            class="mopen mtight">(</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.05764em;">E</span><span
                                                            class="mord mathnormal mtight">ye</span><span
                                                            class="mord mathnormal mtight">Sp</span><span
                                                            class="mord mathnormal mtight">a</span><span
                                                            class="mord mathnormal mtight">ce</span><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mpunct mtight">,</span><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">A</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:2.7390660000000002em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:3.749066em;vertical-align:-2.7390660000000002em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.01em;"><span style="top:-2.19em;"><span class="pstrut"
                                                    style="height:3.6513970000000002em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mop op-limits sizing reset-size3 size6"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:1.6513970000000002em;"><span
                                                                                style="top:-1.872331em;margin-left:0em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3.05em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathnormal mtight">i</span><span
                                                                                            class="mrel mtight">=</span><span
                                                                                            class="mord mtight">0</span></span></span></span><span
                                                                                style="top:-3.050005em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3.05em;"></span><span><span
                                                                                        class="mop op-symbol large-op">∑</span></span></span><span
                                                                                style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3.05em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                            class="mopen mtight">(</span><span class="mop mtight"><span
                                                                class="mord mathrm mtight"
                                                                style="margin-right:0.01389em;">V</span></span><span
                                                            class="mopen mtight">(</span><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">A</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span></span></span></span><span
                                                style="top:-3.881397em;"><span class="pstrut"
                                                    style="height:3.6513970000000002em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-4.1363970000000005em;"><span class="pstrut"
                                                    style="height:3.6513970000000002em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mop mtight"><span
                                                                class="mord mathrm mtight"
                                                                style="margin-right:0.01389em;">V</span></span><span
                                                            class="mopen mtight">(</span><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:2.7390660000000002em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq> and we have that
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mrow>
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <mo>=</mo>
                                <mrow>
                                    <mi mathvariant="normal">W</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>E</mi>
                                    <mi>y</mi>
                                    <mi>e</mi>
                                    <mi>S</mi>
                                    <mi>p</mi>
                                    <mi>a</mi>
                                    <mi>c</mi>
                                    <mi>e</mi>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <mfrac>
                                    <mrow>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <munderover>
                                                <mo>∑</mo>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>=</mo>
                                                    <mn>0</mn>
                                                </mrow>
                                                <mi>n</mi>
                                            </munderover>
                                        </mstyle>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">V</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                    <mrow>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <munderover>
                                                <mo>∑</mo>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>=</mo>
                                                    <mn>0</mn>
                                                </mrow>
                                                <mi>n</mi>
                                            </munderover>
                                        </mstyle>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">W</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>E</mi>
                                        <mi>y</mi>
                                        <mi>e</mi>
                                        <mi>S</mi>
                                        <mi>p</mi>
                                        <mi>a</mi>
                                        <mi>c</mi>
                                        <mi>e</mi>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                </mfrac>
                                <mo>=</mo>
                                <mrow>
                                    <mi mathvariant="normal">W</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>E</mi>
                                    <mi>y</mi>
                                    <mi>e</mi>
                                    <mi>S</mi>
                                    <mi>p</mi>
                                    <mi>a</mi>
                                    <mi>c</mi>
                                    <mi>e</mi>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <mfrac>
                                    <mrow>
                                        <mn>1</mn>
                                        <mo>−</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <munderover>
                                                <mo>∏</mo>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>=</mo>
                                                    <mn>0</mn>
                                                </mrow>
                                                <mi>n</mi>
                                            </munderover>
                                        </mstyle>
                                        <mo stretchy="false">(</mo>
                                        <mn>1</mn>
                                        <mo>−</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                    <mrow>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <munderover>
                                                <mo>∑</mo>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>=</mo>
                                                    <mn>0</mn>
                                                </mrow>
                                                <mi>n</mi>
                                            </munderover>
                                        </mstyle>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">W</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>E</mi>
                                        <mi>y</mi>
                                        <mi>e</mi>
                                        <mi>S</mi>
                                        <mi>p</mi>
                                        <mi>a</mi>
                                        <mi>c</mi>
                                        <mi>e</mi>
                                        <msub>
                                            <mi>Z</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                </mfrac>
                            </mrow>
                            <annotation encoding="application/x-tex">{\operatorname{V}( Z_i )} = {\operatorname{W}(
                                EyeSpaceZ_i,A_i)}{\frac{{\displaystyle\sum_{i = 0}^n}(\operatorname{V}( Z_i)
                                A_i)}{{\displaystyle\sum_{i = 0}^n}(\operatorname{W}( EyeSpaceZ_i,A_i) A_i)}} =
                                {\operatorname{W}(EyeSpaceZ_i,A_i)}{\frac{1-{\displaystyle\prod_{i = 0}^n}( 1 - A_i
                                )}{{\displaystyle\sum_{i = 0}^n}(\operatorname{W}(EyeSpaceZ_i, A_i) A_i)}}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                                class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                    style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:5.9781320000000004em;vertical-align:-2.7390660000000002em;"></span><span
                            class="mord"><span class="mop"><span class="mord mathrm"
                                    style="margin-right:0.01389em;">W</span></span><span class="mopen">(</span><span
                                class="mord mathnormal" style="margin-right:0.05764em;">E</span><span
                                class="mord mathnormal">ye</span><span class="mord mathnormal">Sp</span><span
                                class="mord mathnormal">a</span><span class="mord mathnormal">ce</span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span><span class="mord"><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:3.2390660000000002em;"><span style="top:-2.19em;"><span
                                                        class="pstrut" style="height:3.6513970000000002em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight"><span
                                                                    class="mop op-limits sizing reset-size3 size6"><span
                                                                        class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.6513970000000002em;"><span
                                                                                    style="top:-1.872331em;margin-left:0em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">i</span><span
                                                                                                class="mrel mtight">=</span><span
                                                                                                class="mord mtight">0</span></span></span></span><span
                                                                                    style="top:-3.050005em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span><span
                                                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mop mtight"><span class="mord mathrm mtight"
                                                                    style="margin-right:0.01389em;">W</span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.05764em;">E</span><span
                                                                class="mord mathnormal mtight">ye</span><span
                                                                class="mord mathnormal mtight">Sp</span><span
                                                                class="mord mathnormal mtight">a</span><span
                                                                class="mord mathnormal mtight">ce</span><span
                                                                class="mord mtight"><span class="mord mathnormal mtight"
                                                                    style="margin-right:0.07153em;">Z</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mpunct mtight">,</span><span
                                                                class="mord mtight"><span
                                                                    class="mord mathnormal mtight">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mclose mtight">)</span><span
                                                                class="mord mtight"><span
                                                                    class="mord mathnormal mtight">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mclose mtight">)</span></span></span></span><span
                                                    style="top:-3.881397em;"><span class="pstrut"
                                                        style="height:3.6513970000000002em;"></span><span
                                                        class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-5.239066em;"><span class="pstrut"
                                                        style="height:3.6513970000000002em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight"><span
                                                                    class="mop op-limits sizing reset-size3 size6"><span
                                                                        class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.6513970000000002em;"><span
                                                                                    style="top:-1.872331em;margin-left:0em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">i</span><span
                                                                                                class="mrel mtight">=</span><span
                                                                                                class="mord mtight">0</span></span></span></span><span
                                                                                    style="top:-3.050005em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span><span
                                                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mop mtight"><span class="mord mathrm mtight"
                                                                    style="margin-right:0.01389em;">V</span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mord mtight"><span class="mord mathnormal mtight"
                                                                    style="margin-right:0.07153em;">Z</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mclose mtight">)</span><span
                                                                class="mord mtight"><span
                                                                    class="mord mathnormal mtight">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mclose mtight">)</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:2.7390660000000002em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:5.9781320000000004em;vertical-align:-2.7390660000000002em;"></span><span
                            class="mord"><span class="mop"><span class="mord mathrm"
                                    style="margin-right:0.01389em;">W</span></span><span class="mopen">(</span><span
                                class="mord mathnormal" style="margin-right:0.05764em;">E</span><span
                                class="mord mathnormal">ye</span><span class="mord mathnormal">Sp</span><span
                                class="mord mathnormal">a</span><span class="mord mathnormal">ce</span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span><span class="mord"><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:3.2390660000000002em;"><span style="top:-2.19em;"><span
                                                        class="pstrut" style="height:3.6513970000000002em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight"><span
                                                                    class="mop op-limits sizing reset-size3 size6"><span
                                                                        class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.6513970000000002em;"><span
                                                                                    style="top:-1.872331em;margin-left:0em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">i</span><span
                                                                                                class="mrel mtight">=</span><span
                                                                                                class="mord mtight">0</span></span></span></span><span
                                                                                    style="top:-3.050005em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span><span
                                                                                            class="mop op-symbol large-op">∑</span></span></span><span
                                                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mop mtight"><span class="mord mathrm mtight"
                                                                    style="margin-right:0.01389em;">W</span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.05764em;">E</span><span
                                                                class="mord mathnormal mtight">ye</span><span
                                                                class="mord mathnormal mtight">Sp</span><span
                                                                class="mord mathnormal mtight">a</span><span
                                                                class="mord mathnormal mtight">ce</span><span
                                                                class="mord mtight"><span class="mord mathnormal mtight"
                                                                    style="margin-right:0.07153em;">Z</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:-0.07153em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mpunct mtight">,</span><span
                                                                class="mord mtight"><span
                                                                    class="mord mathnormal mtight">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mclose mtight">)</span><span
                                                                class="mord mtight"><span
                                                                    class="mord mathnormal mtight">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mclose mtight">)</span></span></span></span><span
                                                    style="top:-3.881397em;"><span class="pstrut"
                                                        style="height:3.6513970000000002em;"></span><span
                                                        class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-5.239066em;"><span class="pstrut"
                                                        style="height:3.6513970000000002em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight">1</span><span
                                                                class="mbin mtight">−</span><span
                                                                class="mord mtight"><span
                                                                    class="mop op-limits sizing reset-size3 size6"><span
                                                                        class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.6513970000000002em;"><span
                                                                                    style="top:-1.872331em;margin-left:0em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">i</span><span
                                                                                                class="mrel mtight">=</span><span
                                                                                                class="mord mtight">0</span></span></span></span><span
                                                                                    style="top:-3.050005em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span><span
                                                                                            class="mop op-symbol large-op">∏</span></span></span><span
                                                                                    style="top:-4.3000050000000005em;margin-left:0em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3.05em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.277669em;"><span></span></span></span></span></span></span><span
                                                                class="mopen mtight">(</span><span
                                                                class="mord mtight">1</span><span
                                                                class="mbin mtight">−</span><span
                                                                class="mord mtight"><span
                                                                    class="mord mathnormal mtight">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                                class="mclose mtight">)</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:2.7390660000000002em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></span></eq>.
    </p>
    <h3 dir="auto" id="3-4-3-render-pass-1">3-4-3. Render Pass</h3>
    <blockquote dir="auto">
        <p dir="auto">1.OpaquePass<br>
            draw the opaque geometries and have the BackgroundColor and the BackgroundDepth.</p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">2.AccumulateAndTotalAlphaPass //GeometryPass
            initilize the depth with the BackgroundDepth<br>
            with depth test without depth write, sort the transparent geometries by [material] and draw them, having
            WeightedColor=<eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <munder>
                                            <mo>∑</mo>
                                            <mi>i</mi>
                                        </munder>
                                        <mrow>
                                            <mo stretchy="false">(</mo>
                                            <mrow>
                                                <mi mathvariant="normal">W</mi>
                                                <mo>⁡</mo>
                                                <mo stretchy="false">(</mo>
                                                <mi>E</mi>
                                                <mi>y</mi>
                                                <mi>e</mi>
                                                <mi>S</mi>
                                                <mi>p</mi>
                                                <mi>a</mi>
                                                <mi>c</mi>
                                                <mi>e</mi>
                                                <msub>
                                                    <mi>Z</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mo separator="true">,</mo>
                                                <msub>
                                                    <mi>A</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                            <msub>
                                                <mi>A</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <msub>
                                                <mi>C</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \sum_i{({\operatorname{W}(
                                    EyeSpaceZ_i,A_i)}A_iC_i)}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.327674em;vertical-align:-1.277669em;"></span><span
                                class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                            class="vlist" style="height:1.0500050000000003em;"><span
                                                style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span><span
                                                style="top:-3.050005em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span><span
                                                        class="mop op-symbol large-op">∑</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.277669em;"><span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord"><span class="mopen">(</span><span class="mord"><span class="mop"><span
                                            class="mord mathrm" style="margin-right:0.01389em;">W</span></span><span
                                        class="mopen">(</span><span class="mord mathnormal"
                                        style="margin-right:0.05764em;">E</span><span
                                        class="mord mathnormal">ye</span><span class="mord mathnormal">Sp</span><span
                                        class="mord mathnormal">a</span><span class="mord mathnormal">ce</span><span
                                        class="mord"><span class="mord mathnormal"
                                            style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.31166399999999994em;"><span
                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                        class="mpunct">,</span><span class="mspace"
                                        style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                            class="mord mathnormal">A</span><span class="msupsub"><span
                                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.31166399999999994em;"><span
                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                        class="mclose">)</span></span><span class="mord"><span
                                        class="mord mathnormal">A</span><span class="msupsub"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.31166399999999994em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                            class="pstrut" style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                    class="mord"><span class="mord mathnormal"
                                        style="margin-right:0.07153em;">C</span><span class="msupsub"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.31166399999999994em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                            class="pstrut" style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                    class="mclose">)</span></span></span></span></span></eq>, CorrectAlphaTotal=<eq>
                <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mo>∏</mo>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">(</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <annotation encoding="application/x-tex">1-\prod_i( 1-A_i)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                                class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span
                                class="mop"><span class="mop op-symbol small-op"
                                    style="position:relative;top:-0.0000050000000000050004em;">∏</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.16195399999999993em;"><span
                                                    style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span></span></span>
            </eq> and WeightedTotalAlpha=<eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <msub>
                                        <mo>∑</mo>
                                        <mi>i</mi>
                                    </msub>
                                    <mrow>
                                        <mo stretchy="false">(</mo>
                                        <mrow>
                                            <mi mathvariant="normal">W</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>E</mi>
                                            <mi>y</mi>
                                            <mi>e</mi>
                                            <mi>S</mi>
                                            <mi>p</mi>
                                            <mi>a</mi>
                                            <mi>c</mi>
                                            <mi>e</mi>
                                            <msub>
                                                <mi>Z</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo separator="true">,</mo>
                                            <msub>
                                                <mi>A</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <msub>
                                            <mi>A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                </mrow>
                                <annotation encoding="application/x-tex">\sum_i{({\operatorname{W}(
                                    EyeSpaceZ_i,A_i)}A_i)}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.0497100000000001em;vertical-align:-0.29971000000000003em;"></span><span
                                class="mop"><span class="mop op-symbol small-op"
                                    style="position:relative;top:-0.0000050000000000050004em;">∑</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.16195399999999993em;"><span
                                                    style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord"><span class="mopen">(</span><span class="mord"><span class="mop"><span
                                            class="mord mathrm" style="margin-right:0.01389em;">W</span></span><span
                                        class="mopen">(</span><span class="mord mathnormal"
                                        style="margin-right:0.05764em;">E</span><span
                                        class="mord mathnormal">ye</span><span class="mord mathnormal">Sp</span><span
                                        class="mord mathnormal">a</span><span class="mord mathnormal">ce</span><span
                                        class="mord"><span class="mord mathnormal"
                                            style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.31166399999999994em;"><span
                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                        class="mpunct">,</span><span class="mspace"
                                        style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                            class="mord mathnormal">A</span><span class="msupsub"><span
                                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.31166399999999994em;"><span
                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                        class="mclose">)</span></span><span class="mord"><span
                                        class="mord mathnormal">A</span><span class="msupsub"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.31166399999999994em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                            class="pstrut" style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                    class="mclose">)</span></span></span></span></span></eq><br>
            Note that:<br>
            1.Since the depth write is turned off, the order of the geometries doesn't impact on the performance and
            thus we sort the geometries only by the material.<br>
            2.The relationship between the AlphaTotal and the TotalAlpha is TotalAlpha = 1 – AlphaTotal as stated in the
            stochastic transparency.</p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">3.CompositePass //FullScreenTrianglePass<br>
            The total contribution of the transparent geometries:<br>
            TransparentColor=<eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <munder>
                                            <mo>∑</mo>
                                            <mi>i</mi>
                                        </munder>
                                        <mrow>
                                            <mo stretchy="false">(</mo>
                                            <mrow>
                                                <mo stretchy="false">(</mo>
                                                <mrow>
                                                    <mi mathvariant="normal">W</mi>
                                                    <mo>⁡</mo>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>E</mi>
                                                    <mi>y</mi>
                                                    <mi>e</mi>
                                                    <mi>S</mi>
                                                    <mi>p</mi>
                                                    <mi>a</mi>
                                                    <mi>c</mi>
                                                    <mi>e</mi>
                                                    <msub>
                                                        <mi>Z</mi>
                                                        <mi>i</mi>
                                                    </msub>
                                                    <mo separator="true">,</mo>
                                                    <msub>
                                                        <mi>A</mi>
                                                        <mi>i</mi>
                                                    </msub>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                                <mfrac>
                                                    <mrow>
                                                        <mn>1</mn>
                                                        <mo>−</mo>
                                                        <munder>
                                                            <mo>∏</mo>
                                                            <mi>i</mi>
                                                        </munder>
                                                        <mo stretchy="false">(</mo>
                                                        <mn>1</mn>
                                                        <mo>−</mo>
                                                        <msub>
                                                            <mi>A</mi>
                                                            <mi>i</mi>
                                                        </msub>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mrow>
                                                        <munder>
                                                            <mo>∑</mo>
                                                            <mi>i</mi>
                                                        </munder>
                                                        <mo stretchy="false">(</mo>
                                                        <mrow>
                                                            <mi mathvariant="normal">W</mi>
                                                            <mo>⁡</mo>
                                                            <mo stretchy="false">(</mo>
                                                            <mi>E</mi>
                                                            <mi>y</mi>
                                                            <mi>e</mi>
                                                            <mi>S</mi>
                                                            <mi>p</mi>
                                                            <mi>a</mi>
                                                            <mi>c</mi>
                                                            <mi>e</mi>
                                                            <msub>
                                                                <mi>Z</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                            <mo separator="true">,</mo>
                                                            <msub>
                                                                <mi>A</mi>
                                                                <mi>i</mi>
                                                            </msub>
                                                            <mo stretchy="false">)</mo>
                                                        </mrow>
                                                        <msub>
                                                            <mi>A</mi>
                                                            <mi>i</mi>
                                                        </msub>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                </mfrac>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                            <msub>
                                                <mi>A</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <msub>
                                                <mi>C</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mo>=</mo>
                                        <mrow>
                                            <mo stretchy="false">(</mo>
                                            <munder>
                                                <mo>∑</mo>
                                                <mi>i</mi>
                                            </munder>
                                            <mrow>
                                                <mi mathvariant="normal">W</mi>
                                                <mo>⁡</mo>
                                                <mo stretchy="false">(</mo>
                                                <mi>E</mi>
                                                <mi>y</mi>
                                                <mi>e</mi>
                                                <mi>S</mi>
                                                <mi>p</mi>
                                                <mi>a</mi>
                                                <mi>c</mi>
                                                <mi>e</mi>
                                                <msub>
                                                    <mi>Z</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mo separator="true">,</mo>
                                                <msub>
                                                    <mi>A</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                            <msub>
                                                <mi>A</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <msub>
                                                <mi>C</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mfrac>
                                            <mrow>
                                                <mn>1</mn>
                                                <mo>−</mo>
                                                <munder>
                                                    <mo>∏</mo>
                                                    <mi>i</mi>
                                                </munder>
                                                <mo stretchy="false">(</mo>
                                                <mn>1</mn>
                                                <mo>−</mo>
                                                <msub>
                                                    <mi>A</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                            <mrow>
                                                <munder>
                                                    <mo>∑</mo>
                                                    <mi>i</mi>
                                                </munder>
                                                <mo stretchy="false">(</mo>
                                                <mrow>
                                                    <mi mathvariant="normal">W</mi>
                                                    <mo>⁡</mo>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>E</mi>
                                                    <mi>y</mi>
                                                    <mi>e</mi>
                                                    <mi>S</mi>
                                                    <mi>p</mi>
                                                    <mi>a</mi>
                                                    <mi>c</mi>
                                                    <mi>e</mi>
                                                    <msub>
                                                        <mi>Z</mi>
                                                        <mi>i</mi>
                                                    </msub>
                                                    <mo separator="true">,</mo>
                                                    <msub>
                                                        <mi>A</mi>
                                                        <mi>i</mi>
                                                    </msub>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                                <msub>
                                                    <mi>A</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mfrac>
                                        <mo>=</mo>
                                        <mi>W</mi>
                                        <mi>e</mi>
                                        <mi>i</mi>
                                        <mi>g</mi>
                                        <mi>h</mi>
                                        <mi>t</mi>
                                        <mi>e</mi>
                                        <mi>d</mi>
                                        <mi>C</mi>
                                        <mi>o</mi>
                                        <mi>l</mi>
                                        <mi>o</mi>
                                        <mi>r</mi>
                                        <mfrac>
                                            <mrow>
                                                <mn>1</mn>
                                                <mo>−</mo>
                                                <mi>C</mi>
                                                <mi>o</mi>
                                                <mi>r</mi>
                                                <mi>r</mi>
                                                <mi>e</mi>
                                                <mi>c</mi>
                                                <mi>t</mi>
                                                <mi>A</mi>
                                                <mi>l</mi>
                                                <mi>p</mi>
                                                <mi>h</mi>
                                                <mi>a</mi>
                                                <mi>T</mi>
                                                <mi>o</mi>
                                                <mi>t</mi>
                                                <mi>a</mi>
                                                <mi>l</mi>
                                            </mrow>
                                            <mrow>
                                                <mi>W</mi>
                                                <mi>e</mi>
                                                <mi>i</mi>
                                                <mi>g</mi>
                                                <mi>h</mi>
                                                <mi>t</mi>
                                                <mi>e</mi>
                                                <mi>d</mi>
                                                <mi>T</mi>
                                                <mi>o</mi>
                                                <mi>t</mi>
                                                <mi>a</mi>
                                                <mi>l</mi>
                                                <mi>A</mi>
                                                <mi>l</mi>
                                                <mi>p</mi>
                                                <mi>h</mi>
                                                <mi>a</mi>
                                            </mrow>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \sum_i{({({\operatorname{W}(
                                    EyeSpaceZ_i,A_i)}\frac{1-\prod_i( 1-A_i)}{\sum_i({\operatorname{W}(
                                    EyeSpaceZ_i,A_i)}A_i)})}A_iC_i)}={(\sum_i{\operatorname{W}(
                                    EyeSpaceZ_i,A_i)}A_iC_i)}{\frac{1-\prod_i( 1-A_i)}{\sum_i({\operatorname{W}(
                                    EyeSpaceZ_i,A_i)}A_i)}}=WeightedColor\frac{1-CorrectAlphaTotal}{WeightedTotalAlpha}
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.717379em;vertical-align:-1.277669em;"></span><span
                                class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                            class="vlist" style="height:1.0500050000000003em;"><span
                                                style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span><span
                                                style="top:-3.050005em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span><span
                                                        class="mop op-symbol large-op">∑</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.277669em;"><span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord"><span class="mopen">(</span><span class="mord"><span
                                        class="mopen">(</span><span class="mord"><span class="mop"><span
                                                class="mord mathrm" style="margin-right:0.01389em;">W</span></span><span
                                            class="mopen">(</span><span class="mord mathnormal"
                                            style="margin-right:0.05764em;">E</span><span
                                            class="mord mathnormal">ye</span><span
                                            class="mord mathnormal">Sp</span><span class="mord mathnormal">a</span><span
                                            class="mord mathnormal">ce</span><span class="mord"><span
                                                class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span
                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                        class="vlist-r"><span class="vlist"
                                                            style="height:0.31166399999999994em;"><span
                                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                    class="pstrut" style="height:2.7em;"></span><span
                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                            class="mpunct">,</span><span class="mspace"
                                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                                class="mord mathnormal">A</span><span class="msupsub"><span
                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                            style="height:0.31166399999999994em;"><span
                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                    class="pstrut" style="height:2.7em;"></span><span
                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                            class="vlist-s">​</span></span><span class="vlist-r"><span
                                                            class="vlist"
                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                            class="mclose">)</span></span><span class="mord"><span
                                            class="mopen nulldelimiter"></span><span class="mfrac"><span
                                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                        style="height:1.4397100000000003em;"><span
                                                            style="top:-2.314em;"><span class="pstrut"
                                                                style="height:3em;"></span><span class="mord"><span
                                                                    class="mop"><span class="mop op-symbol small-op"
                                                                        style="position:relative;top:-0.0000050000000000050004em;">∑</span><span
                                                                        class="msupsub"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.16195399999999993em;"><span
                                                                                        style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.7em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
                                                                    class="mopen">(</span><span class="mord"><span
                                                                        class="mop"><span class="mord mathrm"
                                                                            style="margin-right:0.01389em;">W</span></span><span
                                                                        class="mopen">(</span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.05764em;">E</span><span
                                                                        class="mord mathnormal">ye</span><span
                                                                        class="mord mathnormal">Sp</span><span
                                                                        class="mord mathnormal">a</span><span
                                                                        class="mord mathnormal">ce</span><span
                                                                        class="mord"><span class="mord mathnormal"
                                                                            style="margin-right:0.07153em;">Z</span><span
                                                                            class="msupsub"><span
                                                                                class="vlist-t vlist-t2"><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.31166399999999994em;"><span
                                                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:2.7em;"></span><span
                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                        class="vlist-s">​</span></span><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord"><span
                                                                            class="mord mathnormal">A</span><span
                                                                            class="msupsub"><span
                                                                                class="vlist-t vlist-t2"><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.31166399999999994em;"><span
                                                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:2.7em;"></span><span
                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                        class="vlist-s">​</span></span><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                        class="mclose">)</span></span><span
                                                                    class="mord"><span
                                                                        class="mord mathnormal">A</span><span
                                                                        class="msupsub"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.31166399999999994em;"><span
                                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.7em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                    class="mclose">)</span></span></span><span
                                                            style="top:-3.23em;"><span class="pstrut"
                                                                style="height:3em;"></span><span class="frac-line"
                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                            style="top:-3.6897100000000003em;"><span class="pstrut"
                                                                style="height:3em;"></span><span class="mord"><span
                                                                    class="mord">1</span><span class="mspace"
                                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                                    class="mbin">−</span><span class="mspace"
                                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                                    class="mop"><span class="mop op-symbol small-op"
                                                                        style="position:relative;top:-0.0000050000000000050004em;">∏</span><span
                                                                        class="msupsub"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.16195399999999993em;"><span
                                                                                        style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.7em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
                                                                    class="mopen">(</span><span
                                                                    class="mord">1</span><span class="mspace"
                                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                                    class="mbin">−</span><span class="mspace"
                                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                                    class="mord"><span
                                                                        class="mord mathnormal">A</span><span
                                                                        class="msupsub"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.31166399999999994em;"><span
                                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.7em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                    class="mclose">)</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:0.9857100000000001em;"><span></span></span></span></span></span><span
                                            class="mclose nulldelimiter"></span></span><span
                                        class="mclose">)</span></span><span class="mord"><span
                                        class="mord mathnormal">A</span><span class="msupsub"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.31166399999999994em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                            class="pstrut" style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                    class="mord"><span class="mord mathnormal"
                                        style="margin-right:0.07153em;">C</span><span class="msupsub"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.31166399999999994em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                            class="pstrut" style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                    class="mclose">)</span></span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.717379em;vertical-align:-1.277669em;"></span><span class="mord"><span
                                    class="mopen">(</span><span class="mop op-limits"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.0500050000000003em;"><span
                                                    style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span><span
                                                    style="top:-3.050005em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∑</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.277669em;"><span></span></span></span></span></span><span
                                    class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                    class="mord"><span class="mop"><span class="mord mathrm"
                                            style="margin-right:0.01389em;">W</span></span><span
                                        class="mopen">(</span><span class="mord mathnormal"
                                        style="margin-right:0.05764em;">E</span><span
                                        class="mord mathnormal">ye</span><span class="mord mathnormal">Sp</span><span
                                        class="mord mathnormal">a</span><span class="mord mathnormal">ce</span><span
                                        class="mord"><span class="mord mathnormal"
                                            style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.31166399999999994em;"><span
                                                            style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                        class="mpunct">,</span><span class="mspace"
                                        style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                            class="mord mathnormal">A</span><span class="msupsub"><span
                                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.31166399999999994em;"><span
                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                        class="mclose">)</span></span><span class="mord"><span
                                        class="mord mathnormal">A</span><span class="msupsub"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.31166399999999994em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                            class="pstrut" style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                    class="mord"><span class="mord mathnormal"
                                        style="margin-right:0.07153em;">C</span><span class="msupsub"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.31166399999999994em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                            class="pstrut" style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                    class="mclose">)</span></span><span class="mord"><span class="mord"><span
                                        class="mopen nulldelimiter"></span><span class="mfrac"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:1.4397100000000003em;"><span
                                                        style="top:-2.314em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mop"><span class="mop op-symbol small-op"
                                                                    style="position:relative;top:-0.0000050000000000050004em;">∑</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.16195399999999993em;"><span
                                                                                    style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
                                                                class="mopen">(</span><span class="mord"><span
                                                                    class="mop"><span class="mord mathrm"
                                                                        style="margin-right:0.01389em;">W</span></span><span
                                                                    class="mopen">(</span><span class="mord mathnormal"
                                                                    style="margin-right:0.05764em;">E</span><span
                                                                    class="mord mathnormal">ye</span><span
                                                                    class="mord mathnormal">Sp</span><span
                                                                    class="mord mathnormal">a</span><span
                                                                    class="mord mathnormal">ce</span><span
                                                                    class="mord"><span class="mord mathnormal"
                                                                        style="margin-right:0.07153em;">Z</span><span
                                                                        class="msupsub"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.31166399999999994em;"><span
                                                                                        style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.7em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                    class="mpunct">,</span><span class="mspace"
                                                                    style="margin-right:0.16666666666666666em;"></span><span
                                                                    class="mord"><span
                                                                        class="mord mathnormal">A</span><span
                                                                        class="msupsub"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.31166399999999994em;"><span
                                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.7em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                    class="mclose">)</span></span><span
                                                                class="mord"><span class="mord mathnormal">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.31166399999999994em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                class="mclose">)</span></span></span><span
                                                        style="top:-3.23em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="frac-line"
                                                            style="border-bottom-width:0.04em;"></span></span><span
                                                        style="top:-3.6897100000000003em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord">1</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mbin">−</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mop"><span class="mop op-symbol small-op"
                                                                    style="position:relative;top:-0.0000050000000000050004em;">∏</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.16195399999999993em;"><span
                                                                                    style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span
                                                                class="mopen">(</span><span class="mord">1</span><span
                                                                class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mbin">−</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mord"><span class="mord mathnormal">A</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.31166399999999994em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                class="mclose">)</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.9857100000000001em;"><span></span></span></span></span></span><span
                                        class="mclose nulldelimiter"></span></span></span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span
                                class="mord mathnormal" style="margin-right:0.13889em;">W</span><span
                                class="mord mathnormal">e</span><span class="mord mathnormal">i</span><span
                                class="mord mathnormal" style="margin-right:0.03588em;">g</span><span
                                class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span
                                class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span
                                class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                class="mord mathnormal">o</span><span class="mord mathnormal"
                                style="margin-right:0.01968em;">l</span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">or</span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.13889em;">W</span><span
                                                            class="mord mathnormal">e</span><span
                                                            class="mord mathnormal">i</span><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">g</span><span
                                                            class="mord mathnormal">h</span><span
                                                            class="mord mathnormal">t</span><span
                                                            class="mord mathnormal">e</span><span
                                                            class="mord mathnormal">d</span><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.13889em;">T</span><span
                                                            class="mord mathnormal">o</span><span
                                                            class="mord mathnormal">t</span><span
                                                            class="mord mathnormal">a</span><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.01968em;">l</span><span
                                                            class="mord mathnormal">A</span><span
                                                            class="mord mathnormal">lp</span><span
                                                            class="mord mathnormal">ha</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.07153em;">C</span><span
                                                            class="mord mathnormal">orrec</span><span
                                                            class="mord mathnormal">t</span><span
                                                            class="mord mathnormal">A</span><span
                                                            class="mord mathnormal">lp</span><span
                                                            class="mord mathnormal">ha</span><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.13889em;">T</span><span
                                                            class="mord mathnormal">o</span><span
                                                            class="mord mathnormal">t</span><span
                                                            class="mord mathnormal">a</span><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.01968em;">l</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq>
        </p>
    </blockquote>
    <blockquote dir="auto">
        <p dir="auto">Then, add the TransparentColor to the final color <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <msub>
                                            <mi>C</mi>
                                            <mrow>
                                                <mi>F</mi>
                                                <mi>i</mi>
                                                <mi>n</mi>
                                                <mi>a</mi>
                                                <mi>l</mi>
                                            </mrow>
                                        </msub>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle C_{Final}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq> by the Over Operation:<br>
            <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <msub>
                                            <mi>C</mi>
                                            <mrow>
                                                <mi>F</mi>
                                                <mi>i</mi>
                                                <mi>n</mi>
                                                <mi>a</mi>
                                                <mi>l</mi>
                                            </mrow>
                                        </msub>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle C_{Final}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.07153em;">C</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord mathnormal mtight">ina</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.01968em;">l</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
            </eq> = TransparentColor + CorrectAlphaTotal × BackgroundColor)<br>
            Note that the BackgroundColor has been added to the color buffer. We can output the TransparentColor and
            CorrectAlphaTotal in the fragment shader and use the Alpha blend hardware feature to implement the Over
            Operation.
        </p>
    </blockquote>
    <h3 dir="auto" id="3-4-4-conclusion-1">3-4-4. Conclusion</h3>
    <p dir="auto">The weighted blending uses the predefined weighted function<eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">W</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>E</mi>
                                    <mi>y</mi>
                                    <mi>e</mi>
                                    <mi>S</mi>
                                    <mi>p</mi>
                                    <mi>a</mi>
                                    <mi>c</mi>
                                    <mi>e</mi>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{W}( EyeSpaceZ_i, A_i)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">W</span></span><span
                            class="mopen">(</span><span class="mord mathnormal"
                            style="margin-right:0.05764em;">E</span><span class="mord mathnormal">ye</span><span
                            class="mord mathnormal">Sp</span><span class="mord mathnormal">a</span><span
                            class="mord mathnormal">ce</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> to simulate the visibility function <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">\operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span>
        </eq>, omitting the calculation of the
        visibility function.<br>
        To some extent, the weighted blending is considered as a simplified version of the stochastic transparency which
        omits the StochasticDepthPass.<br>
        Consequently, the error of the weighted blending is highest of all OIT algorthims since the weighted function
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">W</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>E</mi>
                                    <mi>y</mi>
                                    <mi>e</mi>
                                    <mi>S</mi>
                                    <mi>p</mi>
                                    <mi>a</mi>
                                    <mi>c</mi>
                                    <mi>e</mi>
                                    <msub>
                                        <mi>Z</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>A</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{W}( EyeSpaceZ_i, A_i)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">W</span></span><span
                            class="mopen">(</span><span class="mord mathnormal"
                            style="margin-right:0.05764em;">E</span><span class="mord mathnormal">ye</span><span
                            class="mord mathnormal">Sp</span><span class="mord mathnormal">a</span><span
                            class="mord mathnormal">ce</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> which is used to simulate the visibility
        function <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi mathvariant="normal">V</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>Z</mi>
                                    <mi>i</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">\operatorname{V} ( Z_i )</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.07153em;">Z</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is not related to the scene at all.
    </p>
    <h3 dir="auto" id="3-4-5-demo-1">3-4-5. Demo</h3>
    <p dir="auto">The github address <a
            href="https://github.com/YuqiaoZhang/WeightedBlendedOIT">https://github.com/YuqiaoZhang/WeightedBlendedOIT</a>
    </p>
    <p dir="auto">The demo was originally the &quot;Weighted Blended Order-independent Transparency&quot; of the
        &quot;NVIDIA GameWorks Vulkan and OpenGL Samples&quot;(24.[NVIDIA]). The weighted blended is the simplest of the
        all OIT algorithms and I haven't made any substantial changes to the demo.</p>
    <h2 dir="auto" id="4-references-1">4. References</h2>
    <p dir="auto">1.[Porter 1984] <a href="https://keithp.com/~keithp/porterduff/p253-porter.pdf">Thomas Porter, Tom
            Duff. &quot;Compositing Digital Images.&quot; SIGGRAPH 1984.</a><br>
        2.[Yusor 2013] Egor Yusor. &quot;Practical Implementation of Light Scattering Effects Using Epipolar Sampling
        and 1D Min/Max Binary Trees.&quot; GDC 2013. <a
            href="https://software.intel.com/en-us/blogs/2013/03/18/gtd-light-scattering-sample-updated">First-Edition</a>
        <a href="https://software.intel.com/en-us/blogs/2013/06/26/outdoor-light-scattering-sample">Second-Edition</a>
        <a
            href="https://software.intel.com/en-us/blogs/2013/09/19/otdoor-light-scattering-sample-update">Third-Edition</a><br>
        3.[Hoobler 2016] <a href="http://developer.nvidia.com/VolumetricLighting">Nathan Hoobler. &quot;Fast, Flexible,
            Physically-Based Volumetric Light Scattering.&quot; GDC 2016.</a><br>
        4.[Dunn 2014] <a href="https://developer.nvidia.com/content/transparency-or-translucency-rendering">Alex Dunn.
            &quot;Transparency (or Translucency) Rendering.&quot; NVIDIA GameWorks Blog 2014.</a><br>
        5.[Everitt 2001] <a href="https://www.nvidia.com/object/Interactive_Order_Transparency.html">Cass Everitt.
            &quot;Interactive Order-Independent Transparency.&quot; NVIDIA WhitePaper 2001.</a><br>
        6.[Enderton 2010] <a href="https://research.nvidia.com/publication/stochastic-transparency">Eric Enderton, Erik
            Sintorn, Peter Shirley, David Luebke. &quot;Stochastic Transparency.&quot; SIGGRAPH 2010.</a><br>
        7.[Laine 2011] <a
            href="https://research.nvidia.com/publication/stratified-sampling-stochastic-transparency">Samuli Laine,
            Tero Karras. &quot;Stratified Sampling for Stochastic Transparency.&quot; EGSR 2011.</a><br>
        8.[McGuire 2011] <a href="http://research.nvidia.com/publication/colored-stochastic-shadow-maps">Morgan McGuire,
            Eric Enderton. &quot;Colored Stochastic Shadow Maps&quot;. SIGGRAPH 2011.</a><br>
        9.[Bavoil 2011] <a href="https://developer.nvidia.com/dx11-samples">Louis Bavoil, Eric Enderton.
            &quot;Constant-Memory Order-Independent Transparency Techniques.&quot; NVIDIA SDK11 Samples /
            StochasticTransparency 2011.</a><br>
        10.[Harris 2019] <a
            href="https://developer.arm.com/solutions/graphics/developer-guides/mali-gpu-best-practices">Pete Harris.
            &quot;Arm Mali GPUs Best Practices Developer Guide.&quot; ARM Developer 2019.</a><br>
        11.[Carpenter 1984] <a href="https://dl.acm.org/citation.cfm?id=80858">Loren Carpenter. &quot;The A-buffer, an
            Antialiased Hidden Surface Method.&quot; SIGGRAPH 1984.</a><br>
        12.[Bavoil 2007] <a href="https://i3dsymposium.github.io/2007/papers.html">Louis Bavoil, Steven Callahan, Aaron
            Lefohn, Joao Comba, Claudio Silva. &quot;Multi-fragment Effects on the GPU using the k-Buffer.&quot;
            SIGGRAPH 2007.</a><br>
        13.[Ragan-Kelley 2011] <a href="http://people.csail.mit.edu/jrk/decoupledsampling/ds.pdf">Jonathan Ragan-Kelley,
            Jaakko Lehtinen, Jiawen Chen, Michael Doggett, Frédo Durand. &quot;Decoupled Sampling for Graphics
            Pipelines.&quot; ACM TOG 2011.</a><br>
        14.[D 2015] <a
            href="https://software.intel.com/en-us/gamedev/articles/rasterizer-order-views-101-a-primer">Leigh D.
            &quot;Rasterizer Order Views 101: a Primer.&quot; Intel Developer Zone 2015.</a><br>
        15.[D 2017] <a
            href="https://software.intel.com/en-us/articles/oit-approximation-with-pixel-synchronization-update-2014">Leigh
            D. &quot;Order-Independent Transparency Approximation with Raster Order Views (Update 2017).&quot; Intel
            Developer Zone 2017.</a><br>
        16.[Bjorge 2014] <a
            href="https://community.arm.com/developer/tools-software/graphics/b/blog/posts/efficient-rendering-with-tile-local-storage">Marius
            Bjorge, Sam Martin, Sandeep Kakarlapudi, Jan-Harald Fredriksen. &quot;Efficient Rendering with Tile Local
            Storage.&quot; SIGGRAPH 2014.</a><br>
        17.[Apple] <a href="https://developer.apple.com/documentation/metal/deferred_lighting">Metal Sample Code /
            Deferred Lighting</a><br>
        18.[Microsoft] <a
            href="https://docs.microsoft.com/en-us/windows/win32/api/d3d12/ne-d3d12-d3d12_resource_flags">Direct3D 12
            Graphics / D3D12.h / D3D12_RESOURCE_FLAGS enumeration</a><br>
        19.[Salvi 2010] <a href="https://software.intel.com/en-us/articles/adaptive-volumetric-shadow-maps">Marco
            Salvi,Kiril Vidimce, Andrew Lauritzen, Aaron Lefohn. &quot;Adaptive Volumetric Shadow Maps.&quot; EGSR
            2010.</a><br>
        20.[Salvi 2011] <a href="https://software.intel.com/en-us/articles/adaptive-transparency-hpg-2011">Marco Salvi,
            Jefferson Montgomery, Aaron Lefohn. &quot;Adaptive Transparency.&quot; HPG 2011.</a><br>
        21.[Salvi 2014] <a href="https://software.intel.com/en-us/articles/multi-layer-alpha-blending">Marco Salvi,
            Karthik Vaidyanathan. &quot;Multi-layer Alpha Blending.&quot; SIGGRAPH 2014.</a><br>
        22.[Imbrogno 2017] <a href="https://developer.apple.com/videos/play/tech-talks/603">Michael Imbrogno.
            &quot;Metal 2 on A11 – Imageblocks.&quot; Apple Developer 2017.</a><br>
        23.[McGuire 2013] <a href="http://jcgt.org/published/0002/02/09/">Morgan McGuire, Louis Bavoil. &quot;Weighted
            Blended Order-Independent Transparency. &quot; JCGT 2013.</a><br>
        24.[NVIDIA] <a
            href="https://github.com/NVIDIAGameWorks/GraphicsSamples/tree/master/samples/gl4-kepler/WeightedBlendedOIT">NVIDIA
            GameWorks Vulkan and OpenGL Samples / Weighted Blended Order-independent Transparency</a>
    </p>

</body>

</html>