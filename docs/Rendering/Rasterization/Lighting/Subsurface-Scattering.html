<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/default.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
</head>

<body class="markdown-body">
  <h1 dir="auto" id="subsurface-scattering">Subsurface Scattering</h1>
  <h2 dir="auto" id="1-diffusion-profile">1. Diffusion Profile</h2>
  <p dir="auto">The <strong>diffusion profile</strong>
    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">Δ</mi>
                  <mi>x</mi>
                  <mo separator="true">,</mo>
                  <mi mathvariant="normal">Δ</mi>
                  <mi>y</mi>
                  <mo separator="true">,</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">Δ</mi>
                  <mi>z</mi>
                  <mo stretchy="false">)</mo>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(\Delta x, \Delta y, (\Delta z))
              </annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
              class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord">Δ</span><span
              class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span
              class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span
              class="mclose">))</span></span></span></span></eq> by &quot;14.4.2 Rendering with Diffusion Profile&quot;
    of [dEon 2007] is called the <strong>scattering profile</strong>
    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">S</mi>
                      <mi mathvariant="normal">p</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{S_p}(\overrightarrow{p_o},
                \overrightarrow{p_i})</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.238668em;vertical-align:-0.286108em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">p</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.286108em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mclose">)</span></span></span></span></eq> by &quot;Equation (11.6)&quot; of <a
      href="https://pbr-book.org/3ed-2018/Volume_Scattering/The_BSSRDF#eq:separable-bssrdf">PBR Book</a> and is called
    the <strong>radial (scattering) profile</strong>
    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">S</mi>
                      <mi mathvariant="normal">r</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{S_r}(\| \overrightarrow{p_i} -
                \overrightarrow{p_o} \|)</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span></span></span></span></eq> by &quot;Equation
    (11.9)&quot; of <a href="https://pbr-book.org/3ed-2018/Volume_Scattering/The_BSSRDF#eq:distance-bssrdf">PBR
      Book</a>.
  </p>
  <p dir="auto">By &quot;Advantages of a Sum-of-Gaussians Diffusion Profile&quot; of [dEon 2007] and &quot;Equation
    (11.9)&quot; of <a href="https://pbr-book.org/3ed-2018/Volume_Scattering/The_BSSRDF#eq:distance-bssrdf">PBR
      Book</a>, by assuming the material is homogeneous, the diffusion profile is isotropic (radially symmetric). This
    means that the diffusion profile can be reduced to the 1D function <eq><span class="katex"><span
          class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">Δ</mi>
                  <mi>x</mi>
                  <mo separator="true">,</mo>
                  <mi mathvariant="normal">Δ</mi>
                  <mi>y</mi>
                  <mo separator="true">,</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">Δ</mi>
                  <mi>z</mi>
                  <mo stretchy="false">)</mo>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <msqrt>
                    <mrow>
                      <msup>
                        <mrow>
                          <mi mathvariant="normal">Δ</mi>
                          <mi>x</mi>
                        </mrow>
                        <mn>2</mn>
                      </msup>
                      <mo>+</mo>
                      <msup>
                        <mrow>
                          <mi mathvariant="normal">Δ</mi>
                          <mi>y</mi>
                        </mrow>
                        <mn>2</mn>
                      </msup>
                      <mo stretchy="false">(</mo>
                      <mo>+</mo>
                      <msup>
                        <mrow>
                          <mi mathvariant="normal">Δ</mi>
                          <mi>z</mi>
                        </mrow>
                        <mn>2</mn>
                      </msup>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </msqrt>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>r</mi>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(\Delta x, \Delta y, (\Delta z)) =
                \operatorname{R}(\sqrt{{\Delta x}^2 +{\Delta y}^2 (+ {\Delta z}^2)}) = \operatorname{R}(r) =
                \operatorname{R}(\| \overrightarrow{p_i} - \overrightarrow{p_o} \|)</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
              class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord">Δ</span><span
              class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span
              class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span
              class="mclose">))</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1.84em;vertical-align:-0.4874560000000001em;"></span><span
              class="mop"><span class="mord mathrm">R</span></span><span class="mopen">(</span><span
              class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:1.352544em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut"
                        style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span
                          class="mord"><span class="mord"><span class="mord">Δ</span><span
                              class="mord mathnormal">x</span></span><span class="msupsub"><span class="vlist-t"><span
                                class="vlist-r"><span class="vlist" style="height:0.887338em;"><span
                                    style="top:-3.1362300000000003em;margin-right:0.05em;"><span class="pstrut"
                                      style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                          class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                          class="mbin">+</span><span class="mspace"
                          style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span
                              class="mord">Δ</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">y</span></span><span class="msupsub"><span
                              class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.887338em;"><span
                                    style="top:-3.1362300000000003em;margin-right:0.05em;"><span class="pstrut"
                                      style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                          class="mopen">(</span><span class="mord">+</span><span class="mord"><span class="mord"><span
                              class="mord">Δ</span><span class="mord mathnormal"
                              style="margin-right:0.04398em;">z</span></span><span class="msupsub"><span
                              class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.887338em;"><span
                                    style="top:-3.1362300000000003em;margin-right:0.05em;"><span class="pstrut"
                                      style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                          class="mclose">)</span></span></span><span style="top:-3.312544em;"><span class="pstrut"
                        style="height:3.8em;"></span><span class="hide-tail"
                        style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em'
                          height='1.8800000000000001em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'>
                          <path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.4874560000000001em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord">∥</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span></span></span></span></eq> and <eq><span
        class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">S</mi>
                      <mi mathvariant="normal">p</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">S</mi>
                      <mi mathvariant="normal">r</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{S_p}(\overrightarrow{p_o},
                \overrightarrow{p_i}) = \operatorname{S_r}(\| \overrightarrow{p_i} - \overrightarrow{p_o} \|)
              </annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.238668em;vertical-align:-0.286108em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">p</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.286108em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
              class="mop"><span class="mord"><span class="mord mathrm">S</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span></span></span></span></eq>.</p>
  <p dir="auto">By the &quot;Equation (11.7)&quot; of <a
      href="https://pbr-book.org/3ed-2018/Volume_Scattering/The_BSSRDF#eq:separable-bssrdf-directional">PBR Book</a>,
    the general BSSRDF term <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">S</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{S}(\overrightarrow{p_o},
                \overrightarrow{\omega_o}, \overrightarrow{p_i}, \overrightarrow{\omega_i})</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">S</span></span><span class="mopen">(</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span></span></span></span></eq> is factored into spatial and directional components
    which can be integrated independently from each other. And the calculation of the subsurface scattering can be
    simplified as <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">L</mi>
                      <mi mathvariant="normal">o</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <msub>
                    <mo>∫</mo>
                    <msup>
                      <mi mathvariant="double-struck">R</mi>
                      <mn>2</mn>
                    </msup>
                  </msub>
                  <mrow>
                    <mo fence="true">(</mo>
                    <msub>
                      <mo>∫</mo>
                      <mi mathvariant="normal">Ω</mi>
                    </msub>
                    <mi mathvariant="normal">S</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">L</mi>
                        <mi mathvariant="normal">i</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo fence="true">)</mo>
                  </mrow>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>≈</mo>
                  <mo stretchy="false">(</mo>
                  <mn>1</mn>
                  <mo>−</mo>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">F</mi>
                      <mi mathvariant="normal">r</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <msub>
                    <mi>θ</mi>
                    <mi>o</mi>
                  </msub>
                  <mo stretchy="false">)</mo>
                  <mo stretchy="false">)</mo>
                  <mrow>
                    <mo fence="true">(</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">R</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <mrow>
                      <mo fence="true">(</mo>
                      <msub>
                        <mo>∫</mo>
                        <mi mathvariant="normal">Ω</mi>
                      </msub>
                      <mfrac>
                        <mrow>
                          <mn>1</mn>
                          <mo>−</mo>
                          <mi mathvariant="normal">
                            <msub>
                              <mi mathvariant="normal">F</mi>
                              <mi mathvariant="normal">r</mi>
                            </msub>
                          </mi>
                          <mo>⁡</mo>
                          <mo stretchy="false">(</mo>
                          <mi>cos</mi>
                          <mo>⁡</mo>
                          <msub>
                            <mi>θ</mi>
                            <mi>i</mi>
                          </msub>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mi>c</mi>
                      </mfrac>
                      <mfrac>
                        <mn>1</mn>
                        <mi>π</mi>
                      </mfrac>
                      <mi mathvariant="normal">
                        <msub>
                          <mi mathvariant="normal">L</mi>
                          <mi mathvariant="normal">i</mi>
                        </msub>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo separator="true">,</mo>
                      <mover accent="true">
                        <msub>
                          <mi>ω</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo stretchy="false">)</mo>
                      <msup>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mi>cos</mi>
                          <mo>⁡</mo>
                          <msub>
                            <mi>θ</mi>
                            <mi>i</mi>
                          </msub>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mo>+</mo>
                      </msup>
                      <mtext> </mtext>
                      <mi>d</mi>
                      <mover accent="true">
                        <msub>
                          <mi>ω</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo fence="true">)</mo>
                    </mrow>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo fence="true">)</mo>
                  </mrow>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                \overrightarrow{\omega_o}) = \int_{{\mathbb{R}}^2} \left\lparen \int_\Omega
                \operatorname{S}(\overrightarrow{p_o}, \overrightarrow{\omega_o}, \overrightarrow{p_i},
                \overrightarrow{\omega_i}) \operatorname{L_i}(\overrightarrow{p_i}, \overrightarrow{\omega_i}) {(\cos
                \theta_i)}^+ \, d \overrightarrow{\omega_i} \right\rparen \, d \overrightarrow{p_i} \approx (1 -
                \operatorname{F_r}(\cos \theta_o)) \left\lparen \int_{{\mathbb{R}}^2} \operatorname{R}(\|
                \overrightarrow{p_i} - \overrightarrow{p_o} \|) \left\lparen \int_\Omega \frac{1 -
                \operatorname{F_r}(\cos \theta_i)}{c} \frac{1}{\pi} \operatorname{L_i}(\overrightarrow{p_i},
                \overrightarrow{\omega_i}) {(\cos \theta_i)}^+ \, d \overrightarrow{\omega_i} \right\rparen \, d
                \overrightarrow{p_i} \right\rparen</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.38952999999999993em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight"><span class="mord mtight"><span
                                  class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                  class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span
                class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span
                class="mop"><span class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.433619em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">Ω</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord mathrm">S</span></span><span class="mopen">(</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mop"><span class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.31750199999999995em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mord"><span class="mord"><span class="mopen">(</span><span
                    class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                    class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                      class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                            style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
              class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span
              class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span
              class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
            class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span
              class="mop"><span class="mord"><span class="mord mathrm">F</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mop">cos</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">o</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mclose">))</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="minner"><span class="mopen delimcenter" style="top:0em;"><span
                  class="delimsizing size3">(</span></span><span class="mop"><span class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord">∥</span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter"
                  style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mop"><span
                    class="mop op-symbol large-op"
                    style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:-0.433619em;"><span
                            style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight">Ω</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                  class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                    class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span
                              class="pstrut" style="height:3em;"></span><span class="mord"><span
                                class="mord mathnormal">c</span></span></span><span style="top:-3.23em;"><span
                              class="pstrut" style="height:3em;"></span><span class="frac-line"
                              style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                              class="pstrut" style="height:3em;"></span><span class="mord"><span
                                class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span
                                  class="mord"><span class="mord mathrm">F</span><span class="msupsub"><span
                                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                          style="height:0.151392em;"><span
                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                              class="pstrut" style="height:2.7em;"></span><span
                                              class="sizing reset-size6 size3 mtight"><span
                                                class="mord mathrm mtight">r</span></span></span></span><span
                                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                  class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:0.31166399999999994em;"><span
                                          style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathnormal mtight">i</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist"
                          style="height:0.686em;"><span></span></span></span></span></span><span
                    class="mclose nulldelimiter"></span></span><span class="mord"><span
                    class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                              class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                              class="pstrut" style="height:3em;"></span><span class="frac-line"
                              style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                              class="pstrut" style="height:3em;"></span><span class="mord"><span
                                class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist"
                          style="height:0.686em;"><span></span></span></span></span></span><span
                    class="mclose nulldelimiter"></span></span><span class="mspace"
                  style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                      class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                          class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span
                              style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathrm mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                  class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                          style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                  class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                        class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span
                                          class="mord mathnormal mtight">i</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                          class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                            style="height:3em;"></span><span class="hide-tail"
                            style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                              viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                              <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                            </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                        class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                            style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.31166399999999994em;"><span
                                      style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                        class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span
                                          class="mord mathnormal mtight">i</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                          class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                            style="height:3em;"></span><span class="hide-tail"
                            style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                              viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                              <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                            </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                        class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                  class="mclose">)</span><span class="mord"><span class="mord"><span class="mopen">(</span><span
                      class="mop">cos</span><span class="mspace"
                      style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                        class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                              style="height:0.31166399999999994em;"><span
                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                  class="pstrut" style="height:2.7em;"></span><span
                                  class="sizing reset-size6 size3 mtight"><span
                                    class="mord mathnormal mtight">i</span></span></span></span><span
                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                              style="height:0.15em;"><span></span></span></span></span></span></span><span
                      class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                        class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                            style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                  class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.31166399999999994em;"><span
                                      style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                        class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span
                                          class="mord mathnormal mtight">i</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                          class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                            style="height:3em;"></span><span class="hide-tail"
                            style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                              viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                              <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                            </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                        class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                  class="mclose delimcenter" style="top:0em;"><span
                    class="delimsizing size3">)</span></span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose delimcenter" style="top:0em;"><span
                  class="delimsizing size3">)</span></span></span></span></span></span></eq> where <eq><span
        class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">F</mi>
                      <mi mathvariant="normal">r</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <mi>θ</mi>
                  <mo stretchy="false">)</mo>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{F_r}(\cos \theta))</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mop">cos</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
              style="margin-right:0.02778em;">θ</span><span class="mclose">))</span></span></span></span></eq> is the
    Fresnel term and <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi>c</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                  <mo>−</mo>
                  <mn>2</mn>
                  <msubsup>
                    <mo>∫</mo>
                    <mn>0</mn>
                    <mfrac>
                      <mi>π</mi>
                      <mn>2</mn>
                    </mfrac>
                  </msubsup>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">F</mi>
                      <mi mathvariant="normal">r</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <mi>θ</mi>
                  <mo stretchy="false">)</mo>
                  <mo stretchy="false">)</mo>
                  <mi>sin</mi>
                  <mo>⁡</mo>
                  <mi>θ</mi>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <mi>θ</mi>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mi>θ</mi>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle c = 1 - 2 \int_0^{\frac{\pi}{2}}
                \operatorname{F_r}(\cos \theta)) \sin \theta \cos \theta \, d \theta</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
              class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:2.5089300000000003em;vertical-align:-0.9119499999999999em;"></span><span
              class="mord">2</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.5969800000000005em;"><span
                        style="top:-2.08805em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut"
                          style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">0</span></span></span><span
                        style="top:-4.112900000000001em;margin-right:0.05em;"><span class="pstrut"
                          style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight"><span
                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.6915428571428572em;"><span style="top:-2.656em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.2255000000000003em;"><span class="pstrut"
                                          style="height:3em;"></span><span class="frac-line mtight"
                                          style="border-bottom-width:0.049em;"></span></span><span
                                        style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.344em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord"><span class="mord mathrm">F</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mop">cos</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
              style="margin-right:0.02778em;">θ</span><span class="mclose">))</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
              style="margin-right:0.02778em;">θ</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
              style="margin-right:0.02778em;">θ</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
              class="mord mathnormal" style="margin-right:0.02778em;">θ</span></span></span></span></eq> is the the
    first moment of the Fresnel term.</p>
  <p dir="auto">By &quot;SSS-NOTE-TRSM&quot; of <a
      href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/Lit/Lit.hlsl#L1330">Unity3D</a>,
    it is too inefficient to apply the first Fresnel term <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mn>1</mn>
                  <mo>−</mo>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">F</mi>
                      <mi mathvariant="normal">r</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <msub>
                    <mi>θ</mi>
                    <mi>o</mi>
                  </msub>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle 1 - \operatorname{F_r}(\cos \theta_o)</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
              style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mop">cos</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">o</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mclose">)</span></span></span></span></eq> after the diffusion profile term <eq><span
        class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mi mathvariant="normal">R</mi>
                <mo>⁡</mo>
                <mo stretchy="false">(</mo>
                <mi mathvariant="normal">∥</mi>
                <mover accent="true">
                  <msub>
                    <mi>p</mi>
                    <mi>i</mi>
                  </msub>
                  <mo stretchy="true">→</mo>
                </mover>
                <mo>−</mo>
                <mover accent="true">
                  <msub>
                    <mi>p</mi>
                    <mi>o</mi>
                  </msub>
                  <mo stretchy="true">→</mo>
                </mover>
                <mi mathvariant="normal">∥</mi>
                <mo stretchy="false">)</mo>
              </mrow>
              <annotation encoding="application/x-tex">\operatorname{R}(\| \overrightarrow{p_i} - \overrightarrow{p_o}
                \|)</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord">∥</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span></span></span></span></eq>. And the calculation of the
    subsurface scattering is further simplified as <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">L</mi>
                      <mi mathvariant="normal">o</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <mo stretchy="false">(</mo>
                  <mn>1</mn>
                  <mo>−</mo>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">F</mi>
                      <mi mathvariant="normal">r</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <msub>
                    <mi>θ</mi>
                    <mi>o</mi>
                  </msub>
                  <mo stretchy="false">)</mo>
                  <mo stretchy="false">)</mo>
                  <mrow>
                    <mo fence="true">(</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">R</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <mrow>
                      <mo fence="true">(</mo>
                      <msub>
                        <mo>∫</mo>
                        <mi mathvariant="normal">Ω</mi>
                      </msub>
                      <mfrac>
                        <mrow>
                          <mn>1</mn>
                          <mo>−</mo>
                          <mi mathvariant="normal">
                            <msub>
                              <mi mathvariant="normal">F</mi>
                              <mi mathvariant="normal">r</mi>
                            </msub>
                          </mi>
                          <mo>⁡</mo>
                          <mo stretchy="false">(</mo>
                          <mi>cos</mi>
                          <mo>⁡</mo>
                          <msub>
                            <mi>θ</mi>
                            <mi>i</mi>
                          </msub>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mi>c</mi>
                      </mfrac>
                      <mfrac>
                        <mn>1</mn>
                        <mi>π</mi>
                      </mfrac>
                      <mi mathvariant="normal">
                        <msub>
                          <mi mathvariant="normal">L</mi>
                          <mi mathvariant="normal">i</mi>
                        </msub>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo separator="true">,</mo>
                      <mover accent="true">
                        <msub>
                          <mi>ω</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo stretchy="false">)</mo>
                      <msup>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mi>cos</mi>
                          <mo>⁡</mo>
                          <msub>
                            <mi>θ</mi>
                            <mi>i</mi>
                          </msub>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mo>+</mo>
                      </msup>
                      <mtext> </mtext>
                      <mi>d</mi>
                      <mover accent="true">
                        <msub>
                          <mi>ω</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo fence="true">)</mo>
                    </mrow>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo fence="true">)</mo>
                  </mrow>
                  <mo>≈</mo>
                  <msub>
                    <mo>∫</mo>
                    <msup>
                      <mi mathvariant="double-struck">R</mi>
                      <mn>2</mn>
                    </msup>
                  </msub>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                  <mrow>
                    <mo fence="true">(</mo>
                    <msub>
                      <mo>∫</mo>
                      <mi mathvariant="normal">Ω</mi>
                    </msub>
                    <mo stretchy="false">(</mo>
                    <mn>1</mn>
                    <mo>−</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">F</mi>
                        <mi mathvariant="normal">r</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>cos</mi>
                    <mo>⁡</mo>
                    <msub>
                      <mi>θ</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="false">)</mo>
                    <mo stretchy="false">)</mo>
                    <mfrac>
                      <mrow>
                        <mn>1</mn>
                        <mo>−</mo>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">F</mi>
                            <mi mathvariant="normal">r</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mi>c</mi>
                    </mfrac>
                    <mfrac>
                      <mn>1</mn>
                      <mi>π</mi>
                    </mfrac>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">L</mi>
                        <mi mathvariant="normal">i</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo fence="true">)</mo>
                  </mrow>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>=</mo>
                  <msub>
                    <mo>∫</mo>
                    <msup>
                      <mi mathvariant="double-struck">R</mi>
                      <mn>2</mn>
                    </msup>
                  </msub>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                \overrightarrow{\omega_o}) = (1 - \operatorname{F_r}(\cos \theta_o)) \left\lparen \int_{{\mathbb{R}}^2}
                \operatorname{R}(\| \overrightarrow{p_i} - \overrightarrow{p_o} \|) \left\lparen \int_\Omega \frac{1 -
                \operatorname{F_r}(\cos \theta_i)}{c} \frac{1}{\pi} \operatorname{L_i}(\overrightarrow{p_i},
                \overrightarrow{\omega_i}) {(\cos \theta_i)}^+ \, d \overrightarrow{\omega_i} \right\rparen \, d
                \overrightarrow{p_i} \right\rparen \approx \int_{{\mathbb{R}}^2} \operatorname{R}(\|
                \overrightarrow{p_i} - \overrightarrow{p_o} \|) \left\lparen \int_\Omega (1 - \operatorname{F_r}(\cos
                \theta_o)) \frac{1 - \operatorname{F_r}(\cos \theta_i)}{c} \frac{1}{\pi}
                \operatorname{L_i}(\overrightarrow{p_i}, \overrightarrow{\omega_i}) {(\cos \theta_i)}^+ \, d
                \overrightarrow{\omega_i} \right\rparen \, d \overrightarrow{p_i} = \int_{{\mathbb{R}}^2}
                \operatorname{R}(\| \overrightarrow{p_i} - \overrightarrow{p_o} \|)
                \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) \, d \overrightarrow{p_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
              class="mopen">(</span><span class="mord">1</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
              style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mop">cos</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">o</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mclose">))</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="minner"><span class="mopen delimcenter" style="top:0em;"><span
                  class="delimsizing size3">(</span></span><span class="mop"><span class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord">∥</span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter"
                  style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mop"><span
                    class="mop op-symbol large-op"
                    style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:-0.433619em;"><span
                            style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mtight">Ω</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                  class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                    class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span
                              class="pstrut" style="height:3em;"></span><span class="mord"><span
                                class="mord mathnormal">c</span></span></span><span style="top:-3.23em;"><span
                              class="pstrut" style="height:3em;"></span><span class="frac-line"
                              style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                              class="pstrut" style="height:3em;"></span><span class="mord"><span
                                class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span
                                  class="mord"><span class="mord mathrm">F</span><span class="msupsub"><span
                                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                          style="height:0.151392em;"><span
                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                              class="pstrut" style="height:2.7em;"></span><span
                                              class="sizing reset-size6 size3 mtight"><span
                                                class="mord mathrm mtight">r</span></span></span></span><span
                                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                  class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:0.31166399999999994em;"><span
                                          style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathnormal mtight">i</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist"
                          style="height:0.686em;"><span></span></span></span></span></span><span
                    class="mclose nulldelimiter"></span></span><span class="mord"><span
                    class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                              class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                              class="pstrut" style="height:3em;"></span><span class="frac-line"
                              style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                              class="pstrut" style="height:3em;"></span><span class="mord"><span
                                class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                        class="vlist-r"><span class="vlist"
                          style="height:0.686em;"><span></span></span></span></span></span><span
                    class="mclose nulldelimiter"></span></span><span class="mspace"
                  style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                      class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                          class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span
                              style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathrm mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                  class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                          style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                  class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                      style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                        class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span
                                          class="mord mathnormal mtight">i</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                          class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                            style="height:3em;"></span><span class="hide-tail"
                            style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                              viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                              <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                            </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                        class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                            style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.31166399999999994em;"><span
                                      style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                        class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span
                                          class="mord mathnormal mtight">i</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                          class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                            style="height:3em;"></span><span class="hide-tail"
                            style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                              viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                              <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                            </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                        class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                  class="mclose">)</span><span class="mord"><span class="mord"><span class="mopen">(</span><span
                      class="mop">cos</span><span class="mspace"
                      style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                        class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                              style="height:0.31166399999999994em;"><span
                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                  class="pstrut" style="height:2.7em;"></span><span
                                  class="sizing reset-size6 size3 mtight"><span
                                    class="mord mathnormal mtight">i</span></span></span></span><span
                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                              style="height:0.15em;"><span></span></span></span></span></span></span><span
                      class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                        class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                            style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                  class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.31166399999999994em;"><span
                                      style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                        class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span
                                          class="mord mathnormal mtight">i</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                          class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                            style="height:3em;"></span><span class="hide-tail"
                            style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                              viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                              <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                            </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                        class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                  class="mclose delimcenter" style="top:0em;"><span
                    class="delimsizing size3">)</span></span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
              class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.38952999999999993em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight"><span class="mord mtight"><span
                                  class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                  class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord">∥</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter"
                style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.433619em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">Ω</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">1</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">r</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                  style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                class="mclose">))</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                  class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                            style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">c</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">F</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.151392em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">r</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.31166399999999994em;"><span
                                        style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.15em;"><span></span></span></span></span></span></span><span
                              class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mord"><span class="mord"><span class="mopen">(</span><span
                    class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                    class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                      class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                            style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
              class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.38952999999999993em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight"><span class="mord mtight"><span
                                  class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                  class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord">∥</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span
                          class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                              class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq> where
    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <msub>
                    <mo>∫</mo>
                    <mi mathvariant="normal">Ω</mi>
                  </msub>
                  <mo stretchy="false">(</mo>
                  <mn>1</mn>
                  <mo>−</mo>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">F</mi>
                      <mi mathvariant="normal">r</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <msub>
                    <mi>θ</mi>
                    <mi>o</mi>
                  </msub>
                  <mo stretchy="false">)</mo>
                  <mo stretchy="false">)</mo>
                  <mfrac>
                    <mrow>
                      <mn>1</mn>
                      <mo>−</mo>
                      <mi mathvariant="normal">
                        <msub>
                          <mi mathvariant="normal">F</mi>
                          <mi mathvariant="normal">r</mi>
                        </msub>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi>cos</mi>
                      <mo>⁡</mo>
                      <msub>
                        <mi>θ</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mi>c</mi>
                  </mfrac>
                  <mfrac>
                    <mn>1</mn>
                    <mi>π</mi>
                  </mfrac>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">L</mi>
                      <mi mathvariant="normal">i</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>cos</mi>
                      <mo>⁡</mo>
                      <msub>
                        <mi>θ</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>+</mo>
                  </msup>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{F}(\overrightarrow{p_i},
                \overrightarrow{\omega_o}) = \int_\Omega (1 - \operatorname{F_r}(\cos \theta_o)) \frac{1 -
                \operatorname{F_r}(\cos \theta_i)}{c} \frac{1}{\pi} \operatorname{L_i}(\overrightarrow{p_i},
                \overrightarrow{\omega_i}) {(\cos \theta_i)}^+ \, d \overrightarrow{\omega_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.433619em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord">1</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
              style="height:2.113em;vertical-align:-0.686em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mop">cos</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">o</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mclose">))</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">c</span></span></span><span style="top:-3.23em;"><span
                          class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mord"><span
                                class="mord mathrm">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mord mathrm mtight">r</span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                              class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.31166399999999994em;"><span
                                      style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                        class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span
                                          class="mord mathnormal mtight">i</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                          class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">i</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mord"><span class="mord"><span class="mopen">(</span><span
                  class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.31166399999999994em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
    </eq> is the form factor. Although the terms <strong>irradiance E</strong> and <strong>form factor F</strong> may be
    interchangeably used, technically <strong>irradiance E</strong> should NOT be divided by <eq><span
        class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi>π</mi>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \pi</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
              style="margin-right:0.03588em;">π</span></span></span></span></eq>. This means that <eq><span
        class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">E</mi>
                  <mo>⁡</mo>
                  <mo>=</mo>
                  <mi>π</mi>
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{E} = \pi \operatorname{F}
              </annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.68333em;vertical-align:0em;"></span><span class="mop"><span
                class="mord mathrm">E</span></span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal"
              style="margin-right:0.03588em;">π</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span></span></span></span></eq>.
  </p>
  <p dir="auto">Analogously to &quot;Figure 13.10&quot; of <a
      href="https://pbr-book.org/3ed-2018/Monte_Carlo_Integration/2D_Sampling_with_Multidimensional_Transformations#SamplingaUnitDisk">PBR
      Book</a>, we have the norm of the diffusion profile <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">∥</mi>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mrow>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>x</mi>
                  </mrow>
                  <mo separator="true">,</mo>
                  <mrow>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>y</mi>
                  </mrow>
                  <mo stretchy="false">)</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mo>=</mo>
                  <msubsup>
                    <mo>∫</mo>
                    <mrow>
                      <mo>−</mo>
                      <mi mathvariant="normal">∞</mi>
                    </mrow>
                    <mi mathvariant="normal">∞</mi>
                  </msubsup>
                  <msubsup>
                    <mo>∫</mo>
                    <mrow>
                      <mo>−</mo>
                      <mi mathvariant="normal">∞</mi>
                    </mrow>
                    <mi mathvariant="normal">∞</mi>
                  </msubsup>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mrow>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>x</mi>
                  </mrow>
                  <mo separator="true">,</mo>
                  <mrow>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>y</mi>
                  </mrow>
                  <mo stretchy="false">)</mo>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mrow>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>x</mi>
                  </mrow>
                  <mi>d</mi>
                  <mrow>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>y</mi>
                  </mrow>
                  <mo>=</mo>
                  <msubsup>
                    <mo>∫</mo>
                    <mn>0</mn>
                    <mi mathvariant="normal">∞</mi>
                  </msubsup>
                  <msubsup>
                    <mo>∫</mo>
                    <mn>0</mn>
                    <mrow>
                      <mn>2</mn>
                      <mi>π</mi>
                    </mrow>
                  </msubsup>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>r</mi>
                  <mo stretchy="false">)</mo>
                  <mi>r</mi>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mi>θ</mi>
                  <mi>d</mi>
                  <mi>r</mi>
                  <mo>=</mo>
                  <msubsup>
                    <mo>∫</mo>
                    <mn>0</mn>
                    <mi mathvariant="normal">∞</mi>
                  </msubsup>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>r</mi>
                  <mo stretchy="false">)</mo>
                  <mn>2</mn>
                  <mi>π</mi>
                  <mi>r</mi>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mi>r</mi>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \| \operatorname{R}({\Delta x}, {\Delta y}) \| =
                \int_{-\infin}^\infin \int_{-\infin}^\infin \operatorname{R}({\Delta x}, {\Delta y}) \, d {\Delta x} d
                {\Delta y} = \int_0^\infin \int_0^{2\pi} \operatorname{R}(r) r \, d \theta dr = \int_0^\infin
                \operatorname{R} (r) 2 \pi r \, dr</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord"><span
                class="mord">Δ</span><span class="mord mathnormal">x</span></span><span class="mpunct">,</span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span
              class="mclose">)</span><span class="mord">∥</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.384573em;vertical-align:-0.970281em;"></span><span class="mop"><span
                class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.414292em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span
                        style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.970281em;"><span></span></span></span></span></span></span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.414292em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight">−</span><span class="mord mtight">∞</span></span></span></span><span
                        style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.970281em;"><span></span></span></span></span></span></span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord"><span
                class="mord">Δ</span><span class="mord mathnormal">x</span></span><span class="mpunct">,</span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord"><span class="mord">Δ</span><span
                class="mord mathnormal">x</span></span><span class="mord mathnormal">d</span><span class="mord"><span
                class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
              class="strut" style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.414292em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span
                        style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.5640080000000003em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span
                        style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight"
                              style="margin-right:0.03588em;">π</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
              class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
              class="mord mathnormal">d</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.414292em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span
                        style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mord">2</span><span
              class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
              class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></eq>. The norm of
    the diffusion profile is called the <strong>total diffuse reflectance</strong>
    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <msub>
                    <mi>R</mi>
                    <mi>d</mi>
                  </msub>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle R_d</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">d</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
    by &quot;Incorporating Diffuse Color Variation&quot; of [dEon 2007] and is called the <strong>effective
      albedo</strong>
    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <msub>
                    <mi>ρ</mi>
                    <mrow>
                      <mi>e</mi>
                      <mi>f</mi>
                      <mi>f</mi>
                    </mrow>
                  </msub>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle {\rho}_{eff}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span
                  class="mord mathnormal">ρ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span
                        style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mathnormal mtight">e</span><span
                              class="mord mathnormal mtight"
                              style="margin-right:0.10764em;">ff</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>
    </eq> by &quot;Equation (11.11)&quot; of <a
      href="https://pbr-book.org/3ed-2018/Volume_Scattering/The_BSSRDF#eq:bssrdf-effective-albedo">PBR Book</a>.
    Evidently, the diffusion profile depends on the position, since the total diffuse reflectance depends on the
    position. This means that the calculation of the subsurface scattering should technically be written as <eq><span
        class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">L</mi>
                        <mi mathvariant="normal">o</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">R</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mover accent="true">
                          <msub>
                            <mi mathvariant="normal">p</mi>
                            <mi mathvariant="normal">i</mi>
                          </msub>
                          <mo stretchy="true">→</mo>
                        </mover>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \displaystyle
                \operatorname{L_o}(\overrightarrow{p_o}, \overrightarrow{\omega_o}) = \int_{{\mathbb{R}}^2}
                \operatorname{R}(\| \overrightarrow{p_i} - \overrightarrow{p_o} \|)
                \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) \, d \overrightarrow{p_i} =
                \int_{{\mathbb{R}}^2} \operatorname{R_{\overrightarrow{p_i}}}(\| \overrightarrow{p_i} -
                \overrightarrow{p_o} \|) \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) \, d
                \overrightarrow{p_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.38952999999999993em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight"><span class="mord mtight"><span
                                  class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                  class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord">∥</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span
                          class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                              class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
              class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.38952999999999993em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight"><span class="mord mtight"><span
                                  class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                  class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span
                          style="top:-2.3780080000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                        style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span
                                          class="mord mtight"><span class="mord mathrm mtight">p</span><span
                                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                  class="vlist" style="height:0.3340428571428572em;"><span
                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                      class="pstrut" style="height:2.5em;"></span><span
                                                      class="sizing reset-size3 size1 mtight"><span
                                                        class="mord mathrm mtight">i</span></span></span></span><span
                                                  class="vlist-s">​</span></span><span class="vlist-r"><span
                                                  class="vlist"
                                                  style="height:0.143em;"><span></span></span></span></span></span></span></span><span
                                        class="svg-align" style="top:-3.13056em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span class="hide-tail mtight"
                                          style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                            viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                          </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.45810000000000006em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span
                          class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                              class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>.
    However, it is too difficult to calculate the subsurface scattering if the diffusion profile varies between the
    positions. Thus, we resort to use the normalized diffusion profile <eq><span class="katex"><span
          class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">R</mi>
                      <mi mathvariant="normal">N</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mi mathvariant="normal">
                        <msub>
                          <mi mathvariant="normal">R</mi>
                          <mover accent="true">
                            <msub>
                              <mi mathvariant="normal">p</mi>
                              <mi mathvariant="normal">i</mi>
                            </msub>
                            <mo stretchy="true">→</mo>
                          </mover>
                        </msub>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi mathvariant="normal">∥</mi>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo>−</mo>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>o</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mi mathvariant="normal">∥</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mi mathvariant="normal">∥</mi>
                      <mi mathvariant="normal">
                        <msub>
                          <mi mathvariant="normal">R</mi>
                          <mover accent="true">
                            <msub>
                              <mi mathvariant="normal">p</mi>
                              <mi mathvariant="normal">i</mi>
                            </msub>
                            <mo stretchy="true">→</mo>
                          </mover>
                        </msub>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi mathvariant="normal">∥</mi>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo>−</mo>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>o</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mi mathvariant="normal">∥</mi>
                      <mo stretchy="false">)</mo>
                      <mi mathvariant="normal">∥</mi>
                    </mrow>
                  </mfrac>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mi mathvariant="normal">
                        <msub>
                          <mi mathvariant="normal">R</mi>
                          <mover accent="true">
                            <msub>
                              <mi mathvariant="normal">p</mi>
                              <mi mathvariant="normal">i</mi>
                            </msub>
                            <mo stretchy="true">→</mo>
                          </mover>
                        </msub>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi mathvariant="normal">∥</mi>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo>−</mo>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>o</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mi mathvariant="normal">∥</mi>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mi mathvariant="normal">
                        <msub>
                          <mi mathvariant="normal">R</mi>
                          <mi mathvariant="normal">d</mi>
                        </msub>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo stretchy="false">)</mo>
                    </mrow>
                  </mfrac>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{R_N}(\| \overrightarrow{p_i} -
                \overrightarrow{p_o} \|) = \frac{\operatorname{R_{\overrightarrow{p_i}}}(\| \overrightarrow{p_i} -
                \overrightarrow{p_o} \|)}{\| \operatorname{R_{\overrightarrow{p_i}}}(\| \overrightarrow{p_i} -
                \overrightarrow{p_o} \|) \|} = \frac{\operatorname{R_{\overrightarrow{p_i}}}(\| \overrightarrow{p_i} -
                \overrightarrow{p_o} \|)}{\operatorname{R_d}(\overrightarrow{p_i})}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">N</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:3.1013200000000003em;vertical-align:-1.3006600000000001em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.8006600000000001em;"><span
                        style="top:-2.15744em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">∥</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                              class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.3448em;"><span
                                        style="top:-2.3780080000000003em;margin-left:0em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord accent mtight"><span class="vlist-t vlist-t2"><span
                                                  class="vlist-r"><span class="vlist"
                                                    style="height:0.9525600000000001em;"><span style="top:-2.7em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="mord mtight"><span
                                                          class="mord mathrm mtight">p</span><span class="msupsub"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.3340428571428572em;"><span
                                                                  style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                    class="pstrut" style="height:2.5em;"></span><span
                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                      class="mord mathrm mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                              class="vlist-r"><span class="vlist"
                                                                style="height:0.143em;"><span></span></span></span></span></span></span></span><span
                                                      class="svg-align" style="top:-3.13056em;"><span class="pstrut"
                                                        style="height:2.7em;"></span><span class="hide-tail mtight"
                                                        style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                          height='0.522em' viewBox='0 0 400000 522'
                                                          preserveAspectRatio='xMaxYMin slice'>
                                                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                        </svg></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.45810000000000006em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="mord"><span
                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="mord"><span
                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mord">∥</span><span class="mclose">)</span><span
                            class="mord">∥</span></span></span><span style="top:-3.23em;"><span class="pstrut"
                          style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.8481em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span
                              class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.3448em;"><span
                                        style="top:-2.3780080000000003em;margin-left:0em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord accent mtight"><span class="vlist-t vlist-t2"><span
                                                  class="vlist-r"><span class="vlist"
                                                    style="height:0.9525600000000001em;"><span style="top:-2.7em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="mord mtight"><span
                                                          class="mord mathrm mtight">p</span><span class="msupsub"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.3340428571428572em;"><span
                                                                  style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                    class="pstrut" style="height:2.5em;"></span><span
                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                      class="mord mathrm mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                              class="vlist-r"><span class="vlist"
                                                                style="height:0.143em;"><span></span></span></span></span></span></span></span><span
                                                      class="svg-align" style="top:-3.13056em;"><span class="pstrut"
                                                        style="height:2.7em;"></span><span class="hide-tail mtight"
                                                        style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                          height='0.522em' viewBox='0 0 400000 522'
                                                          preserveAspectRatio='xMaxYMin slice'>
                                                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                        </svg></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.45810000000000006em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="mord"><span
                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="mord"><span
                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mord">∥</span><span class="mclose">)</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:1.3006600000000001em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.8932200000000003em;vertical-align:-1.0925600000000002em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.8006600000000001em;"><span
                        style="top:-2.15744em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mop"><span class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.33610799999999996em;"><span
                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mord mathrm mtight">d</span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                    style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                      class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut"
                          style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.8481em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span
                              class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.3448em;"><span
                                        style="top:-2.3780080000000003em;margin-left:0em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord accent mtight"><span class="vlist-t vlist-t2"><span
                                                  class="vlist-r"><span class="vlist"
                                                    style="height:0.9525600000000001em;"><span style="top:-2.7em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="mord mtight"><span
                                                          class="mord mathrm mtight">p</span><span class="msupsub"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.3340428571428572em;"><span
                                                                  style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                    class="pstrut" style="height:2.5em;"></span><span
                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                      class="mord mathrm mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                              class="vlist-r"><span class="vlist"
                                                                style="height:0.143em;"><span></span></span></span></span></span></span></span><span
                                                      class="svg-align" style="top:-3.13056em;"><span class="pstrut"
                                                        style="height:2.7em;"></span><span class="hide-tail mtight"
                                                        style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                          height='0.522em' viewBox='0 0 400000 522'
                                                          preserveAspectRatio='xMaxYMin slice'>
                                                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                        </svg></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.45810000000000006em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="mord"><span
                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="mord"><span
                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mord">∥</span><span class="mclose">)</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:1.0925600000000002em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span></span></span></span></eq> which is assumed to be the same at
    each postion. And the calculation of the subsurface scattering is further simplified as <eq><span
        class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">L</mi>
                      <mi mathvariant="normal">o</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <msub>
                    <mo>∫</mo>
                    <msup>
                      <mi mathvariant="double-struck">R</mi>
                      <mn>2</mn>
                    </msup>
                  </msub>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">R</mi>
                      <mover accent="true">
                        <msub>
                          <mi mathvariant="normal">p</mi>
                          <mi mathvariant="normal">i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>=</mo>
                  <msub>
                    <mo>∫</mo>
                    <msup>
                      <mi mathvariant="double-struck">R</mi>
                      <mn>2</mn>
                    </msup>
                  </msub>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">R</mi>
                      <mi mathvariant="normal">N</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">R</mi>
                      <mi mathvariant="normal">d</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                \overrightarrow{\omega_o}) = \int_{{\mathbb{R}}^2} \operatorname{R_{\overrightarrow{p_i}}}(\|
                \overrightarrow{p_i} - \overrightarrow{p_o} \|) \operatorname{F}(\overrightarrow{p_i},
                \overrightarrow{\omega_o}) \, d \overrightarrow{p_i} = \int_{{\mathbb{R}}^2} \operatorname{R_N}(\|
                \overrightarrow{p_i} - \overrightarrow{p_o} \|) \operatorname{R_d}(\overrightarrow{p_i})
                \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) \, d \overrightarrow{p_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.38952999999999993em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight"><span class="mord mtight"><span
                                  class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                  class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span
                          style="top:-2.3780080000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                        style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span
                                          class="mord mtight"><span class="mord mathrm mtight">p</span><span
                                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                  class="vlist" style="height:0.3340428571428572em;"><span
                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                      class="pstrut" style="height:2.5em;"></span><span
                                                      class="sizing reset-size3 size1 mtight"><span
                                                        class="mord mathrm mtight">i</span></span></span></span><span
                                                  class="vlist-s">​</span></span><span class="vlist-r"><span
                                                  class="vlist"
                                                  style="height:0.143em;"><span></span></span></span></span></span></span></span><span
                                        class="svg-align" style="top:-3.13056em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span class="hide-tail mtight"
                                          style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                            viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                          </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.45810000000000006em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span
                          class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                              class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
              class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.38952999999999993em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight"><span class="mord mtight"><span
                                  class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                  class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.32833099999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">N</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">d</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span
                          class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                              class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>.
  </p>
  <p dir="auto">According to <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">L</mi>
                      <mi mathvariant="normal">o</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <msub>
                    <mo>∫</mo>
                    <msup>
                      <mi mathvariant="double-struck">R</mi>
                      <mn>2</mn>
                    </msup>
                  </msub>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">R</mi>
                      <mi mathvariant="normal">N</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">R</mi>
                      <mi mathvariant="normal">d</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                \overrightarrow{\omega_o}) = \int_{{\mathbb{R}}^2} \operatorname{R_N}(\| \overrightarrow{p_i} -
                \overrightarrow{p_o} \|) \operatorname{R_d}(\overrightarrow{p_i}) \operatorname{F}(\overrightarrow{p_i},
                \overrightarrow{\omega_o}) \, d \overrightarrow{p_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.38952999999999993em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight"><span class="mord mtight"><span
                                  class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                  class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.32833099999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">N</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">d</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span
                          class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                              class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>, we
    merely need to calculate the total diffuse reflectance <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">R</mi>
                      <mi mathvariant="normal">d</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{R_d}(\overrightarrow{p_i})
              </annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">d</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mclose">)</span></span></span></span></eq> and the form factor <eq><span class="katex"><span
          class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{F}(\overrightarrow{p_i},
                \overrightarrow{\omega_o})</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span></span></span></span></eq> at each vicinal position <eq><span class="katex"><span
          class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq> around
    the center position <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_o}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>, and
    apply the blur pass to accumulate them according to the weights derived from the normalized diffusion profile <eq>
      <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">R</mi>
                      <mi mathvariant="normal">N</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{R_N}(\| \overrightarrow{p_i} -
                \overrightarrow{p_o} \|)</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">N</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span></span></span></span>
    </eq>.</p>
  <h2 dir="auto" id="2-texturing-mode">2. Texturing Mode</h2>
  <p dir="auto">However, by &quot;Incorporating Diffuse Color Variation&quot; of [dEon 2007], it is difficult to measure
    the total diffuse reflectance. Thus, we resort to use the albedo from the texture asset to simulate the total
    diffuse reflectance.</p>
  <p dir="auto">Pre- and Post-Scatter Texturing Mode</p>
  <blockquote dir="auto">
    <p dir="auto">By &quot;Combining Pre-Scatter and Post-Scatter Texturing&quot; of [dEon 2007], the &quot;pre- and
      post-scatter texturing mode&quot; assumes that the total diffuse reflectance <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">d</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{R_d}(\overrightarrow{p_i})
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">d</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span></span></span></span></eq> at each vicinal position equals product of the square
      root of the albedo <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <msqrt>
                      <mrow>
                        <mi mathvariant="normal">ρ</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mover accent="true">
                          <msub>
                            <mi>p</mi>
                            <mi>i</mi>
                          </msub>
                          <mo stretchy="true">→</mo>
                        </mover>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </msqrt>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \sqrt{\operatorname{\rho}(\overrightarrow{p_i})}
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.84em;vertical-align:-0.45484499999999994em;"></span><span class="mord sqrt"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.3851550000000001em;"><span class="svg-align" style="top:-3.8em;"><span
                          class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span
                            class="mop"><span class="mord">ρ</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="mord"><span
                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span><span style="top:-3.345155em;"><span class="pstrut"
                          style="height:3.8em;"></span><span class="hide-tail"
                          style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em'
                            height='1.8800000000000001em' viewBox='0 0 400000 1944'
                            preserveAspectRatio='xMinYMin slice'>
                            <path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.45484499999999994em;"><span></span></span></span></span></span></span></span></span>
      </eq> at the vicinal position and the square root of the albedo <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <msqrt>
                      <mrow>
                        <mi mathvariant="normal">ρ</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mover accent="true">
                          <msub>
                            <mi>p</mi>
                            <mi>o</mi>
                          </msub>
                          <mo stretchy="true">→</mo>
                        </mover>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </msqrt>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \sqrt{\operatorname{\rho}(\overrightarrow{p_o})}
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.84em;vertical-align:-0.45484499999999994em;"></span><span class="mord sqrt"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.3851550000000001em;"><span class="svg-align" style="top:-3.8em;"><span
                          class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span
                            class="mop"><span class="mord">ρ</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="mord"><span
                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span><span style="top:-3.345155em;"><span class="pstrut"
                          style="height:3.8em;"></span><span class="hide-tail"
                          style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em'
                            height='1.8800000000000001em' viewBox='0 0 400000 1944'
                            preserveAspectRatio='xMinYMin slice'>
                            <path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.45484499999999994em;"><span></span></span></span></span></span></span></span></span>
      </eq> at the center position. This means that we have <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">L</mi>
                        <mi mathvariant="normal">o</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">d</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <msqrt>
                      <mrow>
                        <mi mathvariant="normal">ρ</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mover accent="true">
                          <msub>
                            <mi>p</mi>
                            <mi>o</mi>
                          </msub>
                          <mo stretchy="true">→</mo>
                        </mover>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </msqrt>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <msqrt>
                      <mrow>
                        <mi mathvariant="normal">ρ</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mover accent="true">
                          <msub>
                            <mi>p</mi>
                            <mi>i</mi>
                          </msub>
                          <mo stretchy="true">→</mo>
                        </mover>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </msqrt>
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                  \overrightarrow{\omega_o}) = \int_{{\mathbb{R}}^2} \operatorname{R_N}(\| \overrightarrow{p_i} -
                  \overrightarrow{p_o} \|) \operatorname{R_d}(\overrightarrow{p_i})
                  \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) \, d \overrightarrow{p_i} =
                  \int_{{\mathbb{R}}^2} \sqrt{\operatorname{\rho}(\overrightarrow{p_o})} \operatorname{R_N}(\|
                  \overrightarrow{p_i} - \overrightarrow{p_o} \|) \sqrt{\operatorname{\rho}(\overrightarrow{p_i})}
                  \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) \, d \overrightarrow{p_i}
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">d</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                class="strut" style="height:2.297105em;vertical-align:-0.9119499999999999em;"></span><span
                class="mop"><span class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord sqrt"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.3851550000000001em;"><span class="svg-align" style="top:-3.8em;"><span
                          class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span
                            class="mop"><span class="mord">ρ</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="mord"><span
                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span><span style="top:-3.345155em;"><span class="pstrut"
                          style="height:3.8em;"></span><span class="hide-tail"
                          style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em'
                            height='1.8800000000000001em' viewBox='0 0 400000 1944'
                            preserveAspectRatio='xMinYMin slice'>
                            <path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.45484499999999994em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.84em;vertical-align:-0.45484499999999994em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mord sqrt"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.3851550000000001em;"><span class="svg-align" style="top:-3.8em;"><span
                          class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span
                            class="mop"><span class="mord">ρ</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="mord"><span
                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span><span style="top:-3.345155em;"><span class="pstrut"
                          style="height:3.8em;"></span><span class="hide-tail"
                          style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em'
                            height='1.8800000000000001em' viewBox='0 0 400000 1944'
                            preserveAspectRatio='xMinYMin slice'>
                            <path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.45484499999999994em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>
      where the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <msqrt>
                      <mrow>
                        <mi mathvariant="normal">ρ</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mover accent="true">
                          <msub>
                            <mi>p</mi>
                            <mi>i</mi>
                          </msub>
                          <mo stretchy="true">→</mo>
                        </mover>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </msqrt>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \sqrt{\operatorname{\rho}(\overrightarrow{p_i})}
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.84em;vertical-align:-0.45484499999999994em;"></span><span class="mord sqrt"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.3851550000000001em;"><span class="svg-align" style="top:-3.8em;"><span
                          class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span
                            class="mop"><span class="mord">ρ</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="mord"><span
                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span><span style="top:-3.345155em;"><span class="pstrut"
                          style="height:3.8em;"></span><span class="hide-tail"
                          style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em'
                            height='1.8800000000000001em' viewBox='0 0 400000 1944'
                            preserveAspectRatio='xMinYMin slice'>
                            <path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.45484499999999994em;"><span></span></span></span></span></span></span></span></span>
      </eq> is multiplied before the blur pass and the <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <msqrt>
                      <mrow>
                        <mi mathvariant="normal">ρ</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mover accent="true">
                          <msub>
                            <mi>p</mi>
                            <mi>o</mi>
                          </msub>
                          <mo stretchy="true">→</mo>
                        </mover>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </msqrt>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \sqrt{\operatorname{\rho}(\overrightarrow{p_o})}
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.84em;vertical-align:-0.45484499999999994em;"></span><span class="mord sqrt"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.3851550000000001em;"><span class="svg-align" style="top:-3.8em;"><span
                          class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span
                            class="mop"><span class="mord">ρ</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="mord"><span
                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                          class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                              style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                  class="pstrut" style="height:2.7em;"></span><span
                                                  class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                              class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                              style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                      style="height:3em;"></span><span class="hide-tail"
                                      style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                        viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                      </svg></span></span></span><span class="vlist-s">​</span></span><span
                                class="vlist-r"><span class="vlist"
                                  style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span><span style="top:-3.345155em;"><span class="pstrut"
                          style="height:3.8em;"></span><span class="hide-tail"
                          style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em'
                            height='1.8800000000000001em' viewBox='0 0 400000 1944'
                            preserveAspectRatio='xMinYMin slice'>
                            <path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.45484499999999994em;"><span></span></span></span></span></span></span></span></span>
      </eq> is multiplied after the blur pass.</p>
    <p dir="auto">By &quot;Combining Pre-Scatter and Post-Scatter Texturing&quot; of [dEon 2007], this texturing mode is
      the most physically plausible.</p>
  </blockquote>
  <p dir="auto">Post-Scatter Texturing Mode</p>
  <blockquote dir="auto">
    <p dir="auto">By &quot;Post-Scatter Texturing&quot; of [dEon 2007], the &quot;post-scatter texturing mode&quot;
      assumes that the total diffuse reflectance <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">d</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{R_d}(\overrightarrow{p_i})
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">d</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span></span></span></span></eq> at each vicinal position equals the albedo <eq><span
          class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">ρ</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{\rho}(\overrightarrow{p_o})
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord">ρ</span></span><span class="mopen">(</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span></span></span></span></eq> at the center position. This means that we have <eq>
        <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">L</mi>
                        <mi mathvariant="normal">o</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">d</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>=</mo>
                    <mstyle scriptlevel="0" displaystyle="true">
                      <mi mathvariant="normal">
                        <msub>
                          <mi mathvariant="normal">L</mi>
                          <mi mathvariant="normal">o</mi>
                        </msub>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>o</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo separator="true">,</mo>
                      <mover accent="true">
                        <msub>
                          <mi>ω</mi>
                          <mi>o</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo stretchy="false">)</mo>
                      <mo>=</mo>
                      <msub>
                        <mo>∫</mo>
                        <msup>
                          <mi mathvariant="double-struck">R</mi>
                          <mn>2</mn>
                        </msup>
                      </msub>
                      <mi mathvariant="normal">ρ</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>o</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo stretchy="false">)</mo>
                      <mi mathvariant="normal">
                        <msub>
                          <mi mathvariant="normal">R</mi>
                          <mi mathvariant="normal">N</mi>
                        </msub>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi mathvariant="normal">∥</mi>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo>−</mo>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>o</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mi mathvariant="normal">∥</mi>
                      <mo stretchy="false">)</mo>
                      <mi mathvariant="normal">F</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo separator="true">,</mo>
                      <mover accent="true">
                        <msub>
                          <mi>ω</mi>
                          <mi>o</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo stretchy="false">)</mo>
                      <mtext> </mtext>
                      <mi>d</mi>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                    </mstyle>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                  \overrightarrow{\omega_o}) = \int_{{\mathbb{R}}^2} \operatorname{R_N}(\| \overrightarrow{p_i} -
                  \overrightarrow{p_o} \|) \operatorname{R_d}(\overrightarrow{p_i})
                  \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) \, d \overrightarrow{p_i} =
                  \displaystyle \operatorname{L_o}(\overrightarrow{p_o}, \overrightarrow{\omega_o}) =
                  \int_{{\mathbb{R}}^2} \operatorname{\rho}(\overrightarrow{p_o}) \operatorname{R_N}(\|
                  \overrightarrow{p_i} - \overrightarrow{p_o} \|) \operatorname{F}(\overrightarrow{p_i},
                  \overrightarrow{\omega_o}) \, d \overrightarrow{p_i}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">d</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord">ρ</span></span><span class="mopen">(</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mop"><span class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>
      </eq>
      where the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">ρ</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{\rho}(\overrightarrow{p_o})
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord">ρ</span></span><span class="mopen">(</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span></span></span></span></eq> is multiplied after the blur pass.</p>
    <p dir="auto">Since the albedo from the texture asset is NOT blurred, no color bleeding occurs in this texturing
      mode and it seems that this texturing mode is undesirable. However, by &quot;Post-Scatter Texturing&quot; of [dEon
      2007], when the texture asset is the photograph of real skin, since natural color bleeding has already occurred
      and no extra blurring should be performed, this texturing mode is an appropriate choice.</p>
  </blockquote>
  <p dir="auto">Both &quot;pre- and post-scatter texturing mode&quot; and &quot;post-scatter texturing mode&quot; are
    supported in <a
      href="(https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@10.8/manual/Diffusion-Profile.html)">Unity3D</a>.
    However, only the &quot;pre- and post-scatter texture mode&quot; is supported in UE4.</p>
  <p dir="auto">The &quot;texturing Mode&quot; is controlled by <a
      href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/Lit/Lit.hlsl#L2023">GetModifiedDiffuseColorForSSS</a>
    and <a
      href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/SubsurfaceScattering/SubsurfaceScattering.compute#L395">ApplySubsurfaceScatteringTexturingMode</a>
    in Unity3D, and <a
      href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/DeferredShadingCommon.ush#L605">AdjustBaseColorAndSpecularColorForSubsurfaceProfileLighting</a>
    and <a
      href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/PostProcessSubsurface.usf#L741">SubsurfaceRecombinePS</a>
    in UE4.</p>
  <h2 dir="auto" id="3-diffuse-brdf">3. Diffuse BRDF</h2>
  <p dir="auto">The form factor is approximated by the Lambert BRDF <eq><span class="katex"><span
          class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <msub>
                    <mo>∫</mo>
                    <mi mathvariant="normal">Ω</mi>
                  </msub>
                  <mo stretchy="false">(</mo>
                  <mn>1</mn>
                  <mo>−</mo>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">F</mi>
                      <mi mathvariant="normal">r</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <msub>
                    <mi>θ</mi>
                    <mi>o</mi>
                  </msub>
                  <mo stretchy="false">)</mo>
                  <mo stretchy="false">)</mo>
                  <mfrac>
                    <mrow>
                      <mn>1</mn>
                      <mo>−</mo>
                      <mi mathvariant="normal">
                        <msub>
                          <mi mathvariant="normal">F</mi>
                          <mi mathvariant="normal">r</mi>
                        </msub>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi>cos</mi>
                      <mo>⁡</mo>
                      <msub>
                        <mi>θ</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mi>c</mi>
                  </mfrac>
                  <mfrac>
                    <mn>1</mn>
                    <mi>π</mi>
                  </mfrac>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">L</mi>
                      <mi mathvariant="normal">i</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>cos</mi>
                      <mo>⁡</mo>
                      <msub>
                        <mi>θ</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>+</mo>
                  </msup>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>≈</mo>
                  <msub>
                    <mo>∫</mo>
                    <mi mathvariant="normal">Ω</mi>
                  </msub>
                  <mfrac>
                    <mn>1</mn>
                    <mi>π</mi>
                  </mfrac>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">L</mi>
                      <mi mathvariant="normal">i</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>cos</mi>
                      <mo>⁡</mo>
                      <msub>
                        <mi>θ</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>+</mo>
                  </msup>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{F}(\overrightarrow{p_i},
                \overrightarrow{\omega_o}) = \int_\Omega (1 - \operatorname{F_r}(\cos \theta_o)) \frac{1 -
                \operatorname{F_r}(\cos \theta_i)}{c} \frac{1}{\pi} \operatorname{L_i}(\overrightarrow{p_i},
                \overrightarrow{\omega_i}) {(\cos \theta_i)}^+ \, d \overrightarrow{\omega_i} \approx \int_\Omega
                \frac{1}{\pi} \operatorname{L_i}(\overrightarrow{p_i}, \overrightarrow{\omega_i}) {(\cos \theta_i)}^+ \,
                d \overrightarrow{\omega_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.433619em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord">1</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
              style="height:2.113em;vertical-align:-0.686em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mop">cos</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">o</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mclose">))</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">c</span></span></span><span style="top:-3.23em;"><span
                          class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mord"><span
                                class="mord mathrm">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mord mathrm mtight">r</span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                              class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.31166399999999994em;"><span
                                      style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                        class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span
                                          class="mord mathnormal mtight">i</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                          class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">i</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mord"><span class="mord"><span class="mopen">(</span><span
                  class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.31166399999999994em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.433619em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                          class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">i</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mord"><span class="mord"><span class="mopen">(</span><span
                  class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.31166399999999994em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
    </eq> in <a href="https://github.com/NVIDIAGameWorks/FaceWorks">NVIDIA FaceWork</a> and <a
      href="https://github.com/iryoku/separable-sss">Demo of [Jimenez 2015]</a>.</p>
  <p dir="auto">However, the more accurate Disney BRDF <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <msub>
                    <mo>∫</mo>
                    <mi mathvariant="normal">Ω</mi>
                  </msub>
                  <mo stretchy="false">(</mo>
                  <mn>1</mn>
                  <mo>−</mo>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">F</mi>
                      <mi mathvariant="normal">r</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <msub>
                    <mi>θ</mi>
                    <mi>o</mi>
                  </msub>
                  <mo stretchy="false">)</mo>
                  <mo stretchy="false">)</mo>
                  <mfrac>
                    <mrow>
                      <mn>1</mn>
                      <mo>−</mo>
                      <mi mathvariant="normal">
                        <msub>
                          <mi mathvariant="normal">F</mi>
                          <mi mathvariant="normal">r</mi>
                        </msub>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi>cos</mi>
                      <mo>⁡</mo>
                      <msub>
                        <mi>θ</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mi>c</mi>
                  </mfrac>
                  <mfrac>
                    <mn>1</mn>
                    <mi>π</mi>
                  </mfrac>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">L</mi>
                      <mi mathvariant="normal">i</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>cos</mi>
                      <mo>⁡</mo>
                      <msub>
                        <mi>θ</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>+</mo>
                  </msup>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>≈</mo>
                  <msub>
                    <mo>∫</mo>
                    <mi mathvariant="normal">Ω</mi>
                  </msub>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">F</mi>
                      <mi mathvariant="normal">r</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <msub>
                    <mi>θ</mi>
                    <mi>o</mi>
                  </msub>
                  <mo stretchy="false">)</mo>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">F</mi>
                      <mi mathvariant="normal">r</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <msub>
                    <mi>θ</mi>
                    <mi>i</mi>
                  </msub>
                  <mo stretchy="false">)</mo>
                  <mfrac>
                    <mn>1</mn>
                    <mi>π</mi>
                  </mfrac>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">L</mi>
                      <mi mathvariant="normal">i</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>cos</mi>
                      <mo>⁡</mo>
                      <msub>
                        <mi>θ</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>+</mo>
                  </msup>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{F}(\overrightarrow{p_i},
                \overrightarrow{\omega_o}) = \int_\Omega (1 - \operatorname{F_r}(\cos \theta_o)) \frac{1 -
                \operatorname{F_r}(\cos \theta_i)}{c} \frac{1}{\pi} \operatorname{L_i}(\overrightarrow{p_i},
                \overrightarrow{\omega_i}) {(\cos \theta_i)}^+ \, d \overrightarrow{\omega_i} \approx \int_\Omega
                \operatorname{F_r}(\cos \theta_o) \operatorname{F_r}(\cos \theta_i) \frac{1}{\pi}
                \operatorname{L_i}(\overrightarrow{p_i}, \overrightarrow{\omega_i}) {(\cos \theta_i)}^+ \, d
                \overrightarrow{\omega_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.433619em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord">1</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
              style="height:2.113em;vertical-align:-0.686em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mop">cos</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">o</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mclose">))</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">c</span></span></span><span style="top:-3.23em;"><span
                          class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mord"><span
                                class="mord mathrm">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mord mathrm mtight">r</span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                              class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.31166399999999994em;"><span
                                      style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                        class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span
                                          class="mord mathnormal mtight">i</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                          class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">i</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mord"><span class="mord"><span class="mopen">(</span><span
                  class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.31166399999999994em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.433619em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">Ω</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord"><span class="mord mathrm">F</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mop">cos</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">o</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mop"><span class="mord"><span class="mord mathrm">F</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mop">cos</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">i</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span><span
              class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                          class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">i</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mord"><span class="mord"><span class="mopen">(</span><span
                  class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.31166399999999994em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
    </eq> is used in <a
      href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/BRDF.ush#L253">UE4</a> and <a
      href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.core/ShaderLibrary/BSDF.hlsl#L414">Unity3D</a>.
  </p>
  <p dir="auto">TODO</p>
  <h2 dir="auto" id="4-blur-pass">4. Blur Pass</h2>
  <table dir="auto">
    <thead dir="auto">
      <tr dir="auto">
        <th style="text-align:center">Blur Pass</th>
        <th style="text-align:center">NVIDIA FaceWorks</th>
        <th style="text-align:center">Demo of [Jimenez 2015]</th>
        <th style="text-align:center">UE4</th>
        <th style="text-align:center">Unity3D</th>
      </tr>
    </thead>
    <tbody dir="auto">
      <tr dir="auto">
        <td style="text-align:center">PreIntegrated SSS</td>
        <td style="text-align:center">Demo</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">PreIntegrated Skin Shading Model</td>
        <td style="text-align:center">N/A</td>
      </tr>
      <tr dir="auto">
        <td style="text-align:center">Separable SSS</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">Demo</td>
        <td style="text-align:center">Subsurface Profile Shading Model without Enable Burley</td>
        <td style="text-align:center">N/A</td>
      </tr>
      <tr dir="auto">
        <td style="text-align:center">Disney SSS</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">Subsurface Profile Shading Model with Enable Burley</td>
        <td style="text-align:center">Subsurface Scattering Material Type</td>
      </tr>
    </tbody>
  </table>
  <p dir="auto">Although the blur pass is much simpler than the general BSSRDF term, a general 2D convolution is still
    too unwieldy to be used in real time. By &quot;Advantages of a Sum-of-Gaussians Diffusion Profile&quot; of [dEon
    2007], by assuming the range of the significant contribution domain of the red channel of the diffusion profile is
    16 mm, 4096 (64 x 64) samples are required per pixel in the blur pass. Thus, more efficient method should be
    proposed to settle down this problem.</p>
  <p dir="auto">Technically, the specular lighting should <strong>NOT</strong> be blurred. In the Demo of [Jimenez
    2015], a dedicated <a
      href="https://github.com/iryoku/separable-sss/blob/master/Demo/Shaders/Main.fx#L272">specularRT</a> is added to
    store the specular lighting. In UE4, the <a
      href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/LightAccumulator.ush#L18">checkerboard
      rendering</a>, which is a bit tricky, is applied to store the diffuse lighting and specular lighting in adjacent
    pixels, and the gbuffer data is modified by <a
      href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/DeferredShadingCommon.ush#L605">AdjustBaseColorAndSpecularColorForSubsurfaceProfileLighting</a>
    before the lighting is calculated. In Unity3D, a dedicated <a
      href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/RenderPipeline/ShaderPass/ShaderPassForward.hlsl#L91">outSSSBuffer</a>
    is added to store the diffuse lighting.</p>
  <p dir="auto">Evidently, the pixels which do NOT represent the skin (such as eyebrow) should be skipped. Usually, an
    empirical value is used to scale the distance between the vicinal position <eq><span class="katex"><span
          class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq> and
    the center position <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_o}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>. And
    the sampling should be skipped if this empirical value is too low (for example, less than <eq><span
        class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mfrac>
                    <mn>1</mn>
                    <mn>255</mn>
                  </mfrac>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \frac{1}{255}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">255</span></span></span><span style="top:-3.23em;"><span class="pstrut"
                          style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span></span></span></span></eq>). This empirical value is called
    <a href="https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L445">SSSS_STRENGTH_SOURCE</a> in Demo
    of [Jimenez 2015], <a
      href="https://docs.unrealengine.com/4.26/en-US/RenderingAndGraphics/Materials/LightingModels/SubSurfaceProfile/#materialinputchannels">Opacity
      Map</a> in UE4 and <a
      href="https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@10.8/manual/Material-Type.html">Subsurface
      Mask Map</a> in Unity3D.
  </p>
  <h3 dir="auto" id="4-1-preintegrated-sss">4-1. PreIntegrated SSS</h3>
  <p dir="auto">The PreIntegrated SSS by [Penner 2011 B] is used by the <a
      href="https://github.com/NVIDIAGameWorks/FaceWorks">NVIDIA FaceWorks</a> and the <a
      href="https://docs.unrealengine.com/4.27/en-US/RenderingAndGraphics/Materials/MaterialProperties/LightingModels/#preintegratedskin">Preintegrated
      Skin Shading Model</a> of UE4.</p>
  <p dir="auto">The main idea of PreIntegrated SSS is to pre-integrate <eq><span class="katex"><span
          class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">L</mi>
                      <mi mathvariant="normal">o</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <msub>
                    <mo>∫</mo>
                    <msup>
                      <mi mathvariant="double-struck">R</mi>
                      <mn>2</mn>
                    </msup>
                  </msub>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">R</mi>
                      <mi mathvariant="normal">N</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">R</mi>
                      <mi mathvariant="normal">d</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                \overrightarrow{\omega_o}) = \int_{{\mathbb{R}}^2} \operatorname{R_N}(\| \overrightarrow{p_i} -
                \overrightarrow{p_o} \|) \operatorname{R_d}(\overrightarrow{p_i}) \operatorname{F}(\overrightarrow{p_i},
                \overrightarrow{\omega_o}) \, d \overrightarrow{p_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.38952999999999993em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight"><span class="mord mtight"><span
                                  class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                  class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.32833099999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">N</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">d</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span
                          class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                              class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>
    offline.</p>
  <p dir="auto">Texturing Mode &amp; Lambert BRDF &amp; Directional Light</p>
  <blockquote dir="auto">
    <p dir="auto">The &quot;Post-Scatter Texturing Mode&quot; is assumed. This means that <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">d</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mi mathvariant="normal">ρ</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{R_d}(\overrightarrow{p_i}) =
                  \operatorname{\rho}(\overrightarrow{p_o})</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">d</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
                class="mop"><span class="mord">ρ</span></span><span class="mopen">(</span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span></span></span></span></eq>.<br>
      And the form factor is approximated by the Lambert BRDF. This means that <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <mi mathvariant="normal">Ω</mi>
                    </msub>
                    <mo stretchy="false">(</mo>
                    <mn>1</mn>
                    <mo>−</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">F</mi>
                        <mi mathvariant="normal">r</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>cos</mi>
                    <mo>⁡</mo>
                    <msub>
                      <mi>θ</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="false">)</mo>
                    <mo stretchy="false">)</mo>
                    <mfrac>
                      <mrow>
                        <mn>1</mn>
                        <mo>−</mo>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">F</mi>
                            <mi mathvariant="normal">r</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mi>c</mi>
                    </mfrac>
                    <mfrac>
                      <mn>1</mn>
                      <mi>π</mi>
                    </mfrac>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">L</mi>
                        <mi mathvariant="normal">i</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>≈</mo>
                    <msub>
                      <mo>∫</mo>
                      <mi mathvariant="normal">Ω</mi>
                    </msub>
                    <mfrac>
                      <mn>1</mn>
                      <mi>π</mi>
                    </mfrac>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">L</mi>
                        <mi mathvariant="normal">i</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{F}(\overrightarrow{p_i},
                  \overrightarrow{\omega_o}) = \int_\Omega (1 - \operatorname{F_r}(\cos \theta_o)) \frac{1 -
                  \operatorname{F_r}(\cos \theta_i)}{c} \frac{1}{\pi} \operatorname{L_i}(\overrightarrow{p_i},
                  \overrightarrow{\omega_i}) {(\cos \theta_i)}^+ \, d \overrightarrow{\omega_i} \approx \int_\Omega
                  \frac{1}{\pi} \operatorname{L_i}(\overrightarrow{p_i}, \overrightarrow{\omega_i}) {(\cos \theta_i)}^+
                  \, d \overrightarrow{\omega_i}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.433619em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">Ω</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">1</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:2.113em;vertical-align:-0.686em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">r</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                  style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                class="mclose">))</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                  class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                            style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">c</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">F</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.151392em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">r</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.31166399999999994em;"><span
                                        style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.15em;"><span></span></span></span></span></span></span><span
                              class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mord"><span class="mord"><span class="mopen">(</span><span
                    class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                    class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                      class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                            style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.433619em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">Ω</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mord"><span class="mord"><span class="mopen">(</span><span
                    class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                    class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                      class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                            style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span></span></span></eq>.<br>
      And the light is assumed to be the directional light. This means that the <a
        href="https://www.pbr-book.org/3ed-2018/Light_Transport_I_Surface_Reflection/Sampling_Light_Sources#LightswithSingularities">Delta
        Distribution</a> is applied and we have <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mstyle scriptlevel="0" displaystyle="true">
                      <mi mathvariant="normal">F</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo separator="true">,</mo>
                      <mover accent="true">
                        <msub>
                          <mi>ω</mi>
                          <mi>o</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo stretchy="false">)</mo>
                      <mo>=</mo>
                      <msub>
                        <mo>∫</mo>
                        <mi mathvariant="normal">Ω</mi>
                      </msub>
                      <mfrac>
                        <mn>1</mn>
                        <mi>π</mi>
                      </mfrac>
                      <mi mathvariant="normal">
                        <msub>
                          <mi mathvariant="normal">L</mi>
                          <mi mathvariant="normal">i</mi>
                        </msub>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mover accent="true">
                        <msub>
                          <mi>p</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo separator="true">,</mo>
                      <mover accent="true">
                        <msub>
                          <mi>ω</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo stretchy="false">)</mo>
                      <msup>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mi>cos</mi>
                          <mo>⁡</mo>
                          <msub>
                            <mi>θ</mi>
                            <mi>i</mi>
                          </msub>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mo>+</mo>
                      </msup>
                      <mtext> </mtext>
                      <mi>d</mi>
                      <mover accent="true">
                        <msub>
                          <mi>ω</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo>=</mo>
                      <mfrac>
                        <mn>1</mn>
                        <mi>π</mi>
                      </mfrac>
                      <msub>
                        <mi>E</mi>
                        <mi>L</mi>
                      </msub>
                      <msup>
                        <mrow>
                          <mo stretchy="false">(</mo>
                          <mi>cos</mi>
                          <mo>⁡</mo>
                          <msub>
                            <mi>θ</mi>
                            <mi>i</mi>
                          </msub>
                          <mo stretchy="false">)</mo>
                        </mrow>
                        <mo>+</mo>
                      </msup>
                    </mstyle>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \displaystyle
                  \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) = \int_\Omega \frac{1}{\pi}
                  \operatorname{L_i}(\overrightarrow{p_i}, \overrightarrow{\omega_i}) {(\cos \theta_i)}^+ \, d
                  \overrightarrow{\omega_i} = \frac{1}{\pi} E_L {(\cos \theta_i)}^+</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.433619em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">Ω</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.31750199999999995em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mord"><span class="mord"><span class="mopen">(</span><span
                    class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                    class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                      class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                            style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal"
                  style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight">L</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span
                  class="mord"><span class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                    style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                      style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                          class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>
      </eq>.<br>
      And the calculation of the subsurface scattering is further simplified as <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">L</mi>
                        <mi mathvariant="normal">o</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">d</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">ρ</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mi>π</mi>
                    </mfrac>
                    <msub>
                      <mi>E</mi>
                      <mi>L</mi>
                    </msub>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>=</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mi>π</mi>
                    </mfrac>
                    <mi mathvariant="normal">ρ</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <msub>
                      <mi>E</mi>
                      <mi>L</mi>
                    </msub>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                  \overrightarrow{\omega_o}) = \int_{{\mathbb{R}}^2} \operatorname{R_N}(\| \overrightarrow{p_i} -
                  \overrightarrow{p_o} \|) \operatorname{R_d}(\overrightarrow{p_i})
                  \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) \, d \overrightarrow{p_i} =
                  \int_{{\mathbb{R}}^2} \operatorname{R_N}(\| \overrightarrow{p_i} - \overrightarrow{p_o} \|)
                  \operatorname{\rho}(\overrightarrow{p_o}) \frac{1}{\pi} E_L {(\cos \theta_i)}^+ \, d
                  \overrightarrow{p_i} = \frac{1}{\pi} \operatorname{\rho}(\overrightarrow{p_o}) E_L
                  \int_{{\mathbb{R}}^2} \operatorname{R_N}(\| \overrightarrow{p_i} - \overrightarrow{p_o} \|) {(\cos
                  \theta_i)}^+ \, d \overrightarrow{p_i}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">d</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                class="mop"><span class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord">ρ</span></span><span class="mopen">(</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                  class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                            style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal"
                  style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight">L</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span
                  class="mord"><span class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                    style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                      style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                          class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span
                          style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord">ρ</span></span><span class="mopen">(</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mord"><span class="mord mathnormal"
                  style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight">L</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mord"><span class="mord"><span
                    class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                    style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                      style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                          class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>.</p>
  </blockquote>
  <p dir="auto">Curvature</p>
  <blockquote dir="auto">
    <p dir="auto">Let <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">D</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>θ</mi>
                    <mo separator="true">,</mo>
                    <mi>c</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, c) =
                  \int_{{\mathbb{R}}^2} \operatorname{R_N}(\| \overrightarrow{p_i} - \overrightarrow{p_o} \|) {(\cos
                  \theta_i)}^+ \, d \overrightarrow{p_i}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mord"><span class="mord"><span
                    class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                    style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                      style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                          class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>
      where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi>θ</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \theta</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span></span></span></span></eq> is the angle between the normal <eq>
        <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mover accent="true">
                      <mi>N</mi>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \overrightarrow{N}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20533em;vertical-align:0em;"></span><span class="mord accent"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.20533em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal"
                          style="margin-right:0.10903em;">N</span></span><span class="svg-align"
                        style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span></span></span></span></span></span></span>
      </eq> of the center
      position <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_o}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq> and
      the opposite direction <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mover accent="true">
                      <mi>L</mi>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \overrightarrow{L}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20533em;vertical-align:0em;"></span><span class="mord accent"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.20533em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                          class="mord mathnormal">L</span></span><span class="svg-align"
                        style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span></span></span></span></span></span></span></eq> of the directional
      light, and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi>c</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle c</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.43056em;vertical-align:0em;"></span><span
                class="mord mathnormal">c</span></span></span></span></eq> is the curvature which can be calculated
      on-the-fly as <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mfrac>
                      <mn>1</mn>
                      <mi>c</mi>
                    </mfrac>
                    <mo>=</mo>
                    <mfrac>
                      <mrow>
                        <mi mathvariant="normal">ddx</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mover accent="true">
                          <mi>N</mi>
                          <mo stretchy="true">→</mo>
                        </mover>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mrow>
                        <mi mathvariant="normal">ddx</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mover accent="true">
                          <mi>P</mi>
                          <mo stretchy="true">→</mo>
                        </mover>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mfrac>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \frac{1}{c} =
                  \frac{\operatorname{ddx}(\overrightarrow{N})}{\operatorname{ddx}(\overrightarrow{P})}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">c</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:3.22766em;vertical-align:-1.3453300000000001em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.88233em;"><span style="top:-2.11em;"><span
                            class="pstrut" style="height:3.20533em;"></span><span class="mord"><span class="mop"><span
                                class="mord mathrm">ddx</span></span><span class="mopen">(</span><span
                              class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                    style="height:1.20533em;"><span style="top:-3em;"><span class="pstrut"
                                        style="height:3em;"></span><span class="mord mathnormal"
                                        style="margin-right:0.13889em;">P</span></span><span class="svg-align"
                                      style="top:-3.6833299999999998em;"><span class="pstrut"
                                        style="height:3em;"></span><span class="hide-tail"
                                        style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                        </svg></span></span></span></span></span></span><span
                              class="mclose">)</span></span></span><span style="top:-3.43533em;"><span class="pstrut"
                            style="height:3.20533em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.88233em;"><span
                            class="pstrut" style="height:3.20533em;"></span><span class="mord"><span class="mop"><span
                                class="mord mathrm">ddx</span></span><span class="mopen">(</span><span
                              class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                    style="height:1.20533em;"><span style="top:-3em;"><span class="pstrut"
                                        style="height:3em;"></span><span class="mord mathnormal"
                                        style="margin-right:0.10903em;">N</span></span><span class="svg-align"
                                      style="top:-3.6833299999999998em;"><span class="pstrut"
                                        style="height:3em;"></span><span class="hide-tail"
                                        style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                        </svg></span></span></span></span></span></span><span
                              class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:1.3453300000000001em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span></span></span></span></eq>. However, the curvature is
      precomputed by <a
        href="https://github.com/NVIDIAGameWorks/FaceWorks/blob/master/src/precomp.cpp#L160">GFSDK_FaceWorks_CalculateMeshCurvature</a>
      in NVIDIA FaceWorks. Perhaps the on-the-fly method is NOT precise enough.</p>
  </blockquote>
  <p dir="auto">Diffusion Profile</p>
  <blockquote dir="auto">
    <p dir="auto">The diffusion profile, which is approximated by the Gaussians, by [dEon 2007] is still used by <a
        href="https://github.com/NVIDIAGameWorks/FaceWorks/blob/master/src/precomp.cpp#L533">EvaluateDiffusionProfile</a>
      in NVIDIA FaceWorks. However, the motivation of [dEon 2007] is to replace the general 2D convolution into two 1D
      convolutions to improve the performance by using the <a
        href="https://en.wikipedia.org/wiki/Separable_filter">Separable Filter</a> property of the <a
        href="https://en.wikipedia.org/wiki/Gaussian_blur">Gaussian Blur</a>. But the <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">D</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>θ</mi>
                    <mo separator="true">,</mo>
                    <mi>c</mi>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, c)</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span
                class="mclose">)</span></span></span></span></eq> is pre-integrated offline by [Penner 2011 B], the
      efficiency of the convolution is NOT important any more, and thus the more physically plausible diffusion profile
      <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mfrac>
                      <mi>S</mi>
                      <mrow>
                        <mn>8</mn>
                        <mi>π</mi>
                        <mi>r</mi>
                      </mrow>
                    </mfrac>
                    <mo stretchy="false">(</mo>
                    <msup>
                      <mi>e</mi>
                      <mrow>
                        <mo>−</mo>
                        <mi>S</mi>
                        <mi>r</mi>
                      </mrow>
                    </msup>
                    <mo>+</mo>
                    <msup>
                      <mi>e</mi>
                      <mrow>
                        <mo>−</mo>
                        <mfrac>
                          <mn>1</mn>
                          <mn>3</mn>
                        </mfrac>
                        <mi>S</mi>
                        <mi>r</mi>
                      </mrow>
                    </msup>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{R_N}(r) = \frac{S}{8 \pi r}(e^{-S
                  r}+e^{-\frac{1}{3} S r})</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span
                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span
                          style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">8</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.05764em;">S</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span
                  class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.891331em;"><span
                          style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight"
                                style="margin-right:0.05764em;">S</span><span class="mord mathnormal mtight"
                                style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.2540200000000001em;vertical-align:-0.25em;"></span><span
                class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:1.0040200000000001em;"><span
                          style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut"
                            style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span
                                  class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span
                                            class="pstrut" style="height:3em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span
                                                class="mord mtight">3</span></span></span></span><span
                                          style="top:-3.2255000000000003em;"><span class="pstrut"
                                            style="height:3em;"></span><span class="frac-line mtight"
                                            style="border-bottom-width:0.049em;"></span></span><span
                                          style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span
                                                class="mord mtight">1</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.344em;"><span></span></span></span></span></span><span
                                  class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span
                                class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span
                                class="mord mathnormal mtight"
                                style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span><span
                class="mclose">)</span></span></span></span></eq> by [Christensen 2015] should be used.
    </p>
  </blockquote>
  <p dir="auto">Integrate on the Ring</p>
  <blockquote dir="auto">
    <p dir="auto"><img src="Subsurface-Scattering-1.png" alt="D" data-src="Subsurface-Scattering-1.png"></p>
    <p dir="auto">By [Penner 2011 B], <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">D</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>θ</mi>
                    <mo separator="true">,</mo>
                    <mi>c</mi>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, c)</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span
                class="mclose">)</span></span></span></span></eq> is approximated as <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mfrac>
                      <mrow>
                        <msubsup>
                          <mo>∫</mo>
                          <mrow>
                            <mo>−</mo>
                            <mi>π</mi>
                          </mrow>
                          <mi>π</mi>
                        </msubsup>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">N</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <msup>
                          <mrow>
                            <mo stretchy="false">(</mo>
                            <mi>cos</mi>
                            <mo>⁡</mo>
                            <mo stretchy="false">(</mo>
                            <mi>θ</mi>
                            <mo>+</mo>
                            <mi>x</mi>
                            <mo stretchy="false">)</mo>
                            <mo stretchy="false">)</mo>
                          </mrow>
                          <mo>+</mo>
                        </msup>
                        <mtext> </mtext>
                        <mi>d</mi>
                        <mi>x</mi>
                      </mrow>
                      <mrow>
                        <msubsup>
                          <mo>∫</mo>
                          <mrow>
                            <mo>−</mo>
                            <mi>π</mi>
                          </mrow>
                          <mi>π</mi>
                        </msubsup>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">N</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <mtext> </mtext>
                        <mi>d</mi>
                        <mi>x</mi>
                      </mrow>
                    </mfrac>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \frac{\int_{-\pi}^{\pi} \operatorname{R_N}(2 c
                  |\sin (\frac{x}{2})|) {(\cos (\theta + x))}^+ \, dx}{\int_{-\pi}^{\pi} \operatorname{R_N}(2 c |\sin
                  (\frac{x}{2})|) \, dx}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:2.878825em;vertical-align:-1.163443em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.715382em;"><span
                          style="top:-2.250708em;"><span class="pstrut" style="height:3em;"></span><span
                            class="mord"><span class="mop"><span class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.8592920000000001em;"><span
                                        style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">−</span><span class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span><span
                                        style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.41415100000000005em;"><span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord">2</span><span
                              class="mord mathnormal">c</span><span class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span
                              class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.804151em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.8592920000000001em;"><span
                                        style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">−</span><span class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span><span
                                        style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.41415100000000005em;"><span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord">2</span><span
                              class="mord mathnormal">c</span><span class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span class="mord"><span
                                class="mord"><span class="mopen">(</span><span class="mop">cos</span><span
                                  class="mopen">(</span><span class="mord mathnormal"
                                  style="margin-right:0.02778em;">θ</span><span class="mspace"
                                  style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                                  class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                  class="mord mathnormal">x</span><span class="mclose">))</span></span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord mathnormal">d</span><span
                              class="mord mathnormal">x</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:1.163443em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span></span></span></span></eq> and pre-integrated offline to be
      stored in the LUT (Look Up Table).</p>
    <p dir="auto">However, this approximation can be improved much further.</p>
    <p dir="auto">Evidently, we have <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi>r</mi>
                    <mo>=</mo>
                    <mn>2</mn>
                    <mi>c</mi>
                    <mi mathvariant="normal">∣</mi>
                    <mi>sin</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mfrac>
                      <mi>x</mi>
                      <mn>2</mn>
                    </mfrac>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">∣</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle r = 2 c |\sin (\frac{x}{2})|</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span class="mord">2</span><span
                class="mord mathnormal">c</span><span class="mord">∣</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                  class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut"
                            style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">x</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                class="mord">∣</span></span></span></span></eq> and <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mfrac>
                      <mrow>
                        <mi>d</mi>
                        <mi>r</mi>
                      </mrow>
                      <mrow>
                        <mi>d</mi>
                        <mi>x</mi>
                      </mrow>
                    </mfrac>
                    <mo>=</mo>
                    <mn>2</mn>
                    <mi>c</mi>
                    <mfrac>
                      <mn>1</mn>
                      <mn>2</mn>
                    </mfrac>
                    <mi>cos</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mfrac>
                      <mi>x</mi>
                      <mn>2</mn>
                    </mfrac>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mi>c</mi>
                    <mi>cos</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mfrac>
                      <mi>x</mi>
                      <mn>2</mn>
                    </mfrac>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \frac{dr}{dx} = 2 c \frac{1}{2} \cos(\frac{x}{2})
                  = c \cos(\frac{x}{2})</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">d</span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord">2</span><span
                class="mord mathnormal">c</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                  class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                            style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                  class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut"
                            style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">x</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span
                class="mord mathnormal">c</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                  class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut"
                            style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">x</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></eq> due
      to the symmetry.</p>
    <p dir="auto">By &quot;13.5.2 Polar Coordinates&quot; of <a
        href="https://pbr-book.org/3ed-2018/Monte_Carlo_Integration/Transforming_between_Distributions#PolarCoordinates">PBR
        Book</a>, we have that <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">D</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>θ</mi>
                    <mo separator="true">,</mo>
                    <mi>c</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>=</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mi mathvariant="normal">∞</mi>
                    </msubsup>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mrow>
                        <mn>2</mn>
                        <mi>π</mi>
                      </mrow>
                    </msubsup>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <msub>
                      <mi>θ</mi>
                      <mi>r</mi>
                    </msub>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>=</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mi mathvariant="normal">∞</mi>
                    </msubsup>
                    <mn>2</mn>
                    <mi>π</mi>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>=</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mrow>
                        <mn>2</mn>
                        <mi>c</mi>
                      </mrow>
                    </msubsup>
                    <mn>2</mn>
                    <mi>π</mi>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>+</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mrow>
                        <mn>2</mn>
                        <mi>c</mi>
                      </mrow>
                      <mi mathvariant="normal">∞</mi>
                    </msubsup>
                    <mn>2</mn>
                    <mi>π</mi>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>r</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, c) =
                  \int_{{\mathbb{R}}^2} \operatorname{R_N}(\| \overrightarrow{p_i} - \overrightarrow{p_o} \|) {(\cos
                  \theta_i)}^+ \, d \overrightarrow{p_i} = \int_0^\infin \int_0^{2\pi} \operatorname{R_N}(r) r {(\cos
                  \theta_i)}^+ \, d \theta_r dr = \int_0^\infin 2 \pi \operatorname{R_N} (r) r {(\cos \theta_i)}^+ \, dr
                  = \int_0^{2c} 2 \pi \operatorname{R_N} (r) r {(\cos \theta_i)}^+ \, dr + \int_{2c}^\infin 2 \pi
                  \operatorname{R_N} (r) r {(\cos \theta_i)}^+ \, dr</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mord"><span class="mord"><span
                    class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                    style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                      style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                          class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                class="strut" style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
                class="mop"><span class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.414292em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">∞</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.5640080000000003em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight"
                                style="margin-right:0.03588em;">π</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mord"><span class="mord"><span class="mopen">(</span><span class="mop">cos</span><span
                    class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                      class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                            style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                  style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight"
                              style="margin-right:0.02778em;">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.414292em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">∞</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mord"><span class="mord"><span class="mopen">(</span><span class="mop">cos</span><span
                    class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                      class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                            style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.5640080000000003em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">2</span><span
                                class="mord mathnormal mtight">c</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mord"><span class="mord"><span class="mopen">(</span><span class="mop">cos</span><span
                    class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                      class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                            style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.414292em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight">2</span><span
                                class="mord mathnormal mtight">c</span></span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">∞</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mord"><span class="mord"><span class="mopen">(</span><span class="mop">cos</span><span
                    class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                      class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                            style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span></span></span></span></eq>. Note that <eq><span
          class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <msub>
                      <mi>θ</mi>
                      <mi>r</mi>
                    </msub>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \theta_r</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal"
                  style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight"
                              style="margin-right:0.02778em;">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
      </eq> is the polar coordinate which is not marked in the figure and is reduced due to the circular symmetry.</p>
    <p dir="auto">By &quot;Figure 15.10&quot; of <a
        href="https://pbr-book.org/3ed-2018/Light_Transport_II_Volume_Rendering/Sampling_Subsurface_Reflection_Functions#fig:probe-segment-length">PBR
        Book</a>, the diffusion profile falls off fairly quickly and the vicinal position <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_i}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>,
      which is too far away from the center position <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_o}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>, can
      be ignored. This means that we have <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">D</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>θ</mi>
                    <mo separator="true">,</mo>
                    <mi>c</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mrow>
                        <mn>2</mn>
                        <mi>c</mi>
                      </mrow>
                    </msubsup>
                    <mn>2</mn>
                    <mi>π</mi>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>+</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mrow>
                        <mn>2</mn>
                        <mi>c</mi>
                      </mrow>
                      <mi mathvariant="normal">∞</mi>
                    </msubsup>
                    <mn>2</mn>
                    <mi>π</mi>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>≈</mo>
                    <mfrac>
                      <mrow>
                        <msubsup>
                          <mo>∫</mo>
                          <mn>0</mn>
                          <mrow>
                            <mn>2</mn>
                            <mi>c</mi>
                          </mrow>
                        </msubsup>
                        <mn>2</mn>
                        <mi>π</mi>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">N</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>r</mi>
                        <mo stretchy="false">)</mo>
                        <mi>r</mi>
                        <msup>
                          <mrow>
                            <mo stretchy="false">(</mo>
                            <mi>cos</mi>
                            <mo>⁡</mo>
                            <msub>
                              <mi>θ</mi>
                              <mi>i</mi>
                            </msub>
                            <mo stretchy="false">)</mo>
                          </mrow>
                          <mo>+</mo>
                        </msup>
                        <mtext> </mtext>
                        <mi>d</mi>
                        <mi>r</mi>
                      </mrow>
                      <mrow>
                        <msubsup>
                          <mo>∫</mo>
                          <mn>0</mn>
                          <mrow>
                            <mn>2</mn>
                            <mi>c</mi>
                          </mrow>
                        </msubsup>
                        <mn>2</mn>
                        <mi>π</mi>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">N</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>r</mi>
                        <mo stretchy="false">)</mo>
                        <mi>r</mi>
                        <mtext> </mtext>
                        <mi>d</mi>
                        <mi>r</mi>
                      </mrow>
                    </mfrac>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, c) = \int_0^{2c} 2 \pi
                  \operatorname{R_N} (r) r {(\cos \theta_i)}^+ \, dr + \int_{2c}^\infin 2 \pi \operatorname{R_N} (r) r
                  {(\cos \theta_i)}^+ \, dr \approx \frac{\int_0^{2c} 2 \pi \operatorname{R_N} (r) r {(\cos \theta_i)}^+
                  \, dr}{\int_0^{2c} 2 \pi \operatorname{R_N} (r) r \, dr}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.5640080000000003em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">2</span><span
                                class="mord mathnormal mtight">c</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mord"><span class="mord"><span class="mopen">(</span><span class="mop">cos</span><span
                    class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                      class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                            style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.414292em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight">2</span><span
                                class="mord mathnormal mtight">c</span></span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">∞</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mord"><span class="mord"><span class="mopen">(</span><span class="mop">cos</span><span
                    class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                      class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                            style="height:0.31166399999999994em;"><span
                              style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                class="pstrut" style="height:2.7em;"></span><span
                                class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathnormal mtight">i</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                          style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:3.0096560000000006em;vertical-align:-1.2548280000000003em;"></span><span
                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.7548280000000003em;"><span style="top:-2.11em;"><span class="pstrut"
                            style="height:3.009008em;"></span><span class="mord"><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:1.0090080000000001em;"><span
                                        style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mord mtight">0</span></span></span><span
                                        style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span><span
                                              class="mord mathnormal mtight">c</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.35582em;"><span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord">2</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span
                              class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span
                              class="mord mathnormal">d</span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.239008em;"><span
                            class="pstrut" style="height:3.009008em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span
                          style="top:-3.7548280000000003em;"><span class="pstrut"
                            style="height:3.009008em;"></span><span class="mord"><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:1.0090080000000001em;"><span
                                        style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mord mtight">0</span></span></span><span
                                        style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span><span
                                              class="mord mathnormal mtight">c</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.35582em;"><span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord">2</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span
                              class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span
                                class="mord"><span class="mopen">(</span><span class="mop">cos</span><span
                                  class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                  class="mord"><span class="mord mathnormal"
                                    style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                          style="height:0.31166399999999994em;"><span
                                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                              class="pstrut" style="height:2.7em;"></span><span
                                              class="sizing reset-size6 size3 mtight"><span
                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                                    class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                                        style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord mathnormal">d</span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:1.2548280000000003em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span></span></span></span></eq>.</p>
    <p dir="auto">Evidently, the denominator does NOT equal one, since <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mn>1</mn>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>=</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mrow>
                        <mn>2</mn>
                        <mi>c</mi>
                      </mrow>
                    </msubsup>
                    <mn>2</mn>
                    <mi>π</mi>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>+</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mrow>
                        <mn>2</mn>
                        <mi>c</mi>
                      </mrow>
                      <mi mathvariant="normal">∞</mi>
                    </msubsup>
                    <mn>2</mn>
                    <mi>π</mi>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>⇒</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mrow>
                        <mn>2</mn>
                        <mi>c</mi>
                      </mrow>
                    </msubsup>
                    <mn>2</mn>
                    <mi>π</mi>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                    <mo>−</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mrow>
                        <mn>2</mn>
                        <mi>c</mi>
                      </mrow>
                      <mi mathvariant="normal">∞</mi>
                    </msubsup>
                    <mn>2</mn>
                    <mi>π</mi>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>&lt;</mo>
                    <mn>1</mn>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle 1 = \int_{{\mathbb{R}}^2} \operatorname{R_N}(\|
                  \overrightarrow{p_i} - \overrightarrow{p_o} \|) \, d \overrightarrow{p_i} = \int_0^{2c} 2 \pi
                  \operatorname{R_N} (r) r \, dr + \int_{2c}^\infin 2 \pi \operatorname{R_N} (r) r \, dr \Rightarrow
                  \int_0^{2c} 2 \pi \operatorname{R_N} (r) r \, dr = 1 - \int_{2c}^\infin 2 \pi \operatorname{R_N} (r) r
                  \, dr &lt; 1</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                class="strut" style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
                class="mop"><span class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.5640080000000003em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">2</span><span
                                class="mord mathnormal mtight">c</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.414292em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight">2</span><span
                                class="mord mathnormal mtight">c</span></span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">∞</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">⇒</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.5640080000000003em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">2</span><span
                                class="mord mathnormal mtight">c</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span
                class="mop"><span class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.414292em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight">2</span><span
                                class="mord mathnormal mtight">c</span></span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">∞</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>
      </eq>.</p>
    <p dir="auto">By <a href="https://en.wikipedia.org/wiki/Integration_by_substitution">Integration by Substitution</a>
      and symmetry, we have <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">D</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>θ</mi>
                    <mo separator="true">,</mo>
                    <mi>c</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mfrac>
                      <mrow>
                        <msubsup>
                          <mo>∫</mo>
                          <mn>0</mn>
                          <mrow>
                            <mn>2</mn>
                            <mi>c</mi>
                          </mrow>
                        </msubsup>
                        <mn>2</mn>
                        <mi>π</mi>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">N</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>r</mi>
                        <mo stretchy="false">)</mo>
                        <mi>r</mi>
                        <msup>
                          <mrow>
                            <mo stretchy="false">(</mo>
                            <mi>cos</mi>
                            <mo>⁡</mo>
                            <msub>
                              <mi>θ</mi>
                              <mi>i</mi>
                            </msub>
                            <mo stretchy="false">)</mo>
                          </mrow>
                          <mo>+</mo>
                        </msup>
                        <mtext> </mtext>
                        <mi>d</mi>
                        <mi>r</mi>
                      </mrow>
                      <mrow>
                        <msubsup>
                          <mo>∫</mo>
                          <mn>0</mn>
                          <mrow>
                            <mn>2</mn>
                            <mi>c</mi>
                          </mrow>
                        </msubsup>
                        <mn>2</mn>
                        <mi>π</mi>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">N</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>r</mi>
                        <mo stretchy="false">)</mo>
                        <mi>r</mi>
                        <mtext> </mtext>
                        <mi>d</mi>
                        <mi>r</mi>
                      </mrow>
                    </mfrac>
                    <mo>=</mo>
                    <mfrac>
                      <mrow>
                        <mfrac>
                          <mn>1</mn>
                          <mn>2</mn>
                        </mfrac>
                        <msubsup>
                          <mo>∫</mo>
                          <mrow>
                            <mo>−</mo>
                            <mi>π</mi>
                          </mrow>
                          <mi>π</mi>
                        </msubsup>
                        <mn>2</mn>
                        <mi>π</mi>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">N</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <msup>
                          <mrow>
                            <mo stretchy="false">(</mo>
                            <mi>cos</mi>
                            <mo>⁡</mo>
                            <mo stretchy="false">(</mo>
                            <mi>θ</mi>
                            <mo>+</mo>
                            <mi>x</mi>
                            <mo stretchy="false">)</mo>
                            <mo stretchy="false">)</mo>
                          </mrow>
                          <mo>+</mo>
                        </msup>
                        <mfrac>
                          <mrow>
                            <mi>d</mi>
                            <mi>r</mi>
                          </mrow>
                          <mrow>
                            <mi>d</mi>
                            <mi>x</mi>
                          </mrow>
                        </mfrac>
                        <mtext> </mtext>
                        <mi>d</mi>
                        <mi>x</mi>
                      </mrow>
                      <mrow>
                        <mfrac>
                          <mn>1</mn>
                          <mn>2</mn>
                        </mfrac>
                        <msubsup>
                          <mo>∫</mo>
                          <mrow>
                            <mo>−</mo>
                            <mi>π</mi>
                          </mrow>
                          <mi>π</mi>
                        </msubsup>
                        <mn>2</mn>
                        <mi>π</mi>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">N</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <mfrac>
                          <mrow>
                            <mi>d</mi>
                            <mi>r</mi>
                          </mrow>
                          <mrow>
                            <mi>d</mi>
                            <mi>x</mi>
                          </mrow>
                        </mfrac>
                        <mtext> </mtext>
                        <mi>d</mi>
                        <mi>x</mi>
                      </mrow>
                    </mfrac>
                    <mo>=</mo>
                    <mfrac>
                      <mrow>
                        <mfrac>
                          <mn>1</mn>
                          <mn>2</mn>
                        </mfrac>
                        <msubsup>
                          <mo>∫</mo>
                          <mrow>
                            <mo>−</mo>
                            <mi>π</mi>
                          </mrow>
                          <mi>π</mi>
                        </msubsup>
                        <mn>2</mn>
                        <mi>π</mi>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">N</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <msup>
                          <mrow>
                            <mo stretchy="false">(</mo>
                            <mi>cos</mi>
                            <mo>⁡</mo>
                            <mo stretchy="false">(</mo>
                            <mi>θ</mi>
                            <mo>+</mo>
                            <mi>x</mi>
                            <mo stretchy="false">)</mo>
                            <mo stretchy="false">)</mo>
                          </mrow>
                          <mo>+</mo>
                        </msup>
                        <mtext>（</mtext>
                        <mi>c</mi>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mo stretchy="false">)</mo>
                        <mtext> </mtext>
                        <mi>d</mi>
                        <mi>x</mi>
                      </mrow>
                      <mrow>
                        <mfrac>
                          <mn>1</mn>
                          <mn>2</mn>
                        </mfrac>
                        <msubsup>
                          <mo>∫</mo>
                          <mrow>
                            <mo>−</mo>
                            <mi>π</mi>
                          </mrow>
                          <mi>π</mi>
                        </msubsup>
                        <mn>2</mn>
                        <mi>π</mi>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">N</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <mtext>（</mtext>
                        <mi>c</mi>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mtext>）</mtext>
                        <mtext> </mtext>
                        <mi>d</mi>
                        <mi>x</mi>
                      </mrow>
                    </mfrac>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, c) = \frac{\int_0^{2c} 2
                  \pi \operatorname{R_N} (r) r {(\cos \theta_i)}^+ \, dr}{\int_0^{2c} 2 \pi \operatorname{R_N} (r) r \,
                  dr} = \frac{\frac{1}{2} \int_{-\pi}^{\pi} 2 \pi \operatorname{R_N} (2 c |\sin (\frac{x}{2})|) (2 c
                  |\sin (\frac{x}{2})|) {(\cos (\theta + x))}^+ \frac{dr}{dx} \, dx}{\frac{1}{2} \int_{-\pi}^{\pi} 2 \pi
                  \operatorname{R_N} (2 c |\sin (\frac{x}{2})|) (2 c |\sin (\frac{x}{2})|) \frac{dr}{dx} \, dx} =
                  \frac{\frac{1}{2} \int_{-\pi}^{\pi} 2 \pi \operatorname{R_N} (2 c |\sin (\frac{x}{2})|) (2 c |\sin
                  (\frac{x}{2})|) {(\cos (\theta + x))}^+ （c \cos(\frac{x}{2})) \, dx}{\frac{1}{2} \int_{-\pi}^{\pi} 2
                  \pi \operatorname{R_N} (2 c |\sin (\frac{x}{2})|) (2 c |\sin (\frac{x}{2})|) （c \cos(\frac{x}{2})）\,
                  dx}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:3.0096560000000006em;vertical-align:-1.2548280000000003em;"></span><span
                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.7548280000000003em;"><span style="top:-2.11em;"><span class="pstrut"
                            style="height:3.009008em;"></span><span class="mord"><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:1.0090080000000001em;"><span
                                        style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mord mtight">0</span></span></span><span
                                        style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span><span
                                              class="mord mathnormal mtight">c</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.35582em;"><span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord">2</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span
                              class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span
                              class="mord mathnormal">d</span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.239008em;"><span
                            class="pstrut" style="height:3.009008em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span
                          style="top:-3.7548280000000003em;"><span class="pstrut"
                            style="height:3.009008em;"></span><span class="mord"><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:1.0090080000000001em;"><span
                                        style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mord mtight">0</span></span></span><span
                                        style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span><span
                                              class="mord mathnormal mtight">c</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.35582em;"><span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord">2</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span
                              class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span
                                class="mord"><span class="mopen">(</span><span class="mop">cos</span><span
                                  class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                  class="mord"><span class="mord mathnormal"
                                    style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                          style="height:0.31166399999999994em;"><span
                                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                              class="pstrut" style="height:2.7em;"></span><span
                                              class="sizing reset-size6 size3 mtight"><span
                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                                    class="vlist-r"><span class="vlist" style="height:0.911231em;"><span
                                        style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord mathnormal">d</span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:1.2548280000000003em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.899641em;vertical-align:-1.184259em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.715382em;"><span
                          style="top:-2.229892em;"><span class="pstrut" style="height:3em;"></span><span
                            class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">1</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.8592920000000001em;"><span
                                        style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">−</span><span class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span><span
                                        style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.41415100000000005em;"><span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord">2</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord">2</span><span
                              class="mord mathnormal">c</span><span class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span class="mopen">(</span><span
                              class="mord">2</span><span class="mord mathnormal">c</span><span
                              class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.8801079999999999em;"><span
                                        style="top:-2.6550000000000002em;"><span class="pstrut"
                                          style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                            class="mord mtight"><span class="mord mathnormal mtight">d</span><span
                                              class="mord mathnormal mtight">x</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">d</span><span
                                              class="mord mathnormal mtight"
                                              style="margin-right:0.02778em;">r</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span
                              class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.804151em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">1</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.8592920000000001em;"><span
                                        style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">−</span><span class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span><span
                                        style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.41415100000000005em;"><span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord">2</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord">2</span><span
                              class="mord mathnormal">c</span><span class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span class="mopen">(</span><span
                              class="mord">2</span><span class="mord mathnormal">c</span><span
                              class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span class="mord"><span
                                class="mord"><span class="mopen">(</span><span class="mop">cos</span><span
                                  class="mopen">(</span><span class="mord mathnormal"
                                  style="margin-right:0.02778em;">θ</span><span class="mspace"
                                  style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                                  class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                  class="mord mathnormal">x</span><span class="mclose">))</span></span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                              class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.8801079999999999em;"><span
                                        style="top:-2.6550000000000002em;"><span class="pstrut"
                                          style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                            class="mord mtight"><span class="mord mathnormal mtight">d</span><span
                                              class="mord mathnormal mtight">x</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">d</span><span
                                              class="mord mathnormal mtight"
                                              style="margin-right:0.02778em;">r</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span
                              class="mord mathnormal">d</span><span
                              class="mord mathnormal">x</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:1.184259em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.878825em;vertical-align:-1.163443em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.715382em;"><span
                          style="top:-2.250708em;"><span class="pstrut" style="height:3em;"></span><span
                            class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">1</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.8592920000000001em;"><span
                                        style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">−</span><span class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span><span
                                        style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.41415100000000005em;"><span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord">2</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord">2</span><span
                              class="mord mathnormal">c</span><span class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span class="mopen">(</span><span
                              class="mord">2</span><span class="mord mathnormal">c</span><span
                              class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span
                              class="mord cjk_fallback">（</span><span class="mord mathnormal">c</span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mop">cos</span><span class="mopen">(</span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord cjk_fallback">）</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span
                              class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.804151em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">1</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.8592920000000001em;"><span
                                        style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">−</span><span class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span><span
                                        style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.41415100000000005em;"><span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord">2</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord">2</span><span
                              class="mord mathnormal">c</span><span class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span class="mopen">(</span><span
                              class="mord">2</span><span class="mord mathnormal">c</span><span
                              class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span class="mord"><span
                                class="mord"><span class="mopen">(</span><span class="mop">cos</span><span
                                  class="mopen">(</span><span class="mord mathnormal"
                                  style="margin-right:0.02778em;">θ</span><span class="mspace"
                                  style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                                  class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                  class="mord mathnormal">x</span><span class="mclose">))</span></span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                              class="mord cjk_fallback">（</span><span class="mord mathnormal">c</span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mop">cos</span><span class="mopen">(</span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">))</span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord mathnormal">d</span><span
                              class="mord mathnormal">x</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:1.163443em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span></span></span></span></eq>.</p>
    <p dir="auto">Here is the MATLAB code which verifies <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">D</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>θ</mi>
                    <mo separator="true">,</mo>
                    <mi>c</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mfrac>
                      <mrow>
                        <mfrac>
                          <mn>1</mn>
                          <mn>2</mn>
                        </mfrac>
                        <msubsup>
                          <mo>∫</mo>
                          <mrow>
                            <mo>−</mo>
                            <mi>π</mi>
                          </mrow>
                          <mi>π</mi>
                        </msubsup>
                        <mn>2</mn>
                        <mi>π</mi>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">N</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <msup>
                          <mrow>
                            <mo stretchy="false">(</mo>
                            <mi>cos</mi>
                            <mo>⁡</mo>
                            <mo stretchy="false">(</mo>
                            <mi>θ</mi>
                            <mo>+</mo>
                            <mi>x</mi>
                            <mo stretchy="false">)</mo>
                            <mo stretchy="false">)</mo>
                          </mrow>
                          <mo>+</mo>
                        </msup>
                        <mtext>（</mtext>
                        <mi>c</mi>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mo stretchy="false">)</mo>
                        <mtext> </mtext>
                        <mi>d</mi>
                        <mi>x</mi>
                      </mrow>
                      <mrow>
                        <mfrac>
                          <mn>1</mn>
                          <mn>2</mn>
                        </mfrac>
                        <msubsup>
                          <mo>∫</mo>
                          <mrow>
                            <mo>−</mo>
                            <mi>π</mi>
                          </mrow>
                          <mi>π</mi>
                        </msubsup>
                        <mn>2</mn>
                        <mi>π</mi>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">N</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <mo stretchy="false">(</mo>
                        <mn>2</mn>
                        <mi>c</mi>
                        <mi mathvariant="normal">∣</mi>
                        <mi>sin</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">∣</mi>
                        <mo stretchy="false">)</mo>
                        <mtext>（</mtext>
                        <mi>c</mi>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mfrac>
                          <mi>x</mi>
                          <mn>2</mn>
                        </mfrac>
                        <mo stretchy="false">)</mo>
                        <mtext>）</mtext>
                        <mtext> </mtext>
                        <mi>d</mi>
                        <mi>x</mi>
                      </mrow>
                    </mfrac>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, c) = \frac{\frac{1}{2}
                  \int_{-\pi}^{\pi} 2 \pi \operatorname{R_N} (2 c |\sin (\frac{x}{2})|) (2 c |\sin (\frac{x}{2})|)
                  {(\cos (\theta + x))}^+ （c \cos(\frac{x}{2})) \, dx}{\frac{1}{2} \int_{-\pi}^{\pi} 2 \pi
                  \operatorname{R_N} (2 c |\sin (\frac{x}{2})|) (2 c |\sin (\frac{x}{2})|) （c \cos(\frac{x}{2})）\, dx}
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut" style="height:2.878825em;vertical-align:-1.163443em;"></span><span
                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.715382em;"><span
                          style="top:-2.250708em;"><span class="pstrut" style="height:3em;"></span><span
                            class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">1</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.8592920000000001em;"><span
                                        style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">−</span><span class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span><span
                                        style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.41415100000000005em;"><span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord">2</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord">2</span><span
                              class="mord mathnormal">c</span><span class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span class="mopen">(</span><span
                              class="mord">2</span><span class="mord mathnormal">c</span><span
                              class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span
                              class="mord cjk_fallback">（</span><span class="mord mathnormal">c</span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mop">cos</span><span class="mopen">(</span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord cjk_fallback">）</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span
                              class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.804151em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">1</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.8592920000000001em;"><span
                                        style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">−</span><span class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span><span
                                        style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight"
                                              style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.41415100000000005em;"><span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord">2</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.32833099999999993em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord">2</span><span
                              class="mord mathnormal">c</span><span class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span class="mopen">(</span><span
                              class="mord">2</span><span class="mord mathnormal">c</span><span
                              class="mord">∣</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                              class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                              class="mord">∣</span><span class="mclose">)</span><span class="mord"><span
                                class="mord"><span class="mopen">(</span><span class="mop">cos</span><span
                                  class="mopen">(</span><span class="mord mathnormal"
                                  style="margin-right:0.02778em;">θ</span><span class="mspace"
                                  style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                                  class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                  class="mord mathnormal">x</span><span class="mclose">))</span></span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                                          class="pstrut" style="height:2.7em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span
                                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                              class="mord cjk_fallback">（</span><span class="mord mathnormal">c</span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mop">cos</span><span class="mopen">(</span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mtight">2</span></span></span></span><span
                                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                                        style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">x</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.345em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">))</span><span
                              class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                              class="mord mathnormal">d</span><span
                              class="mord mathnormal">x</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:1.163443em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span></span></span></span></eq>.</p>
    <pre><code class="code-line language-matlab" dir="auto"><span class="hljs-keyword">global</span> S = (<span class="hljs-number">1.0</span> / <span class="hljs-number">0.7568628</span>);
<span class="hljs-keyword">global</span> c = <span class="hljs-number">3.0</span>;
<span class="hljs-keyword">global</span> theta = <span class="hljs-built_in">pi</span> / <span class="hljs-number">4.0</span>;

<span class="hljs-comment">% ========================================================</span>
<span class="hljs-comment">% numerator polar</span>
<span class="hljs-comment">% ========================================================</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span> = <span class="hljs-title">numerator_polar_positive</span><span class="hljs-params">(r)</span></span>
  <span class="hljs-keyword">global</span> S
  <span class="hljs-keyword">global</span> c
  <span class="hljs-keyword">global</span> theta
  R_N_mul_r = (S / (<span class="hljs-number">8.0</span> * <span class="hljs-built_in">pi</span>)) * (<span class="hljs-built_in">exp</span>(-S * r) + <span class="hljs-built_in">exp</span>(-(<span class="hljs-number">1.0</span> / <span class="hljs-number">3.0</span>) * S * r));
  x = <span class="hljs-number">2.0</span> * <span class="hljs-built_in">asin</span>(r / (<span class="hljs-number">2.0</span> * c));
  cos_theta_add_x = <span class="hljs-built_in">max</span>(<span class="hljs-number">0.0</span>, <span class="hljs-built_in">cos</span>(theta + x));
  y = <span class="hljs-number">2.0</span> * <span class="hljs-built_in">pi</span> * R_N_mul_r * cos_theta_add_x;
endfunction

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span> = <span class="hljs-title">numerator_polar_negative</span><span class="hljs-params">(r)</span></span>
  <span class="hljs-keyword">global</span> S
  <span class="hljs-keyword">global</span> c
  <span class="hljs-keyword">global</span> theta
  R_N_mul_r = (S / (<span class="hljs-number">8.0</span> * <span class="hljs-built_in">pi</span>)) * (<span class="hljs-built_in">exp</span>(-S * r) + <span class="hljs-built_in">exp</span>(-(<span class="hljs-number">1.0</span> / <span class="hljs-number">3.0</span>) * S * r));
  x = <span class="hljs-number">-2.0</span> * <span class="hljs-built_in">asin</span>(r / (<span class="hljs-number">2.0</span> * c));
  cos_theta_add_x = <span class="hljs-built_in">max</span>(<span class="hljs-number">0.0</span>, <span class="hljs-built_in">cos</span>(theta + x));
  y = <span class="hljs-number">2.0</span> * <span class="hljs-built_in">pi</span> * R_N_mul_r * cos_theta_add_x;
endfunction

q_numerator_polar = <span class="hljs-number">0.5</span> * (quad(<span class="hljs-string">&quot;numerator_polar_positive&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2.0</span> * c) + quad(<span class="hljs-string">&quot;numerator_polar_negative&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2.0</span> * c));

<span class="hljs-comment">% output: &quot;numerator_polar: 0.563473&quot;</span>
printf(<span class="hljs-string">&quot;numerator_polar: %f\n&quot;</span>, q_numerator_polar);

<span class="hljs-comment">% ========================================================</span>
<span class="hljs-comment">% numerator ring</span>
<span class="hljs-comment">% ========================================================</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span> = <span class="hljs-title">numerator_ring</span><span class="hljs-params">(x)</span></span>
  <span class="hljs-keyword">global</span> S
  <span class="hljs-keyword">global</span> c
  <span class="hljs-keyword">global</span> theta
  r = <span class="hljs-number">2.0</span> * c * <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">sin</span>(<span class="hljs-number">0.5</span> * x));
  R_N_mul_r = (S / (<span class="hljs-number">8.0</span> * <span class="hljs-built_in">pi</span>)) * (<span class="hljs-built_in">exp</span>(<span class="hljs-number">-1.0</span> * S * r) + <span class="hljs-built_in">exp</span>(-(<span class="hljs-number">1.0</span> / <span class="hljs-number">3.0</span>) * S * r));
  cos_theta_add_x = <span class="hljs-built_in">max</span>(<span class="hljs-number">0.0</span>, <span class="hljs-built_in">cos</span>(theta + x));
  dr_per_dx = <span class="hljs-number">2.0</span> * c * <span class="hljs-number">0.5</span> * <span class="hljs-built_in">cos</span>(<span class="hljs-number">0.5</span> * x);
  y =  <span class="hljs-number">2.0</span> * <span class="hljs-built_in">pi</span> * R_N_mul_r * cos_theta_add_x * dr_per_dx;
endfunction

q_numerator_ring = <span class="hljs-number">0.5</span> * quad(<span class="hljs-string">&quot;numerator_ring&quot;</span>, -<span class="hljs-built_in">pi</span>, <span class="hljs-built_in">pi</span>);

<span class="hljs-comment">% output: &quot;numerator_ring: 0.563473&quot;</span>
printf(<span class="hljs-string">&quot;numerator_ring: %f\n&quot;</span>, q_numerator_ring);

<span class="hljs-comment">% ========================================================</span>
<span class="hljs-comment">% denominator polar</span>
<span class="hljs-comment">% ========================================================</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span> = <span class="hljs-title">denominator_polar</span><span class="hljs-params">(r)</span></span>
  <span class="hljs-keyword">global</span> S
  R_N_mul_r = (S / (<span class="hljs-number">8.0</span> * <span class="hljs-built_in">pi</span>)) * (<span class="hljs-built_in">exp</span>(-S * r) + <span class="hljs-built_in">exp</span>(-(<span class="hljs-number">1.0</span> / <span class="hljs-number">3.0</span>) * S * r));
  y = <span class="hljs-number">2.0</span> * <span class="hljs-built_in">pi</span> * R_N_mul_r;
endfunction

q_denominator_polar = quad(<span class="hljs-string">&quot;denominator_polar&quot;</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2.0</span> * c);

<span class="hljs-comment">% output: &quot;denominator_polar: 0.946522&quot;</span>
printf(<span class="hljs-string">&quot;denominator_polar: %f\n&quot;</span>, q_denominator_polar);

<span class="hljs-comment">% ========================================================</span>
<span class="hljs-comment">% denominator ring</span>
<span class="hljs-comment">% ========================================================</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">y</span> = <span class="hljs-title">denominator_ring</span><span class="hljs-params">(x)</span></span>
  <span class="hljs-keyword">global</span> S
  <span class="hljs-keyword">global</span> c
  r = <span class="hljs-number">2.0</span> * c * <span class="hljs-built_in">abs</span>(<span class="hljs-built_in">sin</span>(<span class="hljs-number">0.5</span> * x));
  R_N_mul_r = (S / (<span class="hljs-number">8.0</span> * <span class="hljs-built_in">pi</span>)) * (<span class="hljs-built_in">exp</span>(<span class="hljs-number">-1.0</span> * S * r) + <span class="hljs-built_in">exp</span>(-(<span class="hljs-number">1.0</span> / <span class="hljs-number">3.0</span>) * S * r));
  dr_per_dx = <span class="hljs-number">2.0</span> * c * <span class="hljs-number">0.5</span> * <span class="hljs-built_in">cos</span>(<span class="hljs-number">0.5</span> * x);
  y =  <span class="hljs-number">2.0</span> * <span class="hljs-built_in">pi</span> * R_N_mul_r * dr_per_dx;
endfunction

q_denominator_ring = <span class="hljs-number">0.5</span> * quad(<span class="hljs-string">&quot;denominator_ring&quot;</span>, -<span class="hljs-built_in">pi</span>, <span class="hljs-built_in">pi</span>);

<span class="hljs-comment">% output: &quot;denominator_ring: 0.946522&quot;</span>
printf(<span class="hljs-string">&quot;denominator_ring: %f\n&quot;</span>, q_denominator_ring);
</code></pre>
    <p dir="auto">The <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">D</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>θ</mi>
                    <mo separator="true">,</mo>
                    <mi>c</mi>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, c)</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span
                class="mclose">)</span></span></span></span></eq> is pre-integrated by <a
        href="https://github.com/NVIDIAGameWorks/FaceWorks/blob/master/src/precomp.cpp#L560">GFSDK_FaceWorks_GenerateCurvatureLUT</a>
      in NVIDIA FaceWorks.</p>
  </blockquote>
  <p dir="auto">Three Normals</p>
  <blockquote dir="auto">
    <p dir="auto">By [Penner 2011 A], three different normals should be used for different RGB channels and the LUT
      should be sampled three times according to the three different <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi>θ</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \theta</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span></span></span></span></eq>s.</p>
    <p dir="auto">Evidently, it is NOT efficient to sample the LUT three times and the <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mstyle scriptlevel="0" displaystyle="true">
                      <mover accent="true">
                        <mi>N</mi>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo>⋅</mo>
                      <mstyle scriptlevel="0" displaystyle="true">
                        <mover accent="true">
                          <mi>L</mi>
                          <mo stretchy="true">→</mo>
                        </mover>
                      </mstyle>
                    </mstyle>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \displaystyle \overrightarrow{N} \cdot
                  \displaystyle \overrightarrow{L}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20533em;vertical-align:0em;"></span><span class="mord accent"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.20533em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal"
                          style="margin-right:0.10903em;">N</span></span><span class="svg-align"
                        style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span></span></span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:1.20533em;vertical-align:0em;"></span><span class="mord accent"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.20533em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                          class="mord mathnormal">L</span></span><span class="svg-align"
                        style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span></span></span></span></span></span></span></eq>, which denotes the
      part of the integral where x is close to zero and the diffuse profile is close to the peak, is detached from the
      total integral <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">D</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>θ</mi>
                    <mo separator="true">,</mo>
                    <mi>c</mi>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, c)</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span
                class="mclose">)</span></span></span></span></eq> in NVIDIA FaceWorks.</p>
    <p dir="auto">However, the remaining part of the integral is relatively small, and thus FaceWorks maps the remaining
      part of the integral from [-0.25, 0.25] to [0, 1] to fully use the precision of the texture (the <a
        href="https://github.com/NVIDIAGameWorks/FaceWorks/blob/master/src/precomp.cpp#L673">rgbAdjust</a> in the <a
        href="https://github.com/NVIDIAGameWorks/FaceWorks/blob/master/src/precomp.cpp#L560">GFSDK_FaceWorks_GenerateCurvatureLUT</a>
      in NVIDIA FaceWorks).</p>
    <p dir="auto">The <a
        href="https://github.com/NVIDIAGameWorks/FaceWorks/blob/master/include/GFSDK_FaceWorks.hlsli#L325">GFSDK_FaceWorks_EvaluateSSSDirectLight</a>
      is used to calculate the subsurface scattering on-the-fly. The LUT is only sampled once and three normals are used
      to calculate the <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mstyle scriptlevel="0" displaystyle="true">
                      <mover accent="true">
                        <mi>N</mi>
                        <mo stretchy="true">→</mo>
                      </mover>
                      <mo>⋅</mo>
                      <mstyle scriptlevel="0" displaystyle="true">
                        <mover accent="true">
                          <mi>L</mi>
                          <mo stretchy="true">→</mo>
                        </mover>
                      </mstyle>
                    </mstyle>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \displaystyle \overrightarrow{N} \cdot
                  \displaystyle \overrightarrow{L}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20533em;vertical-align:0em;"></span><span class="mord accent"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.20533em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal"
                          style="margin-right:0.10903em;">N</span></span><span class="svg-align"
                        style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span></span></span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:1.20533em;vertical-align:0em;"></span><span class="mord accent"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.20533em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                          class="mord mathnormal">L</span></span><span class="svg-align"
                        style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span></span></span></span></span></span></span></eq> which is detached
      from the total integral.</p>
  </blockquote>
  <h3 dir="auto" id="4-2-separable-sss">4-2. Separable SSS</h3>
  <p dir="auto">The <strong>Separable SSS</strong> by [Jimenez 2012] is used by <a
      href="https://github.com/iryoku/separable-sss">Demo of [Jimenez 2015]</a> and the <a
      href="https://docs.unrealengine.com/4.27/en-US/RenderingAndGraphics/Materials/MaterialProperties/LightingModels/">Subsurface
      Profile Shading Model</a> <strong>without</strong> <a
      href="https://docs.unrealengine.com/4.27/en-US/RenderingAndGraphics/Materials/LightingModels/SubSurfaceProfile/">Enable
      Burley</a> of UE4.</p>
  <p dir="auto">Note that the demo of [Jimenez 2012] is provided by [Jimenez 2015]. Perhaps you can not believe it but
    it is really the truth. <strong>The demo provided by [Jimenez 2015] has nothing to do with [Jimenez 2015]</strong>.
    This is really arcane, and I do spend some time to realize this fact.</p>
  <p dir="auto">The main idea of the Separable SSS is to approximate the diffusion profile kernel by the separable
    kernel. Evidently, the Monte Carlo method is <strong>much more popular</strong> than the separable kernel in real
    time rendering. <strong>Thus, the Separable SSS has been obsolete and should be replaced by the Disney SSS</strong>.
  </p>
  <p dir="auto">Note that the word &quot;separable&quot; in the &quot;Separable SSS&quot; has nothing to do with the
    &quot;11.4.1 Separable BSSRDFs&quot; of <a
      href="https://pbr-book.org/3ed-2018/Volume_Scattering/The_BSSRDF#eq:separable-bssrdf">PBR Book</a>.</p>
  <p dir="auto">Separable Kernel</p>
  <blockquote dir="auto">
    <p dir="auto">The approach of [dEon 2007] is to approximate the diffusion profile by the weighted sum of 6
      Gaussians, and thus the general 2D convolution can be replaced by 12(2 x 6) 1D convolutions since the <a
        href="https://en.wikipedia.org/wiki/Gaussian_blur">Gaussian blur</a> is a <a
        href="https://en.wikipedia.org/wiki/Separable_filter">separable filter</a>. However, the approach proposed by
      [dEon 2007] is applied in texture space which is too weird according to the convention of the real time rendering.
      And the screen space approach is proposed by [Jimenez 2009]. However, the approach proposed by [Jimenez 2009]
      still needs 12(2 x 6) passes to perform the 12(2 x 6) 1D convolutions. Evidently, this is still too expensive for
      real time rendering. And thus, the 2 passes approach is proposed by [Jimenez 2012].</p>
    <p dir="auto">The main idea of [Jimenez 2012] is that in real time rendering, the non-separable diffusion profile is
      represented by the discretized kernel where the SVD can be applied, and the SVD indicates that the diffusion
      profile kernel can be approximated by a separable kernel <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">M</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>x</mi>
                      <mi>o</mi>
                    </msub>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>y</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <munder>
                      <mo>∑</mo>
                      <mi>y</mi>
                    </munder>
                    <mo stretchy="false">(</mo>
                    <munder>
                      <mo>∑</mo>
                      <mi>x</mi>
                    </munder>
                    <mi mathvariant="normal">E</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <msub>
                      <mi>x</mi>
                      <mi>o</mi>
                    </msub>
                    <mo>+</mo>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>x</mi>
                    <mo separator="true">,</mo>
                    <msub>
                      <mi>y</mi>
                      <mi>o</mi>
                    </msub>
                    <mo>+</mo>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>y</mi>
                    <mo stretchy="false">)</mo>
                    <mo>⋅</mo>
                    <mi mathvariant="normal">S</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>x</mi>
                    <mo stretchy="false">)</mo>
                    <mo stretchy="false">)</mo>
                    <mo>⋅</mo>
                    <mi mathvariant="normal">
                      <msup>
                        <mi mathvariant="normal">S</mi>
                        <mi mathvariant="normal">T</mi>
                      </msup>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>y</mi>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{M}(x_o, y_o) = \sum_y (\sum_x
                  \operatorname{E}(x_o + \Delta x, y_o + \Delta y) \cdot \operatorname{S}(\Delta x)) \cdot
                  \operatorname{S^T}(\Delta y)</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">M</span></span><span class="mopen">(</span><span class="mord"><span
                  class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span class="mop op-limits"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.0500050000000003em;"><span
                        style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                          style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span><span
                        style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span
                            class="mop op-symbol large-op">∑</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:1.386113em;"><span></span></span></span></span></span><span
                class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.050005em;"><span
                        style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                          style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">x</span></span></span><span
                        style="top:-3.0500049999999996em;"><span class="pstrut"
                          style="height:3.05em;"></span><span><span
                            class="mop op-symbol large-op">∑</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:1.250005em;"><span></span></span></span></span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord mathrm">E</span></span><span class="mopen">(</span><span class="mord"><span
                  class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">Δ</span><span
                class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                  style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Δ</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">S</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                class="mord mathnormal">x</span><span class="mclose">))</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">S</span><span class="msupsub"><span class="vlist-t"><span
                        class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span
                            style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">Δ</span><span class="mord mathnormal"
                style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></eq> where
      <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">S</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>x</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mi mathvariant="normal">R</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mfrac>
                      <mrow>
                        <mi mathvariant="normal">Δ</mi>
                        <mi>x</mi>
                        <mo>⋅</mo>
                        <mtext>width</mtext>
                      </mrow>
                      <mrow>
                        <mn>0.001</mn>
                        <mo>+</mo>
                        <mtext>falloff</mtext>
                      </mrow>
                    </mfrac>
                    <mo stretchy="false">)</mo>
                    <mo>⋅</mo>
                    <mtext>strength</mtext>
                    <mo>+</mo>
                    <mi mathvariant="normal">δ</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>x</mi>
                    <mo stretchy="false">)</mo>
                    <mo>⋅</mo>
                    <mo stretchy="false">(</mo>
                    <mn>1</mn>
                    <mo>−</mo>
                    <mtext>strength</mtext>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{S}(\Delta x) =
                  \operatorname{R}(\frac{\Delta x \cdot \text{width}}{0.001 + \text{falloff}}) \cdot \text{strength} +
                  \operatorname{\delta}(\Delta x) \cdot (1 - \text{strength})</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">S</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.14077em;vertical-align:-0.7693300000000001em;"></span><span class="mop"><span
                  class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">0.001</span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                              class="mord text"><span class="mord">falloff</span></span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                              class="mord text"><span class="mord">width</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span
                  class="mord">strength</span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord">δ</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span
                class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
              class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                class="mord text"><span class="mord">strength</span></span><span
                class="mclose">)</span></span></span></span></eq> where <strong>R</strong> denotes the 1D diffusion
      profile and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">δ</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>x</mi>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{\delta}(\Delta x)</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord">δ</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq> denotes the <a
        href="https://en.wikipedia.org/wiki/Dirac_delta_function">Delta Function</a> such that <eq><span
          class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">δ</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mn>0</mn>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{\delta}(0) = 1</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord">δ</span></span><span class="mopen">(</span><span class="mord">0</span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                class="mord">1</span></span></span></span></eq>.
    </p>
    <p dir="auto">The <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">S</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>x</mi>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{S}(\Delta x)</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">S</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq> is calculated by
      the <a
        href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/SeparableSSS.cpp#L205">calculateKernel</a>
      in Demo of [Jimenez 2015] and the <a
        href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Source/Runtime/Engine/Private/Rendering/SeparableSSS.cpp#L85">ComputeMirroredSSSKernel</a>
      in UE4.</p>
  </blockquote>
  <p dir="auto">Sampling Diffusion Profile</p>
  <blockquote dir="auto">
    <p dir="auto">By [dEon 2007], the range of the significant contribution domain of the diffusion profile is about 16
      mm. However, perhaps the diffusion profile is made narrower by the <strong>falloff</strong> in the formula by
      [Jimenez 2012], and thus the range of the significant contribution domain of the diffusion profile is reduced to
      6(3x2) mm (the <a
        href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/SeparableSSS.cpp#L208">RANGE</a> in the <a
        href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/SeparableSSS.cpp#L205">calculateKernel</a>
      in Demo of [Jimenez 2015].</p>
    <p dir="auto">According to the <strong>numerical quadrature</strong>, the function value sampled from the separable
      kernel <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">S</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">Δ</mi>
                    <mi>x</mi>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{S}(\Delta x)</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">S</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq> should be
      multiplied by the difference of the domain the <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">Δ</mi>
                    <mo>⁡</mo>
                    <mi>x</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta} x</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.68333em;vertical-align:0em;"></span><span class="mop"><span
                  class="mord mathrm">Δ</span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">x</span></span></span></span></eq> and the <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">Δ</mi>
                    <mo>⁡</mo>
                    <mi>y</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta} y</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mop"><span
                  class="mord mathrm">Δ</span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                style="margin-right:0.03588em;">y</span></span></span></span></eq> (the <a
        href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/SeparableSSS.cpp#L225">area</a> in the <a
        href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/SeparableSSS.cpp#L205">calculateKernel</a>
      in Demo of [Jimenez 2015]. And in Demo of [Jimenez 2015], it is manifested that the position of the sampling is
      fixed, and the offset in mm between the vicinal position <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_i}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq> and
      the center position <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_o}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq> in
      world space is stored in the <a
        href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/SeparableSSS.cpp#L218">w</a> component of
      the <a href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/SeparableSSS.h#L180">kernel</a> member
      of the <a href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/SeparableSSS.h#L47">SeparableSSS</a>
      class.</p>
    <p dir="auto">Technically, the position of the sampling is fixed. However, the <a
        href="https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L445">SSSS_STRENGTH_SOURCE</a> in Demo
      of [Jimenez 2015] provides the scaling to tweak the offset. The <a
        href="https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L445">SSSS_STRENGTH_SOURCE</a> is
      merely the alpha channel of the albedo texture, and is used to skip the pixels which do NOT represent the skin
      (such as eyebrow). Evidently, the <a
        href="https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L445">SSSS_STRENGTH_SOURCE</a> has
      nothing to do with the <strong>strength</strong> in the formula by [Jimenez 2012] at all. However, this empirical
      value is adopted by both UE4 and Unity3D. The equivalent is called <a
        href="https://docs.unrealengine.com/4.26/en-US/RenderingAndGraphics/Materials/LightingModels/SubSurfaceProfile/#materialinputchannels">Opacity
        Map</a> in UE4 and <a
        href="https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@10.8/manual/Material-Type.html">Subsurface
        Mask Map</a> in Unity3D.</p>
  </blockquote>
  <p dir="auto">World Scale</p>
  <blockquote dir="auto">
    <p dir="auto">Since the offset of position of the sampling is fixed and stored in the <a
        href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/SeparableSSS.cpp#L218">w</a> component of
      the <a href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/SeparableSSS.h#L180">kernel</a>, the
      mere purpose of the <a
        href="https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L377">SSSSBlurPS</a> is to transform
      the offset from world space to texture space. Assuming that the center position is at the origin of the Y axis,
      the transformation can be calculated as <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mtext>TextureSpace</mtext>
                    <mo>=</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mn>2</mn>
                    </mfrac>
                    <mo>×</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mrow>
                        <mi>tan</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mtext>FOVY</mtext>
                        <mo>×</mo>
                        <mn>0.5</mn>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mfrac>
                    <mo>×</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mtext>ViewPositionZInWorldSpaceUnit</mtext>
                    </mfrac>
                    <mo>×</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mrow>
                        <mn>1000</mn>
                        <mo>×</mo>
                        <mtext>MetersPerWorldSpaceUnit</mtext>
                      </mrow>
                    </mfrac>
                    <mo>×</mo>
                    <mtext>WorldSpaceDeltaXInMM</mtext>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \text{TextureSpace} = \frac{1}{2}
                  \times\frac{1}{\tan(\text{FOVY} \times 0.5)} \times \frac{1}{\text{ViewPositionZInWorldSpaceUnit}}
                  \times \frac{1}{1000 \times \text{MetersPerWorldSpaceUnit}} \times \text{WorldSpaceDeltaXInMM}
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span
                  class="mord">TextureSpace</span></span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut"
                            style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:2.25744em;vertical-align:-0.936em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mop">tan</span><span class="mopen">(</span><span class="mord text"><span
                                class="mord">FOVY</span></span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                              class="mord">0.5</span><span class="mclose">)</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.936em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span
                                class="mord">ViewPositionZInWorldSpaceUnit</span></span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1000</span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                              class="mord text"><span
                                class="mord">MetersPerWorldSpaceUnit</span></span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span
                  class="mord">WorldSpaceDeltaXInMM</span></span></span></span></span></eq> where the 1000 is to
      transform from mm to m, the <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mfrac>
                      <mn>1</mn>
                      <mrow>
                        <mi>tan</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mtext>FOVY</mtext>
                        <mo>×</mo>
                        <mn>0.5</mn>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mfrac>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \frac{1}{\tan(\text{FOVY} \times 0.5)}
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:2.25744em;vertical-align:-0.936em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mop">tan</span><span class="mopen">(</span><span class="mord text"><span
                                class="mord">FOVY</span></span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                              class="mord">0.5</span><span class="mclose">)</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.936em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span></span></span></span></eq> is the second row and the second
      column of the projection matrix, and the 2 is to transform from NDC to texture space.</p>
    <p dir="auto">And since the <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mfrac>
                      <mrow>
                        <mi mathvariant="normal">Δ</mi>
                        <mi>x</mi>
                      </mrow>
                      <mrow>
                        <mn>0.001</mn>
                        <mo>+</mo>
                        <mtext>falloff</mtext>
                      </mrow>
                    </mfrac>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \frac{\Delta x}{0.001 + \text{falloff}}
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span
                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span
                          style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">0.001</span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                              class="mord text"><span class="mord">falloff</span></span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">Δ</span><span class="mord mathnormal">x</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span></span></span></span></eq> is passed to the diffusion
      profile <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">R</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(r)</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span></eq> directly
      in the <a
        href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/SeparableSSS.cpp#L205">calculateKernel</a>
      without the <strong>width</strong> in the formula by [Jimenez 2012] multiplied at all, the <a
        href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/Demo.cpp#L1590">sssWidth</a> in Demo of
      [Jimenez 2015] can NOT be considered as the <strong>width</strong> in the formula by [Jimenez 2012].</p>
    <p dir="auto">In <a href="https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L377">SSSSBlurPS</a>,
      the transformation is calculated as <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mtext>TextureSpace</mtext>
                    <mo>=</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mrow>
                        <mi>tan</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mtext>FOVY</mtext>
                        <mo>×</mo>
                        <mn>0.5</mn>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mfrac>
                    <mo>×</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mtext>ViewPositionZInWorldSpaceUnit</mtext>
                    </mfrac>
                    <mo>×</mo>
                    <mfrac>
                      <mtext>sssWidth</mtext>
                      <mn>3</mn>
                    </mfrac>
                    <mo>×</mo>
                    <mtext>WorldSpaceDeltaXInMM</mtext>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \text{TextureSpace} = \frac{1}{\tan(\text{FOVY}
                  \times 0.5)} \times \frac{1}{\text{ViewPositionZInWorldSpaceUnit}} \times\frac{\text{sssWidth}}{3}
                  \times \text{WorldSpaceDeltaXInMM}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span
                  class="mord">TextureSpace</span></span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.25744em;vertical-align:-0.936em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mop">tan</span><span class="mopen">(</span><span class="mord text"><span
                                class="mord">FOVY</span></span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                              class="mord">0.5</span><span class="mclose">)</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.936em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span
                                class="mord">ViewPositionZInWorldSpaceUnit</span></span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut"
                            style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span
                                class="mord">sssWidth</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span
                  class="mord">WorldSpaceDeltaXInMM</span></span></span></span></span></eq>. By comparing these two
      formulas, a hypothesis can be proposed that <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mtext>MetersPerWorldSpaceUnit</mtext>
                    <mo>=</mo>
                    <mfrac>
                      <mn>3</mn>
                      <mrow>
                        <mn>1000</mn>
                        <mo>×</mo>
                        <mn>2</mn>
                        <mo>×</mo>
                        <mtext>sssWidth</mtext>
                      </mrow>
                    </mfrac>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \text{MetersPerWorldSpaceUnit} = \frac{3}{1000
                  \times 2 \times \text{sssWidth}}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span
                  class="mord">MetersPerWorldSpaceUnit</span></span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.09077em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1000</span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                              class="mord">2</span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                              class="mord text"><span class="mord">sssWidth</span></span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span></span></span></span></eq>. The default of the <a
        href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/Demo.cpp#L1590">sssWidth</a> in Demo of
      [Jimenez 2015] is 0.012, and thus the hypothesis implies that the <strong>MetersPerWorldSpaceUnit</strong> in Demo
      of [Jimenez 2015] is <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mfrac>
                      <mn>1</mn>
                      <mn>8</mn>
                    </mfrac>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \frac{1}{8}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">8</span></span></span><span style="top:-3.23em;"><span class="pstrut"
                            style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span></span></span></span></eq>. Fortunately, the vertex data of
      the head mesh in the Demo of [Jimenez 2015] is consistent with this result that <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mtext>MetersPerWorldSpaceUnit</mtext>
                    <mo>=</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mn>8</mn>
                    </mfrac>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \text{MetersPerWorldSpaceUnit} = \frac{1}{8}
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord text"><span
                  class="mord">MetersPerWorldSpaceUnit</span></span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">8</span></span></span><span style="top:-3.23em;"><span class="pstrut"
                            style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span></span></span></span></eq>.</p>
  </blockquote>
  <p dir="auto">Properties between Demo of [Jimenez 2015] and UE4</p>
  <blockquote dir="auto">
    <table dir="auto">
      <thead dir="auto">
        <tr dir="auto">
          <th style="text-align:center">Name in Formula by [Jimenez 2012]</th>
          <th style="text-align:center">Demo of [Jimenez 2015]</th>
          <th style="text-align:center">Demo of [Jimenez 2015] Unity3D Default</th>
          <th style="text-align:center">UE4 Name</th>
          <th style="text-align:center">UE4 Default</th>
        </tr>
      </thead>
      <tbody dir="auto">
        <tr dir="auto">
          <td style="text-align:center">strength</td>
          <td style="text-align:center">SSS Strength</td>
          <td style="text-align:center">(0.48, 0.41, 0.28)</td>
          <td style="text-align:center">Subsurface Color</td>
          <td style="text-align:center">(0.48, 0.41, 0.28)</td>
        </tr>
        <tr dir="auto">
          <td style="text-align:center">falloff</td>
          <td style="text-align:center">SSS Falloff</td>
          <td style="text-align:center">(1.0, 0.37, 0.3)</td>
          <td style="text-align:center">Falloff Color</td>
          <td style="text-align:center">(1.0, 0.37, 0.3)</td>
        </tr>
        <tr dir="auto">
          <td style="text-align:center">width</td>
          <td style="text-align:center">N/A</td>
          <td style="text-align:center">1</td>
          <td style="text-align:center">N/A</td>
          <td style="text-align:center">1</td>
        </tr>
        <tr dir="auto">
          <td style="text-align:center">N/A</td>
          <td style="text-align:center">SSS Width</td>
          <td style="text-align:center">0.012 (0.125 Meters Per Unit)</td>
          <td style="text-align:center">World Unit Scale</td>
          <td style="text-align:center">0.1 (Units Per Centimeter)</td>
        </tr>
      </tbody>
    </table>
    <p dir="auto">strength</p>
    <blockquote dir="auto">
      <p dir="auto">The <strong>strength</strong> is to lerp between the SSS diffuse term <eq><span class="katex"><span
              class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                  <mrow>
                    <mstyle scriptlevel="0" displaystyle="true">
                      <mi mathvariant="normal">R</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mfrac>
                        <mrow>
                          <mi mathvariant="normal">Δ</mi>
                          <mi>x</mi>
                          <mo>⋅</mo>
                          <mtext>width</mtext>
                        </mrow>
                        <mrow>
                          <mn>0.001</mn>
                          <mo>+</mo>
                          <mtext>falloff</mtext>
                        </mrow>
                      </mfrac>
                      <mo stretchy="false">)</mo>
                    </mstyle>
                  </mrow>
                  <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(\frac{\Delta x \cdot
                    \text{width}}{0.001 + \text{falloff}})</annotation>
                </semantics>
              </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                  style="height:2.14077em;vertical-align:-0.7693300000000001em;"></span><span class="mop"><span
                    class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord"><span
                    class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span
                              class="pstrut" style="height:3em;"></span><span class="mord"><span
                                class="mord">0.001</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mord text"><span class="mord">falloff</span></span></span></span><span
                            style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                              style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                              class="pstrut" style="height:3em;"></span><span class="mord"><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mord text"><span class="mord">width</span></span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                    class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></eq>
        and the conventional diffuse term <eq><span class="katex"><span class="katex-mathml"><math
                xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                  <mrow>
                    <mstyle scriptlevel="0" displaystyle="true">
                      <mi mathvariant="normal">δ</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi mathvariant="normal">Δ</mi>
                      <mi>x</mi>
                      <mo stretchy="false">)</mo>
                    </mstyle>
                  </mrow>
                  <annotation encoding="application/x-tex">\displaystyle \operatorname{\delta}(\Delta x)</annotation>
                </semantics>
              </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                  style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                    class="mord">δ</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                  class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq>. Evidently,
        when the <strong>strength</strong> equals 0, since <eq><span class="katex"><span class="katex-mathml"><math
                xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                  <mrow>
                    <mstyle scriptlevel="0" displaystyle="true">
                      <mi mathvariant="normal">S</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi mathvariant="normal">Δ</mi>
                      <mi>x</mi>
                      <mo stretchy="false">)</mo>
                      <mo>=</mo>
                      <mstyle scriptlevel="0" displaystyle="true">
                        <mi mathvariant="normal">δ</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi mathvariant="normal">Δ</mi>
                        <mi>x</mi>
                        <mo stretchy="false">)</mo>
                      </mstyle>
                    </mstyle>
                  </mrow>
                  <annotation encoding="application/x-tex">\displaystyle \operatorname{S}(\Delta x) = \displaystyle
                    \operatorname{\delta}(\Delta x)</annotation>
                </semantics>
              </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                  style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                    class="mord mathrm">S</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                  class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace"
                  style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                  style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                  style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                    class="mord">δ</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                  class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq> and <eq><span
            class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                  <mrow>
                    <mstyle scriptlevel="0" displaystyle="true">
                      <mi mathvariant="normal">δ</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mn>0</mn>
                      <mo stretchy="false">)</mo>
                      <mo>=</mo>
                      <mn>1</mn>
                    </mstyle>
                  </mrow>
                  <annotation encoding="application/x-tex">\displaystyle \operatorname{\delta}(0) = 1</annotation>
                </semantics>
              </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                  style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                    class="mord">δ</span></span><span class="mopen">(</span><span class="mord">0</span><span
                  class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                  class="mrel">=</span><span class="mspace"
                  style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                  style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>
        </eq>, the formula is reduced to the conventional diffuse term <eq><span class="katex"><span
              class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                  <mrow>
                    <mstyle scriptlevel="0" displaystyle="true">
                      <mi mathvariant="normal">M</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mi>x</mi>
                        <mi>o</mi>
                      </msub>
                      <mo separator="true">,</mo>
                      <msub>
                        <mi>y</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="false">)</mo>
                      <mo>=</mo>
                      <munder>
                        <mo>∑</mo>
                        <mi>y</mi>
                      </munder>
                      <mo stretchy="false">(</mo>
                      <munder>
                        <mo>∑</mo>
                        <mi>x</mi>
                      </munder>
                      <mi mathvariant="normal">E</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mi>x</mi>
                        <mi>o</mi>
                      </msub>
                      <mo>+</mo>
                      <mi mathvariant="normal">Δ</mi>
                      <mi>x</mi>
                      <mo separator="true">,</mo>
                      <msub>
                        <mi>y</mi>
                        <mi>o</mi>
                      </msub>
                      <mo>+</mo>
                      <mi mathvariant="normal">Δ</mi>
                      <mi>y</mi>
                      <mo stretchy="false">)</mo>
                      <mo>⋅</mo>
                      <mi mathvariant="normal">S</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi mathvariant="normal">Δ</mi>
                      <mi>x</mi>
                      <mo stretchy="false">)</mo>
                      <mo stretchy="false">)</mo>
                      <mo>⋅</mo>
                      <mi mathvariant="normal">
                        <msup>
                          <mi mathvariant="normal">S</mi>
                          <mi mathvariant="normal">T</mi>
                        </msup>
                      </mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi mathvariant="normal">Δ</mi>
                      <mi>y</mi>
                      <mo stretchy="false">)</mo>
                      <mo>=</mo>
                      <munder>
                        <mo>∑</mo>
                        <mi>y</mi>
                      </munder>
                      <mo stretchy="false">(</mo>
                      <munder>
                        <mo>∑</mo>
                        <mi>x</mi>
                      </munder>
                      <mi mathvariant="normal">E</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mi>x</mi>
                        <mi>o</mi>
                      </msub>
                      <mo>+</mo>
                      <mi mathvariant="normal">Δ</mi>
                      <mi>x</mi>
                      <mo separator="true">,</mo>
                      <msub>
                        <mi>y</mi>
                        <mi>o</mi>
                      </msub>
                      <mo>+</mo>
                      <mi mathvariant="normal">Δ</mi>
                      <mi>y</mi>
                      <mo stretchy="false">)</mo>
                      <mo>⋅</mo>
                      <mi mathvariant="normal">δ</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi mathvariant="normal">Δ</mi>
                      <mi>x</mi>
                      <mo stretchy="false">)</mo>
                      <mo stretchy="false">)</mo>
                      <mo>⋅</mo>
                      <mi mathvariant="normal">δ</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi mathvariant="normal">Δ</mi>
                      <mi>y</mi>
                      <mo stretchy="false">)</mo>
                      <mo>=</mo>
                      <mi mathvariant="normal">E</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <msub>
                        <mi>x</mi>
                        <mi>o</mi>
                      </msub>
                      <mo separator="true">,</mo>
                      <msub>
                        <mi>y</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="false">)</mo>
                    </mstyle>
                  </mrow>
                  <annotation encoding="application/x-tex">\displaystyle \operatorname{M}(x_o, y_o) = \sum_y (\sum_x
                    \operatorname{E}(x_o + \Delta x, y_o + \Delta y) \cdot \operatorname{S}(\Delta x)) \cdot
                    \operatorname{S^T}(\Delta y) = \sum_y (\sum_x \operatorname{E}(x_o + \Delta x, y_o + \Delta y) \cdot
                    \operatorname{\delta}(\Delta x)) \cdot \operatorname{\delta}(\Delta y) = \operatorname{E}(x_o, y_o)
                  </annotation>
                </semantics>
              </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                  style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                    class="mord mathrm">M</span></span><span class="mopen">(</span><span class="mord"><span
                    class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                  class="mrel">=</span><span class="mspace"
                  style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                  style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span
                  class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.0500050000000003em;"><span
                          style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                            style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span><span
                          style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span
                              class="mop op-symbol large-op">∑</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:1.386113em;"><span></span></span></span></span></span><span
                  class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.050005em;"><span
                          style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                            style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight">x</span></span></span><span
                          style="top:-3.0500049999999996em;"><span class="pstrut"
                            style="height:3.05em;"></span><span><span
                              class="mop op-symbol large-op">∑</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:1.250005em;"><span></span></span></span></span></span><span class="mspace"
                  style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                    class="mord mathrm">E</span></span><span class="mopen">(</span><span class="mord"><span
                    class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"
                  style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
                  style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">Δ</span><span
                  class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace"
                  style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                    style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"
                  style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
                  style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                  style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Δ</span><span
                  class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span
                  class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                  class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                  class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                    class="mord mathrm">S</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                  class="mord mathnormal">x</span><span class="mclose">))</span><span class="mspace"
                  style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace"
                  style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                  style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mop"><span
                    class="mord"><span class="mord mathrm">S</span><span class="msupsub"><span class="vlist-t"><span
                          class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span
                              style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                  class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span
                  class="mopen">(</span><span class="mord">Δ</span><span class="mord mathnormal"
                  style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace"
                  style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                  style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                  style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span
                  class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.0500050000000003em;"><span
                          style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                            style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span><span
                          style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span
                              class="mop op-symbol large-op">∑</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:1.386113em;"><span></span></span></span></span></span><span
                  class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.050005em;"><span
                          style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                            style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight">x</span></span></span><span
                          style="top:-3.0500049999999996em;"><span class="pstrut"
                            style="height:3.05em;"></span><span><span
                              class="mop op-symbol large-op">∑</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:1.250005em;"><span></span></span></span></span></span><span class="mspace"
                  style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                    class="mord mathrm">E</span></span><span class="mopen">(</span><span class="mord"><span
                    class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"
                  style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
                  style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord">Δ</span><span
                  class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace"
                  style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                    style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"
                  style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
                  style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                  style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Δ</span><span
                  class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span
                  class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                  class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                  class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                    class="mord">δ</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                  class="mord mathnormal">x</span><span class="mclose">))</span><span class="mspace"
                  style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace"
                  style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                  style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                    class="mord">δ</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                  class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span
                  class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                  class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                  class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                    class="mord mathrm">E</span></span><span class="mopen">(</span><span class="mord"><span
                    class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                  class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mclose">)</span></span></span></span></eq>.</p>
      <p dir="auto">However, the <a
          href="https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L445">SSSS_STRENGTH_SOURCE</a> has
        nothing to do with the <strong>strength</strong> in the formula by [Jimenez 2012] at all. The <a
          href="https://github.com/iryoku/separable-sss/blob/master/SeparableSSS.h#L445">SSSS_STRENGTH_SOURCE</a> is
        merely the alpha channel of the albedo texture, and is used to skip the pixels which do NOT represent the skin
        (such as eyebrow). this empirical value is adopted by both UE4 and Unity3D. The equivalent is called <a
          href="https://docs.unrealengine.com/4.26/en-US/RenderingAndGraphics/Materials/LightingModels/SubSurfaceProfile/#materialinputchannels">Opacity
          Map</a> in UE4 and <a
          href="https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@10.8/manual/Material-Type.html">Subsurface
          Mask Map</a> in Unity3D.</p>
    </blockquote>
    <p dir="auto">width</p>
    <blockquote dir="auto">
      <p dir="auto">The <eq><span class="katex"><span class="katex-mathml"><math
                xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                  <mrow>
                    <mstyle scriptlevel="0" displaystyle="true">
                      <mfrac>
                        <mrow>
                          <mi mathvariant="normal">Δ</mi>
                          <mi>x</mi>
                        </mrow>
                        <mrow>
                          <mn>0.001</mn>
                          <mo>+</mo>
                          <mtext>falloff</mtext>
                        </mrow>
                      </mfrac>
                    </mstyle>
                  </mrow>
                  <annotation encoding="application/x-tex">\displaystyle \frac{\Delta x}{0.001 + \text{falloff}}
                  </annotation>
                </semantics>
              </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                  style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span
                  class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span
                            style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span
                              class="mord"><span class="mord">0.001</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mord text"><span class="mord">falloff</span></span></span></span><span
                            style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                              style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                              class="pstrut" style="height:3em;"></span><span class="mord"><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                    class="mclose nulldelimiter"></span></span></span></span></span></eq> is passed to the diffusion
        profile <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                <semantics>
                  <mrow>
                    <mstyle scriptlevel="0" displaystyle="true">
                      <mi mathvariant="normal">R</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi>r</mi>
                      <mo stretchy="false">)</mo>
                    </mstyle>
                  </mrow>
                  <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(r)</annotation>
                </semantics>
              </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                  style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                    class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord mathnormal"
                  style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span></eq>
        directly in the <a
          href="https://github.com/iryoku/separable-sss/blob/master/Demo/Code/SeparableSSS.cpp#L205">calculateKernel</a>
        without the <strong>width</strong> in the formula by [Jimenez 2012] multiplied at all. This implies the
        <strong>width</strong> in the formula by [Jimenez 2012] is actually fixed at 1.
      </p>
    </blockquote>
  </blockquote>
  <h3 dir="auto" id="4-3-disney-sss">4-3. Disney SSS</h3>
  <p dir="auto">The <strong>Disney SSS</strong> by [Golubev 2018] is used by the <a
      href="https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@10.8/manual/Material-Type.html">Subsurface
      Scattering Material Type</a> of Unity3D and the <a
      href="https://docs.unrealengine.com/4.27/en-US/RenderingAndGraphics/Materials/MaterialProperties/LightingModels/">Subsurface
      Profile Shading Model</a> with <a
      href="https://docs.unrealengine.com/4.27/en-US/RenderingAndGraphics/Materials/LightingModels/SubSurfaceProfile/">Enable
      Burley</a> of UE4.</p>
  <p dir="auto">The main idea of the Disney SSS is to use the Monte Carlo method to integrate <eq><span
        class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">L</mi>
                      <mi mathvariant="normal">o</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <msub>
                    <mo>∫</mo>
                    <msup>
                      <mi mathvariant="double-struck">R</mi>
                      <mn>2</mn>
                    </msup>
                  </msub>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                \overrightarrow{\omega_o}) = \int_{{\mathbb{R}}^2} \operatorname{R}(\| \overrightarrow{p_i} -
                \overrightarrow{p_o} \|) \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) \, d
                \overrightarrow{p_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.38952999999999993em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight"><span class="mord mtight"><span
                                  class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                  class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord">∥</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span
                          class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                              class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq> in
    real time.</p>
  <p dir="auto">By [Christensen 2015], the diffusion profile <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>r</mi>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mi>A</mi>
                      <mi>S</mi>
                    </mrow>
                    <mrow>
                      <mn>8</mn>
                      <mi>π</mi>
                      <mi>r</mi>
                    </mrow>
                  </mfrac>
                  <mo stretchy="false">(</mo>
                  <msup>
                    <mi>e</mi>
                    <mrow>
                      <mo>−</mo>
                      <mi>S</mi>
                      <mi>r</mi>
                    </mrow>
                  </msup>
                  <mo>+</mo>
                  <msup>
                    <mi>e</mi>
                    <mrow>
                      <mo>−</mo>
                      <mfrac>
                        <mn>1</mn>
                        <mn>3</mn>
                      </mfrac>
                      <mi>S</mi>
                      <mi>r</mi>
                    </mrow>
                  </msup>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(r) = \frac{A S}{8 \pi r}(e^{-S
                r}+e^{-\frac{1}{3} S r})</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">π</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span><span
                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">A</span><span class="mord mathnormal"
                            style="margin-right:0.05764em;">S</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span
                class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.891331em;"><span style="top:-3.113em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight">−</span><span class="mord mathnormal mtight"
                              style="margin-right:0.05764em;">S</span><span class="mord mathnormal mtight"
                              style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.2540200000000001em;vertical-align:-0.25em;"></span><span class="mord"><span
                class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:1.0040200000000001em;"><span
                        style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut"
                          style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span
                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span
                                              class="mord mtight">3</span></span></span></span><span
                                        style="top:-3.2255000000000003em;"><span class="pstrut"
                                          style="height:3em;"></span><span class="frac-line mtight"
                                          style="border-bottom-width:0.049em;"></span></span><span
                                        style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span
                                              class="mord mtight">1</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.344em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span
                              class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span
                              class="mord mathnormal mtight"
                              style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span><span
              class="mclose">)</span></span></span></span></eq>, where the A is the surface albedo and the S is the
    scaling factor, is used. The derivation of the diffusion profile will NOT be involved here, but you can refer to
    &quot;15.5 Subsurface Scattering Using the Diffusion Equation&quot; of <a
      href="https://pbr-book.org/3ed-2018/Light_Transport_II_Volume_Rendering/Subsurface_Scattering_Using_the_Diffusion_Equation">PBR
      Book V3</a> for more information.</p>
  <h4 dir="auto" id="4-3-1-monte-carlo-integration">4-3-1. Monte Carlo Integration</h4>
  <p dir="auto">PDF</p>
  <blockquote dir="auto">
    <p dir="auto">By [Christensen 2015], we have the norm of the diffusion profile <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <msubsup>
                      <mo>∫</mo>
                      <mi>o</mi>
                      <mi mathvariant="normal">∞</mi>
                    </msubsup>
                    <mi mathvariant="normal">R</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mn>2</mn>
                    <mi>π</mi>
                    <mi>r</mi>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>=</mo>
                    <mi>A</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \int_o^\infin \operatorname{R}(r) 2 \pi r \, dr =
                  A</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:2.3262420000000006em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.4142920000000005em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mathnormal mtight">o</span></span></span><span
                          style="top:-3.812900000000001em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">∞</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mord">2</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
                class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:0.68333em;vertical-align:0em;"></span><span
                class="mord mathnormal">A</span></span></span></span></eq>. This means that the surface albedo A is
      exactly the total diffuse reflectance and we have the normalized diffusion profile <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mfrac>
                      <mrow>
                        <mi mathvariant="normal">R</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>r</mi>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mi>A</mi>
                    </mfrac>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{R_N}(r) =
                  \frac{\operatorname{R}(r)}{A}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span
                          style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">A</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                              class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                              class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span></span></span></span></eq>. And by [Golubev 2018], the
      normalized function <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">p</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo separator="true">,</mo>
                    <mi>θ</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mfrac>
                      <mrow>
                        <mi mathvariant="normal">R</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>r</mi>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mi>A</mi>
                    </mfrac>
                    <mi>r</mi>
                    <mo>=</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <mo>=</mo>
                    <mfrac>
                      <mi>s</mi>
                      <mrow>
                        <mn>8</mn>
                        <mi>π</mi>
                      </mrow>
                    </mfrac>
                    <mo stretchy="false">(</mo>
                    <msup>
                      <mi>e</mi>
                      <mrow>
                        <mo>−</mo>
                        <mi>s</mi>
                        <mi>r</mi>
                      </mrow>
                    </msup>
                    <mo>+</mo>
                    <msup>
                      <mi>e</mi>
                      <mrow>
                        <mo>−</mo>
                        <mfrac>
                          <mrow>
                            <mi>s</mi>
                            <mi>r</mi>
                          </mrow>
                          <mn>3</mn>
                        </mfrac>
                      </mrow>
                    </msup>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{p}(r, \theta) =
                  \frac{\operatorname{R}(r)}{A} r = \operatorname{R_N}(r) r = \frac{s}{8 \pi}(e^{-sr}+e^{-\frac{sr}{3}})
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">A</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                              class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                              class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                class="strut" style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span
                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span
                          style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">8</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">s</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span
                  class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.821331em;"><span
                          style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight"
                                style="margin-right:0.02778em;">sr</span></span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.1470799999999999em;vertical-align:-0.25em;"></span><span
                class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.89708em;"><span
                          style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut"
                            style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span
                                  class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.6915428571428572em;"><span style="top:-2.656em;"><span
                                            class="pstrut" style="height:3em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span
                                                class="mord mtight">3</span></span></span></span><span
                                          style="top:-3.2255000000000003em;"><span class="pstrut"
                                            style="height:3em;"></span><span class="frac-line mtight"
                                            style="border-bottom-width:0.049em;"></span></span><span
                                          style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span
                                                class="mord mathnormal mtight"
                                                style="margin-right:0.02778em;">sr</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.344em;"><span></span></span></span></span></span><span
                                  class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span
                class="mclose">)</span></span></span></span></eq> is used as the PDF.</p>
  </blockquote>
  <p dir="auto">Estimator</p>
  <blockquote dir="auto">
    <p dir="auto">By appealing <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">p</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo separator="true">,</mo>
                    <mi>θ</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{p}(r, \theta) =
                  \operatorname{R_N}(r) r</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span></span></span></span></eq> to <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">L</mi>
                        <mi mathvariant="normal">o</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">d</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                  \overrightarrow{\omega_o}) = \int_{{\mathbb{R}}^2} \operatorname{R_N}(\| \overrightarrow{p_i} -
                  \overrightarrow{p_o} \|) \operatorname{R_d}(\overrightarrow{p_i})
                  \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) \, d \overrightarrow{p_i}
                </annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">d</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>, we
      have <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">L</mi>
                        <mi mathvariant="normal">o</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msub>
                      <mo>∫</mo>
                      <msup>
                        <mi mathvariant="double-struck">R</mi>
                        <mn>2</mn>
                      </msup>
                    </msub>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi mathvariant="normal">∥</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>−</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mi mathvariant="normal">∥</mi>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">d</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo>=</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mi mathvariant="normal">∞</mi>
                    </msubsup>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mrow>
                        <mn>2</mn>
                        <mi>π</mi>
                      </mrow>
                    </msubsup>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">d</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>p</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>θ</mi>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>=</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mi mathvariant="normal">∞</mi>
                    </msubsup>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mrow>
                        <mn>2</mn>
                        <mi>π</mi>
                      </mrow>
                    </msubsup>
                    <mfrac>
                      <mrow>
                        <mi mathvariant="normal">p</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>r</mi>
                        <mo separator="true">,</mo>
                        <mi>θ</mi>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mi>r</mi>
                    </mfrac>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">d</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>p</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>θ</mi>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>=</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mi mathvariant="normal">∞</mi>
                    </msubsup>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mrow>
                        <mn>2</mn>
                        <mi>π</mi>
                      </mrow>
                    </msubsup>
                    <mi mathvariant="normal">p</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo separator="true">,</mo>
                    <mi>θ</mi>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">d</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>p</mi>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>θ</mi>
                    <mi>d</mi>
                    <mi>r</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                  \overrightarrow{\omega_o}) = \int_{{\mathbb{R}}^2} \operatorname{R_N}(\| \overrightarrow{p_i} -
                  \overrightarrow{p_o} \|) \operatorname{R_d}(\overrightarrow{p_i})
                  \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) \, d \overrightarrow{p_i} =
                  \int_0^\infin \int_0^{2\pi} \operatorname{R_N}(r) \operatorname{R_d}(\overrightarrow{p_i})
                  \operatorname{F}(p) r \, d \theta dr = \int_0^\infin \int_0^{2\pi} \frac{\operatorname{p}(r,
                  \theta)}{r} \operatorname{R_d}(\overrightarrow{p_i}) \operatorname{F}(p) r \, d \theta dr =
                  \int_0^\infin \int_0^{2\pi} \operatorname{p}(r, \theta) \operatorname{R_d}(\overrightarrow{p_i})
                  \operatorname{F}(p) \, d \theta dr</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:-0.38952999999999993em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                class="mord mtight"><span class="mord mtight"><span
                                    class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.7463142857142857em;"><span
                                          style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                            style="height:2.5em;"></span><span
                                            class="sizing reset-size3 size1 mtight"><span
                                              class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord">∥</span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mord">∥</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">d</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                class="strut" style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
                class="mop"><span class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.414292em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">∞</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.5640080000000003em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight"
                                style="margin-right:0.03588em;">π</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mop"><span class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                      class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                          style="height:0.33610799999999996em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">d</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                class="mord mathnormal">p</span><span class="mclose">)</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.414292em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">∞</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.5640080000000003em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight"
                                style="margin-right:0.03588em;">π</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span
                                class="mord mathrm">p</span></span><span class="mopen">(</span><span
                              class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                              class="mpunct">,</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">θ</span><span
                              class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">d</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                class="mord mathnormal">p</span><span class="mclose">)</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.414292em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">∞</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.5640080000000003em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight"
                                style="margin-right:0.03588em;">π</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">d</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span></span></span></span></eq>.</p>
    <p dir="auto">By &quot;Equation (13.3)&quot; of <a
        href="https://pbr-book.org/3ed-2018/Monte_Carlo_Integration/The_Monte_Carlo_Estimator">PBR Book</a>, we have
      <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">L</mi>
                        <mi mathvariant="normal">o</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo separator="true">,</mo>
                    <mover accent="true">
                      <msub>
                        <mi>ω</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mi mathvariant="normal">∞</mi>
                    </msubsup>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mrow>
                        <mn>2</mn>
                        <mi>π</mi>
                      </mrow>
                    </msubsup>
                    <mi mathvariant="normal">p</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo separator="true">,</mo>
                    <mi>θ</mi>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">d</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                    <mo stretchy="false">)</mo>
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>p</mi>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>θ</mi>
                    <mi>d</mi>
                    <mi>r</mi>
                    <mo>=</mo>
                    <mo>∑</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mi>N</mi>
                    </mfrac>
                    <mfrac>
                      <mrow>
                        <mi mathvariant="normal">p</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>r</mi>
                        <mo separator="true">,</mo>
                        <mi>θ</mi>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">
                          <msub>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">d</mi>
                          </msub>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mover accent="true">
                          <msub>
                            <mi>p</mi>
                            <mi>i</mi>
                          </msub>
                          <mo stretchy="true">→</mo>
                        </mover>
                        <mo stretchy="false">)</mo>
                        <mi mathvariant="normal">F</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>p</mi>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mrow>
                        <mi mathvariant="normal">
                          <msup>
                            <mi mathvariant="normal">p</mi>
                            <mi mathvariant="normal">i</mi>
                          </msup>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>r</mi>
                        <mo separator="true">,</mo>
                        <mi>θ</mi>
                        <mo stretchy="false">)</mo>
                      </mrow>
                    </mfrac>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                  \overrightarrow{\omega_o}) = \int_0^\infin \int_0^{2\pi} \operatorname{p}(r, \theta)
                  \operatorname{R_d}(\overrightarrow{p_i}) \operatorname{F}(p) \, d \theta dr = \sum \frac{1}{N}
                  \frac{\operatorname{p}(r, \theta) \operatorname{R_d}(\overrightarrow{p_i})
                  \operatorname{F}(p)}{\operatorname{p^i}(r, \theta)}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">o</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                              class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
              class="base"><span class="strut"
                style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.414292em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">∞</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.5640080000000003em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight"
                                style="margin-right:0.03588em;">π</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">d</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                        style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                class="mord mathnormal">d</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.56556em;vertical-align:-0.936em;"></span><span class="mop op-symbol large-op"
                style="position:relative;top:-0.000004999999999977245em;">∑</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.6295600000000001em;"><span
                          style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mop"><span class="mord"><span class="mord mathrm">p</span><span
                                  class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.756502em;"><span
                                          style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut"
                                            style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">i</span></span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span><span
                          style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span
                                class="mord mathrm">p</span></span><span class="mopen">(</span><span
                              class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                              class="mpunct">,</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.33610799999999996em;"><span
                                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">d</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                  class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                      style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                        class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                      class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                        style="height:3em;"></span><span class="hide-tail"
                                        style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                        </svg></span></span></span><span class="vlist-s">​</span></span><span
                                  class="vlist-r"><span class="vlist"
                                    style="height:0.19444em;"><span></span></span></span></span></span><span
                              class="mclose">)</span><span class="mspace"
                              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">F</span></span><span class="mopen">(</span><span
                              class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.936em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span></span></span></span></eq>.
    </p>
    <p dir="auto">Technically, <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{R_N}(r)</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span></span></span></span></eq> is spectrally varying since the scaling factor s is
      spectrally varying. This means that the <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">p</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo separator="true">,</mo>
                    <mi>θ</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mi mathvariant="normal">
                      <msub>
                        <mi mathvariant="normal">R</mi>
                        <mi mathvariant="normal">N</mi>
                      </msub>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mi>r</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{p}(r, \theta) =
                  \operatorname{R_N}(r) r</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">N</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mclose">)</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span></span></span></span></eq> is a vector &quot;RGB&quot;. However,
      the PDF, which is used to calculate the sampling of the diffusion profile, should be a scalar &quot;float&quot;.
      Thus, the spectral channel i is selected as the PDF and we have <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msup>
                        <mi mathvariant="normal">p</mi>
                        <mi mathvariant="normal">i</mi>
                      </msup>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo separator="true">,</mo>
                    <mi>θ</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mfrac>
                      <mrow>
                        <mi mathvariant="normal">
                          <msup>
                            <mi mathvariant="normal">R</mi>
                            <mi mathvariant="normal">i</mi>
                          </msup>
                        </mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>r</mi>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mi>A</mi>
                    </mfrac>
                    <mi>r</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{p^i}(r, \theta) =
                  \frac{\operatorname{R^i}(r)}{A} r</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.130502em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                          class="vlist" style="height:0.8805019999999999em;"><span
                            style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">i</span></span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                class="strut" style="height:2.193502em;vertical-align:-0.686em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.5075020000000001em;"><span
                          style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">A</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.830502em;"><span style="top:-3.063em;margin-right:0.05em;"><span
                                            class="pstrut" style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span
                                              class="mord mathrm mtight">i</span></span></span></span></span></span></span></span></span><span
                              class="mopen">(</span><span class="mord mathnormal"
                              style="margin-right:0.02778em;">r</span><span
                              class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span></span></span></span></eq>. This means that the <eq><span
          class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">p</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo separator="true">,</mo>
                    <mi>θ</mi>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{p}(r, \theta)</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span></eq> in the
      numerator is a vector &quot;RGB&quot; while the <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">
                      <msup>
                        <mi mathvariant="normal">p</mi>
                        <mi mathvariant="normal">i</mi>
                      </msup>
                    </mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo separator="true">,</mo>
                    <mi>θ</mi>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{p^i}(r, \theta)</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.130502em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                    class="mord mathrm">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                          class="vlist" style="height:0.8805019999999999em;"><span
                            style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                              style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                class="mord mathrm mtight">i</span></span></span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                class="mclose">)</span></span></span></span></eq> in the denominator is a scalar &quot;float&quot;.
      Analogously to the &quot;Equation 15.11&quot; of <a
        href="https://pbr-book.org/3ed-2018/Light_Transport_II_Volume_Rendering/Sampling_Volume_Scattering#eq:homogeneous-medium-pmed">PBR
        Book</a>, the average over all spectral channels can be used as the PDF. However, in real time rendering, the
      spectral channel corresponding to the minimum PDF is usually used for efficiency.</p>
  </blockquote>
  <p dir="auto">Sampling 2D Diffusion Profile</p>
  <blockquote dir="auto">
    <p dir="auto">Analogously to &quot;Equation (14.1)&quot; of <a
        href="https://pbr-book.org/3ed-2018/Light_Transport_I_Surface_Reflection/Sampling_Reflection_Functions#MicrofacetBxDFs">PBR
        Book</a>, we can derive the sampling of diffusion profile. Since the diffusion profile is isotropic (radially
      symmetric), we have <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mstyle scriptlevel="0" displaystyle="true">
                      <mi mathvariant="normal">p</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mi>θ</mi>
                      <mi mathvariant="normal">∣</mi>
                      <mi>r</mi>
                      <mo stretchy="false">)</mo>
                      <mo>=</mo>
                      <mfrac>
                        <mn>1</mn>
                        <mrow>
                          <mn>2</mn>
                          <mi>π</mi>
                        </mrow>
                      </mfrac>
                      <mo>⇒</mo>
                      <mi>θ</mi>
                      <mo>=</mo>
                      <mn>2</mn>
                      <mi>π</mi>
                      <msub>
                        <mi>ξ</mi>
                        <mn>2</mn>
                      </msub>
                    </mstyle>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \displaystyle \operatorname{p}(\theta | r) =
                  \frac{1}{2 \pi} \Rightarrow \theta = 2 \pi \xi_2</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mord">∣</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">2</span><span class="mord mathnormal"
                              style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">⇒</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord"><span
                  class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.30110799999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">2</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
      </eq>. Since the PDF is <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">p</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo separator="true">,</mo>
                    <mi>θ</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mfrac>
                      <mrow>
                        <mi mathvariant="normal">R</mi>
                        <mo>⁡</mo>
                        <mo stretchy="false">(</mo>
                        <mi>r</mi>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mi>A</mi>
                    </mfrac>
                    <mi>r</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{p}(r, \theta) =
                  \frac{\operatorname{R}(r)}{A} r</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">A</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                              class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                              class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span></span></span></span></eq>, we have the marginal PDF <eq><span
          class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">p</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mrow>
                        <mn>2</mn>
                        <mi>π</mi>
                      </mrow>
                    </msubsup>
                    <mi mathvariant="normal">R</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <mi>θ</mi>
                    <mo>=</mo>
                    <mi mathvariant="normal">R</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mn>2</mn>
                    <mi>π</mi>
                    <mi>r</mi>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{p}(r) = \int_0^{2 \pi}
                  \operatorname{R}(r) \, d \theta = \operatorname{R}(r) 2 \pi r</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.5640080000000003em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight"
                                style="margin-right:0.03588em;">π</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mord">2</span><span
                class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span></span></span></span></eq> and the CDF <eq><span
          class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">P</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>r</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <msubsup>
                      <mo>∫</mo>
                      <mn>0</mn>
                      <mi>r</mi>
                    </msubsup>
                    <mi mathvariant="normal">p</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <msup>
                      <mi>r</mi>
                      <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                    </msup>
                    <mo stretchy="false">)</mo>
                    <mtext> </mtext>
                    <mi>d</mi>
                    <msup>
                      <mi>r</mi>
                      <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                    </msup>
                    <mo>=</mo>
                    <msub>
                      <mi>ξ</mi>
                      <mn>1</mn>
                    </msub>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{P}(r) = \int_0^{r}
                  \operatorname{p}(r&#x27;) \, d r&#x27; = \xi_1</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">P</span></span><span class="mopen">(</span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                  class="mop op-symbol large-op"
                  style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.414292em;"><span
                          style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">0</span></span></span><span
                          style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span class="mord mathnormal mtight"
                                style="margin-right:0.02778em;">r</span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                  class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord"><span
                  class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span
                    class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span
                          style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span
                                class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
                class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                  style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span
                      class="vlist-r"><span class="vlist" style="height:0.801892em;"><span
                          style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight"><span
                                class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span
                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.30110799999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">1</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
      </eq>. Fortunately, by [Golubev 2018], the inverse of the CDF is closed-form and we have <eq><span
          class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi>r</mi>
                    <mo>=</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mi>s</mi>
                    </mfrac>
                    <mo>⋅</mo>
                    <mn>3</mn>
                    <mo>⋅</mo>
                    <msub>
                      <mrow>
                        <mi>log</mi>
                        <mo>⁡</mo>
                      </mrow>
                      <mn>2</mn>
                    </msub>
                    <mo stretchy="false">(</mo>
                    <mfrac>
                      <mrow>
                        <mn>1</mn>
                        <mo>+</mo>
                        <msup>
                          <mrow>
                            <mi mathvariant="normal">G</mi>
                            <mo>⁡</mo>
                            <mo stretchy="false">(</mo>
                            <mi>u</mi>
                            <mo stretchy="false">)</mo>
                          </mrow>
                          <mrow>
                            <mo>−</mo>
                            <mfrac>
                              <mn>1</mn>
                              <mn>3</mn>
                            </mfrac>
                          </mrow>
                        </msup>
                        <mo>+</mo>
                        <msup>
                          <mrow>
                            <mi mathvariant="normal">G</mi>
                            <mo>⁡</mo>
                            <mo stretchy="false">(</mo>
                            <mi>u</mi>
                            <mo stretchy="false">)</mo>
                          </mrow>
                          <mfrac>
                            <mn>1</mn>
                            <mn>3</mn>
                          </mfrac>
                        </msup>
                      </mrow>
                      <mrow>
                        <mn>4</mn>
                        <mi>u</mi>
                      </mrow>
                    </mfrac>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle r = \frac{1}{s} \cdot 3 \cdot \log_2(\frac{1 +
                  {\operatorname{G}(u)}^{-\frac{1}{3}} + {\operatorname{G}(u)}^{\frac{1}{3}}}{4 u})</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                style="margin-right:0.02778em;">r</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                  class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord mathnormal">s</span></span></span><span style="top:-3.23em;"><span
                            class="pstrut" style="height:3em;"></span><span class="frac-line"
                            style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                            class="pstrut" style="height:3em;"></span><span class="mord"><span
                              class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                      class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:2.45692em;vertical-align:-0.686em;"></span><span class="mop"><span class="mop">lo<span
                    style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.20696799999999996em;"><span
                          style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">2</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.24414em;"><span></span></span></span></span></span></span><span
                class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                  class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:1.77092em;"><span style="top:-2.40792em;"><span class="pstrut"
                            style="height:3.09392em;"></span><span class="mord"><span class="mord">4</span><span
                              class="mord mathnormal">u</span></span></span><span
                          style="top:-3.3239199999999998em;"><span class="pstrut" style="height:3.09392em;"></span><span
                            class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                          style="top:-3.77092em;"><span class="pstrut" style="height:3.09392em;"></span><span
                            class="mord"><span class="mord">1</span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                                class="mord"><span class="mop"><span class="mord mathrm">G</span></span><span
                                  class="mopen">(</span><span class="mord mathnormal">u</span><span
                                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                                    class="vlist-r"><span class="vlist" style="height:1.09392em;"><span
                                        style="top:-3.5029000000000003em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                            class="mord mtight"><span class="mord mtight">−</span><span
                                              class="mord mtight"><span
                                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                      class="vlist" style="height:0.8443142857142858em;"><span
                                                        style="top:-2.656em;"><span class="pstrut"
                                                          style="height:3em;"></span><span
                                                          class="sizing reset-size3 size1 mtight"><span
                                                            class="mord mtight"><span
                                                              class="mord mtight">3</span></span></span></span><span
                                                        style="top:-3.2255000000000003em;"><span class="pstrut"
                                                          style="height:3em;"></span><span class="frac-line mtight"
                                                          style="border-bottom-width:0.049em;"></span></span><span
                                                        style="top:-3.384em;"><span class="pstrut"
                                                          style="height:3em;"></span><span
                                                          class="sizing reset-size3 size1 mtight"><span
                                                            class="mord mtight"><span
                                                              class="mord mtight">1</span></span></span></span></span><span
                                                      class="vlist-s">​</span></span><span class="vlist-r"><span
                                                      class="vlist"
                                                      style="height:0.344em;"><span></span></span></span></span></span><span
                                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span
                              class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                              class="mbin">+</span><span class="mspace"
                              style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                                class="mord"><span class="mop"><span class="mord mathrm">G</span></span><span
                                  class="mopen">(</span><span class="mord mathnormal">u</span><span
                                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                                    class="vlist-r"><span class="vlist" style="height:1.09392em;"><span
                                        style="top:-3.5029000000000003em;margin-right:0.05em;"><span class="pstrut"
                                          style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                            class="mord mtight"><span class="mord mtight"><span
                                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                      class="vlist" style="height:0.8443142857142858em;"><span
                                                        style="top:-2.656em;"><span class="pstrut"
                                                          style="height:3em;"></span><span
                                                          class="sizing reset-size3 size1 mtight"><span
                                                            class="mord mtight"><span
                                                              class="mord mtight">3</span></span></span></span><span
                                                        style="top:-3.2255000000000003em;"><span class="pstrut"
                                                          style="height:3em;"></span><span class="frac-line mtight"
                                                          style="border-bottom-width:0.049em;"></span></span><span
                                                        style="top:-3.384em;"><span class="pstrut"
                                                          style="height:3em;"></span><span
                                                          class="sizing reset-size3 size1 mtight"><span
                                                            class="mord mtight"><span
                                                              class="mord mtight">1</span></span></span></span></span><span
                                                      class="vlist-s">​</span></span><span class="vlist-r"><span
                                                      class="vlist"
                                                      style="height:0.344em;"><span></span></span></span></span></span><span
                                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.686em;"><span></span></span></span></span></span><span
                  class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></eq>
      where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">G</mi>
                    <mo>⁡</mo>
                    <mo stretchy="false">(</mo>
                    <mi>u</mi>
                    <mo stretchy="false">)</mo>
                    <mo>=</mo>
                    <mn>1</mn>
                    <mo>+</mo>
                    <mn>4</mn>
                    <mi>u</mi>
                    <mo stretchy="false">(</mo>
                    <mn>2</mn>
                    <mi>u</mi>
                    <mo>+</mo>
                    <msqrt>
                      <mrow>
                        <mn>1</mn>
                        <mo>+</mo>
                        <mn>4</mn>
                        <msup>
                          <mi>u</mi>
                          <mn>2</mn>
                        </msup>
                      </mrow>
                    </msqrt>
                    <mo stretchy="false">)</mo>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \operatorname{G}(u) = 1 + 4u(2u + \sqrt{1 +
                  4u^2})</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                  class="mord mathrm">G</span></span><span class="mopen">(</span><span
                class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span
                class="mord mathnormal">u</span><span class="mopen">(</span><span class="mord">2</span><span
                class="mord mathnormal">u</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace"
                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
                style="height:1.3122639999999999em;vertical-align:-0.25em;"></span><span class="mord sqrt"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.0622639999999999em;"><span class="svg-align" style="top:-3.2em;"><span
                          class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span
                            class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mord">4</span><span class="mord"><span class="mord mathnormal">u</span><span
                              class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                    style="height:0.740108em;"><span
                                      style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut"
                                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                          class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                        style="top:-3.0222640000000003em;"><span class="pstrut" style="height:3.2em;"></span><span
                          class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width='400em' height='1.28em'
                            viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'>
                            <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist" style="height:0.177736em;"><span></span></span></span></span></span><span
                class="mclose">)</span></span></span></span></eq> and <eq><span class="katex"><span
            class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi>u</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                    <mo>−</mo>
                    <msub>
                      <mi>ξ</mi>
                      <mn>1</mn>
                    </msub>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle u = 1 - \xi_1</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
              class="base"><span class="strut"
                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span
                  class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.30110799999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">1</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
      </eq>.</p>
    <p dir="auto">The sampling of diffusion profile is calculated by <a
        href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/SubsurfaceBurleyNormalized.ush#L347">RadiusRootFindAnalytic</a>
      in UE4 and <a
        href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/SubsurfaceScattering/SubsurfaceScattering.compute#L182">SampleBurleyDiffusionProfile</a>
      in Unity3D.</p>
  </blockquote>
  <p dir="auto">Pseudo-Random Sequence</p>
  <blockquote dir="auto">
    <p dir="auto">The <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <msub>
                      <mi>ξ</mi>
                      <mn>1</mn>
                    </msub>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \xi_1</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span
                  class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.30110799999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">1</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
      </eq> is generated by pseudo-random sequence in UE4 and by evenly spaced sequence in Unity3D.</p>
    <p dir="auto">The <strong>pseudo-random sequence</strong> is calculated by <a
        href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/SubsurfaceBurleyNormalized.ush#L935">Generate2DRandomNumber</a>
      in UE4 and the <strong>evenly spaced sequence</strong> is calculated by <a
        href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/SubsurfaceScattering/SubsurfaceScattering.compute#L182">i
        * scale + offset</a> in Unity3D.</p>
    <p dir="auto">And the <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <msub>
                      <mi>ξ</mi>
                      <mn>2</mn>
                    </msub>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \xi_2</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span
                  class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.30110799999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">2</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
      </eq> is generated by <strong>Fibonacci sequence</strong>, which is related to the <a
        href="https://en.wikipedia.org/wiki/Golden_ratio#Relationship_to_Fibonacci_sequence">Golden Ratio</a>, in both
      UE4 and Unity3D.</p>
    <p dir="auto">The <strong>Fibonacci sequence</strong> is calculated by <a
        href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/SubsurfaceBurleyNormalized.ush#L332">FIBONACCI_SEQUENCE_ANGLE</a>
      in UE4 and <a
        href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.core/ShaderLibrary/Sampling/Fibonacci.hlsl#L248">Fibonacci2d</a>
      in Unity3D.</p>
  </blockquote>
  <p dir="auto">Low-Discrepancy Sequence</p>
  <blockquote dir="auto">
    <p dir="auto">By &quot;20.3 Quasirandom Low-Discrepancy Sequences&quot; of [Colbert 2007] and &quot;13.8.2 Quasi
      Monte Carlo&quot; of <a
        href="https://pbr-book.org/3ed-2018/Monte_Carlo_Integration/Careful_Sample_Placement#QuasiMonteCarlo">PBR
        Book</a>, the <strong>low-discrepancy sequence</strong> is the better alternative than <strong>pseudo-random
        sequence</strong> to generate the <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <msub>
                      <mi>ξ</mi>
                      <mn>1</mn>
                    </msub>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \xi_1</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span
                  class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.30110799999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">1</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
      </eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <msub>
                      <mi>ξ</mi>
                      <mn>2</mn>
                    </msub>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \xi_2</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span
                  class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span
                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                        style="height:0.30110799999999993em;"><span
                          style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                            class="pstrut" style="height:2.7em;"></span><span
                            class="sizing reset-size6 size3 mtight"><span
                              class="mord mtight">2</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
      </eq>.</p>
    <p dir="auto">For example, the <strong>Hammersley sequence</strong> (&quot;7.4.1 Hammersley and Halton
      Sequences&quot; of <a
        href="https://pbr-book.org/3ed-2018/Sampling_and_Reconstruction/The_Halton_Sampler#HammersleyandHaltonSequences">PBR
        Book</a>) is a typical <strong>low-discrepancy sequence</strong>.</p>
    <p dir="auto">The <strong>Hammersley sequence</strong> is calculated by <a
        href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/MonteCarlo.ush#L34">Hammersley</a>
      in UE4 and <a
        href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.core/ShaderLibrary/Sampling/Hammersley.hlsl#L415">Hammersley2d</a>
      in Unity3D.</p>
  </blockquote>
  <p dir="auto">Stratified Sampling</p>
  <blockquote dir="auto">
    <p dir="auto">In UE4, the <strong>Center Sample Reweighting</strong>, which is controlled by the macro
      <strong>REWEIGHT_CENTER_SAMPLE</strong>, is used, and the <strong>CDF</strong> of the center sample is calculated
      and removed from the vicinal samples. And UE4 claims that the result of this approach is still unbiased.
    </p>
  </blockquote>
  <p dir="auto">Sampling 3D Surface</p>
  <blockquote dir="auto">
    <p dir="auto">By &quot;Figure 15.8&quot; of <a
        href="https://pbr-book.org/3ed-2018/Light_Transport_II_Volume_Rendering/Sampling_Subsurface_Reflection_Functions#fig:separable-bssrdf-sampling">PBR
        Book</a>, the sampling of the 2D diffusion profile should be mapped to the position on the 3D surface. And by
      &quot;Figure 15.12&quot; of <a
        href="https://pbr-book.org/3ed-2018/Light_Transport_II_Volume_Rendering/Sampling_Subsurface_Reflection_Functions#fig:separable-bssrdf-sampling-pdf">PBR
        Book</a>, the radii under three projection axes, which are the three basis vectors of the tangent space at the
      center position <eq><span class="katex"><span class="katex-mathml"><math
              xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mover accent="true">
                      <msub>
                        <mi>p</mi>
                        <mi>o</mi>
                      </msub>
                      <mo stretchy="true">→</mo>
                    </mover>
                  </mstyle>
                </mrow>
                <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_o}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                          style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                  style="height:0.151392em;"><span
                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                      class="pstrut" style="height:2.7em;"></span><span
                                      class="sizing reset-size6 size3 mtight"><span
                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                  class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                  style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                        class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                          class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em'
                            height='0.522em' viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>, are
      calculated. Evidently, it is too inefficient to be used in real time rendering.</p>
    <p dir="auto">Analogously to the the &quot;Bilateral Filter&quot; by [Mikkelsen 2010], the radius is approximated as
      <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
              <semantics>
                <mrow>
                  <msqrt>
                    <mrow>
                      <msup>
                        <mrow>
                          <mi mathvariant="normal">∥</mi>
                          <msub>
                            <mover accent="true">
                              <msub>
                                <mi>p</mi>
                                <mi>i</mi>
                              </msub>
                              <mo stretchy="true">→</mo>
                            </mover>
                            <mrow>
                              <mi>x</mi>
                              <mi>y</mi>
                            </mrow>
                          </msub>
                          <mo>−</mo>
                          <msub>
                            <mover accent="true">
                              <msub>
                                <mi>p</mi>
                                <mi>o</mi>
                              </msub>
                              <mo stretchy="true">→</mo>
                            </mover>
                            <mrow>
                              <mi>x</mi>
                              <mi>y</mi>
                            </mrow>
                          </msub>
                          <mi mathvariant="normal">∥</mi>
                        </mrow>
                        <mn>2</mn>
                      </msup>
                      <mo>+</mo>
                      <msup>
                        <msub>
                          <mrow>
                            <mi mathvariant="normal">Δ</mi>
                            <mi>x</mi>
                          </mrow>
                          <mi>z</mi>
                        </msub>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </msqrt>
                </mrow>
                <annotation encoding="application/x-tex">\sqrt{{\|{\overrightarrow{p_i}}_{xy} -
                  {\overrightarrow{p_o}}_{xy}\|}^2 + {{\Delta x}_z}^2}</annotation>
              </semantics>
            </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                style="height:1.84em;vertical-align:-0.4668399999999999em;"></span><span class="mord sqrt"><span
                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.3731600000000002em;"><span class="svg-align" style="top:-3.8em;"><span
                          class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span
                            class="mord"><span class="mord"><span class="mord">∥</span><span class="mord"><span
                                  class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                              class="mord"><span class="mord mathnormal">p</span><span
                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                    class="vlist-r"><span class="vlist"
                                                      style="height:0.31166399999999994em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                          class="pstrut" style="height:2.7em;"></span><span
                                                          class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                      class="vlist-s">​</span></span><span class="vlist-r"><span
                                                      class="vlist"
                                                      style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                              style="height:3em;"></span><span class="hide-tail"
                                              style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                height='0.522em' viewBox='0 0 400000 522'
                                                preserveAspectRatio='xMaxYMin slice'>
                                                <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                              </svg></span></span></span><span class="vlist-s">​</span></span><span
                                        class="vlist-r"><span class="vlist"
                                          style="height:0.19444em;"><span></span></span></span></span></span></span><span
                                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:0.057252000000000025em;"><span
                                          style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut"
                                            style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                class="mord mathnormal mtight">x</span><span
                                                class="mord mathnormal mtight"
                                                style="margin-right:0.03588em;">y</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.380248em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">−</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                                  class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                              class="mord"><span class="mord mathnormal">p</span><span
                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                          class="pstrut" style="height:2.7em;"></span><span
                                                          class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                      class="vlist-s">​</span></span><span class="vlist-r"><span
                                                      class="vlist"
                                                      style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                              style="height:3em;"></span><span class="hide-tail"
                                              style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                height='0.522em' viewBox='0 0 400000 522'
                                                preserveAspectRatio='xMaxYMin slice'>
                                                <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                              </svg></span></span></span><span class="vlist-s">​</span></span><span
                                        class="vlist-r"><span class="vlist"
                                          style="height:0.19444em;"><span></span></span></span></span></span></span><span
                                  class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:0.057252000000000025em;"><span
                                          style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut"
                                            style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                class="mord mathnormal mtight">x</span><span
                                                class="mord mathnormal mtight"
                                                style="margin-right:0.03588em;">y</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.380248em;"><span></span></span></span></span></span></span><span
                                class="mord">∥</span></span><span class="msupsub"><span class="vlist-t"><span
                                  class="vlist-r"><span class="vlist" style="height:1.156568em;"><span
                                      style="top:-3.40546em;margin-right:0.05em;"><span class="pstrut"
                                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                          class="mord mtight">2</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                              class="mord"><span class="mord"><span class="mord"><span class="mord">Δ</span><span
                                    class="mord mathnormal">x</span></span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.151392em;"><span
                                          style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut"
                                            style="height:2.7em;"></span><span
                                            class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight"
                                              style="margin-right:0.04398em;">z</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                              class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                    style="height:0.887338em;"><span
                                      style="top:-3.1362300000000003em;margin-right:0.05em;"><span class="pstrut"
                                        style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                          class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                        style="top:-3.33316em;"><span class="pstrut" style="height:3.8em;"></span><span
                          class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em'
                            height='1.8800000000000001em' viewBox='0 0 400000 1944'
                            preserveAspectRatio='xMinYMin slice'>
                            <path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z' />
                          </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                      class="vlist"
                      style="height:0.4668399999999999em;"><span></span></span></span></span></span></span></span></span>
      </eq> by [Golubev 2018]. The <strong>Bilateral Filter</strong> is controlled by the macro
      <strong>SSS_BILATERAL_FILTER</strong> in Unity3D and the macro <strong>USE_BILATERAL_FILTERING</strong> in UE4.
    </p>
    <p dir="auto">The <strong>Stretch Texture</strong> by &quot;Correcting for UV Distortion&quot; of [dEon 2007] can be
      used to calculate the radius as well. However, it is too inefficient to be used in real time rendering.</p>
  </blockquote>
  <h4 dir="auto" id="4-3-2-properties-between-unity3d-and-ue4">4-3-2. Properties between Unity3D and UE4</h4>
  <table dir="auto">
    <thead dir="auto">
      <tr dir="auto">
        <th style="text-align:center">Formula Name</th>
        <th style="text-align:center"><a
            href="https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@10.8/manual/Diffusion-Profile.html">Unity3D
            Name</a></th>
        <th style="text-align:center"><a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/RenderPipelineResources/Skin%20Diffusion%20Profile.asset#L17">Unity3D
            Default</a></th>
        <th style="text-align:center"><a
            href="https://docs.unrealengine.com/4.27/en-US/RenderingAndGraphics/Materials/LightingModels/SubSurfaceProfile/">UE4
            Name</a></th>
        <th style="text-align:center"><a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Source/Runtime/Engine/Classes/Engine/SubsurfaceProfile.h#L113">UE4
            Default</a></th>
      </tr>
    </thead>
    <tbody dir="auto">
      <tr dir="auto">
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">World Scale</td>
        <td style="text-align:center">1 (Meters Per Unit)</td>
        <td style="text-align:center">World Unit Scale</td>
        <td style="text-align:center">0.1 (Units Per Centimeter)</td>
      </tr>
      <tr dir="auto">
        <td style="text-align:center">Total Diffuse Reflectance A</td>
        <td style="text-align:center">Texturing Mode</td>
        <td style="text-align:center">Pre- and Post-Scatter</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">Post-Scatter</td>
      </tr>
      <tr dir="auto">
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">Surface Albedo</td>
        <td style="text-align:center">(0.91058, 0.338275, 0.2718)</td>
      </tr>
      <tr dir="auto">
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">Mean Free Path Color</td>
        <td style="text-align:center">(1.0, 0.1983/2.229, (0.1607/2.229)</td>
      </tr>
      <tr dir="auto">
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">Mean Free Path Distance</td>
        <td style="text-align:center">(1.2*2.229, 1.2*2.229, 1.2*2.229)</td>
      </tr>
      <tr dir="auto">
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">Scattering Distance</td>
        <td style="text-align:center">(0.7568628, 0.32156864, 0.20000002)</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">N/A</td>
      </tr>
      <tr dir="auto">
        <td style="text-align:center">Scaling Factor S</td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">
          <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                  <semantics>
                    <mrow>
                      <mstyle scriptlevel="0" displaystyle="true">
                        <mfrac>
                          <mn>1</mn>
                          <mrow>
                            <mi mathvariant="normal">S</mi>
                            <mi mathvariant="normal">c</mi>
                            <mi mathvariant="normal">a</mi>
                            <mi mathvariant="normal">t</mi>
                            <mi mathvariant="normal">t</mi>
                            <mi mathvariant="normal">e</mi>
                            <mi mathvariant="normal">r</mi>
                            <mi mathvariant="normal">i</mi>
                            <mi mathvariant="normal">n</mi>
                            <mi mathvariant="normal">g</mi>
                            <mi mathvariant="normal">D</mi>
                            <mi mathvariant="normal">i</mi>
                            <mi mathvariant="normal">s</mi>
                            <mi mathvariant="normal">t</mi>
                            <mi mathvariant="normal">a</mi>
                            <mi mathvariant="normal">n</mi>
                            <mi mathvariant="normal">c</mi>
                            <mi mathvariant="normal">e</mi>
                          </mrow>
                        </mfrac>
                      </mstyle>
                    </mrow>
                    <annotation encoding="application/x-tex">\displaystyle \frac{1}{\mathrm{ScatteringDistance}}
                    </annotation>
                  </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                    style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span class="mord"><span
                      class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                          class="vlist-r"><span class="vlist" style="height:1.32144em;"><span
                              style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span
                                class="mord"><span class="mord"><span
                                    class="mord mathrm">ScatteringDistance</span></span></span></span><span
                              style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                              style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span
                                class="mord"><span class="mord">1</span></span></span></span><span
                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                            style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                      class="mclose nulldelimiter"></span></span></span></span></span></eq>
        </td>
        <td style="text-align:center">N/A</td>
        <td style="text-align:center">
          <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                  <semantics>
                    <mrow>
                      <mstyle scriptlevel="0" displaystyle="true">
                        <mfrac>
                          <mrow>
                            <mi mathvariant="normal">GetScalingFactor</mi>
                            <mo>⁡</mo>
                            <mo stretchy="false">(</mo>
                            <mrow>
                              <mi mathvariant="normal">S</mi>
                              <mi mathvariant="normal">u</mi>
                              <mi mathvariant="normal">r</mi>
                              <mi mathvariant="normal">f</mi>
                              <mi mathvariant="normal">a</mi>
                              <mi mathvariant="normal">c</mi>
                              <mi mathvariant="normal">e</mi>
                              <mi mathvariant="normal">A</mi>
                              <mi mathvariant="normal">l</mi>
                              <mi mathvariant="normal">b</mi>
                              <mi mathvariant="normal">e</mi>
                              <mi mathvariant="normal">d</mi>
                              <mi mathvariant="normal">o</mi>
                            </mrow>
                            <mo stretchy="false">)</mo>
                          </mrow>
                          <mrow>
                            <mrow>
                              <mi mathvariant="normal">M</mi>
                              <mi mathvariant="normal">e</mi>
                              <mi mathvariant="normal">a</mi>
                              <mi mathvariant="normal">n</mi>
                              <mi mathvariant="normal">F</mi>
                              <mi mathvariant="normal">r</mi>
                              <mi mathvariant="normal">e</mi>
                              <mi mathvariant="normal">e</mi>
                              <mi mathvariant="normal">P</mi>
                              <mi mathvariant="normal">a</mi>
                              <mi mathvariant="normal">t</mi>
                              <mi mathvariant="normal">h</mi>
                              <mi mathvariant="normal">C</mi>
                              <mi mathvariant="normal">o</mi>
                              <mi mathvariant="normal">l</mi>
                              <mi mathvariant="normal">o</mi>
                              <mi mathvariant="normal">r</mi>
                            </mrow>
                            <mo>⋅</mo>
                            <mrow>
                              <mi mathvariant="normal">M</mi>
                              <mi mathvariant="normal">e</mi>
                              <mi mathvariant="normal">a</mi>
                              <mi mathvariant="normal">n</mi>
                              <mi mathvariant="normal">F</mi>
                              <mi mathvariant="normal">r</mi>
                              <mi mathvariant="normal">e</mi>
                              <mi mathvariant="normal">e</mi>
                              <mi mathvariant="normal">P</mi>
                              <mi mathvariant="normal">a</mi>
                              <mi mathvariant="normal">t</mi>
                              <mi mathvariant="normal">h</mi>
                              <mi mathvariant="normal">D</mi>
                              <mi mathvariant="normal">i</mi>
                              <mi mathvariant="normal">s</mi>
                              <mi mathvariant="normal">t</mi>
                              <mi mathvariant="normal">a</mi>
                              <mi mathvariant="normal">n</mi>
                              <mi mathvariant="normal">c</mi>
                              <mi mathvariant="normal">e</mi>
                            </mrow>
                          </mrow>
                        </mfrac>
                      </mstyle>
                    </mrow>
                    <annotation encoding="application/x-tex">\displaystyle
                      \frac{\operatorname{GetScalingFactor}(\mathrm{SurfaceAlbedo})}{\mathrm{MeanFreePathColor} \cdot
                      \mathrm{MeanFreePathDistance}}</annotation>
                  </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                    style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span
                      class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                          class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span
                                class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span
                                    class="mord mathrm">MeanFreePathColor</span></span><span class="mspace"
                                  style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                                  class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                  class="mord"><span
                                    class="mord mathrm">MeanFreePathDistance</span></span></span></span><span
                              style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span
                                class="frac-line" style="border-bottom-width:0.04em;"></span></span><span
                              style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span
                                class="mord"><span class="mop"><span
                                    class="mord mathrm">GetScalingFactor</span></span><span class="mopen">(</span><span
                                  class="mord"><span class="mord mathrm">SurfaceAlbedo</span></span><span
                                  class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                          class="vlist-r"><span class="vlist"
                            style="height:0.686em;"><span></span></span></span></span></span><span
                      class="mclose nulldelimiter"></span></span></span></span></span></eq>
        </td>
      </tr>
    </tbody>
  </table>
  <p dir="auto">By &quot;11.1.3 Out-Scattering and Attenuation&quot; of <a
      href="https://pbr-book.org/3ed-2018/Volume_Scattering/Volume_Scattering_Processes#Out-ScatteringandAttenuation">PBR
      Book</a>, we have the <strong>mean free path</strong>
    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mfrac>
                    <mn>1</mn>
                    <msub>
                      <mi>σ</mi>
                      <mi>τ</mi>
                    </msub>
                  </mfrac>
                  <mo>=</mo>
                  <mfrac>
                    <mn>1</mn>
                    <mrow>
                      <msub>
                        <mi>σ</mi>
                        <mi>a</mi>
                      </msub>
                      <mo>+</mo>
                      <msub>
                        <mi>σ</mi>
                        <mi>s</mi>
                      </msub>
                    </mrow>
                  </mfrac>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \frac{1}{\sigma_{\tau}} = \frac{1}{\sigma_a +
                \sigma_s}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:2.1574400000000002em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.32144em;"><span
                        style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span
                          class="mord"><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.03588em;">σ</span><span class="msupsub"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.151392em;"><span
                                      style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                        class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                            class="mord mathnormal mtight"
                                            style="margin-right:0.1132em;">τ</span></span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                    style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.8360000000000001em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.1574400000000002em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.32144em;"><span
                        style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span
                          class="mord"><span class="mord"><span class="mord mathnormal"
                              style="margin-right:0.03588em;">σ</span><span class="msupsub"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.151392em;"><span
                                      style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                        class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span
                                          class="mord mathnormal mtight">a</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                              class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span
                              class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                    style="height:0.151392em;"><span
                                      style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                        class="pstrut" style="height:2.7em;"></span><span
                                        class="sizing reset-size6 size3 mtight"><span
                                          class="mord mathnormal mtight">s</span></span></span></span><span
                                    class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                    style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.8360000000000001em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span></span></span></span></eq> where <eq><span
        class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <msub>
                    <mi>σ</mi>
                    <mi>τ</mi>
                  </msub>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \sigma_{\tau}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mathnormal mtight"
                              style="margin-right:0.1132em;">τ</span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
    is the extinction coefficient, <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <msub>
                    <mi>σ</mi>
                    <mi>a</mi>
                  </msub>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \sigma_a</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">a</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
    is the absorption coefficient and <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <msub>
                    <mi>σ</mi>
                    <mi>s</mi>
                  </msub>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \sigma_s</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">s</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>
    is the scattering coefficient.
  </p>
  <p dir="auto">Note that, in UE4, the scaling factor s is calculated by <eq><span class="katex"><span
          class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi>S</mi>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mi mathvariant="normal">GetScalingFactor</mi>
                      <mo>⁡</mo>
                      <mo stretchy="false">(</mo>
                      <mrow>
                        <mi mathvariant="normal">S</mi>
                        <mi mathvariant="normal">u</mi>
                        <mi mathvariant="normal">r</mi>
                        <mi mathvariant="normal">f</mi>
                        <mi mathvariant="normal">a</mi>
                        <mi mathvariant="normal">c</mi>
                        <mi mathvariant="normal">e</mi>
                        <mi mathvariant="normal">A</mi>
                        <mi mathvariant="normal">l</mi>
                        <mi mathvariant="normal">b</mi>
                        <mi mathvariant="normal">e</mi>
                        <mi mathvariant="normal">d</mi>
                        <mi mathvariant="normal">o</mi>
                      </mrow>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mrow>
                      <mrow>
                        <mi mathvariant="normal">M</mi>
                        <mi mathvariant="normal">e</mi>
                        <mi mathvariant="normal">a</mi>
                        <mi mathvariant="normal">n</mi>
                        <mi mathvariant="normal">F</mi>
                        <mi mathvariant="normal">r</mi>
                        <mi mathvariant="normal">e</mi>
                        <mi mathvariant="normal">e</mi>
                        <mi mathvariant="normal">P</mi>
                        <mi mathvariant="normal">a</mi>
                        <mi mathvariant="normal">t</mi>
                        <mi mathvariant="normal">h</mi>
                        <mi mathvariant="normal">C</mi>
                        <mi mathvariant="normal">o</mi>
                        <mi mathvariant="normal">l</mi>
                        <mi mathvariant="normal">o</mi>
                        <mi mathvariant="normal">r</mi>
                      </mrow>
                      <mo>⋅</mo>
                      <mrow>
                        <mi mathvariant="normal">M</mi>
                        <mi mathvariant="normal">e</mi>
                        <mi mathvariant="normal">a</mi>
                        <mi mathvariant="normal">n</mi>
                        <mi mathvariant="normal">F</mi>
                        <mi mathvariant="normal">r</mi>
                        <mi mathvariant="normal">e</mi>
                        <mi mathvariant="normal">e</mi>
                        <mi mathvariant="normal">P</mi>
                        <mi mathvariant="normal">a</mi>
                        <mi mathvariant="normal">t</mi>
                        <mi mathvariant="normal">h</mi>
                        <mi mathvariant="normal">D</mi>
                        <mi mathvariant="normal">i</mi>
                        <mi mathvariant="normal">s</mi>
                        <mi mathvariant="normal">t</mi>
                        <mi mathvariant="normal">a</mi>
                        <mi mathvariant="normal">n</mi>
                        <mi mathvariant="normal">c</mi>
                        <mi mathvariant="normal">e</mi>
                      </mrow>
                    </mrow>
                  </mfrac>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle S =
                \frac{\operatorname{GetScalingFactor}(\mathrm{SurfaceAlbedo})}{\mathrm{MeanFreePathColor} \cdot
                \mathrm{MeanFreePathDistance}}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal"
              style="margin-right:0.05764em;">S</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span
                              class="mord mathrm">MeanFreePathColor</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                              class="mord mathrm">MeanFreePathDistance</span></span></span></span><span
                        style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span
                              class="mord mathrm">GetScalingFactor</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathrm">SurfaceAlbedo</span></span><span
                            class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span></span></span></span></eq> where the <eq><span
        class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">GetScalingFactor</mi>
                  <mo>⁡</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{GetScalingFactor}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mop"><span
                class="mord mathrm">GetScalingFactor</span></span></span></span></span></eq> follows the Equation 5, 6,
    7 of [Christensen 2015]. But, by [Christensen 2015], the result of the <eq><span class="katex"><span
          class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">GetScalingFactor</mi>
                  <mo>⁡</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{GetScalingFactor}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mop"><span
                class="mord mathrm">GetScalingFactor</span></span></span></span></span></eq> is exactly the scaling
    factor. Thus, the denominator is <strong>NOT</strong> reasonable.</p>
  <h2 dir="auto" id="5-transmittance">5. Transmittance</h2>
  <p dir="auto">The blur pass is only to accumulate the vicinal position <eq><span class="katex"><span
          class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq> which
    is on the same face as the center position <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_o}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>. And
    the transmittance is to accumulate the vicinal position <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_i}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq> which
    is on the different face from the center position <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_o}</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist"
                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></eq>.</p>
  <h3 dir="auto" id="5-1-thickness-map">5-1. Thickness Map</h3>
  <p dir="auto">By &quot;16.3 Simulating Absorption Using Depth Maps&quot; of [Green 2004], if the objects are assumed
    to be convex, the thickness (the distance a light ray travels inside an object) can be estimated by using the shadow
    maps.</p>
  <p dir="auto">The thickness is calculated by <a
      href="https://github.com/NVIDIAGameWorks/FaceWorks/blob/master/include/GFSDK_FaceWorks.hlsli#L518">GFSDK_FaceWorks_EstimateThicknessFromParallelShadowPoisson32</a>
    in NVIDIA FaceWorks.</p>
  <p dir="auto">However, it is NOT efficient to calculate the thickness in real time rendering. Actually, the baked
    thickness is provided by the <a
      href="https://substance3d.adobe.com/documentation/bake/thickness-map-from-mesh-172818642.html">Substance</a>.</p>
  <p dir="auto">The backed thickness is used by the <a
      href="https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@10.8/manual/Diffusion-Profile.html">Thin
      Object Transmission Mode</a> in Unity3D.</p>
  <p dir="auto">The thickness is calculated by the <a
      href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/SubsurfaceScattering/SubsurfaceScattering.hlsl#L201">FillMaterialTransmission</a>,
    the <a
      href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Lighting/SurfaceShading.hlsl#L10">ShouldEvaluateThickObjectTransmission</a>
    and the <a
      href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Lighting/SurfaceShading.hlsl#L120">EvaluateTransmittance_Punctual</a>
    in Unity3D.</p>
  <h3 dir="auto" id="5-2-transmittance-coefficient">5-2. Transmittance Coefficient</h3>
  <p dir="auto">By [Green 2004], by the <a href="https://en.wikipedia.org/wiki/Beer%E2%80%93Lambert_law">Beer–Lambert
      law</a>, the transmittance coefficient can be calculated according to the thickness.</p>
  <p dir="auto">The transmittance coefficient by [Green 2004] is calculated by <a
      href="https://github.com/NVIDIAGameWorks/FaceWorks/blob/master/include/GFSDK_FaceWorks.hlsli#L559">GFSDK_FaceWorks_EvaluateDeepScatterDirectLight</a>
    in NVIDIA FaceWorks.</p>
  <p dir="auto">However, the transmittance coefficient by the Beer–Lambert law is too inaccurate to be used.</p>
  <p dir="auto"><img src="Subsurface-Scattering-2.png" alt="Transmittance Coefficient"
      data-src="Subsurface-Scattering-2.png"></p>
  <p dir="auto">By [Jimenez 2010], the transmittance coefficient can be calculated based on the diffusion profile rather
    than the Beer–Lambert law. The idea of the &quot;14.5.3 Modified Translucent Shadow Maps&quot; of [dEon 2007] is
    applied. By assuming that the form factors <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{F}(\overrightarrow{p_i},
                \overrightarrow{\omega_o})</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span></span></span></span></eq> are the same, by &quot;13.5.2 Polar Coordinates&quot; of
    <a href="https://pbr-book.org/3ed-2018/Monte_Carlo_Integration/Transforming_between_Distributions#PolarCoordinates">PBR
      Book</a>, the transmittance coefficient can be calculated as <eq><span class="katex"><span
          class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">
                    <msub>
                      <mi mathvariant="normal">L</mi>
                      <mi mathvariant="normal">o</mi>
                    </msub>
                  </mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <msub>
                    <mo>∫</mo>
                    <msup>
                      <mi mathvariant="double-struck">R</mi>
                      <mn>2</mn>
                    </msup>
                  </msub>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo separator="true">,</mo>
                  <mover accent="true">
                    <msub>
                      <mi>ω</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo stretchy="false">)</mo>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>=</mo>
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <msub>
                    <mo>∫</mo>
                    <msup>
                      <mi mathvariant="double-struck">R</mi>
                      <mn>2</mn>
                    </msup>
                  </msub>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi mathvariant="normal">∥</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>−</mo>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>o</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mi mathvariant="normal">∥</mi>
                  <mo stretchy="false">)</mo>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mover accent="true">
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <mo stretchy="true">→</mo>
                  </mover>
                  <mo>=</mo>
                  <mi mathvariant="normal">F</mi>
                  <mo>⁡</mo>
                  <msubsup>
                    <mo>∫</mo>
                    <mi>o</mi>
                    <mi mathvariant="normal">∞</mi>
                  </msubsup>
                  <mn>2</mn>
                  <mi>π</mi>
                  <mi>r</mi>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <msqrt>
                    <mrow>
                      <msup>
                        <mi>r</mi>
                        <mn>2</mn>
                      </msup>
                      <mo>+</mo>
                      <msup>
                        <mi>d</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </msqrt>
                  <mo stretchy="false">)</mo>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mi>r</mi>
                  <mo>⇒</mo>
                  <mi mathvariant="normal">T</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>d</mi>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <msubsup>
                    <mo>∫</mo>
                    <mi>o</mi>
                    <mi mathvariant="normal">∞</mi>
                  </msubsup>
                  <mn>2</mn>
                  <mi>π</mi>
                  <mi>r</mi>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <msqrt>
                    <mrow>
                      <msup>
                        <mi>r</mi>
                        <mn>2</mn>
                      </msup>
                      <mo>+</mo>
                      <msup>
                        <mi>d</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </msqrt>
                  <mo stretchy="false">)</mo>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mi>r</mi>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(\overrightarrow{p_o},
                \overrightarrow{\omega_o})= \int_{{\mathbb{R}}^2} \operatorname{R}(\| \overrightarrow{p_i} -
                \overrightarrow{p_o} \|) \operatorname{F}(\overrightarrow{p_i}, \overrightarrow{\omega_o}) \, d
                \overrightarrow{p_i} = \operatorname{F} \int_{{\mathbb{R}}^2} \operatorname{R}(\| \overrightarrow{p_i} -
                \overrightarrow{p_o} \|) \, d \overrightarrow{p_i} = \operatorname{F} \int_o^\infin 2 \pi r
                \operatorname{R} (\sqrt{r^2 + d^2}) \, dr \Rightarrow \operatorname{T}(d) = \int_o^\infin 2 \pi r
                \operatorname{R} (\sqrt{r^2 + d^2}) \, dr</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                  class="mord mathrm">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                      class="vlist-r"><span class="vlist" style="height:0.151392em;"><span
                          style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut"
                            style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                              class="mord mathrm mtight">o</span></span></span></span><span
                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
              class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                    class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span
              class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
            class="base"><span class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.38952999999999993em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight"><span class="mord mtight"><span
                                  class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                  class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord">∥</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                          style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.15em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                  class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                        class="pstrut" style="height:3em;"></span><span class="mord"><span
                          class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                              class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
              class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mord mathrm">F</span></span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:-0.38952999999999993em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                              class="mord mtight"><span class="mord mtight"><span
                                  class="mord mathbb mtight">R</span></span><span class="msupsub"><span
                                  class="vlist-t"><span class="vlist-r"><span class="vlist"
                                      style="height:0.7463142857142857em;"><span
                                        style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut"
                                          style="height:2.5em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span
                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord">∥</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.151392em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">o</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mord">∥</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span
              class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:0.9525600000000001em;"><span style="top:-3em;"><span class="pstrut"
                        style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span
                          class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                style="height:0.31166399999999994em;"><span
                                  style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                    class="pstrut" style="height:2.7em;"></span><span
                                    class="sizing reset-size6 size3 mtight"><span
                                      class="mord mathnormal mtight">i</span></span></span></span><span
                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                      class="svg-align" style="top:-3.43056em;"><span class="pstrut" style="height:3em;"></span><span
                        class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width='400em' height='0.522em'
                          viewBox='0 0 400000 522' preserveAspectRatio='xMaxYMin slice'>
                          <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
              class="strut" style="height:2.3262420000000006em;vertical-align:-0.9119499999999999em;"></span><span
              class="mop"><span class="mord mathrm">F</span></span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.4142920000000005em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">o</span></span></span><span
                        style="top:-3.812900000000001em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span
              class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord sqrt"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:1.0622639999999999em;"><span class="svg-align" style="top:-3.2em;"><span
                        class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span
                          class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                  style="height:0.740108em;"><span
                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut"
                                      style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                          class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                          class="mbin">+</span><span class="mspace"
                          style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                            class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span
                                class="vlist-r"><span class="vlist" style="height:0.740108em;"><span
                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut"
                                      style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                      style="top:-3.0222640000000003em;"><span class="pstrut" style="height:3.2em;"></span><span
                        class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width='400em' height='1.28em'
                          viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'>
                          <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.177736em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">⇒</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">T</span></span><span class="mopen">(</span><span
              class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.3262420000000006em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.4142920000000005em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">o</span></span></span><span
                        style="top:-3.812900000000001em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span
              class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span><span class="mspace"
              style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord sqrt"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:1.0622639999999999em;"><span class="svg-align" style="top:-3.2em;"><span
                        class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span
                          class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                  style="height:0.740108em;"><span
                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut"
                                      style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                          class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                          class="mbin">+</span><span class="mspace"
                          style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                            class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span
                                class="vlist-r"><span class="vlist" style="height:0.740108em;"><span
                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut"
                                      style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                      style="top:-3.0222640000000003em;"><span class="pstrut" style="height:3.2em;"></span><span
                        class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width='400em' height='1.28em'
                          viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'>
                          <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.177736em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span></span></span></span></eq> where d is the thickness, r is the
    distance on the different face of the surface and <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <msqrt>
                    <mrow>
                      <msup>
                        <mi>r</mi>
                        <mn>2</mn>
                      </msup>
                      <mo>+</mo>
                      <msup>
                        <mi>d</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </msqrt>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{R} (\sqrt{r^2 + d^2})</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.3122639999999999em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord sqrt"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:1.0622639999999999em;"><span class="svg-align" style="top:-3.2em;"><span
                        class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span
                          class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                  style="height:0.740108em;"><span
                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut"
                                      style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                          class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                          class="mbin">+</span><span class="mspace"
                          style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                            class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span
                                class="vlist-r"><span class="vlist" style="height:0.740108em;"><span
                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut"
                                      style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                      style="top:-3.0222640000000003em;"><span class="pstrut" style="height:3.2em;"></span><span
                        class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width='400em' height='1.28em'
                          viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'>
                          <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.177736em;"><span></span></span></span></span></span><span
              class="mclose">)</span></span></span></span></eq> is the diffusion profile.
  </p>
  <p dir="auto">Usually, the form factor is approximated by the Lambert BRDF and the light is assumed to be the
    directional light. The <a
      href="https://www.pbr-book.org/3ed-2018/Light_Transport_I_Surface_Reflection/Sampling_Light_Sources#LightswithSingularities">Delta
      Distribution</a> is applied and we have <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo>=</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mi>π</mi>
                    </mfrac>
                    <msub>
                      <mi>E</mi>
                      <mi>L</mi>
                    </msub>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                  </mstyle>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \displaystyle \operatorname{F} = \frac{1}{\pi} E_L
                {(\cos \theta_i)}^+</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.68333em;vertical-align:0em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                          class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">L</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span
                class="mord"><span class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                  style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                    style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>
    </eq>. Evidently, the <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>cos</mi>
                      <mo>⁡</mo>
                      <msub>
                        <mi>θ</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>+</mo>
                  </msup>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle {(\cos \theta_i)}^+</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.161231em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span
                  class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                  style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                    style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>
    </eq> varies at each position. However, since the form factors are assumed to be the same, the maximum value of <eq>
      <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <msup>
                    <mrow>
                      <mo stretchy="false">(</mo>
                      <mi>cos</mi>
                      <mo>⁡</mo>
                      <msub>
                        <mi>θ</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy="false">)</mo>
                    </mrow>
                    <mo>+</mo>
                  </msup>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle {(\cos \theta_i)}^+</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1.161231em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span
                  class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                  style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                    style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>
    </eq> is used. This means that we have <eq><span class="katex"><span class="katex-mathml"><math
            xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mstyle scriptlevel="0" displaystyle="true">
                    <mi mathvariant="normal">F</mi>
                    <mo>⁡</mo>
                    <mo>=</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mi>π</mi>
                    </mfrac>
                    <msub>
                      <mi>E</mi>
                      <mi>L</mi>
                    </msub>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mi>cos</mi>
                        <mo>⁡</mo>
                        <msub>
                          <mi>θ</mi>
                          <mi>i</mi>
                        </msub>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mo>≈</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mi>π</mi>
                    </mfrac>
                    <msub>
                      <mi>E</mi>
                      <mi>L</mi>
                    </msub>
                    <msup>
                      <mrow>
                        <mo stretchy="false">(</mo>
                        <mn>1</mn>
                        <mo stretchy="false">)</mo>
                      </mrow>
                      <mo>+</mo>
                    </msup>
                    <mo>=</mo>
                    <mfrac>
                      <mn>1</mn>
                      <mi>π</mi>
                    </mfrac>
                    <msub>
                      <mi>E</mi>
                      <mi>L</mi>
                    </msub>
                  </mstyle>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \displaystyle \operatorname{F} = \frac{1}{\pi} E_L
                {(\cos \theta_i)}^+ \approx \frac{1}{\pi} E_L {(1)}^+ = \frac{1}{\pi} E_L</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:0.68333em;vertical-align:0em;"></span><span class="mop"><span
                class="mord mathrm">F</span></span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                          class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">L</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span
                class="mord"><span class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                  style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal"
                    style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                        class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                              class="pstrut" style="height:2.7em;"></span><span
                              class="sizing reset-size6 size3 mtight"><span
                                class="mord mathnormal mtight">i</span></span></span></span><span
                          class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                          style="height:0.15em;"><span></span></span></span></span></span></span><span
                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
              class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                          class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">L</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span
                class="mord"><span class="mopen">(</span><span class="mord">1</span><span
                  class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                      class="vlist" style="height:0.911231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
              class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
              class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span
                          class="pstrut" style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal"
                style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span
                        style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span
                            class="mord mathnormal mtight">L</span></span></span></span><span
                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                      style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></eq>.
  </p>
  <p dir="auto">By [Golubev 2018], the diffuse profile of [Christensen 2015] is applied, and we have <eq><span
        class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
            <semantics>
              <mrow>
                <mstyle scriptlevel="0" displaystyle="true">
                  <mi mathvariant="normal">T</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <mi>d</mi>
                  <mo stretchy="false">)</mo>
                  <mo>=</mo>
                  <msubsup>
                    <mo>∫</mo>
                    <mn>0</mn>
                    <mi mathvariant="normal">∞</mi>
                  </msubsup>
                  <mn>2</mn>
                  <mi>π</mi>
                  <mi>r</mi>
                  <mo>⋅</mo>
                  <mi mathvariant="normal">R</mi>
                  <mo>⁡</mo>
                  <mo stretchy="false">(</mo>
                  <msqrt>
                    <mrow>
                      <msup>
                        <mi>r</mi>
                        <mn>2</mn>
                      </msup>
                      <mo>+</mo>
                      <msup>
                        <mi>d</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </msqrt>
                  <mo stretchy="false">)</mo>
                  <mtext> </mtext>
                  <mi>d</mi>
                  <mi>r</mi>
                  <mo>=</mo>
                  <mfrac>
                    <mn>1</mn>
                    <mn>4</mn>
                  </mfrac>
                  <mi>A</mi>
                  <mo stretchy="false">(</mo>
                  <msup>
                    <mi>e</mi>
                    <mrow>
                      <mo>−</mo>
                      <mi>s</mi>
                      <mi>d</mi>
                    </mrow>
                  </msup>
                  <mo>+</mo>
                  <mn>3</mn>
                  <msup>
                    <mi>e</mi>
                    <mrow>
                      <mo>−</mo>
                      <mfrac>
                        <mrow>
                          <mi>s</mi>
                          <mi>d</mi>
                        </mrow>
                        <mn>3</mn>
                      </mfrac>
                    </mrow>
                  </msup>
                  <mo stretchy="false">)</mo>
                </mstyle>
              </mrow>
              <annotation encoding="application/x-tex">\displaystyle \operatorname{T}(d) = \int_0^\infin 2 \pi r \cdot
                \operatorname{R} (\sqrt{r^2 + d^2}) \, dr = \frac{1}{4} A (e^{-sd} + 3e^{-\frac{sd}{3}})</annotation>
            </semantics>
          </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
              style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">T</span></span><span class="mopen">(</span><span
              class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span
                class="mop op-symbol large-op"
                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                      style="height:1.414292em;"><span
                        style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                          class="pstrut" style="height:2.7em;"></span><span
                          class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span
                        style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span
              class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace"
              style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut"
              style="height:1.3122639999999999em;vertical-align:-0.25em;"></span><span class="mop"><span
                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord sqrt"><span
                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                    style="height:1.0622639999999999em;"><span class="svg-align" style="top:-3.2em;"><span
                        class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span
                          class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                  style="height:0.740108em;"><span
                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut"
                                      style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                          class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                          class="mbin">+</span><span class="mspace"
                          style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                            class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span
                                class="vlist-r"><span class="vlist" style="height:0.740108em;"><span
                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut"
                                      style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                      style="top:-3.0222640000000003em;"><span class="pstrut" style="height:3.2em;"></span><span
                        class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width='400em' height='1.28em'
                          viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'>
                          <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                        </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span
                    class="vlist" style="height:0.177736em;"><span></span></span></span></span></span><span
              class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span
              class="mord mathnormal">d</span><span class="mord mathnormal"
              style="margin-right:0.02778em;">r</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace"
              style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
              style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span
                    class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut"
                          style="height:3em;"></span><span class="frac-line"
                          style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span
                          class="pstrut" style="height:3em;"></span><span class="mord"><span
                            class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span
                    class="vlist-r"><span class="vlist"
                      style="height:0.686em;"><span></span></span></span></span></span><span
                class="mclose nulldelimiter"></span></span><span class="mord mathnormal">A</span><span
              class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span
                  class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span
                        style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                          style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight">−</span><span
                              class="mord mathnormal mtight">s</span><span
                              class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
              class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
              class="strut" style="height:1.27902em;vertical-align:-0.25em;"></span><span class="mord">3</span><span
              class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span
                    class="vlist-r"><span class="vlist" style="height:1.02902em;"><span
                        style="top:-3.4130000000000003em;margin-right:0.05em;"><span class="pstrut"
                          style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span
                            class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span
                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span
                                  class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                      style="height:0.8800285714285714em;"><span style="top:-2.656em;"><span
                                          class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span
                                              class="mord mtight">3</span></span></span></span><span
                                        style="top:-3.2255000000000003em;"><span class="pstrut"
                                          style="height:3em;"></span><span class="frac-line mtight"
                                          style="border-bottom-width:0.049em;"></span></span><span
                                        style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span
                                          class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span
                                              class="mord mathnormal mtight">s</span><span
                                              class="mord mathnormal mtight">d</span></span></span></span></span><span
                                      class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                      style="height:0.344em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span
              class="mclose">)</span></span></span></span></eq>.</p>
  <p dir="auto">The transmittance coefficient by [Golubev 2018] is calculated by the <a
      href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/DiffusionProfile/DiffusionProfile.hlsl#L9">ComputeTransmittanceDisney</a>
    in Unity3D.</p>
  <h2 dir="auto" id="6-specular-brdf">6. Specular BRDF</h2>
  <h3 dir="auto" id="6-1-two-lobe-blinn-phong">6-1. Two-lobe Blinn-Phong</h3>
  <p dir="auto">The Two-lobe Blinn-Phong is calculated by <a
      href="https://github.com/NVIDIAGameWorks/FaceWorks/blob/master/samples/d3d11/shaders/lighting.hlsli#L129">EvaluateSpecularLight</a>
    in NVIDIA FaceWorks.</p>
  <p dir="auto">TODO</p>
  <h3 dir="auto" id="6-2-dual-trowbridge-reitz">6-2. Dual Trowbridge-Reitz</h3>
  <p dir="auto">The Dual Trowbridge-Reitz is calculated by <a
      href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/ShadingModels.ush#L178">DualSpecularGGX</a>
    in UE4.</p>
  <p dir="auto">TODO</p>
  <h2 dir="auto" id="references">References</h2>
  <p dir="auto">[Kelemen 2001] <a href="http://cg.iit.bme.hu/~szirmay/scook_link.htm">Csaba Kelemen, László
      Szirmay-Kalos. &quot;A Microfacet Based Coupled Specular-Matte BRDF Model with Importance Sampling.&quot; EGSR
      2001.</a><br>
    [Green 2004] <a
      href="https://developer.nvidia.com/gpugems/gpugems/part-iii-materials/chapter-16-real-time-approximations-subsurface-scattering">Simon
      Green. &quot;Chapter 16. Real-Time Approximations to Subsurface Scattering.&quot; GPU Gems 1.</a><br>
    [dEon 2007] <a
      href="https://developer.nvidia.com/gpugems/gpugems3/part-iii-rendering/chapter-14-advanced-techniques-realistic-real-time-skin">Eugene
      dEon, David Luebke. &quot;Advanced Techniques for Realistic Real-Time Skin Rendering.&quot; GPU Gem 3.</a><br>
    [Colbert 2007] <a
      href="https://developer.nvidia.com/gpugems/gpugems3/part-iii-rendering/chapter-20-gpu-based-importance-sampling">Mark
      Colbert, Jaroslav Krivanek. &quot;GPU-Based Importance Sampling.&quot; GPU Gems 3.</a><br>
    [Jimenez 2009] <a href="https://www.iryoku.com/sssss/">Jorge Jimenez, Veronica Sundstedt, Diego Gutierrez.
      &quot;Screen-Space Perceptual Rendering of Human Skin.&quot; ACM TAP 2009.</a><br>
    [Jimenez 2009] Jorge Jimenez, Diego Gutierrez. &quot;Screen-Space Subsurface Scattering.&quot; GPU Pro 1.<br>
    [Jimenez 2010] <a href="http://www.iryoku.com/translucency/">Jorge Jimenez, David Whelan, Veronica Sundstedt, Diego
      Gutierrez. &quot;Real-Time Realistic Skin Translucency.&quot; IEEE 2010.</a><br>
    [Mikkelsen 2010] <a href="https://mmikk.github.io/papers3d/cbf_skin.pdf">Morten Mikkelsen. &quot;Skin Rendering by
      Pseudo–Separable Cross Bilateral Filtering.&quot; Naughty Dog.</a><br>
    [Penner 2011 A] Eric Penner, George Borshukov. &quot;Pre-Integrated Skin Shading.&quot; GPU Pro 2.<br>
    [Penner 2011 B] <a href="http://advances.realtimerendering.com/s2011/">Eric Penner. &quot;Pre-Integrated Skin
      Shading.&quot; SIGGRAPH 2011.</a><br>
    [Lazarov 2011] <a href="http://advances.realtimerendering.com/s2011/">Dimitar Lazarov. &quot;Physically Based
      Lighting in Call of Duty : Black Ops.&quot; SIGGRAPH 2011.</a><br>
    [Jimenez 2012] <a href="https://graphics.unizar.es/publications.html#year_2012">Jorge Jimenez, Adrian Jarabo, Diego
      Gutierrez. &quot;Separable Subsurface Scattering.&quot; Technical Report 2012.</a><br>
    [Jimenez 2015] <a href="http://www.iryoku.com/separable-sss/">Jorge Jimenez, Karoly Zsolnai, Adrian Jarabo1,
      Christian Freude, Thomas Auzinger, Xian-Chun Wu, Javier von der Pahlen, Michael Wimmer, Diego Gutierrez.
      &quot;Separable Subsurface Scattering.&quot; EGSR 2015.</a><br>
    [Christensen 2015] <a href="https://graphics.pixar.com/library/">Per Christensen, Brent Burley. &quot;Approximate
      Reflectance Profiles for Efficient Subsurface Scattering.&quot; SIGGRAPH 2015.</a><br>
    [Golubev 2018] <a href="https://zero-radiance.github.io/post/sampling-diffusion/">Evgenii Golubev. &quot;Efficient
      Screen-Space Subsurface Scattering Using Burley's Normalized Diffusion in Real-Time.&quot; SIGGRAPH 2018.</a></p>

</body>

</html>