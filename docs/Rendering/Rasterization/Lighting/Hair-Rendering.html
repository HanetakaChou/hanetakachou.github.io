<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/default.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
</head>

<body class="markdown-body">
    <h1 dir="auto" id="hair-rendering">Hair Rendering</h1>
    <p dir="auto">By &quot;Equation (5.9)&quot; of <a
            href="https://www.pbr-book.org/3ed-2018/Color_and_Radiometry/Surface_Reflection#TheBRDF">PBR Book</a>, we
        have the reflectance equation <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">f</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">i</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{L_o}(\overrightarrow{\omega_o}) = \int_\Omega
                                \operatorname{f}(\overrightarrow{\omega_i}, \overrightarrow{\omega_o})
                                \operatorname{L_i}(\overrightarrow{\omega_i}) (\cos \theta_i)^+ \, d
                                \overrightarrow{\omega_i}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31750199999999995em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq>.</p>
    <p dir="auto"><a href="https://github.com/mmp/pbrt-v3/blob/master/src/materials/hair.h#L36">HairMaterial</a> in
        PBRT-V3</p>
    <p dir="auto"><a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/HairBsdf.ush#L310">HairShading</a>
        in UE4</p>
    <p dir="auto"><a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/Hair/Hair.hlsl#L359">EvaluateBSDF</a>
        in Unity3D</p>
    <p dir="auto"><a href="https://rmanwiki.pixar.com/display/REN25/PxrMarschnerHair">PxrMarschnerHair</a> in RenderMan
    </p>
    <h2 dir="auto" id="micro-cylinder-models">Micro-Cylinder Models</h2>
    <p dir="auto">The name <strong>micro-cylinder models</strong> is from &quot;9.10.3 Micro-Cylinder Cloth Models&quot;
        of <a href="https://www.realtimerendering.com/">Real-Time Rendering Fourth Edition</a>.</p>
    <p dir="auto">By [Kajiya 1998], at any given position of the cylinder, there are infinite number of normals which
        point in all directions perpendicular to the tangent.</p>
    <p dir="auto">Let <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <mi>t</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{t}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.13708em;vertical-align:0em;"></span><span class="mord accent"><span
                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:1.13708em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span
                                                class="mord mathnormal">t</span></span><span class="svg-align"
                                            style="top:-3.61508em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span></span></span></span>
        </eq> be the tangent, <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <msup>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo lspace="0em" rspace="0em">⊥</mo>
                                        </msup>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{{\omega_i}^{\perp}}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.4471079999999998em;vertical-align:-0.15em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.297108em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span class="mord"><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                    class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.7751079999999999em;"><span
                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mtight"><span
                                                                                class="mrel mtight">⊥</span></span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.775108em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> be the (normalized) projection of the incident direction <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{\omega_i}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> onto the plane perpendicular to the tangent, and <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <mi>b</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>=</mo>
                                    <mover accent="true">
                                        <msup>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo lspace="0em" rspace="0em">⊥</mo>
                                        </msup>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>×</mo>
                                    <mover accent="true">
                                        <mi>t</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{b} =
                                \overrightarrow{{\omega_i}^{\perp}} \times \overrightarrow{t}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.21644em;vertical-align:0em;"></span><span class="mord accent"><span
                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:1.21644em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span
                                                class="mord mathnormal">b</span></span><span class="svg-align"
                                            style="top:-3.69444em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.4471079999999998em;vertical-align:-0.15em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.297108em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span class="mord"><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                    class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.7751079999999999em;"><span
                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mtight"><span
                                                                                class="mrel mtight">⊥</span></span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.775108em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">×</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.13708em;vertical-align:0em;"></span><span
                            class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:1.13708em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span
                                                class="mord mathnormal">t</span></span><span class="svg-align"
                                            style="top:-3.61508em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span></span></span></span>
        </eq> be the bitangent.</p>
    <p dir="auto"><img src="Hair-Rendering-1.png" alt="" data-src="Hair-Rendering-1.png"></p>
    <p dir="auto">Let <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>ϕ</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \phi</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord mathnormal">ϕ</span></span></span></span></eq> be the azimuth, and <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <mover accent="true">
                                            <mi mathvariant="normal">n</mi>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>ϕ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mover accent="true">
                                        <msup>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo lspace="0em" rspace="0em">⊥</mo>
                                        </msup>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mi>sin</mi>
                                    <mo>⁡</mo>
                                    <mi>ϕ</mi>
                                    <mo>+</mo>
                                    <mover accent="true">
                                        <mi>b</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mi>ϕ</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{\overrightarrow{n}}(\phi) = \overrightarrow{{\omega_i}^{\perp}} \sin \phi
                                + \overrightarrow{b} \cos \phi</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                    class="pstrut" style="height:3em;"></span><span
                                                    class="mord mathrm">n</span></span><span class="svg-align"
                                                style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">ϕ</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.4915479999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.297108em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span class="mord"><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                    class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.7751079999999999em;"><span
                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mtight"><span
                                                                                class="mrel mtight">⊥</span></span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.775108em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mop">sin</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">ϕ</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.41088em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:1.21644em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span
                                                class="mord mathnormal">b</span></span><span class="svg-align"
                                            style="top:-3.69444em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">ϕ</span></span></span></span></eq> be the normal points in one
        direction perpendicular to the tangent.</p>
    <p dir="auto"><img src="Hair-Rendering-2.png" alt="" data-src="Hair-Rendering-2.png"></p>
    <p dir="auto">By [Kajiya 1998], the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle (\cos \theta_i)^+</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.071331em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span
                            class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>
        </eq> is no longer calculated as <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>max</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>0</mn>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <mi>n</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>⋅</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \max (0, \overrightarrow{n} \cdot
                                \overrightarrow{\omega_i})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop">max</span><span
                            class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">n</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>, but as the integral along the
        circumference of the cylinder intead. This means that <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi>π</mi>
                                    </msubsup>
                                    <mi mathvariant="normal">
                                        <mover accent="true">
                                            <mi mathvariant="normal">n</mi>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>ϕ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>ϕ</mi>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi>π</mi>
                                    </msubsup>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msup>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo lspace="0em" rspace="0em">⊥</mo>
                                        </msup>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mi>sin</mi>
                                    <mo>⁡</mo>
                                    <mi>ϕ</mi>
                                    <mo>+</mo>
                                    <mover accent="true">
                                        <mi>b</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mi>ϕ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>ϕ</mi>
                                    <mo>=</mo>
                                    <mover accent="true">
                                        <msup>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo lspace="0em" rspace="0em">⊥</mo>
                                        </msup>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>⋅</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi>π</mi>
                                    </msubsup>
                                    <mi>sin</mi>
                                    <mo>⁡</mo>
                                    <mi>ϕ</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>ϕ</mi>
                                    <mo>=</mo>
                                    <mover accent="true">
                                        <msup>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo lspace="0em" rspace="0em">⊥</mo>
                                        </msup>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>⋅</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>=</mo>
                                    <mi>sin</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mi>t</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msup>
                                        <mrow>
                                            <mo stretchy="false">(</mo>
                                            <mover accent="true">
                                                <mi>t</mi>
                                                <mo stretchy="true">→</mo>
                                            </mover>
                                            <mo>⋅</mo>
                                            <mover accent="true">
                                                <msub>
                                                    <mi>ω</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mo stretchy="true">→</mo>
                                            </mover>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mn>2</mn>
                                    </msup>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle (\cos \theta_i)^+ = \int_0^\pi
                                \operatorname{\overrightarrow{n}}(\phi) \cdot \overrightarrow{\omega_i} \, d \phi =
                                \int_0^\pi (\overrightarrow{{\omega_i}^{\perp}} \sin \phi + \overrightarrow{b} \cos
                                \phi) \cdot \overrightarrow{\omega_i} \, d \phi = \overrightarrow{{\omega_i}^{\perp}}
                                \cdot \overrightarrow{\omega_i} \int_0^\pi \sin \phi \, d \phi =
                                \overrightarrow{{\omega_i}^{\perp}} \cdot \overrightarrow{\omega_i} =
                                \sin(\overrightarrow{t}, \overrightarrow{\omega_i}) = 1 - {(\overrightarrow{t} \cdot
                                \overrightarrow{\omega_i})}^2</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.071331em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span
                            class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">π</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                    class="pstrut" style="height:3em;"></span><span
                                                    class="mord mathrm">n</span></span><span class="svg-align"
                                                style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">ϕ</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1.147em;vertical-align:-0.19444em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal">ϕ</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">π</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:1.297108em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord"><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                    class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.7751079999999999em;"><span
                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mtight"><span
                                                                                class="mrel mtight">⊥</span></span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.775108em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mop">sin</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">ϕ</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1.46644em;vertical-align:-0.25em;"></span><span
                            class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:1.21644em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span
                                                class="mord mathnormal">b</span></span><span class="svg-align"
                                            style="top:-3.69444em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">ϕ</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1.147em;vertical-align:-0.19444em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal">ϕ</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.4471079999999998em;vertical-align:-0.15em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.297108em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span class="mord"><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                    class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.7751079999999999em;"><span
                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mtight"><span
                                                                                class="mrel mtight">⊥</span></span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.775108em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">π</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mop">sin</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">ϕ</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal">ϕ</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.4471079999999998em;vertical-align:-0.15em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.297108em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span class="mord"><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                    class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.7751079999999999em;"><span
                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mtight"><span
                                                                                class="mrel mtight">⊥</span></span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.775108em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.10256em;vertical-align:-0.15em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1.38708em;vertical-align:-0.25em;"></span><span
                            class="mop">sin</span><span class="mopen">(</span><span class="mord accent"><span
                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:1.13708em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span
                                                class="mord mathnormal">t</span></span><span class="svg-align"
                                            style="top:-3.61508em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.591088em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord"><span class="mopen">(</span><span class="mord accent"><span
                                        class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                style="height:1.13708em;"><span style="top:-3em;"><span class="pstrut"
                                                        style="height:3em;"></span><span
                                                        class="mord mathnormal">t</span></span><span class="svg-align"
                                                    style="top:-3.61508em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="hide-tail"
                                                        style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                            height='0.522em' viewBox='0 0 400000 522'
                                                            preserveAspectRatio='xMaxYMin slice'>
                                                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                        </svg></span></span></span></span></span></span><span
                                    class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                    class="mbin">⋅</span><span class="mspace"
                                    style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="hide-tail"
                                                        style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                            height='0.522em' viewBox='0 0 400000 522'
                                                            preserveAspectRatio='xMaxYMin slice'>
                                                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                        </svg></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span><span
                                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                                        class="vlist-r"><span class="vlist" style="height:1.341088em;"><span
                                                style="top:-3.58998em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>
        </eq>. The <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle (\cos \theta_i)^+</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.071331em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span
                            class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>
        </eq> is calculated by <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/HairBsdf.ush#L66">FakeNormal</a>
        in UE4 and <a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/Hair/Hair.hlsl#L367">_USE_LIGHT_FACING_NORMAL</a>
        in Unity3D.</p>
    <p dir="auto">Let <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">reflect</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{reflect}(\overrightarrow{\omega_i})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">reflect</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> be the reflected direction of the incident
        direction, and <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{\omega_o}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> be the outgoing direction.<br>
        <img src="Hair-Rendering-3.png" alt="" data-src="Hair-Rendering-3.png">
    </p>
    <p dir="auto">By [Kajiya 1998], the half-angle vector <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mover accent="true">
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>h</mi>
                                    </msub>
                                    <mo stretchy="true">→</mo>
                                </mover>
                            </mrow>
                            <annotation encoding="application/x-tex">\overrightarrow{\omega_h}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.33610799999999996em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">h</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> should be independent of the azimuth <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>ϕ</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \phi</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord mathnormal">ϕ</span></span></span></span></eq>. This means that the incident
        direction <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{\omega_i}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> is rotated about the tangent <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <mi>t</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{t}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.13708em;vertical-align:0em;"></span><span class="mord accent"><span
                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:1.13708em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span
                                                class="mord mathnormal">t</span></span><span class="svg-align"
                                            style="top:-3.61508em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span></span></span></span>
        </eq> to make sure that the incident direction <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{\omega_i}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq>, the reflected direction <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">reflect</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{reflect}(\overrightarrow{\omega_i})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">reflect</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>, and the outgoing direction <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{\omega_o}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> are coplanar before the half-angle vector is calculated.</p>
    <h2 dir="auto" id="references">References</h2>
    <p dir="auto">[Kajiya 1998] James Kajiya, Timothy Kay. &quot;Rendering Fur with Three Dimensional Textures.&quot;
        SIGGRAPH 1998.<br>
        [Marschner 2003] <a href="https://www.cs.cornell.edu/~srm/publications/SG03-hair-abstract.html">Stephen
            Marschner, Henrik Jensen, Mike Cammarano. &quot;Light Scattering from Human Hair Fibers.&quot; SIGGRAPH
            2003.</a><br>
        [Scheuermann 2004] <a href="https://www.shaderwrangler.com/publications/hairsketch/">Thorsten Scheuermann.
            &quot;Practical Real-Time Hair Rendering and Shading.&quot; SIGGRAPH 2004.</a><br>
        [Nguyen 2005] <a
            href="https://developer.nvidia.com/gpugems/gpugems2/part-iii-high-quality-rendering/chapter-23-hair-animation-and-rendering-nalu-demo">Hubert
            Nguyen, William Donnelly. &quot;Hair Animation and Rendering in the Nalu Demo.&quot; GPU Gems 2.</a><br>
        [Yuksel 2010] <a href="" data-href="">Cem Yuksel, Sarah Tariq. &quot;Advanced Techniques in Real-time Hair
            Rendering and Simulation.&quot; SIGGRAPH 2010.</a><br>
        [Pekelis 2015] <a href="https://graphics.pixar.com/library/DataDrivenHairScattering/index.html">Leonid Pekelis,
            Christophe Hery, Ryusuke Villemin, Junyi Ling. &quot;A Data-Driven Light Scattering Model for Hair.&quot;
            Pixar Technical Memo 2015.</a><br>
        [Pharr 2016] <a href="http://pbrt.org/hair.pdf">Matt Pharr. &quot;The Implementation of a Hair Scattering
            Model.&quot; PBRT V3.</a><br>
        [Karis 2016] <a href="https://blog.selfshadow.com/publications/s2016-shading-course/">Brian Karis.
            &quot;Physically Based Hair Shading in Unreal.&quot; SIGGRAPH 2016.</a><br>
        [Hery 2017] <a href="https://blog.selfshadow.com/publications/s2017-shading-course/">Christophe Hery, Junyi
            Ling. &quot;Pixar's Foundation for Materials: PxrSurface and PxrMarschnerHair.&quot; SIGGRAPH 2017.</a></p>

</body>

</html>