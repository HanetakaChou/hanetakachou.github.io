<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/default.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
</head>

<body class="markdown-body">
    <h1 dir="auto" id="photon-mapping">Photon Mapping</h1>
    <h2 dir="auto" id="workflow">Workflow</h2>
    <p dir="auto">By &quot;4.3 Overview&quot; of [Jensen 2001] and &quot;16.2.2 Photon Mapping&quot; of <a
            href="https://pbr-book.org/3ed-2018/Light_Transport_III_Bidirectional_Methods/Stochastic_Progressive_Photon_Mapping#PhotonMapping">PBR
            Book V3</a>, the <strong>photon mapping</strong> is composed of two steps: <strong>photon tracing</strong>
        and <strong>rendering</strong>. During the <strong>photon tracing</strong> step, the <strong>photon
            rays</strong> are traced from the light sources, and the lighting information of the intersection positions
        of these <strong>photon rays</strong> is recorded as the photons. During the <strong>rendering</strong> step,
        the <strong>primary rays</strong> are traced from the camera and the <strong>final gather rays</strong> are
        traced from the <a
            href="http://docs.autodesk.com/MENTALRAY/2015/ENU/mental-ray-help/files/manual/node52.html"><strong>final
                gather points</strong></a>, and the lighting information of the vicinal photons of the intersection
        positions of these <strong>primary rays</strong> or <strong>final gather rays</strong> is used to approximate
        the lighting of these intersection points by <strong>density estimation</strong>.</p>
    <p dir="auto">By &quot;7.5 Photon Gathering&quot; of [Jensen 2001], &quot;38.2.2 Final Gathering&quot; of [Hachisuka
        2005] and &quot;16.2.2 Photon Mapping&quot; of <a
            href="https://pbr-book.org/3ed-2018/Light_Transport_III_Bidirectional_Methods/Stochastic_Progressive_Photon_Mapping#PhotonMapping">PBR
            Book V3</a>, the rendering step of the photon mapping is usually composed of two steps: <strong>radiance
            estimate</strong> and <strong>final gathering</strong>. During the <strong>radiance estimate</strong> step,
        the <strong>primary rays</strong> are traced from the camera, and the lighting information of the vicinal
        photons of the intersection positions of these <strong>primary rays</strong> is used to approximate the lighting
        of these intersection points by <strong>density estimation</strong>. During the <strong>final gathering</strong>
        step, from some of the intersection positions of the <strong>primary rays</strong>, which are called the <a
            href="http://docs.autodesk.com/MENTALRAY/2015/ENU/mental-ray-help/files/manual/node52.html"><strong>final
                gather points</strong></a>, the <strong>final gather rays</strong> are traced, and the lighting
        information of the vicinal photons of the intersection positions of these <strong>final gather rays</strong> is
        used to approximate the lighting of these intersection positions by <strong>density estimation</strong>.</p>
    <table dir="auto">
        <thead dir="auto">
            <tr dir="auto">
                <th style="text-align:center"><strong>Photon Tracing</strong></th>
                <th style="text-align:center"><strong>Rendering / Radiance-Estimate</strong></th>
                <th style="text-align:center"><strong>Rendering / Final Gathering</strong></th>
            </tr>
        </thead>
        <tbody dir="auto">
            <tr dir="auto">
                <td style="text-align:center"><img src="Photon-Mapping-Photon-Tracing.png" alt=""
                        data-src="Photon-Mapping-Photon-Tracing.png"></td>
                <td style="text-align:center"><img src="Photon-Mapping-Rendering-Radiance-Estimate.png" alt=""
                        data-src="Photon-Mapping-Rendering-Radiance-Estimate.png"></td>
                <td style="text-align:center"><img src="Photon-Mapping-Rendering-Final-Gathering.png" alt=""
                        data-src="Photon-Mapping-Rendering-Final-Gathering.png"></td>
            </tr>
        </tbody>
    </table>
    <h2 dir="auto" id="density-estimation">Density Estimation</h2>
    <p dir="auto">By &quot;Equation (16.9)&quot; of <a
            href="https://pbr-book.org/3ed-2018/Light_Transport_III_Bidirectional_Methods/Stochastic_Progressive_Photon_Mapping#PhotonMapping">PBR
            Book V3</a>, &quot;Equation (7.3)&quot; of [Jensen 2001] and &quot;14.4.5 Delta Distributions in the
        Integrand&quot; of <a
            href="https://pbr-book.org/3ed-2018/Light_Transport_I_Surface_Reflection/The_Light_Transport_Equation#DeltaDistributionsintheIntegrand">PBR
            Book V3</a>, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mi>p</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msup>
                                            <mi mathvariant="normal">S</mi>
                                            <mn>2</mn>
                                        </msup>
                                    </msub>
                                    <mi mathvariant="normal">f</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mi>p</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">i</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mi>p</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>A</mi>
                                    </msub>
                                    <mrow>
                                        <mo fence="true">(</mo>
                                        <msub>
                                            <mo>∫</mo>
                                            <msup>
                                                <mi mathvariant="normal">S</mi>
                                                <mn>2</mn>
                                            </msup>
                                        </msub>
                                        <mi mathvariant="normal">δ</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <msup>
                                                <mi>p</mi>
                                                <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                            </msup>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo>−</mo>
                                        <mover accent="true">
                                            <mi>p</mi>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mi mathvariant="normal">f</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <msup>
                                                <mi>p</mi>
                                                <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                            </msup>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo separator="true">,</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo separator="true">,</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mi mathvariant="normal">
                                            <msub>
                                                <mi mathvariant="normal">L</mi>
                                                <mi mathvariant="normal">i</mi>
                                            </msub>
                                        </mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <msup>
                                                <mi>p</mi>
                                                <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                            </msup>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo separator="true">,</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>cos</mi>
                                        <mo>⁡</mo>
                                        <msub>
                                            <mi>θ</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <msup>
                                            <mo stretchy="false">)</mo>
                                            <mo>+</mo>
                                        </msup>
                                        <mtext> </mtext>
                                        <mi>d</mi>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo fence="true">)</mo>
                                    </mrow>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi mathvariant="normal">A</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msup>
                                            <mi>p</mi>
                                            <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                        </msup>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{L_o}(\overrightarrow{p}, \overrightarrow{\omega_o}) = \int_{\mathrm{S}^2}
                                \operatorname{f}(\overrightarrow{p}, \overrightarrow{\omega_i},
                                \overrightarrow{\omega_o}) \operatorname{L_i}(\overrightarrow{p},
                                \overrightarrow{\omega_i}) (\cos \theta_i)^+ \, d \overrightarrow{\omega_i} = \int_A
                                \left\lparen \int_{\mathrm{S}^2} \operatorname{\delta}(\overrightarrow{p&#x27;} -
                                \overrightarrow{p}) \operatorname{f}(\overrightarrow{p&#x27;},
                                \overrightarrow{\omega_i}, \overrightarrow{\omega_o})
                                \operatorname{L_i}(\overrightarrow{p&#x27;}, \overrightarrow{\omega_i}) (\cos
                                \theta_i)^+ \, d \overrightarrow{\omega_i} \right\rparen \, d
                                \operatorname{A}(\overrightarrow{p&#x27;})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">p</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.38952999999999993em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathrm mtight">S</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.7463142857142857em;"><span
                                                                                style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">p</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31750199999999995em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">p</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">A</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span
                                class="mopen delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">(</span></span><span class="mop"><span
                                    class="mop op-symbol large-op"
                                    style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:-0.38952999999999993em;"><span
                                                    style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight"><span
                                                                    class="mord mathrm mtight">S</span><span
                                                                    class="msupsub"><span class="vlist-t"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.7463142857142857em;"><span
                                                                                    style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mop"><span class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                            class="vlist" style="height:1.199892em;"><span style="top:-3em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                                            class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                    style="height:0.6778919999999999em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">−</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                    class="pstrut" style="height:3em;"></span><span
                                                    class="mord mathnormal">p</span></span><span class="svg-align"
                                                style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:1.199892em;"><span
                                                style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.6778919999999999em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.151392em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">o</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                    class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.31750199999999995em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                            class="pstrut" style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathrm mtight">i</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:1.199892em;"><span
                                                style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.6778919999999999em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                        class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                style="height:0.821331em;"><span
                                                    style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                        style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">d</span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">)</span></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">A</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.199892em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                style="height:0.6778919999999999em;"><span
                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mtight"><span
                                                                                class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> where <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">δ</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msup>
                                            <mi>p</mi>
                                            <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                        </msup>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>−</mo>
                                    <mover accent="true">
                                        <mi>p</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{\delta}(\overrightarrow{p&#x27;} - \overrightarrow{p})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.449892em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord">δ</span></span><span class="mopen">(</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.199892em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                style="height:0.6778919999999999em;"><span
                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mtight"><span
                                                                                class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">p</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is the <strong>delta function</strong>.
    </p>
    <p dir="auto">By &quot;Equation (16.11)&quot; of <a
            href="https://pbr-book.org/3ed-2018/Light_Transport_III_Bidirectional_Methods/Stochastic_Progressive_Photon_Mapping#PhotonMapping">PBR
            Book V3</a> and &quot;Equation (7.4)&quot; of [Jensen 2001], the <strong>delta function</strong> is
        approximated by the <strong>filter function</strong>. This is the reason why the photon mapping algorithm is
        <strong>biased</strong>. Theoretically, the <strong>delta function</strong> is considered as an unknown
        <strong>probability density function</strong>, and the <strong>density estimation</strong> is used to
        <strong>approximate</strong> the <strong>probability density</strong> at the shading position. The
        <strong>kernel density estimation</strong> is one of the methods of the <strong>density estimation</strong>, and
        we have <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mi>p</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>A</mi>
                                    </msub>
                                    <mrow>
                                        <mo fence="true">(</mo>
                                        <msub>
                                            <mo>∫</mo>
                                            <msup>
                                                <mi mathvariant="normal">S</mi>
                                                <mn>2</mn>
                                            </msup>
                                        </msub>
                                        <mi mathvariant="normal">δ</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <msup>
                                                <mi>p</mi>
                                                <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                            </msup>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo>−</mo>
                                        <mover accent="true">
                                            <mi>p</mi>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mi mathvariant="normal">f</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <msup>
                                                <mi>p</mi>
                                                <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                            </msup>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo separator="true">,</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo separator="true">,</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mi mathvariant="normal">
                                            <msub>
                                                <mi mathvariant="normal">L</mi>
                                                <mi mathvariant="normal">i</mi>
                                            </msub>
                                        </mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <msup>
                                                <mi>p</mi>
                                                <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                            </msup>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo separator="true">,</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>cos</mi>
                                        <mo>⁡</mo>
                                        <msub>
                                            <mi>θ</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <msup>
                                            <mo stretchy="false">)</mo>
                                            <mo>+</mo>
                                        </msup>
                                        <mtext> </mtext>
                                        <mi>d</mi>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo fence="true">)</mo>
                                    </mrow>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi mathvariant="normal">A</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msup>
                                            <mi>p</mi>
                                            <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                        </msup>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>≈</mo>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>1</mn>
                                        </mrow>
                                        <mi>N</mi>
                                    </munderover>
                                    <mrow>
                                        <mo fence="true">(</mo>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mi>N</mi>
                                        </mfrac>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mi>h</mi>
                                        </mfrac>
                                        <mi mathvariant="normal">K</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mfrac>
                                            <mrow>
                                                <mover accent="true">
                                                    <msub>
                                                        <mi>p</mi>
                                                        <mi>i</mi>
                                                    </msub>
                                                    <mo stretchy="true">→</mo>
                                                </mover>
                                                <mo>−</mo>
                                                <mover accent="true">
                                                    <mi>p</mi>
                                                    <mo stretchy="true">→</mo>
                                                </mover>
                                            </mrow>
                                            <mi>h</mi>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                        <mo fence="true">)</mo>
                                    </mrow>
                                    <mrow>
                                        <mo fence="true">(</mo>
                                        <msub>
                                            <mo>∫</mo>
                                            <msup>
                                                <mi mathvariant="normal">S</mi>
                                                <mn>2</mn>
                                            </msup>
                                        </msub>
                                        <mi mathvariant="normal">f</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <mi>p</mi>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo separator="true">,</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo separator="true">,</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mi mathvariant="normal">
                                            <msub>
                                                <mi mathvariant="normal">L</mi>
                                                <mi mathvariant="normal">i</mi>
                                            </msub>
                                        </mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo separator="true">,</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>cos</mi>
                                        <mo>⁡</mo>
                                        <msub>
                                            <mi>θ</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <msup>
                                            <mo stretchy="false">)</mo>
                                            <mo>+</mo>
                                        </msup>
                                        <mtext> </mtext>
                                        <mi>d</mi>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo fence="true">)</mo>
                                    </mrow>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{L_o}(\overrightarrow{p}, \overrightarrow{\omega_o}) = \int_A \left\lparen
                                \int_{\mathrm{S}^2} \operatorname{\delta}(\overrightarrow{p&#x27;} - \overrightarrow{p})
                                \operatorname{f}(\overrightarrow{p&#x27;}, \overrightarrow{\omega_i},
                                \overrightarrow{\omega_o}) \operatorname{L_i}(\overrightarrow{p&#x27;},
                                \overrightarrow{\omega_i}) (\cos \theta_i)^+ \, d \overrightarrow{\omega_i}
                                \right\rparen \, d \operatorname{A}(\overrightarrow{p&#x27;}) \approx \sum_{i=1}^N
                                \left\lparen \frac{1}{N} \frac{1}{h} \operatorname{K}(\frac{\overrightarrow{p_i} -
                                \overrightarrow{p}}{h}) \right\rparen \left\lparen \int_{\mathrm{S}^2}
                                \operatorname{f}(\overrightarrow{p}, \overrightarrow{\omega_i},
                                \overrightarrow{\omega_o}) \operatorname{L_i}(\overrightarrow{p_i},
                                \overrightarrow{\omega_i}) (\cos \theta_i)^+ \, d \overrightarrow{\omega_i}
                                \right\rparen</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">p</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">A</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span
                                class="mopen delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">(</span></span><span class="mop"><span
                                    class="mop op-symbol large-op"
                                    style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:-0.38952999999999993em;"><span
                                                    style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight"><span
                                                                    class="mord mathrm mtight">S</span><span
                                                                    class="msupsub"><span class="vlist-t"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.7463142857142857em;"><span
                                                                                    style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mop"><span class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                            class="vlist" style="height:1.199892em;"><span style="top:-3em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                                            class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                    style="height:0.6778919999999999em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">−</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                    class="pstrut" style="height:3em;"></span><span
                                                    class="mord mathnormal">p</span></span><span class="svg-align"
                                                style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:1.199892em;"><span
                                                style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.6778919999999999em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.151392em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">o</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                    class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.31750199999999995em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                            class="pstrut" style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathrm mtight">i</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:1.199892em;"><span
                                                style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.6778919999999999em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                        class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                style="height:0.821331em;"><span
                                                    style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                        style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">d</span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">)</span></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">A</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.199892em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                style="height:0.6778919999999999em;"><span
                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mtight"><span
                                                                                class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:3.106005em;vertical-align:-1.277669em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.8283360000000002em;"><span
                                            style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal mtight">i</span><span
                                                        class="mrel mtight">=</span><span
                                                        class="mord mtight">1</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight"
                                                    style="margin-right:0.10903em;">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.277669em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span
                                class="mopen delimcenter" style="top:0em;"><span
                                    class="delimsizing size4">(</span></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.10903em;">N</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span
                                                            class="mord mathnormal">h</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                    class="mord mathrm">K</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.6295600000000001em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span
                                                            class="mord mathnormal">h</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord accent"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.9525600000000001em;"><span
                                                                            style="top:-3em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="mord"><span
                                                                                    class="mord mathnormal">p</span><span
                                                                                    class="msupsub"><span
                                                                                        class="vlist-t vlist-t2"><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.31166399999999994em;"><span
                                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                                        class="pstrut"
                                                                                                        style="height:2.7em;"></span><span
                                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                                class="vlist-s">​</span></span><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                                            class="svg-align"
                                                                            style="top:-3.43056em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="hide-tail"
                                                                                style="height:0.522em;min-width:0.888em;"><svg
                                                                                    width='400em' height='0.522em'
                                                                                    viewBox='0 0 400000 522'
                                                                                    preserveAspectRatio='xMaxYMin slice'>
                                                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                                                </svg></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord accent"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.9525600000000001em;"><span
                                                                            style="top:-3em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="mord mathnormal">p</span></span><span
                                                                            class="svg-align"
                                                                            style="top:-3.43056em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="hide-tail"
                                                                                style="height:0.522em;min-width:0.888em;"><svg
                                                                                    width='400em' height='0.522em'
                                                                                    viewBox='0 0 400000 522'
                                                                                    preserveAspectRatio='xMaxYMin slice'>
                                                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                                                </svg></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.19444em;"><span></span></span></span></span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                                class="mclose delimcenter" style="top:0em;"><span
                                    class="delimsizing size4">)</span></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="minner"><span
                                class="mopen delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">(</span></span><span class="mop"><span
                                    class="mop op-symbol large-op"
                                    style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:-0.38952999999999993em;"><span
                                                    style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight"><span
                                                                    class="mord mathrm mtight">S</span><span
                                                                    class="msupsub"><span class="vlist-t"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.7463142857142857em;"><span
                                                                                    style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mop"><span class="mord mathrm"
                                    style="margin-right:0.07778em;">f</span></span><span class="mopen">(</span><span
                                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                            class="vlist" style="height:0.9525600000000001em;"><span
                                                style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                    class="mord mathnormal">p</span></span><span class="svg-align"
                                                style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.151392em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">o</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                    class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.31750199999999995em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                            class="pstrut" style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathrm mtight">i</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                                style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                        class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                style="height:0.821331em;"><span
                                                    style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                        style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">d</span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">)</span></span></span></span></span></span></eq> where
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>h</mi>
                                    </mfrac>
                                    <mi mathvariant="normal">K</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mfrac>
                                        <mrow>
                                            <mover accent="true">
                                                <msub>
                                                    <mi>p</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mo stretchy="true">→</mo>
                                            </mover>
                                            <mo>−</mo>
                                            <mover accent="true">
                                                <mi>p</mi>
                                                <mo stretchy="true">→</mo>
                                            </mover>
                                        </mrow>
                                        <mi>h</mi>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">K</mi>
                                            <mi mathvariant="normal">h</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>−</mo>
                                    <mover accent="true">
                                        <mi>p</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \frac{1}{h}
                                \operatorname{K}(\frac{\overrightarrow{p_i} - \overrightarrow{p}}{h}) =
                                \operatorname{K_h}(\overrightarrow{p_i} - \overrightarrow{p})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.31556em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">h</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">K</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.6295600000000001em;"><span style="top:-2.314em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">h</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord accent"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.9525600000000001em;"><span
                                                                        style="top:-3em;"><span class="pstrut"
                                                                            style="height:3em;"></span><span
                                                                            class="mord"><span
                                                                                class="mord mathnormal">p</span><span
                                                                                class="msupsub"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.31166399999999994em;"><span
                                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:2.7em;"></span><span
                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                                        class="svg-align" style="top:-3.43056em;"><span
                                                                            class="pstrut"
                                                                            style="height:3em;"></span><span
                                                                            class="hide-tail"
                                                                            style="height:0.522em;min-width:0.888em;"><svg
                                                                                width='400em' height='0.522em'
                                                                                viewBox='0 0 400000 522'
                                                                                preserveAspectRatio='xMaxYMin slice'>
                                                                                <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                                            </svg></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.19444em;"><span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">−</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord accent"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.9525600000000001em;"><span
                                                                        style="top:-3em;"><span class="pstrut"
                                                                            style="height:3em;"></span><span
                                                                            class="mord mathnormal">p</span></span><span
                                                                        class="svg-align" style="top:-3.43056em;"><span
                                                                            class="pstrut"
                                                                            style="height:3em;"></span><span
                                                                            class="hide-tail"
                                                                            style="height:0.522em;min-width:0.888em;"><svg
                                                                                width='400em' height='0.522em'
                                                                                viewBox='0 0 400000 522'
                                                                                preserveAspectRatio='xMaxYMin slice'>
                                                                                <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                                            </svg></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.19444em;"><span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">K</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">h</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal">p</span><span
                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">p</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is the <strong>scaled kernel</strong>. The
        <strong>k-NN (k-Nearest Neighbors)</strong> is one of the methods of the <strong>kernel density
            estimation</strong>, and is the actual method used by the photon mapping algorithm, and we have <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mi>p</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>A</mi>
                                    </msub>
                                    <mrow>
                                        <mo fence="true">(</mo>
                                        <msub>
                                            <mo>∫</mo>
                                            <msup>
                                                <mi mathvariant="normal">S</mi>
                                                <mn>2</mn>
                                            </msup>
                                        </msub>
                                        <mi mathvariant="normal">δ</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <msup>
                                                <mi>p</mi>
                                                <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                            </msup>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo>−</mo>
                                        <mover accent="true">
                                            <mi>p</mi>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mi mathvariant="normal">f</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <msup>
                                                <mi>p</mi>
                                                <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                            </msup>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo separator="true">,</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo separator="true">,</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mi mathvariant="normal">
                                            <msub>
                                                <mi mathvariant="normal">L</mi>
                                                <mi mathvariant="normal">i</mi>
                                            </msub>
                                        </mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <msup>
                                                <mi>p</mi>
                                                <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                            </msup>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo separator="true">,</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>cos</mi>
                                        <mo>⁡</mo>
                                        <msub>
                                            <mi>θ</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <msup>
                                            <mo stretchy="false">)</mo>
                                            <mo>+</mo>
                                        </msup>
                                        <mtext> </mtext>
                                        <mi>d</mi>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo fence="true">)</mo>
                                    </mrow>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi mathvariant="normal">A</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msup>
                                            <mi>p</mi>
                                            <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                        </msup>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>≈</mo>
                                    <mfrac>
                                        <mi>k</mi>
                                        <mi>N</mi>
                                    </mfrac>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mrow>
                                            <mi>π</mi>
                                            <msup>
                                                <mrow>
                                                    <mo stretchy="false">(</mo>
                                                    <mi mathvariant="normal">
                                                        <msub>
                                                            <mi mathvariant="normal">R</mi>
                                                            <mi mathvariant="normal">k</mi>
                                                        </msub>
                                                    </mi>
                                                    <mo>⁡</mo>
                                                    <mo stretchy="false">(</mo>
                                                    <mover accent="true">
                                                        <mi>p</mi>
                                                        <mo stretchy="true">→</mo>
                                                    </mover>
                                                    <mo stretchy="false">)</mo>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                                <mn>2</mn>
                                            </msup>
                                        </mrow>
                                    </mfrac>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>1</mn>
                                        </mrow>
                                        <mi>N</mi>
                                    </munderover>
                                    <msub>
                                        <mo>∫</mo>
                                        <msup>
                                            <mi mathvariant="normal">S</mi>
                                            <mn>2</mn>
                                        </msup>
                                    </msub>
                                    <mi mathvariant="normal">f</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mi>p</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">i</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{L_o}(\overrightarrow{p}, \overrightarrow{\omega_o}) = \int_A \left\lparen
                                \int_{\mathrm{S}^2} \operatorname{\delta}(\overrightarrow{p&#x27;} - \overrightarrow{p})
                                \operatorname{f}(\overrightarrow{p&#x27;}, \overrightarrow{\omega_i},
                                \overrightarrow{\omega_o}) \operatorname{L_i}(\overrightarrow{p&#x27;},
                                \overrightarrow{\omega_i}) (\cos \theta_i)^+ \, d \overrightarrow{\omega_i}
                                \right\rparen \, d \operatorname{A}(\overrightarrow{p&#x27;}) \approx \frac{k}{N}
                                \frac{1}{\pi {(\operatorname{R_k}(\overrightarrow{p}))}^2} \sum_{i=1}^N
                                \int_{\mathrm{S}^2} \operatorname{f}(\overrightarrow{p}, \overrightarrow{\omega_i},
                                \overrightarrow{\omega_o}) \operatorname{L_i}(\overrightarrow{p_i},
                                \overrightarrow{\omega_i}) (\cos \theta_i)^+ \, d \overrightarrow{\omega_i}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">p</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">A</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span
                                class="mopen delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">(</span></span><span class="mop"><span
                                    class="mop op-symbol large-op"
                                    style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:-0.38952999999999993em;"><span
                                                    style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight"><span
                                                                    class="mord mathrm mtight">S</span><span
                                                                    class="msupsub"><span class="vlist-t"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.7463142857142857em;"><span
                                                                                    style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mop"><span class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                            class="vlist" style="height:1.199892em;"><span style="top:-3em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                                            class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                    style="height:0.6778919999999999em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">−</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                    class="pstrut" style="height:3em;"></span><span
                                                    class="mord mathnormal">p</span></span><span class="svg-align"
                                                style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:1.199892em;"><span
                                                style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.6778919999999999em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.151392em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">o</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                    class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.31750199999999995em;"><span
                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                            class="pstrut" style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathrm mtight">i</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:1.199892em;"><span
                                                style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.6778919999999999em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                        class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                style="height:0.821331em;"><span
                                                    style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                        style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">d</span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">)</span></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">A</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.199892em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                style="height:0.6778919999999999em;"><span
                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mtight"><span
                                                                                class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.677892em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:3.1249040000000003em;vertical-align:-1.2965680000000002em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.10903em;">N</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03148em;">k</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.11em;"><span class="pstrut"
                                                    style="height:3.156568em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span><span class="mord"><span
                                                            class="mord"><span class="mopen">(</span><span
                                                                class="mop"><span class="mord"><span
                                                                        class="mord mathrm">R</span><span
                                                                        class="msupsub"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.33610799999999996em;"><span
                                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.7em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mathrm mtight">k</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                                class="mopen">(</span><span class="mord accent"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.9525600000000001em;"><span
                                                                                style="top:-3em;"><span class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord mathnormal">p</span></span><span
                                                                                class="svg-align"
                                                                                style="top:-3.43056em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="hide-tail"
                                                                                    style="height:0.522em;min-width:0.888em;"><svg
                                                                                        width='400em' height='0.522em'
                                                                                        viewBox='0 0 400000 522'
                                                                                        preserveAspectRatio='xMaxYMin slice'>
                                                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                                                    </svg></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.19444em;"><span></span></span></span></span></span><span
                                                                class="mclose">))</span></span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:1.156568em;"><span
                                                                            style="top:-3.40546em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.386568em;"><span class="pstrut"
                                                    style="height:3.156568em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.833568em;"><span class="pstrut"
                                                    style="height:3.156568em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.2965680000000002em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.8283360000000002em;"><span
                                            style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal mtight">i</span><span
                                                        class="mrel mtight">=</span><span
                                                        class="mord mtight">1</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight"
                                                    style="margin-right:0.10903em;">N</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.277669em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.38952999999999993em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathrm mtight">S</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.7463142857142857em;"><span
                                                                                style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">p</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31750199999999995em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal">p</span><span
                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>N</mi>
                                    <mo>=</mo>
                                    <mi>k</mi>
                                    <mo>⇒</mo>
                                    <mfrac>
                                        <mi>k</mi>
                                        <mi>N</mi>
                                    </mfrac>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle N = k \Rightarrow \frac{k}{N} = 1
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.10903em;">N</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">⇒</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.10903em;">N</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03148em;">k</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span></span></span></span></eq> (the samples are exactly the k-nearest
        neighbors, namely, the number of the samples N is exactly the k), and <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">R</mi>
                                            <mi mathvariant="normal">k</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mi>p</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{R_k}(\overrightarrow{p})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">R</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">k</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.9525600000000001em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">p</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>, which is also called the radius, is the
        maximum distance between each sample position <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_i}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>
        </eq> and the shading position <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <mi>p</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">p</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>
        </eq>.
    </p>
    <h2 dir="auto" id="sppm-stochastic-progressive-photon-mapping">SPPM (Stochastic Progressive Photon Mapping)</h2>
    <p dir="auto">&quot;Equation (16.13)&quot; of <a
            href="https://pbr-book.org/3ed-2018/Light_Transport_III_Bidirectional_Methods/Stochastic_Progressive_Photon_Mapping#PhotonMapping">PBR
            Book V3</a></p>
    <p dir="auto">&quot;SPPMIntegrator::Render&quot; of <a
            href="https://github.com/mmp/pbrt-v3/blob/book/src/integrators/sppm.cpp#L424">PBRT V3</a></p>
    <h2 dir="auto" id=""></h2>
    <p dir="auto">&quot;24. Real-Time Global Illumination with Photon Mapping&quot; of <a
            href="https://www.realtimerendering.com/raytracinggems/rtg/index.html">Ray Tracing Gems</a></p>
    <p dir="auto">&quot;30. Caustics Using Screen Space Photon Mapping&quot; of <a
            href="https://www.realtimerendering.com/raytracinggems/rtg/index.html">Ray Tracing Gems</a></p>
    <p dir="auto">&quot;30. Real-Time Ray Traced Caustics&quot; of <a
            href="https://www.realtimerendering.com/raytracinggems/rtg2/index.html">Ray Tracing Gems II</a></p>
    <h2 dir="auto" id="references">References</h2>
    <p dir="auto">[Jensen 2001] <a href="http://www.graphics.stanford.edu/papers/jensen_book/">Henrik Jensen.
            &quot;Realistic Image Synthesis Using Photon Mapping.&quot; AK Peters 2001.</a><br>
        [Hachisuka 2008] <a href="http://graphics.ucsd.edu/~henrik/papers/progressive_photon_mapping/">Toshiya
            Hachisuka, Shinji Ogaki, Henrik Jensen. &quot;Progressive Photon Mapping.&quot; SIGGRAPH 2008.</a><br>
        [Hachisuka 2009] <a href="http://graphics.ucsd.edu/~henrik/papers/sppm/index.html">Toshiya Hachisuka, Henrik
            Jensen. &quot;Stochastic Progressive Photon Mapping.&quot; SIGGRAPH 2009.</a></p>

</body>

</html>