<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/default.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
</head>

<body class="markdown-body">
    <h1 dir="auto" id="ltc-linearly-transformed-cosine">LTC (Linearly Transformed Cosine)</h1>
    <h2 dir="auto" id="1-clamped-cosine-integral">1. Clamped Cosine Integral</h2>
    <h3 dir="auto" id="1-1-clamped-cosine">1-1. Clamped Cosine</h3>
    <p dir="auto">We assume that the normal direction in the tangent space is (0, 0, 1), which is called the
        <strong>Median Vector</strong> in [Heitz 2016]. The <strong>clamped cosine</strong> is defined as <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mrow>
                                            <mo stretchy="false">(</mo>
                                            <mn>0</mn>
                                            <mo separator="true">,</mo>
                                            <mn>0</mn>
                                            <mo separator="true">,</mo>
                                            <mn>1</mn>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>⋅</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mi>max</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>0</mn>
                                    <mo separator="true">,</mo>
                                    <mi>z</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D_o}(\omega_o) =
                                \frac{1}{\pi} (\cos \theta_o)^+ = \frac{1}{\pi} (\overrightarrow{(0,0,1)} \cdot
                                \overrightarrow{\omega_o})^+ = \frac{1}{\pi} \max(0, z)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span
                            class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.272em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mopen">(</span><span class="mord">0</span><span
                                                    class="mpunct">,</span><span class="mspace"
                                                    style="margin-right:0.16666666666666666em;"></span><span
                                                    class="mord">0</span><span class="mpunct">,</span><span
                                                    class="mspace"
                                                    style="margin-right:0.16666666666666666em;"></span><span
                                                    class="mord">1</span><span
                                                    class="mclose">)</span></span></span><span class="svg-align"
                                            style="top:-3.75em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg
                                                    width='400em' height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.25em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">max</span><span
                            class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal" style="margin-right:0.04398em;">z</span><span
                            class="mclose">)</span></span></span></span></eq> where <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>=</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>x</mi>
                                    <mo separator="true">,</mo>
                                    <mi>y</mi>
                                    <mo separator="true">,</mo>
                                    <mi>z</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{\omega_o} = (x, y, z)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mopen">(</span><span class="mord mathnormal">x</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span>
        </eq>. Evidently, by &quot;Figure 5.13&quot; of <a
            href="https://pbr-book.org/3ed-2018/Color_and_Radiometry/Working_with_Radiometric_Integrals#IntegralsoverProjectedSolidAngle">PBR
            Book</a>, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mn>1</mn>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msubsup>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                        <mo lspace="0em" rspace="0em">⊥</mo>
                                    </msubsup>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <mi>π</mi>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_\Omega \operatorname{D_o} \,
                                d\omega_o = \frac{1}{\pi} \int_\Omega (\cos \theta_o)^+ \, d\omega_o = \frac{1}{\pi}
                                \int_\Omega 1 \, d\omega_o^{\perp} = \frac{1}{\pi} \cdot \pi = 1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord">1</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.8991079999999998em;"><span
                                                style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mrel mtight">⊥</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.247em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span></span></span></span></eq>, and thus <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D_o}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
        </eq> is normalized.</p>
    <h3 dir="auto" id="1-2-integral-over-the-polygon">1-2. Integral over the Polygon</h3>
    <p dir="auto">We assume that the vertices <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mn>1</mn>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mn>2</mn>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mo>…</mo>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>n</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_1},
                                \overrightarrow{p_2}, \ldots, \overrightarrow{p_n}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.30110799999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mtight">1</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.30110799999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mtight">2</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">n</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>
        </eq> of the polygon <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle P_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> are in the tangent space, normalized, and located in the upper hemisphere. By [Heitz 2017], the clamped
        cosine integral over the polygon <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>P</mi>
                                            <mi>o</mi>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{F}(P_o) = \int_{P_o}
                                \operatorname{D_o} \, d\omega_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.3720499999999998em;vertical-align:-1.01205em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000004em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">P</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.01205em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is closed-form <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mrow>
                                            <mn>2</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </mfrac>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mtext> </mtext>
                                            <mi>j</mi>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                    <mi>arccos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>⋅</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>j</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">normalize</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>×</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>j</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mover accent="true">
                                        <mrow>
                                            <mo stretchy="false">(</mo>
                                            <mn>0</mn>
                                            <mo separator="true">,</mo>
                                            <mn>0</mn>
                                            <mo separator="true">,</mo>
                                            <mn>1</mn>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{F}(P_o) =
                                \frac{1}{2\pi} \sum_{i \, j}^n \arccos(\overrightarrow{p_i} \cdot \overrightarrow{p_j})
                                (\operatorname{normalize}(\overrightarrow{p_i} \times \overrightarrow{p_j}) \cdot
                                \overrightarrow{(0, 0, 1)})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">2</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.6513970000000007em;"><span
                                            style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal mtight">i</span><span
                                                        class="mspace mtight"
                                                        style="margin-right:0.19516666666666668em;"></span><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">n</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.4137769999999998em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mop">arccos</span><span class="mopen">(</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.238668em;vertical-align:-0.286108em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.311664em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.05724em;">j</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.286108em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.286108em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">normalize</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">×</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.238668em;vertical-align:-0.286108em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.311664em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.05724em;">j</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.286108em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.286108em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1.522em;vertical-align:-0.25em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.272em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mopen">(</span><span class="mord">0</span><span
                                                    class="mpunct">,</span><span class="mspace"
                                                    style="margin-right:0.16666666666666666em;"></span><span
                                                    class="mord">0</span><span class="mpunct">,</span><span
                                                    class="mspace"
                                                    style="margin-right:0.16666666666666666em;"></span><span
                                                    class="mord">1</span><span
                                                    class="mclose">)</span></span></span><span class="svg-align"
                                            style="top:-3.75em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg
                                                    width='400em' height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.25em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>. Note that the <strong>winding
            order</strong> of the vertices implies the direction of the resulting vector <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>×</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>j</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \overrightarrow{p_i} \times
                                \overrightarrow{p_j}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.147em;vertical-align:-0.19444em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">×</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.238668em;vertical-align:-0.286108em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.311664em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.05724em;">j</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.286108em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.286108em;"><span></span></span></span></span></span></span></span></span>
        </eq> and thus the facing of the polygon.<br>
        Actually, the clamped cosine integral over the polygon <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{F}(P_o)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is called the <strong>form
            factor</strong>. The terms <strong>irradiance</strong> and <strong>form factor</strong> may be
        interchangeably used. But technically, the <strong>irradiance</strong> should NOT be divided by <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>π</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \pi</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span></span></span></span></eq>. This means that <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi>π</mi>
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{E}(P_o) = \pi
                                \operatorname{F}(P_o)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">E</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.</p>
    <p dir="auto">However, the assumption, that the vertices are in the upper hemisphere, forces us to clip the polygon.
        This introduces <a
            href="https://docs.nvidia.com/gameworks/content/developertools/desktop/analysis/report/cudaexperiments/sourcelevel/divergentbranch.htm">divergent
            branches</a> which should ideally be avoided.</p>
    <p dir="auto">Actually, by [Snyder 1996], the integral over the sphere can be calculated without clipping as <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>F</mi>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mrow>
                                        <mo fence="true">{</mo>
                                        <mtable rowspacing="0.3600em" columnalign="left left" columnspacing="1em">
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mstyle scriptlevel="0" displaystyle="true">
                                                            <mi>π</mi>
                                                            <mi>cos</mi>
                                                            <mo>⁡</mo>
                                                            <mi>ω</mi>
                                                            <msup>
                                                                <mrow>
                                                                    <mi>sin</mi>
                                                                    <mo>⁡</mo>
                                                                </mrow>
                                                                <mn>2</mn>
                                                            </msup>
                                                            <mi>σ</mi>
                                                        </mstyle>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mstyle scriptlevel="0" displaystyle="true">
                                                            <mi>ω</mi>
                                                            <mo>∈</mo>
                                                            <mo stretchy="false">[</mo>
                                                            <mn>0</mn>
                                                            <mo separator="true">,</mo>
                                                            <mfrac>
                                                                <mi>π</mi>
                                                                <mn>2</mn>
                                                            </mfrac>
                                                            <mo>−</mo>
                                                            <mi>σ</mi>
                                                            <mo stretchy="false">]</mo>
                                                        </mstyle>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mstyle scriptlevel="0" displaystyle="true">
                                                            <mi>π</mi>
                                                            <mi>cos</mi>
                                                            <mo>⁡</mo>
                                                            <mi>ω</mi>
                                                            <msup>
                                                                <mrow>
                                                                    <mi>sin</mi>
                                                                    <mo>⁡</mo>
                                                                </mrow>
                                                                <mn>2</mn>
                                                            </msup>
                                                            <mi>σ</mi>
                                                            <mo>+</mo>
                                                            <mi mathvariant="normal">G</mi>
                                                            <mo>⁡</mo>
                                                            <mo stretchy="false">(</mo>
                                                            <mi>ω</mi>
                                                            <mo separator="true">,</mo>
                                                            <mi>σ</mi>
                                                            <mo separator="true">,</mo>
                                                            <mi>γ</mi>
                                                            <mo stretchy="false">)</mo>
                                                            <mo>−</mo>
                                                            <mi mathvariant="normal">H</mi>
                                                            <mo>⁡</mo>
                                                            <mo stretchy="false">(</mo>
                                                            <mi>ω</mi>
                                                            <mo separator="true">,</mo>
                                                            <mi>σ</mi>
                                                            <mo separator="true">,</mo>
                                                            <mi>γ</mi>
                                                            <mo stretchy="false">)</mo>
                                                        </mstyle>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mstyle scriptlevel="0" displaystyle="true">
                                                            <mi>ω</mi>
                                                            <mo>∈</mo>
                                                            <mo stretchy="false">[</mo>
                                                            <mfrac>
                                                                <mi>π</mi>
                                                                <mn>2</mn>
                                                            </mfrac>
                                                            <mo>−</mo>
                                                            <mi>σ</mi>
                                                            <mo separator="true">,</mo>
                                                            <mfrac>
                                                                <mi>π</mi>
                                                                <mn>2</mn>
                                                            </mfrac>
                                                            <mo stretchy="false">]</mo>
                                                        </mstyle>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mrow>
                                                            <mi mathvariant="normal">G</mi>
                                                            <mo>⁡</mo>
                                                            <mo stretchy="false">(</mo>
                                                            <mi>ω</mi>
                                                            <mo separator="true">,</mo>
                                                            <mi>σ</mi>
                                                            <mo separator="true">,</mo>
                                                            <mi>γ</mi>
                                                            <mo stretchy="false">)</mo>
                                                            <mo>−</mo>
                                                            <mi mathvariant="normal">H</mi>
                                                            <mo>⁡</mo>
                                                            <mo stretchy="false">(</mo>
                                                            <mi>ω</mi>
                                                            <mo separator="true">,</mo>
                                                            <mi>σ</mi>
                                                            <mo separator="true">,</mo>
                                                            <mi>γ</mi>
                                                            <mo stretchy="false">)</mo>
                                                        </mrow>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mstyle scriptlevel="0" displaystyle="true">
                                                            <mi>ω</mi>
                                                            <mo>∈</mo>
                                                            <mo stretchy="false">[</mo>
                                                            <mfrac>
                                                                <mi>π</mi>
                                                                <mn>2</mn>
                                                            </mfrac>
                                                            <mo separator="true">,</mo>
                                                            <mfrac>
                                                                <mi>π</mi>
                                                                <mn>2</mn>
                                                            </mfrac>
                                                            <mo>+</mo>
                                                            <mi>σ</mi>
                                                            <mo stretchy="false">]</mo>
                                                        </mstyle>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mn>0</mn>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mrow>
                                                            <mi>ω</mi>
                                                            <mo>∈</mo>
                                                            <mo stretchy="false">[</mo>
                                                            <mfrac>
                                                                <mi>π</mi>
                                                                <mn>2</mn>
                                                            </mfrac>
                                                            <mo>+</mo>
                                                            <mi>σ</mi>
                                                            <mo separator="true">,</mo>
                                                            <mi>π</mi>
                                                            <mo stretchy="false">]</mo>
                                                        </mrow>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                        </mtable>
                                    </mrow>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle F = \frac{1}{\pi} {\begin{cases}
                                {\displaystyle \pi \cos \omega \sin^2 \sigma} &amp;{\displaystyle \omega \isin [0,
                                \frac{\pi}{2} - \sigma]} \\{\displaystyle \pi \cos \omega \sin^2 \sigma +
                                \operatorname{G}(\omega, \sigma, \gamma) - \operatorname{H}(\omega, \sigma, \gamma)}
                                &amp;{\displaystyle \omega \isin [\frac{\pi}{2} - \sigma, \frac{\pi}{2}]}
                                \\{\operatorname{G}(\omega, \sigma, \gamma) - \operatorname{H}(\omega, \sigma, \gamma)}
                                &amp;{\displaystyle \omega \isin [\frac{\pi}{2}, \frac{\pi}{2} + \sigma]} \\{0}
                                &amp;{\omega \isin [\frac{\pi}{2} + \sigma, {\pi}]} \end{cases}}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.13889em;">F</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:6.820680000000001em;vertical-align:-3.16034em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord"><span class="minner"><span
                                    class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span
                                                class="vlist-r"><span class="vlist" style="height:3.55002em;"><span
                                                        style="top:-1.36599em;"><span class="pstrut"
                                                            style="height:3.516em;"></span><span
                                                            class="delimsizinginner delim-size4"><span>⎩</span></span></span><span
                                                        style="top:-1.35799em;"><span class="pstrut"
                                                            style="height:3.516em;"></span><span
                                                            style="height:1.516em;width:0.889em;"><svg width='0.889em'
                                                                height='1.516em' style='width:0.889em'
                                                                viewBox='0 0 889 1516' preserveAspectRatio='xMinYMin'>
                                                                <path
                                                                    d='M384 0 H504 V1516 H384z M384 0 H504 V1516 H384z' />
                                                            </svg></span></span><span style="top:-3.51601em;"><span
                                                            class="pstrut" style="height:3.516em;"></span><span
                                                            class="delimsizinginner delim-size4"><span>⎨</span></span></span><span
                                                        style="top:-4.65801em;"><span class="pstrut"
                                                            style="height:3.516em;"></span><span
                                                            style="height:1.516em;width:0.889em;"><svg width='0.889em'
                                                                height='1.516em' style='width:0.889em'
                                                                viewBox='0 0 889 1516' preserveAspectRatio='xMinYMin'>
                                                                <path
                                                                    d='M384 0 H504 V1516 H384z M384 0 H504 V1516 H384z' />
                                                            </svg></span></span><span style="top:-6.16602em;"><span
                                                            class="pstrut" style="height:3.516em;"></span><span
                                                            class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:3.05002em;"><span></span></span></span></span></span></span><span
                                    class="mord"><span class="mtable"><span class="col-align-l"><span
                                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                        style="height:3.6603400000000006em;"><span
                                                            style="top:-5.660340000000001em;"><span class="pstrut"
                                                                style="height:3.1075600000000003em;"></span><span
                                                                class="mord"><span class="mord"><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">π</span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mop">cos</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">ω</span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mop"><span class="mop">sin</span><span
                                                                            class="msupsub"><span class="vlist-t"><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.871868em;"><span
                                                                                            style="top:-3.12076em;margin-right:0.05em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:2.7em;"></span><span
                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">σ</span></span></span></span><span
                                                            style="top:-3.8667800000000003em;"><span class="pstrut"
                                                                style="height:3.1075600000000003em;"></span><span
                                                                class="mord"><span class="mord"><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">π</span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mop">cos</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">ω</span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mop"><span class="mop">sin</span><span
                                                                            class="msupsub"><span class="vlist-t"><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.871868em;"><span
                                                                                            style="top:-3.12076em;margin-right:0.05em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:2.7em;"></span><span
                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">σ</span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mbin">+</span><span class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mop"><span
                                                                            class="mord mathrm">G</span></span><span
                                                                        class="mopen">(</span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">ω</span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">σ</span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.05556em;">γ</span><span
                                                                        class="mclose">)</span><span class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mbin">−</span><span class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mop"><span
                                                                            class="mord mathrm">H</span></span><span
                                                                        class="mopen">(</span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">ω</span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">σ</span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.05556em;">γ</span><span
                                                                        class="mclose">)</span></span></span></span><span
                                                            style="top:-2.07322em;"><span class="pstrut"
                                                                style="height:3.1075600000000003em;"></span><span
                                                                class="mord"><span class="mord"><span class="mop"><span
                                                                            class="mord mathrm">G</span></span><span
                                                                        class="mopen">(</span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">ω</span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">σ</span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.05556em;">γ</span><span
                                                                        class="mclose">)</span><span class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mbin">−</span><span class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mop"><span
                                                                            class="mord mathrm">H</span></span><span
                                                                        class="mopen">(</span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">ω</span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">σ</span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.05556em;">γ</span><span
                                                                        class="mclose">)</span></span></span></span><span
                                                            style="top:-0.3792200000000002em;"><span class="pstrut"
                                                                style="height:3.1075600000000003em;"></span><span
                                                                class="mord"><span class="mord"><span
                                                                        class="mord">0</span></span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:3.16034em;"><span></span></span></span></span></span><span
                                            class="arraycolsep" style="width:1em;"></span><span
                                            class="col-align-l"><span class="vlist-t vlist-t2"><span
                                                    class="vlist-r"><span class="vlist"
                                                        style="height:3.6603400000000006em;"><span
                                                            style="top:-5.660340000000001em;"><span class="pstrut"
                                                                style="height:3.1075600000000003em;"></span><span
                                                                class="mord"><span class="mord"><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">ω</span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                                        class="mrel">∈</span><span class="mspace"
                                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                                        class="mopen">[</span><span
                                                                        class="mord">0</span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord"><span
                                                                            class="mopen nulldelimiter"></span><span
                                                                            class="mfrac"><span
                                                                                class="vlist-t vlist-t2"><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:1.10756em;"><span
                                                                                            style="top:-2.314em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="mord"><span
                                                                                                    class="mord">2</span></span></span><span
                                                                                            style="top:-3.23em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="frac-line"
                                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                                            style="top:-3.677em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="mord"><span
                                                                                                    class="mord mathnormal"
                                                                                                    style="margin-right:0.03588em;">π</span></span></span></span><span
                                                                                        class="vlist-s">​</span></span><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.686em;"><span></span></span></span></span></span><span
                                                                            class="mclose nulldelimiter"></span></span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mbin">−</span><span class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">σ</span><span
                                                                        class="mclose">]</span></span></span></span><span
                                                            style="top:-3.8667800000000003em;"><span class="pstrut"
                                                                style="height:3.1075600000000003em;"></span><span
                                                                class="mord"><span class="mord"><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">ω</span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                                        class="mrel">∈</span><span class="mspace"
                                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                                        class="mopen">[</span><span class="mord"><span
                                                                            class="mopen nulldelimiter"></span><span
                                                                            class="mfrac"><span
                                                                                class="vlist-t vlist-t2"><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:1.10756em;"><span
                                                                                            style="top:-2.314em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="mord"><span
                                                                                                    class="mord">2</span></span></span><span
                                                                                            style="top:-3.23em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="frac-line"
                                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                                            style="top:-3.677em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="mord"><span
                                                                                                    class="mord mathnormal"
                                                                                                    style="margin-right:0.03588em;">π</span></span></span></span><span
                                                                                        class="vlist-s">​</span></span><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.686em;"><span></span></span></span></span></span><span
                                                                            class="mclose nulldelimiter"></span></span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mbin">−</span><span class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">σ</span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord"><span
                                                                            class="mopen nulldelimiter"></span><span
                                                                            class="mfrac"><span
                                                                                class="vlist-t vlist-t2"><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:1.10756em;"><span
                                                                                            style="top:-2.314em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="mord"><span
                                                                                                    class="mord">2</span></span></span><span
                                                                                            style="top:-3.23em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="frac-line"
                                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                                            style="top:-3.677em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="mord"><span
                                                                                                    class="mord mathnormal"
                                                                                                    style="margin-right:0.03588em;">π</span></span></span></span><span
                                                                                        class="vlist-s">​</span></span><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.686em;"><span></span></span></span></span></span><span
                                                                            class="mclose nulldelimiter"></span></span><span
                                                                        class="mclose">]</span></span></span></span><span
                                                            style="top:-2.07322em;"><span class="pstrut"
                                                                style="height:3.1075600000000003em;"></span><span
                                                                class="mord"><span class="mord"><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">ω</span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                                        class="mrel">∈</span><span class="mspace"
                                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                                        class="mopen">[</span><span class="mord"><span
                                                                            class="mopen nulldelimiter"></span><span
                                                                            class="mfrac"><span
                                                                                class="vlist-t vlist-t2"><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:1.10756em;"><span
                                                                                            style="top:-2.314em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="mord"><span
                                                                                                    class="mord">2</span></span></span><span
                                                                                            style="top:-3.23em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="frac-line"
                                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                                            style="top:-3.677em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="mord"><span
                                                                                                    class="mord mathnormal"
                                                                                                    style="margin-right:0.03588em;">π</span></span></span></span><span
                                                                                        class="vlist-s">​</span></span><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.686em;"><span></span></span></span></span></span><span
                                                                            class="mclose nulldelimiter"></span></span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord"><span
                                                                            class="mopen nulldelimiter"></span><span
                                                                            class="mfrac"><span
                                                                                class="vlist-t vlist-t2"><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:1.10756em;"><span
                                                                                            style="top:-2.314em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="mord"><span
                                                                                                    class="mord">2</span></span></span><span
                                                                                            style="top:-3.23em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="frac-line"
                                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                                            style="top:-3.677em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="mord"><span
                                                                                                    class="mord mathnormal"
                                                                                                    style="margin-right:0.03588em;">π</span></span></span></span><span
                                                                                        class="vlist-s">​</span></span><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.686em;"><span></span></span></span></span></span><span
                                                                            class="mclose nulldelimiter"></span></span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mbin">+</span><span class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">σ</span><span
                                                                        class="mclose">]</span></span></span></span><span
                                                            style="top:-0.3792200000000002em;"><span class="pstrut"
                                                                style="height:3.1075600000000003em;"></span><span
                                                                class="mord"><span class="mord"><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">ω</span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                                        class="mrel">∈</span><span class="mspace"
                                                                        style="margin-right:0.2777777777777778em;"></span><span
                                                                        class="mopen">[</span><span class="mord"><span
                                                                            class="mopen nulldelimiter"></span><span
                                                                            class="mfrac"><span
                                                                                class="vlist-t vlist-t2"><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.695392em;"><span
                                                                                            style="top:-2.6550000000000002em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                    class="mord mtight"><span
                                                                                                        class="mord mtight">2</span></span></span></span><span
                                                                                            style="top:-3.23em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="frac-line"
                                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                                            style="top:-3.394em;"><span
                                                                                                class="pstrut"
                                                                                                style="height:3em;"></span><span
                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                    class="mord mtight"><span
                                                                                                        class="mord mathnormal mtight"
                                                                                                        style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                                                                        class="vlist-s">​</span></span><span
                                                                                    class="vlist-r"><span class="vlist"
                                                                                        style="height:0.345em;"><span></span></span></span></span></span><span
                                                                            class="mclose nulldelimiter"></span></span><span
                                                                        class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mbin">+</span><span class="mspace"
                                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                                        class="mord mathnormal"
                                                                        style="margin-right:0.03588em;">σ</span><span
                                                                        class="mpunct">,</span><span class="mspace"
                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                        class="mord"><span class="mord mathnormal"
                                                                            style="margin-right:0.03588em;">π</span></span><span
                                                                        class="mclose">]</span></span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:3.16034em;"><span></span></span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></span></eq> where
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>ω</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span></span></span></span></eq> is the <strong>elevation
            angle</strong> and <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>σ</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \sigma</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">σ</span></span></span></span></eq> is the <strong>angular
            extent</strong>. Evidently, this formulation can precomputed and stored in a 2D LUT which is indexed by <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mi>ω</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \cos \omega</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span></eq>
        and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>sin</mi>
                                    <mo>⁡</mo>
                                    <mi>σ</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \sin \sigma</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.66786em;vertical-align:0em;"></span><span class="mop">sin</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></eq>.
        And by [Stephen 2016], using the linear fit, this formulation can be approximated by <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>F</mi>
                                    <mo>=</mo>
                                    <msup>
                                        <mrow>
                                            <mi>sin</mi>
                                            <mo>⁡</mo>
                                        </mrow>
                                        <mn>2</mn>
                                    </msup>
                                    <mi>σ</mi>
                                    <mfrac>
                                        <mrow>
                                            <msup>
                                                <mrow>
                                                    <mi>sin</mi>
                                                    <mo>⁡</mo>
                                                </mrow>
                                                <mn>2</mn>
                                            </msup>
                                            <mi>σ</mi>
                                            <mo>+</mo>
                                            <mi>cos</mi>
                                            <mo>⁡</mo>
                                            <mi>ω</mi>
                                        </mrow>
                                        <mrow>
                                            <msup>
                                                <mrow>
                                                    <mi>sin</mi>
                                                    <mo>⁡</mo>
                                                </mrow>
                                                <mn>2</mn>
                                            </msup>
                                            <mi>σ</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle F = \sin^2 \sigma \frac{\sin^2 \sigma
                                + \cos \omega}{\sin^2 \sigma + 1}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.13889em;">F</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.394066em;vertical-align:-0.845198em;"></span><span class="mop"><span
                                class="mop">sin</span><span class="msupsub"><span class="vlist-t"><span
                                        class="vlist-r"><span class="vlist" style="height:0.871868em;"><span
                                                style="top:-3.12076em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.5488680000000001em;"><span
                                                style="top:-2.2381320000000002em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mop">sin</span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.871868em;"><span
                                                                            style="top:-3.12076em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">σ</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">+</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord">1</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mop">sin</span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.871868em;"><span
                                                                            style="top:-3.12076em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">σ</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">+</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mop">cos</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.845198em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>. Evidently, this
        approximation can be calculated in real time.<br>
        The integral over the sphere is calcualted by the <a
            href="https://github.com/selfshadow/ltc_code/blob/master/fit/fitLTC.cpp#L307">genSphereTab</a> in the WebGL
        Demo provided by [Stephen 2016], <a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/Lit/Lit.hlsl#L1630">PolygonIrradianceFromVectorFormFactor</a>
        in Unity3D, and <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/CapsuleLight.ush#L95">SphereHorizonCosWrap</a>
        in UE4.</p>
    <p dir="auto">By [Stephen 2016], the <strong>vector form factor</strong> over the polygon can be calculated as <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mover accent="true">
                                        <mi mathvariant="normal">F</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mrow>
                                            <mn>2</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </mfrac>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mtext> </mtext>
                                            <mi>j</mi>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                    <mi>arccos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>⋅</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>j</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">normalize</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>×</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>p</mi>
                                            <mi>j</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \overrightarrow{\operatorname{F}}(P_o) = \frac{1}{2\pi} \sum_{i \, j}^n
                                \arccos(\overrightarrow{p_i} \cdot \overrightarrow{p_j})
                                \operatorname{normalize}(\overrightarrow{p_i} \times \overrightarrow{p_j})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.45533em;vertical-align:-0.25em;"></span><span class="mord accent"><span
                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:1.20533em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mop"><span
                                                    class="mord mathrm">F</span></span></span><span class="svg-align"
                                            style="top:-3.6833299999999998em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.13889em;">P</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">2</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.6513970000000007em;"><span
                                            style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal mtight">i</span><span
                                                        class="mspace mtight"
                                                        style="margin-right:0.19516666666666668em;"></span><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">n</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.4137769999999998em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mop">arccos</span><span class="mopen">(</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.238668em;vertical-align:-0.286108em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.311664em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.05724em;">j</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.286108em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.286108em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">normalize</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.19444em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">×</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.238668em;vertical-align:-0.286108em;"></span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal">p</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.311664em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.05724em;">j</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.286108em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.286108em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> even if the vertices are NOT in the upper
        hemisphere. The term <strong>vector form factor</strong> is analogous to the term <strong>vector
            irradiance</strong> of which the direction is the direction where a flat surface can receive the highest
        irradiance.<br>
        And the vector form factor over the sphere is the vector of which the direction is towards the center of the
        sphere and the length is <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>F</mi>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mrow>
                                            <mn>2</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </msubsup>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi>α</mi>
                                    </msubsup>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mi>θ</mi>
                                    <mi>sin</mi>
                                    <mo>⁡</mo>
                                    <mi>θ</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>θ</mi>
                                    <mi>d</mi>
                                    <mi>ϕ</mi>
                                    <mo>=</mo>
                                    <msup>
                                        <mrow>
                                            <mi>sin</mi>
                                            <mo>⁡</mo>
                                        </mrow>
                                        <mn>2</mn>
                                    </msup>
                                    <mo stretchy="false">(</mo>
                                    <mi>σ</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle F = \frac{1}{\pi} \int_0^{2\pi}
                                \int_0^\alpha \cos \theta \sin \theta \, d \theta d \phi = \sin^2(\sigma)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.13889em;">F</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.5640080000000003em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">2</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.0037em;">α</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal">ϕ</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1.121868em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mop">sin</span><span class="msupsub"><span class="vlist-t"><span
                                        class="vlist-r"><span class="vlist" style="height:0.871868em;"><span
                                                style="top:-3.12076em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">σ</span><span class="mclose">)</span></span></span></span>
        </eq> where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>σ</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \sigma</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">σ</span></span></span></span></eq> is the angular extent.
        Thus, a proxy sphere with the same vector form factor can be introduced. This proxy sphere can be used to
        calculate the integral over the polygon without clipping according to the formulation by [Snyder 1996].<br>
        The clamped cosine integral over the polygon <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{F}(P_o)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">F</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is calculated by the <a
            href="https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_quad.fs#L274">LTC_Evaluate</a>
        in the WebGL Demo provided by [Stephen 2016], <a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/Lit/Lit.hlsl#L1764">EvaluateBSDF_Rect</a>
        in Unity3D, and <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/RectLight.ush#L108">RectIrradianceLambert</a>
        and <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/RectLight.ush#L442">RectGGXApproxLTC</a>
        in UE4.</p>
    <h2 dir="auto" id="2-ltc">2. LTC</h2>
    <h3 dir="auto" id="2-1-ltsd">2-1. LTSD</h3>
    <p dir="auto">We assume that M is the linear transform matrix, and <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">normalize</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>M</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega = \operatorname{normalize}(M
                                \omega_o)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">normalize</span></span><span
                            class="mopen">(</span><span class="mord mathnormal"
                            style="margin-right:0.10903em;">M</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>. For the arbitrary <strong>original
            distribution</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D_o}(\omega_o)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>, the corresponding <strong>LTSD (linearly
            transformed spherical distribution)</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\omega)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span></span></span></span></eq> is defined as <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi>d</mi>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </mrow>
                                        <mrow>
                                            <mi>d</mi>
                                            <mi>ω</mi>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\omega) =
                                \operatorname{D_o}(\omega_o) \frac{d\omega_o}{d\omega}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>. Evidently, we
        have <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">normalize</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega_o =
                                \operatorname{normalize}(M^{-1} \omega)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">normalize</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.10903em;">M</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span></span></span></span></eq>. And the relationship between <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.84444em;vertical-align:-0.15em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span></span></span></span></eq> is closed-form <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mrow>
                                            <mi>d</mi>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </mrow>
                                        <mrow>
                                            <mi>d</mi>
                                            <mi>ω</mi>
                                        </mrow>
                                    </mfrac>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">∣</mi>
                                            <msup>
                                                <mi>M</mi>
                                                <mrow>
                                                    <mo>−</mo>
                                                    <mn>1</mn>
                                                </mrow>
                                            </msup>
                                            <mi mathvariant="normal">∣</mi>
                                        </mrow>
                                        <msup>
                                            <mrow>
                                                <mi mathvariant="normal">∥</mi>
                                                <msup>
                                                    <mi>M</mi>
                                                    <mrow>
                                                        <mo>−</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msup>
                                                <mi>w</mi>
                                                <mi mathvariant="normal">∥</mi>
                                            </mrow>
                                            <mn>3</mn>
                                        </msup>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \frac{d\omega_o}{d\omega} =
                                \frac{|M^{-1}|}{{\|M^{-1}w\|}^3}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.585116em;vertical-align:-1.094008em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.491108em;"><span style="top:-2.155992em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord"><span class="mord">∥</span><span
                                                                class="mord"><span class="mord mathnormal"
                                                                    style="margin-right:0.10903em;">M</span><span
                                                                    class="msupsub"><span class="vlist-t"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.740108em;"><span
                                                                                    style="top:-2.989em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mtight">−</span><span
                                                                                                class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                                class="mord mathnormal"
                                                                style="margin-right:0.02691em;">w</span><span
                                                                class="mord">∥</span></span><span class="msupsub"><span
                                                                class="vlist-t"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.954008em;"><span
                                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">∣</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.10903em;">M</span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.8141079999999999em;"><span
                                                                            style="top:-3.063em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">−</span><span
                                                                                        class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                        class="mord">∣</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.094008em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>. The proof of this
        closed-form formula is provided in &quot;Appendix A&quot; of [Heitz 2016]. Note that <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>ω</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span></span></span></span></eq> are
        <strong>vectors</strong> which represent the <strong>direction</strong>, while <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.84444em;vertical-align:-0.15em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span></span></span></span></eq> are <strong>solid
            angles</strong> which represent the <strong>area</strong> on the <strong>sphere surface</strong>. By
        &quot;Equation (5.6)&quot; of <a
            href="https://pbr-book.org/3ed-2018/Color_and_Radiometry/Working_with_Radiometric_Integrals#IntegralsoverArea">PBR
            Book</a>, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mo stretchy="false">(</mo>
                                            <mi>A</mi>
                                            <mi>d</mi>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                            <mi>cos</mi>
                                            <mo>⁡</mo>
                                            <mi>θ</mi>
                                        </mrow>
                                        <msup>
                                            <mi>r</mi>
                                            <mn>2</mn>
                                        </msup>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega = \frac{(A d\omega_o)
                                \cos\theta}{r^2}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">r</span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.740108em;"><span
                                                                            style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mopen">(</span><span
                                                        class="mord mathnormal">A</span><span
                                                        class="mord mathnormal">d</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                        class="mclose">)</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mop">cos</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq> where the A is the
        ratio, and the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>A</mi>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle A d\omega_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.84444em;vertical-align:-0.15em;"></span><span
                            class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is the area subtended by the solid angle <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span></span></span></span></eq>.
    </p>
    <h3 dir="auto" id="2-2-ltc">2-2. LTC</h3>
    <p dir="auto">When the <strong>clamped cosine</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D_o}(\omega_o) =
                                \frac{1}{\pi} (\cos \theta_o)^+</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span
                            class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>
        </eq> is used as the <strong>original distribution</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D_o}(\omega_o)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>, the corresponding <strong>LTSD (linearly
            transformed spherical distribution)</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\omega)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span></span></span></span></eq> is called the <strong>LTC (linearly
            transformed cosine)</strong>.
    </p>
    <h3 dir="auto" id="2-3-shading-with-constant-polygonal-lights">2-3. Shading with Constant Polygonal Lights</h3>
    <p dir="auto">When the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_l}(\omega_l)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">l</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is assumed to be constant <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>L</mi>
                                        <mi>l</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle L_l</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">v</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>P</mi>
                                    </msub>
                                    <mi mathvariant="normal">BRDF</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mi>L</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>P</mi>
                                    </msub>
                                    <mi mathvariant="normal">BRDF</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_v}(\omega_v) =
                                \int_{P} \operatorname{BRDF}(\omega_v, \omega_l) \operatorname{L_l}(\omega_l) |\cos
                                \theta_l| \, d\omega_l = L_l \int_{P} \operatorname{BRDF}(\omega_v, \omega_l) |\cos
                                \theta_l| \, d\omega_l</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight"
                                                            style="margin-right:0.01389em;">v</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">BRDF</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">l</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">BRDF</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.</p>
    <h2 dir="auto" id="3-approximation">3. Approximation</h2>
    <h3 dir="auto" id="3-1-approximation-ggx">3-1. Approximation GGX</h3>
    <p dir="auto">By the &quot;Equation (5.9)&quot; of the <a
            href="https://pbr-book.org/3ed-2018/Color_and_Radiometry/Surface_Reflection#TheBRDF">PBR Book</a>, we have
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">v</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>P</mi>
                                    </msub>
                                    <mi mathvariant="normal">f</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_v}(\omega_v) =
                                \int_{P} \operatorname{f}(\omega_v, \omega_l) \operatorname{L_l}(\omega_l) (\cos
                                \theta_l)^+ \, d\omega_l</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight"
                                                            style="margin-right:0.01389em;">v</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">l</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>. And we use <strong>non-linear optimization</strong> to approximate the BRDF cosine by LTC. The <a
            href="https://github.com/selfshadow/ltc_code/blob/master/fit/fitLTC.cpp">fitting</a> code</p>
    <h3 dir="auto" id="3-1-lut-uv">3-1. LUT UV</h3>
    <p dir="auto">Since the GGX BRDF is isotropic, the distribution can be determined by the outgoing direction <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega_v</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and the roughness <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>α</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \alpha</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.0037em;">α</span></span></span></span></eq>, which are used as the UV
        of the LUTs.</p>
    <h3 dir="auto" id="3-2-tangent-space">3-2. Tangent Space</h3>
    <p dir="auto">Note that the LUTs are precomputed by assuming that the vectors are in the tangent space where the
        normal direction is assumed to be the Z axis (0, 0, 1), and since the GGX BRDF is isotropic, the outgoing
        direction <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega_v</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is assumed to be in the XOZ plane. Thus, the vectors should be transformed to this tangent space before
        the approximation is applied.</p>
    <h3 dir="auto" id="3-3-lut-m">3-3. LUT M</h3>
    <p dir="auto">Actually, when M is the scaling transformation <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>M</mi>
                                    <mo>=</mo>
                                    <mi>λ</mi>
                                    <mi>I</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle M = \lambda I</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.10903em;">M</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">λ</span><span class="mord mathnormal"
                            style="margin-right:0.07847em;">I</span></span></span></span></eq>, we have <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mrow>
                                            <mi>d</mi>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </mrow>
                                        <mrow>
                                            <mi>d</mi>
                                            <mi>ω</mi>
                                        </mrow>
                                    </mfrac>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">∣</mi>
                                            <msup>
                                                <mi>M</mi>
                                                <mrow>
                                                    <mo>−</mo>
                                                    <mn>1</mn>
                                                </mrow>
                                            </msup>
                                            <mi mathvariant="normal">∣</mi>
                                        </mrow>
                                        <msup>
                                            <mrow>
                                                <mi mathvariant="normal">∥</mi>
                                                <msup>
                                                    <mi>M</mi>
                                                    <mrow>
                                                        <mo>−</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msup>
                                                <mi>w</mi>
                                                <mi mathvariant="normal">∥</mi>
                                            </mrow>
                                            <mn>3</mn>
                                        </msup>
                                    </mfrac>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mfrac>
                                            <mn>1</mn>
                                            <msup>
                                                <mi>λ</mi>
                                                <mn>3</mn>
                                            </msup>
                                        </mfrac>
                                        <msup>
                                            <mrow>
                                                <mo stretchy="false">(</mo>
                                                <mfrac>
                                                    <mn>1</mn>
                                                    <mi>λ</mi>
                                                </mfrac>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                            <mn>3</mn>
                                        </msup>
                                    </mfrac>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \frac{d\omega_o}{d\omega} =
                                \frac{|M^{-1}|}{{\|M^{-1}w\|}^3} = \frac{\frac{1}{{\lambda}^3}}{{(\frac{1}{\lambda})}^3}
                                = 1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.585116em;vertical-align:-1.094008em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.491108em;"><span style="top:-2.155992em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord"><span class="mord">∥</span><span
                                                                class="mord"><span class="mord mathnormal"
                                                                    style="margin-right:0.10903em;">M</span><span
                                                                    class="msupsub"><span class="vlist-t"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.740108em;"><span
                                                                                    style="top:-2.989em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mtight">−</span><span
                                                                                                class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                                class="mord mathnormal"
                                                                style="margin-right:0.02691em;">w</span><span
                                                                class="mord">∥</span></span><span class="msupsub"><span
                                                                class="vlist-t"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.954008em;"><span
                                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">∣</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.10903em;">M</span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.8141079999999999em;"><span
                                                                            style="top:-3.063em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">−</span><span
                                                                                        class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                        class="mord">∣</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.094008em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.864224em;vertical-align:-1.284116em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.580108em;"><span style="top:-2.1099999999999994em;"><span
                                                    class="pstrut" style="height:3.0491159999999997em;"></span><span
                                                    class="mord"><span class="mord"><span class="mord"><span
                                                                class="mopen">(</span><span class="mord"><span
                                                                    class="mopen nulldelimiter"></span><span
                                                                    class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.845108em;"><span
                                                                                    style="top:-2.6550000000000002em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">λ</span></span></span></span><span
                                                                                    style="top:-3.23em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3em;"></span><span
                                                                                        class="frac-line"
                                                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                                                    style="top:-3.394em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mtight">1</span></span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.345em;"><span></span></span></span></span></span><span
                                                                    class="mclose nulldelimiter"></span></span><span
                                                                class="mclose">)</span></span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:1.049116em;"><span
                                                                            style="top:-3.2980080000000003em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.2791159999999997em;"><span class="pstrut"
                                                    style="height:3.0491159999999997em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.784116em;"><span class="pstrut"
                                                    style="height:3.0491159999999997em;"></span><span class="mord"><span
                                                        class="mord"><span class="mopen nulldelimiter"></span><span
                                                            class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.845108em;"><span
                                                                            style="top:-2.6550000000000002em;"><span
                                                                                class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">λ</span></span><span
                                                                                            class="msupsub"><span
                                                                                                class="vlist-t"><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.7463142857142857em;"><span
                                                                                                            style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height:2.5em;"></span><span
                                                                                                                class="sizing reset-size3 size1 mtight"><span
                                                                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span><span
                                                                            style="top:-3.23em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="frac-line"
                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                            style="top:-3.394em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">1</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.345em;"><span></span></span></span></span></span><span
                                                            class="mclose nulldelimiter"></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.284116em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span></span></span></span></eq>, and thus the LTSC is scale invariant. And
        since GGX BRDF is planar symmetry and isotropic, by [Heitz 2016], the M can be represented by only 4 parameters.
        The the inverse <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mo>=</mo>
                                    <mrow>
                                        <mo fence="true">[</mo>
                                        <mtable rowspacing="0.1600em" columnalign="center center center"
                                            columnspacing="1em">
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mn>1</mn>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mn>0</mn>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mi>G</mi>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mn>0</mn>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mi>B</mi>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mn>0</mn>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mi>A</mi>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mn>0</mn>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mi>R</mi>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                        </mtable>
                                        <mo fence="true">]</mo>
                                    </mrow>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle M^{-1} = \begin{bmatrix} 1 &amp; 0
                                &amp; G \\ 0 &amp; B &amp; 0 \\ A &amp; 0 &amp; R \end{bmatrix}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.10903em;">M</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span
                            class="minner"><span class="mopen"><span class="delimsizing mult"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span
                                                        class="pstrut" style="height:3.1550000000000002em;"></span><span
                                                        class="delimsizinginner delim-size4"><span>⎣</span></span></span><span
                                                    style="top:-3.3970000000000002em;"><span class="pstrut"
                                                        style="height:3.1550000000000002em;"></span><span
                                                        style="height:0.016em;width:0.667em;"><svg width='0.667em'
                                                            height='0.016em' style='width:0.667em' viewBox='0 0 667 16'
                                                            preserveAspectRatio='xMinYMin'>
                                                            <path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z' />
                                                        </svg></span></span><span style="top:-4.05002em;"><span
                                                        class="pstrut" style="height:3.1550000000000002em;"></span><span
                                                        class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.55002em;"><span></span></span></span></span></span></span><span
                                class="mord"><span class="mtable"><span class="col-align-c"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:2.05em;"><span style="top:-4.21em;"><span
                                                            class="pstrut" style="height:3em;"></span><span
                                                            class="mord"><span class="mord">1</span></span></span><span
                                                        style="top:-3.0099999999999993em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord">0</span></span></span><span
                                                        style="top:-1.8099999999999994em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord mathnormal">A</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:1.5500000000000007em;"><span></span></span></span></span></span><span
                                        class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep"
                                        style="width:0.5em;"></span><span class="col-align-c"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:2.05em;"><span style="top:-4.21em;"><span
                                                            class="pstrut" style="height:3em;"></span><span
                                                            class="mord"><span class="mord">0</span></span></span><span
                                                        style="top:-3.0099999999999993em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord mathnormal"
                                                                style="margin-right:0.05017em;">B</span></span></span><span
                                                        style="top:-1.8099999999999994em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord">0</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:1.5500000000000007em;"><span></span></span></span></span></span><span
                                        class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep"
                                        style="width:0.5em;"></span><span class="col-align-c"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:2.05em;"><span style="top:-4.21em;"><span
                                                            class="pstrut" style="height:3em;"></span><span
                                                            class="mord"><span
                                                                class="mord mathnormal">G</span></span></span><span
                                                        style="top:-3.0099999999999993em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord">0</span></span></span><span
                                                        style="top:-1.8099999999999994em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord mathnormal"
                                                                style="margin-right:0.00773em;">R</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span
                                class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist" style="height:2.05002em;"><span
                                                    style="top:-2.2500000000000004em;"><span class="pstrut"
                                                        style="height:3.1550000000000002em;"></span><span
                                                        class="delimsizinginner delim-size4"><span>⎦</span></span></span><span
                                                    style="top:-3.3970000000000002em;"><span class="pstrut"
                                                        style="height:3.1550000000000002em;"></span><span
                                                        style="height:0.016em;width:0.667em;"><svg width='0.667em'
                                                            height='0.016em' style='width:0.667em' viewBox='0 0 667 16'
                                                            preserveAspectRatio='xMinYMin'>
                                                            <path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z' />
                                                        </svg></span></span><span style="top:-4.05002em;"><span
                                                        class="pstrut" style="height:3.1550000000000002em;"></span><span
                                                        class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span>
        </eq>, which is used when rendering, is stored in the LUT. This LUT is called the <a
            href="https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_quad.fs#L26">ltc_1</a> in the
        WebGL Demo provided by [Stephen 2016].</p>
    <h3 dir="auto" id="3-4-lut-norm">3-4. LUT Norm</h3>
    <p dir="auto">By <a href="https://en.wikipedia.org/wiki/Integration_by_substitution">Integration by
            Substitution</a>, we can comprehend intuitively that <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi>d</mi>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </mrow>
                                        <mrow>
                                            <mi>d</mi>
                                            <mi>ω</mi>
                                        </mrow>
                                    </mfrac>
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_{\Omega}
                                \operatorname{D}(\omega) \, d\omega = \int_{\Omega} \operatorname{D_o}(\omega_o)
                                \frac{d\omega_o}{d\omega} d\omega = \int_{\Omega} \operatorname{D_o}(\omega_o) d\omega_o
                                = 1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">Ω</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.28339em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">Ω</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">Ω</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span></span></span></span></eq>. Since the <strong>clamped cosine</strong>
        is normalied, the LTCs must be normalized. However, <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">f</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>l</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{f}(\overrightarrow{\omega_v}, \overrightarrow{\omega_l}) (\cos \theta_l)^+
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.33610799999999996em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.01968em;">l</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>
        </eq> is <strong>NOT</strong> normalized. And thus the <strong>norm</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">n</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">f</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>l</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{n}(\overrightarrow{\omega_v}) = \int_{\Omega}
                                \operatorname{f}(\overrightarrow{\omega_v}, \overrightarrow{\omega_l}) (\cos \theta_l)^+
                                \, d\omega_l</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">n</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">Ω</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.33610799999999996em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.01968em;">l</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> should be introduced to accomplish the approximation. This means that <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">f</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>l</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mo>≈</mo>
                                    <mi mathvariant="normal">n</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{f}(\overrightarrow{\omega_v}, \overrightarrow{\omega_l}) (\cos \theta_l)^+
                                \approx \operatorname{n}(\overrightarrow{\omega_v}) \operatorname{D}(\omega_l)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.33610799999999996em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.01968em;">l</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">≈</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">n</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.<br>
        Actually, according to &quot;Equation (9.9)&quot; of <a href="https://www.realtimerendering.com/">Real-Time
            Rendering Fourth Edition</a>, the <strong>norm</strong> is the HDR (hemispherical directional reflectance).
        Analogous to the &quot;Equation (9)&quot; of [Karis 2013], the <a
            href="https://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf">LTC Fresnel
            Approximation</a> of [Stephen 2016] proposed that the Fresnel term is treated separately, and we have <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mo stretchy="false">[</mo>
                                    <msub>
                                        <mi>F</mi>
                                        <mn>0</mn>
                                    </msub>
                                    <mo>+</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>F</mi>
                                        <mn>90</mn>
                                    </msub>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>F</mi>
                                        <mn>0</mn>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <msup>
                                        <mrow>
                                            <mo stretchy="false">(</mo>
                                            <mn>1.0</mn>
                                            <mo>−</mo>
                                            <mover accent="true">
                                                <msub>
                                                    <mi>ω</mi>
                                                    <mi>v</mi>
                                                </msub>
                                                <mo stretchy="true">→</mo>
                                            </mover>
                                            <mo>⋅</mo>
                                            <mover accent="true">
                                                <msub>
                                                    <mi>ω</mi>
                                                    <mi>h</mi>
                                                </msub>
                                                <mo stretchy="true">→</mo>
                                            </mover>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mn>5</mn>
                                    </msup>
                                    <mo stretchy="false">]</mo>
                                    <mi mathvariant="normal">DV</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>l</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mi>F</mi>
                                        <mn>0</mn>
                                    </msub>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">R</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>+</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>F</mi>
                                        <mn>90</mn>
                                    </msub>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>F</mi>
                                        <mn>0</mn>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">G</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{R}(\overrightarrow{\omega_v}) = \int_\Omega [F_0 + (F_{90} - F_0) {(1.0 -
                                \overrightarrow{\omega_v} \cdot \overrightarrow{\omega_h})}^5]
                                \operatorname{DV}(\overrightarrow{\omega_l}, \overrightarrow{\omega_v}) \, d \omega_l =
                                F_0 \cdot \operatorname{n_R}(\overrightarrow{\omega_v}) + (F_{90} - F_0) \cdot
                                \operatorname{n_G}(\overrightarrow{\omega_v})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mopen">[</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.13889em;">F</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.13889em;">F</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">90</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.406568em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mord"><span
                                    class="mopen">(</span><span class="mord">1.0</span><span class="mspace"
                                    style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                    class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                    class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight"
                                                                                    style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="hide-tail"
                                                        style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                            height='0.522em' viewBox='0 0 400000 522'
                                                            preserveAspectRatio='xMaxYMin slice'>
                                                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                        </svg></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span><span
                                    class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                    class="mbin">⋅</span><span class="mspace"
                                    style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.33610799999999996em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">h</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="hide-tail"
                                                        style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                            height='0.522em' viewBox='0 0 400000 522'
                                                            preserveAspectRatio='xMaxYMin slice'>
                                                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                        </svg></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span><span
                                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                                        class="vlist-r"><span class="vlist" style="height:1.156568em;"><span
                                                style="top:-3.40546em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">5</span></span></span></span></span></span></span></span><span
                            class="mclose">]</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">DV</span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.33610799999999996em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.01968em;">l</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">n</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">R</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.13889em;">F</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">90</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">F</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">n</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">G</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> where <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">R</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">DV</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>l</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{n_R}(\overrightarrow{\omega_v}) = \int_\Omega
                                \operatorname{DV}(\overrightarrow{\omega_l}, \overrightarrow{\omega_v}) \, d \omega_l
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">n</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">R</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">DV</span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.33610799999999996em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.01968em;">l</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">G</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <msup>
                                        <mrow>
                                            <mo stretchy="false">(</mo>
                                            <mn>1.0</mn>
                                            <mo>−</mo>
                                            <mover accent="true">
                                                <msub>
                                                    <mi>ω</mi>
                                                    <mi>v</mi>
                                                </msub>
                                                <mo stretchy="true">→</mo>
                                            </mover>
                                            <mo>⋅</mo>
                                            <mover accent="true">
                                                <msub>
                                                    <mi>ω</mi>
                                                    <mi>h</mi>
                                                </msub>
                                                <mo stretchy="true">→</mo>
                                            </mover>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mn>5</mn>
                                    </msup>
                                    <mi mathvariant="normal">DV</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>l</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{n_G}(\overrightarrow{\omega_v}) = \int_\Omega {(1.0 -
                                \overrightarrow{\omega_v} \cdot \overrightarrow{\omega_h})}^5
                                \operatorname{DV}(\overrightarrow{\omega_l}, \overrightarrow{\omega_v}) \, d \omega_l
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">n</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">G</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord"><span class="mopen">(</span><span class="mord">1.0</span><span
                                    class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                    class="mbin">−</span><span class="mspace"
                                    style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight"
                                                                                    style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="hide-tail"
                                                        style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                            height='0.522em' viewBox='0 0 400000 522'
                                                            preserveAspectRatio='xMaxYMin slice'>
                                                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                        </svg></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span><span
                                    class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                    class="mbin">⋅</span><span class="mspace"
                                    style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.33610799999999996em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">h</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                    class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="hide-tail"
                                                        style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                            height='0.522em' viewBox='0 0 400000 522'
                                                            preserveAspectRatio='xMaxYMin slice'>
                                                            <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                        </svg></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span><span
                                    class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span
                                        class="vlist-r"><span class="vlist" style="height:1.156568em;"><span
                                                style="top:-3.40546em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">5</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">DV</span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.33610799999999996em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.01968em;">l</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>. Evidently, <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">R</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{n_R}(\overrightarrow{\omega_v})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">n</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">R</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> and <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">G</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{n_G}(\overrightarrow{\omega_v})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">n</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">G</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist" style="height:0.151392em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> can be stored in the LUT.<br>
        But we can use the same formluation as [Karis 2013], and the same LUT can be used. The LUT of [Stephen 2016] is
        called the <a
            href="https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_quad.fs#L26">ltc_2</a> in the
        WebGL Demo provided by [Heitz 2016] and <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/RectLight.ush#L437">LTCAmpTexture</a>
        in UE4. And the LUT of [Karis 2013] is called <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/BRDF.ush#L467">PreIntegratedGF</a>
        in UE4 and <a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/PreIntegratedFGD/PreIntegratedFGD.hlsl#L3">_PreIntegratedFGD_GGXDisneyDiffuse</a>
        in Unity3D.
    </p>
    <h2 dir="auto" id="4-light">4. Light</h2>
    <h3 dir="auto" id="4-1-integration-over-polygons">4-1. Integration over Polygons</h3>
    <p dir="auto">By <a href="https://en.wikipedia.org/wiki/Integration_by_substitution">Integration by
            Substitution</a>, we can comprehend intuitively that <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>P</mi>
                                    </msub>
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>P</mi>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi>d</mi>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </mrow>
                                        <mrow>
                                            <mi>d</mi>
                                            <mi>ω</mi>
                                        </mrow>
                                    </mfrac>
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>P</mi>
                                            <mi>o</mi>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_{P} \operatorname{D}(\omega) \,
                                d\omega = \int_{P} \operatorname{D_o}(\omega_o) \frac{d\omega_o}{d\omega} d\omega =
                                \int_{P_o} \operatorname{D_o}(\omega_o) d\omega_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.28339em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.3720499999999998em;vertical-align:-1.01205em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000004em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">P</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.01205em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mi>P</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle P_o = M^{-1} P</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.10903em;">M</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></eq>.
        Evidently, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">normalize</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mi>P</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle P_o = \operatorname{normalize}(M^{-1}
                                P)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">normalize</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.10903em;">M</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                            class="mclose">)</span></span></span></span></eq> is more consistent with <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">normalize</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega_o =
                                \operatorname{normalize}(M^{-1} \omega)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">normalize</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.10903em;">M</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span></span></span></span></eq>. However, even if the <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mi>P</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle M^{-1} P</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.10903em;">M</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></eq>
        is <strong>NOT</strong> normalized, the area on the sphere surface subtended by the polygon remains the same.
        Thus, the normalize operator is <strong>NOT</strong> necessary here. Actually, the normalize operator will
        eventually be applied when the irradiance <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{E}(P_o)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">E</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is calculated by [Heitz 2017].</p>
    <h3 dir="auto" id="4-2-shading-with-constant-polygonal-lights">4-2. Shading with Constant Polygonal Lights</h3>
    <p dir="auto">By <strong>2. Approximation</strong>, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mi>L</mi>
                                    <mi>l</mi>
                                </msub>
                                <msub>
                                    <mo>∫</mo>
                                    <mi>P</mi>
                                </msub>
                                <mi mathvariant="normal">BRDF</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>ω</mi>
                                    <mi>v</mi>
                                </msub>
                                <mo separator="true">,</mo>
                                <msub>
                                    <mi>ω</mi>
                                    <mi>l</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <mi mathvariant="normal">∣</mi>
                                <mi>cos</mi>
                                <mo>⁡</mo>
                                <msub>
                                    <mi>θ</mi>
                                    <mi>l</mi>
                                </msub>
                                <mi mathvariant="normal">∣</mi>
                                <mtext> </mtext>
                                <mi>d</mi>
                                <msub>
                                    <mi>ω</mi>
                                    <mi>l</mi>
                                </msub>
                                <mo>≈</mo>
                                <msub>
                                    <mi>L</mi>
                                    <mi>l</mi>
                                </msub>
                                <msub>
                                    <mo>∫</mo>
                                    <mi>P</mi>
                                </msub>
                                <mrow>
                                    <mi mathvariant="normal">N</mi>
                                    <mi mathvariant="normal">o</mi>
                                    <mi mathvariant="normal">r</mi>
                                    <mi mathvariant="normal">m</mi>
                                    <mi mathvariant="normal">B</mi>
                                    <mi mathvariant="normal">R</mi>
                                    <mi mathvariant="normal">D</mi>
                                    <mi mathvariant="normal">F</mi>
                                    <mi mathvariant="normal">C</mi>
                                    <mi mathvariant="normal">o</mi>
                                    <mi mathvariant="normal">s</mi>
                                    <mi mathvariant="normal">i</mi>
                                    <mi mathvariant="normal">n</mi>
                                    <mi mathvariant="normal">e</mi>
                                </mrow>
                                <mo>⋅</mo>
                                <mi mathvariant="normal">D</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>ω</mi>
                                    <mi>l</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <mtext> </mtext>
                                <mi>d</mi>
                                <msub>
                                    <mi>ω</mi>
                                    <mi>l</mi>
                                </msub>
                                <mo>=</mo>
                                <msub>
                                    <mi>L</mi>
                                    <mi>l</mi>
                                </msub>
                                <mo>⋅</mo>
                                <mrow>
                                    <mi mathvariant="normal">N</mi>
                                    <mi mathvariant="normal">o</mi>
                                    <mi mathvariant="normal">r</mi>
                                    <mi mathvariant="normal">m</mi>
                                    <mi mathvariant="normal">B</mi>
                                    <mi mathvariant="normal">R</mi>
                                    <mi mathvariant="normal">D</mi>
                                    <mi mathvariant="normal">F</mi>
                                    <mi mathvariant="normal">C</mi>
                                    <mi mathvariant="normal">o</mi>
                                    <mi mathvariant="normal">s</mi>
                                    <mi mathvariant="normal">i</mi>
                                    <mi mathvariant="normal">n</mi>
                                    <mi mathvariant="normal">e</mi>
                                </mrow>
                                <mo>⋅</mo>
                                <msub>
                                    <mo>∫</mo>
                                    <mi>P</mi>
                                </msub>
                                <mi mathvariant="normal">D</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>ω</mi>
                                    <mi>l</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <mtext> </mtext>
                                <mi>d</mi>
                                <msub>
                                    <mi>ω</mi>
                                    <mi>l</mi>
                                </msub>
                            </mrow>
                            <annotation encoding="application/x-tex">L_l \int_{P} \operatorname{BRDF}(\omega_v,
                                \omega_l) |\cos \theta_l| \, d\omega_l \approx L_l \int_{P} \mathrm{NormBRDFCosine}
                                \cdot \operatorname{D}(\omega_l) \, d\omega_l = L_l \cdot \mathrm{NormBRDFCosine} \cdot
                                \int_{P} \operatorname{D}(\omega_l) \, d\omega_l</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.1608200000000002em;vertical-align:-0.35582em;"></span><span
                            class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.12251099999999993em;"><span
                                                style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.35582em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">BRDF</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">≈</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1.1608200000000002em;vertical-align:-0.35582em;"></span><span
                            class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.12251099999999993em;"><span
                                                style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.35582em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathrm">NormBRDFCosine</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathrm">NormBRDFCosine</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.1608200000000002em;vertical-align:-0.35582em;"></span><span
                            class="mop"><span class="mop op-symbol small-op"
                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.12251099999999993em;"><span
                                                style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.35582em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>. Note that the polygon P should be transformed to the tangent space before the approximation is
        applied.<br>
        And by <strong>3-1. Integration over Polygons</strong>, we have <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>L</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo>⋅</mo>
                                    <mrow>
                                        <mi mathvariant="normal">N</mi>
                                        <mi mathvariant="normal">o</mi>
                                        <mi mathvariant="normal">r</mi>
                                        <mi mathvariant="normal">m</mi>
                                        <mi mathvariant="normal">B</mi>
                                        <mi mathvariant="normal">R</mi>
                                        <mi mathvariant="normal">D</mi>
                                        <mi mathvariant="normal">F</mi>
                                        <mi mathvariant="normal">C</mi>
                                        <mi mathvariant="normal">o</mi>
                                        <mi mathvariant="normal">s</mi>
                                        <mi mathvariant="normal">i</mi>
                                        <mi mathvariant="normal">n</mi>
                                        <mi mathvariant="normal">e</mi>
                                    </mrow>
                                    <mo>⋅</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>P</mi>
                                    </msub>
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mi>L</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo>⋅</mo>
                                    <mrow>
                                        <mi mathvariant="normal">N</mi>
                                        <mi mathvariant="normal">o</mi>
                                        <mi mathvariant="normal">r</mi>
                                        <mi mathvariant="normal">m</mi>
                                        <mi mathvariant="normal">B</mi>
                                        <mi mathvariant="normal">R</mi>
                                        <mi mathvariant="normal">D</mi>
                                        <mi mathvariant="normal">F</mi>
                                        <mi mathvariant="normal">C</mi>
                                        <mi mathvariant="normal">o</mi>
                                        <mi mathvariant="normal">s</mi>
                                        <mi mathvariant="normal">i</mi>
                                        <mi mathvariant="normal">n</mi>
                                        <mi mathvariant="normal">e</mi>
                                    </mrow>
                                    <mo>⋅</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>P</mi>
                                            <mi>o</mi>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mi>L</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo>⋅</mo>
                                    <mrow>
                                        <mi mathvariant="normal">N</mi>
                                        <mi mathvariant="normal">o</mi>
                                        <mi mathvariant="normal">r</mi>
                                        <mi mathvariant="normal">m</mi>
                                        <mi mathvariant="normal">B</mi>
                                        <mi mathvariant="normal">R</mi>
                                        <mi mathvariant="normal">D</mi>
                                        <mi mathvariant="normal">F</mi>
                                        <mi mathvariant="normal">C</mi>
                                        <mi mathvariant="normal">o</mi>
                                        <mi mathvariant="normal">s</mi>
                                        <mi mathvariant="normal">i</mi>
                                        <mi mathvariant="normal">n</mi>
                                        <mi mathvariant="normal">e</mi>
                                    </mrow>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle L_l \cdot \mathrm{NormBRDFCosine}
                                \cdot \int_{P} \operatorname{D}(\omega_l) \, d\omega_l = L_l \cdot
                                \mathrm{NormBRDFCosine} \cdot \int_{P_o} \operatorname{D_o}(\omega_o) \, d\omega_o = L_l
                                \cdot \mathrm{NormBRDFCosine} \cdot \operatorname{E}(P_o)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathrm">NormBRDFCosine</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathrm">NormBRDFCosine</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.3720499999999998em;vertical-align:-1.01205em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000004em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">P</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.01205em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathrm">NormBRDFCosine</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">E</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> where <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mi>P</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle P_o = M^{-1} P</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.10903em;">M</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></eq>
        and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>P</mi>
                                            <mi>o</mi>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>P</mi>
                                            <mi>o</mi>
                                        </msub>
                                    </msub>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{E}(P_o) = \int_{P_o}
                                \operatorname{D_o}(\omega_o) \, d\omega_o = \int_{P_o} \frac{1}{\pi}|\cos \theta_o| \,
                                d\omega_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">E</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.3720499999999998em;vertical-align:-1.01205em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000004em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">P</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.01205em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.3720499999999998em;vertical-align:-1.01205em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000004em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">P</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.01205em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord">∣</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.</p>
    <h2 dir="auto" id="references">References</h2>
    <p dir="auto">[Snyder 1996] <a
            href="https://www.microsoft.com/en-us/research/publication/area-light-sources-for-real-time-graphics/">John
            Snyder. &quot;Area Light Sources for Real-Time Graphics.&quot; Technical Report 1996</a><br>
        [Karis 2013] <a
            href="https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf">Brian
            Karis. &quot;Real Shading in Unreal Engine 4.&quot; SIGGRAPH 2013.</a><br>
        [Heitz 2016] <a href="https://eheitzresearch.wordpress.com/415-2/">Eric Heitz, Jonathan Dupuy, Stephen Hill,
            David Neubelt. &quot;Real-Time Polygonal-Light Shading with Linearly Transformed Cosines.&quot; SIGGRAPH
            2016.</a><br>
        [Stephen 2016] <a href="https://blog.selfshadow.com/publications/s2016-advances/">Stephen Hill, Eric Heitz.
            &quot;Real-Time Area Lighting: a Journey from Research to Production.&quot; SIGGRAPH 2016.</a><br>
        [Heitz 2017] <a href="https://hal.archives-ouvertes.fr/hal-01458129">Eric Heitz. &quot;Geometric Derivation of
            the Irradiance of Polygonal Lights.&quot; Technical report 2017.</a></p>

</body>

</html>