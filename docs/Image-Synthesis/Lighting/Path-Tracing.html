<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/default.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
</head>

<body class="markdown-body">
    <h1 dir="auto" id="path-tracing">Path Tracing</h1>
    <h2 dir="auto" id="rendering-equation">Rendering Equation</h2>
    <p dir="auto">The <strong>Rendering Equation</strong> is also called the <strong>LTE</strong> (<strong>Light
            Transport Equation</strong>) by &quot;14.4 The Light Transport Equation&quot; of <a
            href="https://www.pbr-book.org/3ed-2018/Light_Transport_I_Surface_Reflection/The_Light_Transport_Equation">PBR
            Book</a>. And we have the <strong>Rendering Equation</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>V</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">e</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>V</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>+</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">f</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>L</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>V</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">i</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>L</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>L</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>L</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(p,
                                \overrightarrow{\omega_V}) = \operatorname{L_e}(p, \overrightarrow{\omega_V}) +
                                \int_\Omega \operatorname{f}(p, \overrightarrow{\omega_L}, \overrightarrow{\omega_V})
                                \operatorname{L_i}(p, \overrightarrow{\omega_L}) (\cos \theta_L)^+ \, d
                                \overrightarrow{\omega_L}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.22222em;">V</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">e</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.22222em;">V</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">L</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.22222em;">V</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31750199999999995em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">L</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.32833099999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">L</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">L</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq>.
    </p>
    <p dir="auto">By &quot;Figure 11.1&quot; of <a href="http://www.realtimerendering.com/">Real-Time Rendering Fourth
            Edition</a> and &quot;Figure 14.14&quot; of <a
            href="https://pbr-book.org/3ed-2018/Light_Transport_I_Surface_Reflection/The_Light_Transport_Equation">PBR
            Book</a>, by assuming no participating media, the incident radiance <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">i</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>L</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_i}(p,
                                \overrightarrow{\omega_L})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31750199999999995em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">L</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> at one point p is exactly the exitant
        radiance <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">r</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>L</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo separator="true">,</mo>
                                    <mo>−</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>L</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{L_o}(\operatorname{r}(p, \overrightarrow{\omega_L}),
                                -\overrightarrow{\omega_L})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop"><span class="mord mathrm">r</span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">L</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord">−</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">L</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> at another point <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">r</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>L</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{r}(p,
                                \overrightarrow{\omega_L})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">r</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">L</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> where <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">r</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <mi>ω</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{r}(p,
                                \overrightarrow{\omega})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">r</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord mathnormal"
                                                style="margin-right:0.03588em;">ω</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is the ray-casting function. This means
        that both the incident radiance <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">i</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <mi>ω</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_i}(p,
                                \overrightarrow{\omega})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31750199999999995em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord mathnormal"
                                                style="margin-right:0.03588em;">ω</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> and the exitant radiance <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <mi>ω</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(p,
                                \overrightarrow{\omega})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord mathnormal"
                                                style="margin-right:0.03588em;">ω</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> can be represented by the same function
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">L</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <mi>ω</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L}(p,
                                \overrightarrow{\omega})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">L</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span class="mord mathnormal"
                                                style="margin-right:0.03588em;">ω</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>. And we have <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">L</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>V</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">e</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>V</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>+</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">f</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>L</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>V</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">L</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">r</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>L</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo separator="true">,</mo>
                                    <mo>−</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>L</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>L</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>L</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L}(p,
                                \overrightarrow{\omega_V}) = \operatorname{L_e}(p, \overrightarrow{\omega_V}) +
                                \int_\Omega \operatorname{f}(p, \overrightarrow{\omega_L}, \overrightarrow{\omega_V})
                                \operatorname{L}(\operatorname{r}(p, \overrightarrow{\omega_L}),
                                -\overrightarrow{\omega_L}) (\cos \theta_L)^+ \, d \overrightarrow{\omega_L}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">L</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.22222em;">V</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">e</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.22222em;">V</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">L</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.22222em;">V</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">L</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">r</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">L</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord">−</span><span
                            class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">L</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.32833099999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">L</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">L</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> which is an integral equation where the unknown function is <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">L</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L}(p, \omega)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">L</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="mclose">)</span></span></span></span>
        </eq>.</p>
    <p dir="auto">According to this integral equation, by <a
            href="https://github.com/AcademySoftwareFoundation/OpenShadingLanguage">OSL (Open Shading Language)</a>, the
        surface and the light are actually the same thing, since the light is merely the surface which is emissive.</p>
    <p dir="auto">By &quot;Light transport and the rendering equation&quot; of <a
            href="http://www-graphics.stanford.edu/courses/cs348b-96/">CS 348B - Computer Graphics: Image Synthesis
            Techniques</a> and &quot;Global Illumination and Rendering Equation&quot; of <a
            href="https://inst.eecs.berkeley.edu/~cs294-13/fa09/">CS 294-13 Advanced Computer Graphics</a>, this
        integral equation is actually the <a href="https://en.wikipedia.org/wiki/Fredholm_integral_equation">Fredholm
            Integral Equation</a> of which the solution is the <a
            href="https://en.wikipedia.org/wiki/Liouville%E2%80%93Neumann_series">Liouville–Neumann Series</a>. And
        thus, the solution of this integral equation can be written as the recursive form <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mtext>L</mtext>
                                <mo>=</mo>
                                <mtext>E</mtext>
                                <mo>+</mo>
                                <mtext>KE</mtext>
                                <mo>+</mo>
                                <msup>
                                    <mtext>K</mtext>
                                    <mn>2</mn>
                                </msup>
                                <mtext>E</mtext>
                                <mo>+</mo>
                                <msup>
                                    <mtext>K</mtext>
                                    <mn>3</mn>
                                </msup>
                                <mtext>E</mtext>
                                <mo>+</mo>
                                <mo>…</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">\text{L} = \text{E} + \text{K}\text{E} +
                                {\text{K}}^2\text{E} + {\text{K}}^3\text{E} + \ldots</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span
                                class="mord">L</span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord text"><span
                                class="mord">E</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord text"><span
                                class="mord">K</span></span><span class="mord text"><span
                                class="mord">E</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.970668em;vertical-align:-0.08333em;"></span><span class="mord"><span
                                class="mord"><span class="mord text"><span class="mord">K</span></span></span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.887338em;"><span
                                                style="top:-3.1362300000000003em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                            class="mord text"><span class="mord">E</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.970668em;vertical-align:-0.08333em;"></span><span class="mord"><span
                                class="mord"><span class="mord text"><span class="mord">K</span></span></span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.887338em;"><span
                                                style="top:-3.1362300000000003em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">3</span></span></span></span></span></span></span></span><span
                            class="mord text"><span class="mord">E</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:0.12em;vertical-align:0em;"></span><span
                            class="minner">…</span></span></span></span></eq>.</p>
    <h2 dir="auto" id="the-area-form">The Area Form</h2>
    <h2 dir="auto" id="the-path-form">The Path Form</h2>
    <p dir="auto">// ray-casting function eliminate<br>
        // area form<br>
        // visibility function</p>
    <p dir="auto">// throughput 14.18</p>
    <p dir="auto">By &quot;Equation (14.19)&quot; of <a
            href="https://pbr-book.org/3ed-2018/Light_Transport_I_Surface_Reflection/Path_Tracing#IncrementalPathConstruction">PBR
            Book</a>, we have the relationship between the area PDF and the solid angle PDF <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">p</mi>
                                            <mi mathvariant="normal">A</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi>cos</mi>
                                            <mo>⁡</mo>
                                            <msub>
                                                <mi>θ</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mrow>
                                        <msup>
                                            <mrow>
                                                <mi mathvariant="normal">∥</mi>
                                                <msub>
                                                    <mi>p</mi>
                                                    <mrow>
                                                        <mi>i</mi>
                                                        <mo>+</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msub>
                                                <mo>−</mo>
                                                <msub>
                                                    <mi>p</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mi mathvariant="normal">∥</mi>
                                            </mrow>
                                            <mn>2</mn>
                                        </msup>
                                    </mfrac>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">p</mi>
                                            <mi>ω</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mrow>
                                            <msub>
                                                <mi>p</mi>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>+</mo>
                                                    <mn>1</mn>
                                                </mrow>
                                            </msub>
                                            <mo>→</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mrow>
                                        <mo stretchy="true">^</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{p_A}(p_i) =
                                \frac{\cos\theta_i}{{\|p_{i+1} - p_i\|}^2} \operatorname{p_{\omega}}(\widehat{p_{i+1}
                                \rightarrow p_i})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">A</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4654480000000003em;vertical-align:-1.094008em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.155992em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord"><span class="mord">∥</span><span
                                                                class="mord"><span class="mord mathnormal">p</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.311664em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">i</span><span
                                                                                                class="mbin mtight">+</span><span
                                                                                                class="mord mtight">1</span></span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.208331em;"><span></span></span></span></span></span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mbin">−</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mord"><span class="mord mathnormal">p</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.31166399999999994em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                class="mord">∥</span></span><span class="msupsub"><span
                                                                class="vlist-t"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.954008em;"><span
                                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop">cos</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">θ</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.094008em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">ω</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.73056em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord"><span
                                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                    class="vlist" style="height:0.311664em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mathnormal mtight">i</span><span
                                                                                    class="mbin mtight">+</span><span
                                                                                    class="mord mtight">1</span></span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.208331em;"><span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mrel">→</span><span class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span style="height:0.3em;"><svg width='100%'
                                                    height='0.3em' viewBox='0 0 2364 300' preserveAspectRatio='none'>
                                                    <path d='M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.208331em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>. Here is the proof of this relationship.
        By &quot;Equation (5.6)&quot; of <a
            href="https://pbr-book.org/3ed-2018/Color_and_Radiometry/Working_with_Radiometric_Integrals#IntegralsoverArea">PBR
            Book</a>, we have the relationship between the differential area and the differential solid angle <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi>cos</mi>
                                            <mo>⁡</mo>
                                            <mi>θ</mi>
                                        </mrow>
                                        <msup>
                                            <mi>r</mi>
                                            <mn>2</mn>
                                        </msup>
                                    </mfrac>
                                    <mi>d</mi>
                                    <mi>A</mi>
                                    <mo>⇒</mo>
                                    <mi>d</mi>
                                    <mi>A</mi>
                                    <mo>=</mo>
                                    <mfrac>
                                        <msup>
                                            <mi>r</mi>
                                            <mn>2</mn>
                                        </msup>
                                        <mrow>
                                            <mi>cos</mi>
                                            <mo>⁡</mo>
                                            <mi>θ</mi>
                                        </mrow>
                                    </mfrac>
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega = \frac{\cos\theta}{r^2}dA
                                \Rightarrow dA = \frac{r^2}{\cos\theta}d\omega</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">r</span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.740108em;"><span
                                                                            style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop">cos</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal">A</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">⇒</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal">A</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.177108em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop">cos</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">r</span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.8141079999999999em;"><span
                                                                            style="top:-3.063em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span></span></span></span></eq>.
        Since <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">p</mi>
                                            <mi mathvariant="normal">A</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{p_A}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">A</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
        </eq> is the area PDF, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>A</mi>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">p</mi>
                                            <mi mathvariant="normal">A</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi mathvariant="normal">A</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                    <mo>⇒</mo>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <msub>
                                            <mo>∫</mo>
                                            <mi>A</mi>
                                        </msub>
                                        <mi mathvariant="normal">
                                            <msub>
                                                <mi mathvariant="normal">p</mi>
                                                <mi mathvariant="normal">A</mi>
                                            </msub>
                                        </mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>p</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <mtext> </mtext>
                                        <mi>d</mi>
                                        <mi mathvariant="normal">A</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>p</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <msub>
                                            <mo>∫</mo>
                                            <mi>A</mi>
                                        </msub>
                                        <mi mathvariant="normal">
                                            <msub>
                                                <mi mathvariant="normal">p</mi>
                                                <mi mathvariant="normal">A</mi>
                                            </msub>
                                        </mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>p</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <mtext> </mtext>
                                        <mo stretchy="false">(</mo>
                                        <mfrac>
                                            <msup>
                                                <mrow>
                                                    <mi mathvariant="normal">∥</mi>
                                                    <msub>
                                                        <mi>p</mi>
                                                        <mrow>
                                                            <mi>i</mi>
                                                            <mo>+</mo>
                                                            <mn>1</mn>
                                                        </mrow>
                                                    </msub>
                                                    <mo>−</mo>
                                                    <msub>
                                                        <mi>p</mi>
                                                        <mi>i</mi>
                                                    </msub>
                                                    <mi mathvariant="normal">∥</mi>
                                                </mrow>
                                                <mn>2</mn>
                                            </msup>
                                            <mrow>
                                                <mi>cos</mi>
                                                <mo>⁡</mo>
                                                <msub>
                                                    <mi>θ</mi>
                                                    <mi>i</mi>
                                                </msub>
                                            </mrow>
                                        </mfrac>
                                        <mi>d</mi>
                                        <mi mathvariant="normal">ω</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <mrow>
                                                <msub>
                                                    <mi>p</mi>
                                                    <mrow>
                                                        <mi>i</mi>
                                                        <mo>+</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msub>
                                                <mo>→</mo>
                                                <msub>
                                                    <mi>p</mi>
                                                    <mi>i</mi>
                                                </msub>
                                            </mrow>
                                            <mo stretchy="true">^</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <msub>
                                            <mo>∫</mo>
                                            <mi mathvariant="normal">Ω</mi>
                                        </msub>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">
                                            <msub>
                                                <mi mathvariant="normal">p</mi>
                                                <mi mathvariant="normal">A</mi>
                                            </msub>
                                        </mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>p</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <mfrac>
                                            <msup>
                                                <mrow>
                                                    <mi mathvariant="normal">∥</mi>
                                                    <msub>
                                                        <mi>p</mi>
                                                        <mrow>
                                                            <mi>i</mi>
                                                            <mo>+</mo>
                                                            <mn>1</mn>
                                                        </mrow>
                                                    </msub>
                                                    <mo>−</mo>
                                                    <msub>
                                                        <mi>p</mi>
                                                        <mi>i</mi>
                                                    </msub>
                                                    <mi mathvariant="normal">∥</mi>
                                                </mrow>
                                                <mn>2</mn>
                                            </msup>
                                            <mrow>
                                                <mi>cos</mi>
                                                <mo>⁡</mo>
                                                <msub>
                                                    <mi>θ</mi>
                                                    <mi>i</mi>
                                                </msub>
                                            </mrow>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                        <mtext> </mtext>
                                        <mi>d</mi>
                                        <mi mathvariant="normal">ω</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <mrow>
                                                <msub>
                                                    <mi>p</mi>
                                                    <mrow>
                                                        <mi>i</mi>
                                                        <mo>+</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msub>
                                                <mo>→</mo>
                                                <msub>
                                                    <mi>p</mi>
                                                    <mi>i</mi>
                                                </msub>
                                            </mrow>
                                            <mo stretchy="true">^</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <mn>1</mn>
                                    </mstyle>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_A \operatorname{p_A}(p_i) \,
                                d\operatorname{A}(p_i) = 1 \Rightarrow \displaystyle \int_A \operatorname{p_A}(p_i) \,
                                d\operatorname{A}(p_i) = \int_A \operatorname{p_A}(p_i) \, (\frac{{\|p_{i+1} -
                                p_i\|}^2}{\cos\theta_i} d\operatorname{\omega}(\widehat{p_{i+1} \rightarrow p_i})) =
                                \int_{\Omega} (\operatorname{p_A}(p_i) \frac{{\|p_{i+1} - p_i\|}^2}{\cos\theta_i}) \,
                                d\operatorname{\omega}(\widehat{p_{i+1} \rightarrow p_i}) = 1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">A</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">A</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">A</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">⇒</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">A</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">A</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">A</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.542958em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">A</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">A</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.631008em;"><span style="top:-2.3139999999999996em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mop">cos</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">θ</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord"><span class="mord">∥</span><span
                                                                class="mord"><span class="mord mathnormal">p</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.311664em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">i</span><span
                                                                                                class="mbin mtight">+</span><span
                                                                                                class="mord mtight">1</span></span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.208331em;"><span></span></span></span></span></span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mbin">−</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mord"><span class="mord mathnormal">p</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.31166399999999994em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                class="mord">∥</span></span><span class="msupsub"><span
                                                                class="vlist-t"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.954008em;"><span
                                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.8360000000000001em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord mathnormal">d</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord">ω</span></span><span class="mopen">(</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.73056em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span class="mord"><span
                                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                    class="vlist" style="height:0.311664em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mathnormal mtight">i</span><span
                                                                                    class="mbin mtight">+</span><span
                                                                                    class="mord mtight">1</span></span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.208331em;"><span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mrel">→</span><span class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span style="height:0.3em;"><svg width='100%'
                                                    height='0.3em' viewBox='0 0 2364 300' preserveAspectRatio='none'>
                                                    <path d='M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.208331em;"><span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.542958em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">Ω</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">A</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.631008em;"><span style="top:-2.3139999999999996em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mop">cos</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">θ</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord"><span class="mord">∥</span><span
                                                                class="mord"><span class="mord mathnormal">p</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.311664em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">i</span><span
                                                                                                class="mbin mtight">+</span><span
                                                                                                class="mord mtight">1</span></span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.208331em;"><span></span></span></span></span></span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mbin">−</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mord"><span class="mord mathnormal">p</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.31166399999999994em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                class="mord">∥</span></span><span class="msupsub"><span
                                                                class="vlist-t"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.954008em;"><span
                                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.8360000000000001em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord">ω</span></span><span class="mopen">(</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.73056em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span class="mord"><span
                                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                    class="vlist" style="height:0.311664em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mathnormal mtight">i</span><span
                                                                                    class="mbin mtight">+</span><span
                                                                                    class="mord mtight">1</span></span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.208331em;"><span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mrel">→</span><span class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span style="height:0.3em;"><svg width='100%'
                                                    height='0.3em' viewBox='0 0 2364 300' preserveAspectRatio='none'>
                                                    <path d='M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.208331em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span></span></span></span></eq>. Since <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">p</mi>
                                            <mi>ω</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{p_{\omega}}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">ω</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
        </eq> is the solid angle PDF, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">p</mi>
                                            <mi>ω</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mrow>
                                            <msub>
                                                <mi>p</mi>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>+</mo>
                                                    <mn>1</mn>
                                                </mrow>
                                            </msub>
                                            <mo>→</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mrow>
                                        <mo stretchy="true">^</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi mathvariant="normal">ω</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mrow>
                                            <msub>
                                                <mi>p</mi>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>+</mo>
                                                    <mn>1</mn>
                                                </mrow>
                                            </msub>
                                            <mo>→</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mrow>
                                        <mo stretchy="true">^</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                    <mo>⇒</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">p</mi>
                                            <mi>ω</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mrow>
                                            <msub>
                                                <mi>p</mi>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>+</mo>
                                                    <mn>1</mn>
                                                </mrow>
                                            </msub>
                                            <mo>→</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mrow>
                                        <mo stretchy="true">^</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">p</mi>
                                            <mi mathvariant="normal">A</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mfrac>
                                        <msup>
                                            <mrow>
                                                <mi mathvariant="normal">∥</mi>
                                                <msub>
                                                    <mi>p</mi>
                                                    <mrow>
                                                        <mi>i</mi>
                                                        <mo>+</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msub>
                                                <mo>−</mo>
                                                <msub>
                                                    <mi>p</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mi mathvariant="normal">∥</mi>
                                            </mrow>
                                            <mn>2</mn>
                                        </msup>
                                        <mrow>
                                            <mi>cos</mi>
                                            <mo>⁡</mo>
                                            <msub>
                                                <mi>θ</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mrow>
                                    </mfrac>
                                    <mo>⇒</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">p</mi>
                                            <mi mathvariant="normal">A</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi>cos</mi>
                                            <mo>⁡</mo>
                                            <msub>
                                                <mi>θ</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mrow>
                                        <msup>
                                            <mrow>
                                                <mi mathvariant="normal">∥</mi>
                                                <msub>
                                                    <mi>p</mi>
                                                    <mrow>
                                                        <mi>i</mi>
                                                        <mo>+</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msub>
                                                <mo>−</mo>
                                                <msub>
                                                    <mi>p</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mi mathvariant="normal">∥</mi>
                                            </mrow>
                                            <mn>2</mn>
                                        </msup>
                                    </mfrac>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">p</mi>
                                            <mi>ω</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mrow>
                                            <msub>
                                                <mi>p</mi>
                                                <mrow>
                                                    <mi>i</mi>
                                                    <mo>+</mo>
                                                    <mn>1</mn>
                                                </mrow>
                                            </msub>
                                            <mo>→</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mrow>
                                        <mo stretchy="true">^</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_{\Omega}
                                \operatorname{p_{\omega}}(\widehat{p_{i+1} \rightarrow p_i}) \,
                                d\operatorname{\omega}(\widehat{p_{i+1} \rightarrow p_i}) = 1 \Rightarrow
                                \operatorname{p_{\omega}}(\widehat{p_{i+1} \rightarrow p_i}) = \operatorname{p_A}(p_i)
                                \frac{{\|p_{i+1} - p_i\|}^2}{\cos\theta_i} \Rightarrow \operatorname{p_A}(p_i) =
                                \frac{\cos\theta_i}{{\|p_{i+1} - p_i\|}^2} \operatorname{p_{\omega}}(\widehat{p_{i+1}
                                \rightarrow p_i})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">Ω</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">ω</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.73056em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord"><span
                                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                    class="vlist" style="height:0.311664em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mathnormal mtight">i</span><span
                                                                                    class="mbin mtight">+</span><span
                                                                                    class="mord mtight">1</span></span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.208331em;"><span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mrel">→</span><span class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span style="height:0.3em;"><svg width='100%'
                                                    height='0.3em' viewBox='0 0 2364 300' preserveAspectRatio='none'>
                                                    <path d='M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.208331em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord">ω</span></span><span class="mopen">(</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.73056em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span class="mord"><span
                                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                    class="vlist" style="height:0.311664em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mathnormal mtight">i</span><span
                                                                                    class="mbin mtight">+</span><span
                                                                                    class="mord mtight">1</span></span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.208331em;"><span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mrel">→</span><span class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span style="height:0.3em;"><svg width='100%'
                                                    height='0.3em' viewBox='0 0 2364 300' preserveAspectRatio='none'>
                                                    <path d='M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.208331em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">⇒</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">ω</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.73056em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord"><span
                                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                    class="vlist" style="height:0.311664em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mathnormal mtight">i</span><span
                                                                                    class="mbin mtight">+</span><span
                                                                                    class="mord mtight">1</span></span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.208331em;"><span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mrel">→</span><span class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span style="height:0.3em;"><svg width='100%'
                                                    height='0.3em' viewBox='0 0 2364 300' preserveAspectRatio='none'>
                                                    <path d='M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.208331em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.467008em;vertical-align:-0.8360000000000001em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">A</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.631008em;"><span style="top:-2.3139999999999996em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mop">cos</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">θ</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord"><span class="mord">∥</span><span
                                                                class="mord"><span class="mord mathnormal">p</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.311664em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">i</span><span
                                                                                                class="mbin mtight">+</span><span
                                                                                                class="mord mtight">1</span></span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.208331em;"><span></span></span></span></span></span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mbin">−</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mord"><span class="mord mathnormal">p</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.31166399999999994em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                class="mord">∥</span></span><span class="msupsub"><span
                                                                class="vlist-t"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.954008em;"><span
                                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.8360000000000001em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">⇒</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">A</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4654480000000003em;vertical-align:-1.094008em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.155992em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord"><span class="mord">∥</span><span
                                                                class="mord"><span class="mord mathnormal">p</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.311664em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">i</span><span
                                                                                                class="mbin mtight">+</span><span
                                                                                                class="mord mtight">1</span></span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.208331em;"><span></span></span></span></span></span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mbin">−</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mord"><span class="mord mathnormal">p</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.31166399999999994em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                class="mord">∥</span></span><span class="msupsub"><span
                                                                class="vlist-t"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.954008em;"><span
                                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop">cos</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">θ</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.094008em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">p</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">ω</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.73056em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord"><span
                                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                    class="vlist" style="height:0.311664em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight"><span
                                                                                    class="mord mathnormal mtight">i</span><span
                                                                                    class="mbin mtight">+</span><span
                                                                                    class="mord mtight">1</span></span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.208331em;"><span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mrel">→</span><span class="mspace"
                                                    style="margin-right:0.2777777777777778em;"></span><span
                                                    class="mord"><span class="mord mathnormal">p</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span style="height:0.3em;"><svg width='100%'
                                                    height='0.3em' viewBox='0 0 2364 300' preserveAspectRatio='none'>
                                                    <path d='M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.208331em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.</p>
    <p dir="auto">// appeal pA = ... pw to 14.17, we have 14.19 (last vertex remains the differential area, change all
        other vertices to differential solid angle)</p>
    <h2 dir="auto" id="incremental-path-construction">Incremental Path Construction</h2>
    <p dir="auto">// when evaluate p(i+1), the result of previous path p(i) is <strong>reused</strong><br>
        // for example, the <strong>beta</strong> is reused // <strong>beta</strong> in 14.5.4 Implementation<br>
        // introduce correlation but the result is not bad</p>

</body>

</html>