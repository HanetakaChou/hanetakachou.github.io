<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/default.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
</head>

<body class="markdown-body">
    <h1 dir="auto" id="skin">Skin</h1>
    <table dir="auto">
        <thead dir="auto">
            <tr dir="auto">
                <th style="text-align:center">N/A</th>
                <th style="text-align:center"><a
                        href="https://github.com/NVIDIAGameWorks/FaceWorks/blob/master/doc/slides/FaceWorks-Overview-GTC14.pdf">NVIDIA
                        FaceWorks</a></th>
                <th style="text-align:center"><a href="http://www.iryoku.com/separable-sss/">Demo Source Code of Jimenez
                        2015</a></th>
                <th style="text-align:center">UE4</th>
                <th style="text-align:center">Unity3D</th>
            </tr>
        </thead>
        <tbody dir="auto">
            <tr dir="auto">
                <td style="text-align:center">Diffuse Reflectance Term</td>
                <td style="text-align:center">Preintegrated</td>
                <td style="text-align:center"><a href="https://graphics.unizar.es/publications.html#year_2012">Separable
                        SSS</a></td>
                <td style="text-align:center"><a
                        href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/ShadingModels.ush#L754">Preintegrated</a>
                    + <a
                        href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/ShadingModels.ush#L585">Disney
                        Diffuse</a> + <a
                        href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Source/Runtime/Engine/Private/Rendering/SeparableSSS.cpp">Separable
                        SSS</a> + <a
                        href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/SubsurfaceBurleyNormalized.ush#L1163">Disney
                        SSS</a></td>
                <td style="text-align:center"><a
                        href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/Lit/Lit.hlsl#L1349">Disney
                        Diffuse</a> + <a
                        href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/SubsurfaceScattering/SubsurfaceScattering.compute#L248">Disney
                        SSS</a></td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">Diffuse Transmittance Term</td>
                <td style="text-align:center">Deep Scatter</td>
                <td style="text-align:center"><a href="http://www.iryoku.com/translucency/">Analytically-Integrated
                        Translucency</a></td>
                <td style="text-align:center"><a
                        href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/ShadingModels.ush#L609">HG
                        Phase function</a></td>
                <td style="text-align:center">Disney SSS + Analytically-Integrated Translucency + <a
                        href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/SubsurfaceScattering/SubsurfaceScattering.hlsl#L225">Baked
                        Textured Thickness</a></td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">Specular Term</td>
                <td style="text-align:center">Two-lobe Blinn-Phong</td>
                <td style="text-align:center">KSK</td>
                <td style="text-align:center"><a
                        href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/ShadingModels.ush#L595">Dual
                        GGX</a></td>
                <td style="text-align:center">GGX</td>
            </tr>
        </tbody>
    </table>
    <h2 dir="auto" id="1-diffuse-reflectance-term">1. Diffuse Reflectance Term</h2>
    <h3 dir="auto" id="1-1-diffusion-profile">1-1. Diffusion Profile</h3>
    <p dir="auto">Currently, all real time approaches are based on the diffusion profile(<strong>14.4.2 Rendering with
            Diffusion Profile</strong> of [dEon 2007]) rather than the <a
            href="https://www.pbr-book.org/3ed-2018/Color_and_Radiometry/Surface_Reflection#TheBSSRDF">BSSRDF</a>.</p>
    <p dir="auto">By using the diffusion profile, the subsurface scattering, which was described by the BSSRDF, is
        simplified by scattering the <strong>amount</strong> of light (technically, the <strong>irradiance E</strong>)
        of each location to the vicinal locations according to the weights indicated by the diffusion profile. The
        <strong>outgoing</strong> irradiance E can also be called <strong>radiant exitance M</strong> and might be
        called <strong>radiosity B</strong> in the last century.<br>
        Evidently, an equivalent gather operation can be used to replace the scatter operation, and the total
        <strong>radiant exitance</strong> can be considered as <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">v</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msup>
                                            <mi mathvariant="double-struck">R</mi>
                                            <mn>2</mn>
                                        </msup>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">M</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>p</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>p</mi>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msup>
                                            <mi mathvariant="double-struck">R</mi>
                                            <mn>2</mn>
                                        </msup>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>p</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_v}(p_o) =
                                \int_{{\reals}^2} \operatorname{R}(p - p_o) \cdot \frac{\operatorname{M}(p)}{\pi} \, dp
                                = \int_{{\reals}^2} \operatorname{R}(p - p_o) \cdot \operatorname{F}(p) \, dp
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight"
                                                            style="margin-right:0.01389em;">v</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.38952999999999993em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mtight"><span
                                                                    class="mord mathbb mtight">R</span></span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.7463142857142857em;"><span
                                                                                style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">M</span></span><span
                                                        class="mopen">(</span><span
                                                        class="mord mathnormal">p</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.38952999999999993em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mtight"><span
                                                                    class="mord mathbb mtight">R</span></span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.7463142857142857em;"><span
                                                                                style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span></span>
        </eq> where the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo separator="true">,</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>y</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(\Delta x, \Delta y)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord">Δ</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                            class="mclose">)</span></span></span></span></eq> is the diffusion profile and <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{F}(p)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">F</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></eq> is
        the form factor at <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>p</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle p</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.625em;vertical-align:-0.19444em;"></span><span
                            class="mord mathnormal">p</span></span></span></span></eq>. Although the terms
        <strong>irradiance</strong> and <strong>form factor</strong> may be interchangeably used, technically
        <strong>irradiance</strong> should NOT be divided by <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>π</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \pi</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span></span></span></span></eq>. This means that <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mi>n</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi>π</mi>
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <mi>n</mi>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{E}(\overrightarrow{n})
                                = \pi \operatorname{F}(\overrightarrow{n})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">E</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">n</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1.20256em;vertical-align:-0.25em;"></span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">F</span></span><span class="mopen">(</span><span
                            class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.9525600000000001em;"><span style="top:-3em;"><span
                                                class="pstrut" style="height:3em;"></span><span
                                                class="mord mathnormal">n</span></span><span class="svg-align"
                                            style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span>
        </eq>.<br>
        And, currently, all real time approaches assume that the material is homogeneous. This means that the diffusion
        profile <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo separator="true">,</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>y</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(\Delta x, \Delta y)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord">Δ</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                            class="mclose">)</span></span></span></span></eq> is isotropic (radially symmetric), and can
        be reduced to the 1D function <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo separator="true">,</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>y</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msqrt>
                                        <mrow>
                                            <msup>
                                                <mrow>
                                                    <mi mathvariant="normal">Δ</mi>
                                                    <mi>x</mi>
                                                </mrow>
                                                <mn>2</mn>
                                            </msup>
                                            <mo>+</mo>
                                            <msup>
                                                <mrow>
                                                    <mi mathvariant="normal">Δ</mi>
                                                    <mi>y</mi>
                                                </mrow>
                                                <mn>2</mn>
                                            </msup>
                                        </mrow>
                                    </msqrt>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">∥</mi>
                                    <mi>p</mi>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mi mathvariant="normal">∥</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(\Delta x, \Delta y)
                                = \operatorname{R}(\sqrt{{\Delta x}^2 +{\Delta y}^2}) = \operatorname{R}(r) =
                                \operatorname{R}(\| p - p_o \|)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord">Δ</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1.84em;vertical-align:-0.459676em;"></span><span
                            class="mop"><span class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.380324em;"><span class="svg-align" style="top:-3.8em;"><span
                                                class="pstrut" style="height:3.8em;"></span><span class="mord"
                                                style="padding-left:1em;"><span class="mord"><span class="mord"><span
                                                            class="mord">Δ</span><span
                                                            class="mord mathnormal">x</span></span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.887338em;"><span
                                                                        style="top:-3.1362300000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mbin">+</span><span class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mord"><span class="mord"><span class="mord">Δ</span><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">y</span></span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.887338em;"><span
                                                                        style="top:-3.1362300000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                            style="top:-3.340324em;"><span class="pstrut"
                                                style="height:3.8em;"></span><span class="hide-tail"
                                                style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em'
                                                    height='1.8800000000000001em' viewBox='0 0 400000 1944'
                                                    preserveAspectRatio='xMinYMin slice'>
                                                    <path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.459676em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord">∥</span><span class="mord mathnormal">p</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∥</span><span class="mclose">)</span></span></span></span></eq>.
    </p>
    <p dir="auto">However, things are far from simple. Although the proposals based on the diffusion profile are much
        simpler than the BSSRDF, a general 2D convolution is still too expensive for real time rendering. Actually,
        according to [dEon 2007], if the width (technically, the range of the significant contribution domain) of the
        diffusion profile is about 16 mm, and the width of pixel is about 0.25 mm, we would need 4096(64 x 64) samples
        per pixel in the shader. Thus, we have to propose more efficient approaches to settle this problem.</p>
    <h3 dir="auto" id="1-2-preintegrated">1-2. Preintegrated</h3>
    <p dir="auto">The <strong>diffuse reflectance</strong> term of NVIDIA FaceWorks and the <strong>Preintegrated
            Skin</strong> <a
            href="https://docs.unrealengine.com/4.27/en-US/RenderingAndGraphics/Materials/MaterialProperties/LightingModels/">Shading
            Model</a> of UE4 is based on the <strong>Preintegrated</strong> [Penner 2011].</p>
    <p dir="auto">In real time rendering, the light is assumed to be the punctual light rather than the area light. The
        <a
            href="https://www.pbr-book.org/3ed-2018/Light_Transport_I_Surface_Reflection/Sampling_Light_Sources#LightswithSingularities">Delta
            Distribution</a> is applied, and the reflectance equation is simplified to <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">BRDF</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">i</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">BRDF</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⊗</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">E</mi>
                                            <mi mathvariant="normal">L</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⊗</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(p, \omega_o) =
                                \int_\Omega \operatorname{BRDF}(p, \omega_o, \omega_i) \cdot \operatorname{L_i}(p,
                                \omega_i) \cdot |\cos(\theta_i)| \, d\omega_i = \operatorname{BRDF}(p, \omega_o,
                                \omega_i) \otimes \operatorname{E_L}(p) \otimes |\cos(\theta)|</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">BRDF</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31750199999999995em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">BRDF</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">E</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">L</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mopen">(</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span
                            class="mord">∣</span></span></span></span></eq> where the <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">E</mi>
                                            <mi mathvariant="normal">L</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{E_L}(p)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">E</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">L</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span></span></span></span></eq> is the irradiance perpendicular to the
        light direction. And since the diffuse BRDF equals <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <msub>
                                            <mi>c</mi>
                                            <mrow>
                                                <mi>d</mi>
                                                <mi>i</mi>
                                                <mi>f</mi>
                                                <mi>f</mi>
                                                <mi>u</mi>
                                                <mi>s</mi>
                                                <mi>e</mi>
                                            </mrow>
                                        </msub>
                                        <mi>π</mi>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \frac{c_{diffuse}}{\pi}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.7935599999999998em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord mathnormal">c</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.3361079999999999em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mathnormal mtight">d</span><span
                                                                                        class="mord mathnormal mtight">i</span><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.10764em;">ff</span><span
                                                                                        class="mord mathnormal mtight">u</span><span
                                                                                        class="mord mathnormal mtight">se</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq> which is
        irrelevant to the the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>w</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle w_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02691em;">w</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>w</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle w_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02691em;">w</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>, the reflectance equation can be simplified further to <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">
                                                <msub>
                                                    <mi mathvariant="normal">c</mi>
                                                    <mrow>
                                                        <mi mathvariant="normal">d</mi>
                                                        <mi mathvariant="normal">i</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">u</mi>
                                                        <mi mathvariant="normal">s</mi>
                                                        <mi mathvariant="normal">e</mi>
                                                    </mrow>
                                                </msub>
                                            </mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>p</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⊗</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">E</mi>
                                            <mi mathvariant="normal">L</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⊗</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(p) =
                                \frac{\operatorname{c_{diffuse}}(p)}{\pi} \otimes \operatorname{E_L}(p) \otimes
                                |\cos(\theta)|</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord"><span
                                                                class="mord mathrm">c</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathrm mtight">diffuse</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                        class="mopen">(</span><span
                                                        class="mord mathnormal">p</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">E</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">L</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mopen">(</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span
                            class="mord">∣</span></span></span></span></eq>. Thus, the diffuse term is simplified to
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>S</mi>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">distance</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">i</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>p</mi>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>S</mi>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">distance</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">
                                                <msub>
                                                    <mi mathvariant="normal">c</mi>
                                                    <mrow>
                                                        <mi mathvariant="normal">d</mi>
                                                        <mi mathvariant="normal">i</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">u</mi>
                                                        <mi mathvariant="normal">s</mi>
                                                        <mi mathvariant="normal">e</mi>
                                                    </mrow>
                                                </msub>
                                            </mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>p</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">E</mi>
                                            <mi mathvariant="normal">L</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>p</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_o}(p_o) =
                                \int_{S_{p_o}} \operatorname{R}(\operatorname{distance}(p, p_o)) \cdot
                                \operatorname{L_i}(p) \, dp = \int_{S_{p_o}} \operatorname{R}(\operatorname{distance}(p,
                                p_o)) \cdot \frac{\operatorname{c_{diffuse}}(p)}{\pi} \cdot \operatorname{E_L}(p) \cdot
                                |\cos(\theta)| \, dp</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4720500000000003em;vertical-align:-1.11205em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.05764em;">S</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285716em;"><span
                                                                                style="top:-2.3569999999999998em;margin-left:-0.05764em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">p</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.23056em;"><span
                                                                                                                style="top:-2.3em;margin-left:0em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.5em;"></span><span
                                                                                                                    class="mord mathnormal mtight">o</span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.2em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.28585714285714287em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.11205em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">distance</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31750199999999995em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4720500000000003em;vertical-align:-1.11205em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.05764em;">S</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285716em;"><span
                                                                                style="top:-2.3569999999999998em;margin-left:-0.05764em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">p</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.23056em;"><span
                                                                                                                style="top:-2.3em;margin-left:0em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.5em;"></span><span
                                                                                                                    class="mord mathnormal mtight">o</span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.2em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.28585714285714287em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.11205em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">distance</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord"><span
                                                                class="mord mathrm">c</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathrm mtight">diffuse</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                        class="mopen">(</span><span
                                                        class="mord mathnormal">p</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">E</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">L</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mopen">(</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span></span>
        </eq>.
    </p>
    <p dir="auto">The main idea of [Penner 2011] is that the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">
                                                <msub>
                                                    <mi mathvariant="normal">c</mi>
                                                    <mrow>
                                                        <mi mathvariant="normal">d</mi>
                                                        <mi mathvariant="normal">i</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">u</mi>
                                                        <mi mathvariant="normal">s</mi>
                                                        <mi mathvariant="normal">e</mi>
                                                    </mrow>
                                                </msub>
                                            </mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>p</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">E</mi>
                                            <mi mathvariant="normal">L</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \frac{\operatorname{c_{diffuse}}(p)}{\pi} \cdot \operatorname{E_L}(p)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord"><span
                                                                class="mord mathrm">c</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathrm mtight">diffuse</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                        class="mopen">(</span><span
                                                        class="mord mathnormal">p</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">E</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">L</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span></span></span></span></eq> is assumed to be the constant <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">
                                                <msub>
                                                    <mi mathvariant="normal">c</mi>
                                                    <mrow>
                                                        <mi mathvariant="normal">d</mi>
                                                        <mi mathvariant="normal">i</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">u</mi>
                                                        <mi mathvariant="normal">s</mi>
                                                        <mi mathvariant="normal">e</mi>
                                                    </mrow>
                                                </msub>
                                            </mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>o</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">E</mi>
                                            <mi mathvariant="normal">L</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \frac{\operatorname{c_{diffuse}}(p_o)}{\pi} \cdot \operatorname{E_L}(p_o)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord"><span
                                                                class="mord mathrm">c</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathrm mtight">diffuse</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                        class="mopen">(</span><span class="mord"><span
                                                            class="mord mathnormal">p</span><span class="msupsub"><span
                                                                class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">E</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">L</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> for all vicinal locations, and thus the
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">distance</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{R}(\operatorname{distance}(p, p_o)) \cdot |\cos(\theta)|</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">distance</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mopen">(</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span
                            class="mord">∣</span></span></span></span></eq> part of the diffuse term can be
        <strong>preintegrated</strong> and stored in a LUT(Look Up Texture) which is called the <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>θ</mi>
                                    <mo separator="true">,</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>r</mi>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, \frac{1}{r})
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span
                            class="mclose">)</span></span></span></span></eq>. The <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>θ</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \theta</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span></span></span></span></eq> is merely the traditional
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">dot</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>N</mi>
                                    <mo separator="true">,</mo>
                                    <mi>L</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{dot}(N,L)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">dot</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.10903em;">N</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span></eq>, and
        the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>r</mi>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \frac{1}{r}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>, which is called
        <strong>curvature</strong> by [Penner 2011], can be calculated on-the-fly as <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>r</mi>
                                    </mfrac>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">ddx</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>N</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mrow>
                                            <mi mathvariant="normal">ddx</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>P</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \frac{1}{r} =
                                \frac{\operatorname{ddx}(N)}{\operatorname{ddx}(P)}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">ddx</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.13889em;">P</span><span
                                                        class="mclose">)</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">ddx</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.10903em;">N</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>. However, the
        on-the-fly method may be inaccurate since the FaceWorks chooses to precompute the curvature instead. In
        conclusion, the diffuse term can be calculated as <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">dot</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>N</mi>
                                    <mo separator="true">,</mo>
                                    <mi>L</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo separator="true">,</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">ddx</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>N</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mrow>
                                            <mi mathvariant="normal">ddx</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>P</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                    <mo>⊗</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">
                                                <msub>
                                                    <mi mathvariant="normal">c</mi>
                                                    <mrow>
                                                        <mi mathvariant="normal">d</mi>
                                                        <mi mathvariant="normal">i</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">u</mi>
                                                        <mi mathvariant="normal">s</mi>
                                                        <mi mathvariant="normal">e</mi>
                                                    </mrow>
                                                </msub>
                                            </mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>p</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⊗</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">E</mi>
                                            <mi mathvariant="normal">L</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{D}(\operatorname{dot}(N,L),
                                \frac{\operatorname{ddx}(N)}{\operatorname{ddx}(P)}) \otimes
                                \frac{\operatorname{c_{diffuse}}(p)}{\pi} \otimes \operatorname{E_L}(p)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.363em;vertical-align:-0.936em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">dot</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.10903em;">N</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">L</span><span class="mclose">)</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">ddx</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.13889em;">P</span><span
                                                        class="mclose">)</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">ddx</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.10903em;">N</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⊗</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord"><span
                                                                class="mord mathrm">c</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathrm mtight">diffuse</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                        class="mopen">(</span><span
                                                        class="mord mathnormal">p</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">E</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">L</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span></span></span></span></eq>.
    </p>
    <p dir="auto">Usually, the diffusion profile is normalized which indicates the energy conservation. This means that
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mrow>
                                            <mo>−</mo>
                                            <mi>π</mi>
                                        </mrow>
                                        <mi>π</mi>
                                    </msubsup>
                                    <mi>R</mi>
                                    <mo stretchy="false">(</mo>
                                    <mn>2</mn>
                                    <mi>r</mi>
                                    <mi>sin</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mfrac>
                                        <mi>x</mi>
                                        <mn>2</mn>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>x</mi>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_{-\pi}^{\pi}
                                R(2r\sin(\frac{x}{2})) \,dx = 1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.384573em;vertical-align:-0.970281em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03588em;">π</span></span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.970281em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal" style="margin-right:0.00773em;">R</span><span
                            class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                            class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">2</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">x</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">))</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span></span></span></span></eq>. However, according to [Penner 2011], <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>θ</mi>
                                    <mo separator="true">,</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>r</mi>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <msubsup>
                                                <mo>∫</mo>
                                                <mrow>
                                                    <mo>−</mo>
                                                    <mi>π</mi>
                                                </mrow>
                                                <mi>π</mi>
                                            </msubsup>
                                            <mi mathvariant="normal">∣</mi>
                                            <mi>cos</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>θ</mi>
                                            <mo>+</mo>
                                            <mi>x</mi>
                                            <mo stretchy="false">)</mo>
                                            <mi mathvariant="normal">∣</mi>
                                            <mo>⋅</mo>
                                            <mi>R</mi>
                                            <mo stretchy="false">(</mo>
                                            <mn>2</mn>
                                            <mi>r</mi>
                                            <mi>sin</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mfrac>
                                                <mi>x</mi>
                                                <mn>2</mn>
                                            </mfrac>
                                            <mo stretchy="false">)</mo>
                                            <mo stretchy="false">)</mo>
                                            <mtext> </mtext>
                                            <mi>d</mi>
                                            <mi>x</mi>
                                        </mrow>
                                        <mrow>
                                            <msubsup>
                                                <mo>∫</mo>
                                                <mrow>
                                                    <mo>−</mo>
                                                    <mi>π</mi>
                                                </mrow>
                                                <mi>π</mi>
                                            </msubsup>
                                            <mi>R</mi>
                                            <mo stretchy="false">(</mo>
                                            <mn>2</mn>
                                            <mi>r</mi>
                                            <mi>sin</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mfrac>
                                                <mi>x</mi>
                                                <mn>2</mn>
                                            </mfrac>
                                            <mo stretchy="false">)</mo>
                                            <mo stretchy="false">)</mo>
                                            <mtext> </mtext>
                                            <mi>d</mi>
                                            <mi>x</mi>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, \frac{1}{r})
                                = \frac{\int_{-\pi}^{\pi} | \cos (\theta + x) | \cdot R(2r\sin(\frac{x}{2}))
                                \,dx}{\int_{-\pi}^{\pi} R(2r\sin(\frac{x}{2})) \,dx}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.826886em;vertical-align:-1.163443em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.663443em;"><span style="top:-2.250708em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mop op-symbol small-op"
                                                            style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.8592920000000001em;"><span
                                                                            style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">−</span><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.03588em;">π</span></span></span></span><span
                                                                            style="top:-3.2579000000000002em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.41415100000000005em;"><span></span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.00773em;">R</span><span
                                                        class="mopen">(</span><span class="mord">2</span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mop">sin</span><span class="mopen">(</span><span
                                                        class="mord"><span class="mopen nulldelimiter"></span><span
                                                            class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.695392em;"><span
                                                                            style="top:-2.6550000000000002em;"><span
                                                                                class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span><span
                                                                            style="top:-3.23em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="frac-line"
                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                            style="top:-3.394em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mathnormal mtight">x</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.345em;"><span></span></span></span></span></span><span
                                                            class="mclose nulldelimiter"></span></span><span
                                                        class="mclose">))</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal">d</span><span
                                                        class="mord mathnormal">x</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.804151em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mop op-symbol small-op"
                                                            style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.8592920000000001em;"><span
                                                                            style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">−</span><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.03588em;">π</span></span></span></span><span
                                                                            style="top:-3.2579000000000002em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.41415100000000005em;"><span></span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord">∣</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mop">cos</span><span class="mopen">(</span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">+</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord mathnormal">x</span><span
                                                        class="mclose">)</span><span class="mord">∣</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.00773em;">R</span><span
                                                        class="mopen">(</span><span class="mord">2</span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mop">sin</span><span class="mopen">(</span><span
                                                        class="mord"><span class="mopen nulldelimiter"></span><span
                                                            class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.695392em;"><span
                                                                            style="top:-2.6550000000000002em;"><span
                                                                                class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span><span
                                                                            style="top:-3.23em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="frac-line"
                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                            style="top:-3.394em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mathnormal mtight">x</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.345em;"><span></span></span></span></span></span><span
                                                            class="mclose nulldelimiter"></span></span><span
                                                        class="mclose">))</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal">d</span><span
                                                        class="mord mathnormal">x</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.163443em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span>
        </eq> where denominator
        is added to make sure the diffusion profile is normalized.
    </p>
    <p dir="auto">In the GPU Pro 2, the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>θ</mi>
                                    <mo separator="true">,</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>r</mi>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, \frac{1}{r})
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span
                            class="mclose">)</span></span></span></span></eq> is calculated by
        <strong>integrateDiffuseScatteringOnRing</strong>. And there are some points to note.
    </p>
    <ol dir="auto">
        <li dir="auto">[Penner 2011] merely follows [dEon 2007] and the diffusion profile is approximated by the
            Gaussians (the <strong>Scatter</strong> in the code). However, the motivation of [dEon 2007] is that the <a
                href="https://en.wikipedia.org/wiki/Gaussian_blur">Gaussian blur</a> is a <a
                href="https://en.wikipedia.org/wiki/Separable_filter">separable filter</a>, and thus the general 2D
            convolution can be replaced by 1D convolutions to improve the performance. In my opinion, it is acceptable
            to perform a general 2D convolution even by using the exact accurate diffusion profile, since the approach
            proposed by [Penner 2011] <strong>pre-integrates</strong> the convolution, and the efficiency doesn't matter
            too much for offline precomputing.</li>
        <li dir="auto">The <strong>pre-integral</strong> is performed on a ring rather than on a sphere. This is
            reasonable since it is assumed that the diffusion profile is radially symmetric.</li>
        <li dir="auto">In the FaceWorks, according to the <strong>numerical quadrature</strong>, the funtion value <eq>
                <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mi mathvariant="normal">f</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <annotation encoding="application/x-tex">\operatorname{f}(x)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                                class="mopen">(</span><span class="mord mathnormal">x</span><span
                                class="mclose">)</span></span></span></span>
            </eq> is multiplied by the difference of the
            domain <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">Δ</mi>
                                        <mo>⁡</mo>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta}x
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.68333em;vertical-align:0em;"></span><span class="mop"><span
                                    class="mord mathrm">Δ</span></span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">x</span></span></span></span></eq> (the <strong>scale</strong>
            in the code).<br>
            However, in the GPU Pro 2, there is no such code like <strong>scale</strong> since the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">Δ</mi>
                                        <mo>⁡</mo>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta}x
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.68333em;vertical-align:0em;"></span><span class="mop"><span
                                    class="mord mathrm">Δ</span></span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">x</span></span></span></span></eq> appears in both numerator and
            denominator, and the it is not necessary to multiply <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">f</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>x</mi>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{f}(x)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                                class="mopen">(</span><span class="mord mathnormal">x</span><span
                                class="mclose">)</span></span></span></span></eq> by <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">Δ</mi>
                                        <mo>⁡</mo>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta}x
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.68333em;vertical-align:0em;"></span><span class="mop"><span
                                    class="mord mathrm">Δ</span></span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">x</span></span></span></span></eq>.</li>
    </ol>
    <p dir="auto">In the FaceWorks, the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>θ</mi>
                                    <mo separator="true">,</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>r</mi>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, \frac{1}{r})
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span
                            class="mclose">)</span></span></span></span></eq> is calculated by
        <strong>GFSDK_FaceWorks_GenerateCurvatureLUT</strong>. However, there is some subtle modification.
    </p>
    <ol dir="auto">
        <li dir="auto">The <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>2</mn>
                                        <mi>r</mi>
                                        <mi>sin</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mfrac>
                                            <mi>x</mi>
                                            <mn>2</mn>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 2r\sin(\frac{x}{2})</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span
                                class="mord">2</span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                                class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                    class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.10756em;"><span
                                                    style="top:-2.314em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">2</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathnormal">x</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span
                                class="mclose">)</span></span></span></span></eq> is replaced by the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi>r</mi>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle rx</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span
                                class="mord mathnormal">x</span></span></span></span></eq> (the <strong>delta</strong>
            in the code). Technically, the <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>2</mn>
                                        <mi>r</mi>
                                        <mi>sin</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mfrac>
                                            <mi>x</mi>
                                            <mn>2</mn>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 2r\sin(\frac{x}{2})</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span
                                class="mord">2</span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                                class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                    class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.10756em;"><span
                                                    style="top:-2.314em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">2</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathnormal">x</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span
                                class="mclose">)</span></span></span></span></eq> is more correct since the diffusion
            profile describes the light absorption inside the medium rather than over the surface. Perhaps the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>2</mn>
                                        <mi>r</mi>
                                        <mi>sin</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mfrac>
                                            <mi>x</mi>
                                            <mn>2</mn>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 2r\sin(\frac{x}{2})</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span
                                class="mord">2</span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                                class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                    class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.10756em;"><span
                                                    style="top:-2.314em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">2</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathnormal">x</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span
                                class="mclose">)</span></span></span></span></eq> and the <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi>r</mi>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle rx</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span
                                class="mord mathnormal">x</span></span></span></span></eq> are close when the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle x</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.43056em;vertical-align:0em;"></span><span
                                class="mord mathnormal">x</span></span></span></span></eq> is small.</li>
        <li dir="auto">The denominator <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <msubsup>
                                            <mo>∫</mo>
                                            <mrow>
                                                <mo>−</mo>
                                                <mi>π</mi>
                                            </mrow>
                                            <mi>π</mi>
                                        </msubsup>
                                        <mi>R</mi>
                                        <mo stretchy="false">(</mo>
                                        <mn>2</mn>
                                        <mi>r</mi>
                                        <mi>sin</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mfrac>
                                            <mi>x</mi>
                                            <mn>2</mn>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                        <mo stretchy="false">)</mo>
                                        <mtext> </mtext>
                                        <mi>d</mi>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \int_{-\pi}^{\pi}
                                    R(2r\sin(\frac{x}{2})) \,dx</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.384573em;vertical-align:-0.970281em;"></span><span class="mop"><span
                                    class="mop op-symbol large-op"
                                    style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.414292em;"><span
                                                    style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight">−</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">π</span></span></span></span><span
                                                    style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.970281em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal" style="margin-right:0.00773em;">R</span><span
                                class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                                class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                    class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.10756em;"><span
                                                    style="top:-2.314em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">2</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathnormal">x</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mclose">))</span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">d</span><span
                                class="mord mathnormal">x</span></span></span></span></eq> is omitted perhaps due to the
            fact that the diffusion profile has been normalized. Actually, I try to calculate the denominator by myself,
            and I find the denominator is really close to one.</li>
        <li dir="auto">In the GPU Pro 2, three normals should be used for different RGB components and the LUT should be
            sampled three times according to three different <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi>θ</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \theta</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">θ</span></span></span></span></eq>s. Perhaps this method
            is not efficient and the FaceWorks detaches the <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">dot</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>N</mi>
                                        <mo separator="true">,</mo>
                                        <mi>L</mi>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{dot}(N,L)
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">dot</span></span><span class="mopen">(</span><span
                                class="mord mathnormal" style="margin-right:0.10903em;">N</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span></eq>,
            which denotes the part of the integral where x is close to zero and the diffuse profile is close to one,
            from the total integral <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">D</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>θ</mi>
                                        <mo separator="true">,</mo>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mi>r</mi>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta,
                                    \frac{1}{r})</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mop"><span
                                    class="mord mathrm">D</span></span><span class="mopen">(</span><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">r</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span
                                class="mclose">)</span></span></span></span></eq>. Evidently, the remaining part of the
            integral is relatively small, and thus FaceWorks maps the remaining part of the integral from [-0.25, 0.25]
            to [0, 1] to fully use the precision of the texture (the <strong>rgbAdjust</strong> in the code). The
            <strong>GFSDK_FaceWorks_EvaluateSSSDirectLight</strong> is used to calculate the diffuse term. The LUT is
            only sampled once and three normals are used to calculate the <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">dot</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>N</mi>
                                        <mo separator="true">,</mo>
                                        <mi>L</mi>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{dot}(N,L)
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">dot</span></span><span class="mopen">(</span><span
                                class="mord mathnormal" style="margin-right:0.10903em;">N</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span></eq>
            which is detached from the total integral.
        </li>
    </ol>
    <h3 dir="auto" id="1-3-separable-sss">1-3. Separable SSS</h3>
    <p dir="auto">The <strong>diffuse reflectance</strong> term of the <strong>Subsurface Profile</strong> <a
            href="https://docs.unrealengine.com/4.27/en-US/RenderingAndGraphics/Materials/MaterialProperties/LightingModels/">Shading
            Model</a> <strong>without</strong> <a
            href="https://docs.unrealengine.com/4.27/en-US/RenderingAndGraphics/Materials/LightingModels/SubSurfaceProfile/">Enable
            Burley</a> of UE4 is based on the <strong>Separable SSS</strong> [Jimenez 2012].</p>
    <p dir="auto">The approach of [dEon 2007] is to approximate the diffusion profile by the weighted sum of 6
        Gaussians, and thus the general 2D convolution can be replaced by 12(2 x 6) 1D convolutions since the <a
            href="https://en.wikipedia.org/wiki/Gaussian_blur">Gaussian blur</a> is a <a
            href="https://en.wikipedia.org/wiki/Separable_filter">separable filter</a>. However, the approach proposed
        by [dEon 2007] is applied in texture space which is too weird according to the convention of the real time
        rendering. And the screen space approach is proposed by [Jimenez 2009]. However, the approach proposed by
        [Jimenez 2009] still needs 12(2 x 6) passes to perform the 12(2 x 6) 1D convolutions. Evidently, this is still
        too expensive for real time rendering. And thus, the 2 passes approach is proposed by [Jimenez 2012].</p>
    <p dir="auto">According to the <strong>numerical quadrature</strong>, the funtion value sampled from the irradiance
        texture should be multiplied by the difference of the domain <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">Δ</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta} p_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                            class="mop"><span class="mord mathrm">Δ</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>. [dEon 2007] proposed the <strong>stretch texture</strong>, where the difference of the world position is
        stored, to described the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">Δ</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta} p_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                            class="mop"><span class="mord mathrm">Δ</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>. Definitely, the screen space depth can be used to calculate the world position and thus the <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">Δ</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta} p_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                            class="mop"><span class="mord mathrm">Δ</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> can be obtained. However, the <strong>stretch factor</strong> proposed by [Jimenez 2009] is not
        proportional to the difference of the world position, and in my opinion, is empirical.</p>
    <p dir="auto">The the demo source code of [Jimenez 2012] is provided by [Jimenez 2015]. Perhaps you can not believe
        it but it is really the truth. <strong>The demo source code provided by [Jimenez 2015] has nothing to do with
            [Jimenez 2015]</strong>. This is really arcane, and I do spend some time to realize this fact.</p>
    <p dir="auto">The main idea of [Jimenez 2012] is that in real time rendering, the non-separable diffusion profile is
        represented by the discretized kernel where the SVD can be applied, and the SVD indicates that the diffusion
        profile kernel can be approximated by a separable kernel <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">M</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>x</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>y</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <munder>
                                        <mo>∑</mo>
                                        <mi>y</mi>
                                    </munder>
                                    <mo stretchy="false">(</mo>
                                    <munder>
                                        <mo>∑</mo>
                                        <mi>x</mi>
                                    </munder>
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>x</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>+</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>y</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>+</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>y</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">S</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msup>
                                            <mi mathvariant="normal">S</mi>
                                            <mi mathvariant="normal">T</mi>
                                        </msup>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>y</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{M}(x_o, y_o) = \sum_y
                                (\sum_x \operatorname{E}(x_o + \Delta x, y_o + \Delta y) \cdot \operatorname{S}(\Delta
                                x)) \cdot \operatorname{S^T}(\Delta y)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">M</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal">x</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.0500050000000003em;"><span
                                            style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight"
                                                    style="margin-right:0.03588em;">y</span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.386113em;"><span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:1.050005em;"><span
                                            style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">x</span></span></span><span
                                            style="top:-3.0500049999999996em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.250005em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">E</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal">x</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">Δ</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">S</span></span><span class="mopen">(</span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">S</span><span class="msupsub"><span
                                        class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                style="height:0.8913309999999999em;"><span
                                                    style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                        style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">Δ</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>
        </eq> where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">S</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">Δ</mi>
                                            <mi>x</mi>
                                            <mo>⋅</mo>
                                            <mtext>width</mtext>
                                        </mrow>
                                        <mrow>
                                            <mn>0.001</mn>
                                            <mo>+</mo>
                                            <mtext>falloff</mtext>
                                        </mrow>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mtext>strength</mtext>
                                    <mo>+</mo>
                                    <mi mathvariant="normal">δ</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <mtext>strength</mtext>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{S}(\Delta x) =
                                \operatorname{R}(\frac{\Delta x \cdot \text{width}}{0.001 + \text{falloff}}) \cdot
                                \text{strength} + \operatorname{\delta}(\Delta x) \cdot (1 - \text{strength})
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">S</span></span><span class="mopen">(</span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.14077em;vertical-align:-0.7693300000000001em;"></span><span
                            class="mop"><span class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">0.001</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">+</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord text"><span
                                                            class="mord">falloff</span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord text"><span
                                                            class="mord">width</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord text"><span class="mord">strength</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord">δ</span></span><span class="mopen">(</span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord text"><span class="mord">strength</span></span><span
                            class="mclose">)</span></span></span></span></eq> where <strong>R</strong> denotes the 1D
        diffusion profile and <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">δ</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{\delta}(\Delta x)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord">δ</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                            class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq>
        denotes the <a href="https://en.wikipedia.org/wiki/Dirac_delta_function">delta function</a> such that <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">δ</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>0</mn>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{\delta}(0) = 1
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord">δ</span></span><span class="mopen">(</span><span class="mord">0</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span></span></span></span></eq>.</p>
    <p dir="auto">The <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">S</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{S}(\Delta x)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">S</span></span><span class="mopen">(</span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mclose">)</span></span></span></span></eq> is calculated by the
        <strong>calculateKernel</strong> in the demo source code provided by [Jimenez 2015] and the
        <strong>ComputeMirroredSSSKernel</strong> in the UE4. And there are some points to note.
    </p>
    <ol dir="auto">
        <li dir="auto">The <strong>strength</strong>, which is the <strong>SubsurfaceColor</strong> in the UE4, is to
            lerp between the SSS diffuse term <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">R</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mfrac>
                                            <mrow>
                                                <mi mathvariant="normal">Δ</mi>
                                                <mi>x</mi>
                                                <mo>⋅</mo>
                                                <mtext>width</mtext>
                                            </mrow>
                                            <mrow>
                                                <mn>0.001</mn>
                                                <mo>+</mo>
                                                <mtext>falloff</mtext>
                                            </mrow>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(\frac{\Delta x
                                    \cdot \text{width}}{0.001 + \text{falloff}})</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.14077em;vertical-align:-0.7693300000000001em;"></span><span
                                class="mop"><span class="mord mathrm">R</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.37144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">0.001</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">+</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">falloff</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">Δ</span><span
                                                            class="mord mathnormal">x</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">⋅</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">width</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span
                                class="mclose">)</span></span></span></span></eq> and the conventional diffuse term <eq>
                <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">δ</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\delta}(\Delta x)
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mclose">)</span></span></span></span>
            </eq>. Evidently, when the
            <strong>strength</strong> equals 0, since <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">S</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi mathvariant="normal">δ</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi mathvariant="normal">Δ</mi>
                                            <mi>x</mi>
                                            <mo stretchy="false">)</mo>
                                        </mstyle>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{S}(\Delta x) =
                                    \displaystyle \operatorname{\delta}(\Delta x)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">S</span></span><span class="mopen">(</span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mop"><span class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mclose">)</span></span></span></span></eq> and <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">δ</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mn>0</mn>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <mn>1</mn>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\delta}(0) = 1
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord">0</span><span class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                            class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                                class="mord">1</span></span></span></span></eq>, the formula is reduced to the
            conventional diffuse term <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">M</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>x</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>y</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <munder>
                                            <mo>∑</mo>
                                            <mi>y</mi>
                                        </munder>
                                        <mo stretchy="false">(</mo>
                                        <munder>
                                            <mo>∑</mo>
                                            <mi>x</mi>
                                        </munder>
                                        <mi mathvariant="normal">E</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>x</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo>+</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>y</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo>+</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>y</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo>⋅</mo>
                                        <mi mathvariant="normal">S</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo stretchy="false">)</mo>
                                        <mo>⋅</mo>
                                        <mi mathvariant="normal">
                                            <msup>
                                                <mi mathvariant="normal">S</mi>
                                                <mi mathvariant="normal">T</mi>
                                            </msup>
                                        </mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>y</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <munder>
                                            <mo>∑</mo>
                                            <mi>y</mi>
                                        </munder>
                                        <mo stretchy="false">(</mo>
                                        <munder>
                                            <mo>∑</mo>
                                            <mi>x</mi>
                                        </munder>
                                        <mi mathvariant="normal">E</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>x</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo>+</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>y</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo>+</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>y</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo>⋅</mo>
                                        <mi mathvariant="normal">δ</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo stretchy="false">)</mo>
                                        <mo>⋅</mo>
                                        <mi mathvariant="normal">δ</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>y</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <mi mathvariant="normal">E</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>x</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>y</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{M}(x_o, y_o) =
                                    \sum_y (\sum_x \operatorname{E}(x_o + \Delta x, y_o + \Delta y) \cdot
                                    \operatorname{S}(\Delta x)) \cdot \operatorname{S^T}(\Delta y) = \sum_y (\sum_x
                                    \operatorname{E}(x_o + \Delta x, y_o + \Delta y) \cdot \operatorname{\delta}(\Delta
                                    x)) \cdot \operatorname{\delta}(\Delta y) = \operatorname{E}(x_o, y_o)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">M</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span
                                class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                            class="vlist" style="height:1.0500050000000003em;"><span
                                                style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">y</span></span></span><span
                                                style="top:-3.050005em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span><span
                                                        class="mop op-symbol large-op">∑</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.386113em;"><span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:1.050005em;"><span
                                                style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">x</span></span></span><span
                                                style="top:-3.0500049999999996em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span><span
                                                        class="mop op-symbol large-op">∑</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.250005em;"><span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mop"><span class="mord mathrm">E</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">+</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                                class="strut"
                                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">+</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord">Δ</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">⋅</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">S</span></span><span class="mopen">(</span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mclose">))</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span
                                class="mop"><span class="mord"><span class="mord mathrm">S</span><span
                                        class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.8913309999999999em;"><span
                                                        style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                            style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mord">Δ</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                class="mrel">=</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                                class="strut"
                                style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span
                                class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                            class="vlist" style="height:1.0500050000000003em;"><span
                                                style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">y</span></span></span><span
                                                style="top:-3.050005em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span><span
                                                        class="mop op-symbol large-op">∑</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.386113em;"><span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:1.050005em;"><span
                                                style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">x</span></span></span><span
                                                style="top:-3.0500049999999996em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span><span
                                                        class="mop op-symbol large-op">∑</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.250005em;"><span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mop"><span class="mord mathrm">E</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">+</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                                class="strut"
                                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">+</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord">Δ</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">⋅</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mclose">))</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mop"><span class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord">Δ</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                class="mrel">=</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">E</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span></span></span></eq>. The default of the
            <strong>strength</strong> in the demo source code is (0.48, 0.41, 0.28).
        </li>
        <li dir="auto">According to [dEon 2007], the width of the diffusion profile is about 16 mm. The
            <strong>falloff</strong>, which is the <strong>FalloffColor</strong> in the UE4, is to make the diffusion
            profile narrower, and thus the width of the diffusion profile in the demo source code is reduced to 6(3x2)
            mm (the <strong>RANGE</strong> in the <strong>calculateKernel</strong> in the code). The default of the
            <strong>falloff</strong> in the demo source code is (1.0, 0.37, 0.3).
        </li>
        <li dir="auto">Actually, the demo source code demonstrates that the <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mrow>
                                                <mi mathvariant="normal">Δ</mi>
                                                <mi>x</mi>
                                            </mrow>
                                            <mrow>
                                                <mn>0.001</mn>
                                                <mo>+</mo>
                                                <mtext>falloff</mtext>
                                            </mrow>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \frac{\Delta x}{0.001 +
                                    \text{falloff}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.36033em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">0.001</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">+</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">falloff</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">Δ</span><span
                                                            class="mord mathnormal">x</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq> is passed to
            the diffusion profile <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">R</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>r</mi>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(r)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">R</span></span><span class="mopen">(</span><span
                                class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                                class="mclose">)</span></span></span></span></eq> directly without the
            <strong>width</strong> in the formula. This implies the <strong>width</strong> in the formula is actually
            fixed at 1.
        </li>
        <li dir="auto">According to the <strong>numerical quadrature</strong>, the function value sampled from the
            irradiance texture should be multiplied by the difference of the domain the <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">Δ</mi>
                                        <mo>⁡</mo>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta} x
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.68333em;vertical-align:0em;"></span><span class="mop"><span
                                    class="mord mathrm">Δ</span></span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">x</span></span></span></span></eq> and the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">Δ</mi>
                                        <mo>⁡</mo>
                                        <mi>y</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta} y
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                                class="mop"><span class="mord mathrm">Δ</span></span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span></span></span></span></eq> (the
            <strong>area</strong> in the <strong>calculateKernel</strong> in the code). And the demo source code
            demonstrates that the deviations of the locations of the samples in world space (in mm) is fixed and stored
            in the <strong>w</strong> component of the <strong>kernel</strong> member of the
            <strong>SeparableSSS</strong> class. Thus, the mere purpose of the <strong>SSSSBlurPS</strong> in the shader
            code is to transform the deviations from world space to texture space. Assuming that the deviations are from
            the origin of the Y axis, the transformation can be calculated as <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mtext>TextureSpace</mtext>
                                        <mo>=</mo>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mn>2</mn>
                                        </mfrac>
                                        <mo>×</mo>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mrow>
                                                <mi>tan</mi>
                                                <mo>⁡</mo>
                                                <mo stretchy="false">(</mo>
                                                <mtext>FOVY</mtext>
                                                <mo>×</mo>
                                                <mn>0.5</mn>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mfrac>
                                        <mo>×</mo>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mtext>ViewPositionZInWorldSpaceUnit</mtext>
                                        </mfrac>
                                        <mo>×</mo>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mrow>
                                                <mn>1000</mn>
                                                <mo>×</mo>
                                                <mtext>MetersPerWorldSpaceUnit</mtext>
                                            </mrow>
                                        </mfrac>
                                        <mo>×</mo>
                                        <mtext>WorldSpaceDeltaXInMM</mtext>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \text{TextureSpace} = \frac{1}{2}
                                    \times\frac{1}{\tan(\text{FOVY} \times 0.5)} \times
                                    \frac{1}{\text{ViewPositionZInWorldSpaceUnit}} \times \frac{1}{1000 \times
                                    \text{MetersPerWorldSpaceUnit}} \times \text{WorldSpaceDeltaXInMM}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord text"><span class="mord">TextureSpace</span></span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">2</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.25744em;vertical-align:-0.936em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mop">tan</span><span
                                                            class="mopen">(</span><span class="mord text"><span
                                                                class="mord">FOVY</span></span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord">0.5</span><span
                                                            class="mclose">)</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.936em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord text"><span
                                                                class="mord">ViewPositionZInWorldSpaceUnit</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">1000</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">MetersPerWorldSpaceUnit</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord text"><span
                                    class="mord">WorldSpaceDeltaXInMM</span></span></span></span></span></eq> where the
            1000 is to transform from mm to m, the <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mn>1</mn>
                                            <mrow>
                                                <mi>tan</mi>
                                                <mo>⁡</mo>
                                                <mo stretchy="false">(</mo>
                                                <mtext>FOVY</mtext>
                                                <mo>×</mo>
                                                <mn>0.5</mn>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \frac{1}{\tan(\text{FOVY} \times
                                    0.5)}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.25744em;vertical-align:-0.936em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mop">tan</span><span
                                                            class="mopen">(</span><span class="mord text"><span
                                                                class="mord">FOVY</span></span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord">0.5</span><span
                                                            class="mclose">)</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.936em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq> is the second
            row and the second column of the projection matrix, and the 2 is to transform from NDC to texture space.
            However, since the width of the diffusion profile is fixed at 6(3x2) mm and the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mrow>
                                                <mi mathvariant="normal">Δ</mi>
                                                <mi>x</mi>
                                            </mrow>
                                            <mrow>
                                                <mn>0.001</mn>
                                                <mo>+</mo>
                                                <mtext>falloff</mtext>
                                            </mrow>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \frac{\Delta x}{0.001 +
                                    \text{falloff}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.36033em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">0.001</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">+</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">falloff</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">Δ</span><span
                                                            class="mord mathnormal">x</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq> is passed to
            the diffusion profile <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">P</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>r</mi>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{P}(r)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">P</span></span><span class="mopen">(</span><span
                                class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                                class="mclose">)</span></span></span></span></eq> directly without the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi>w</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle w</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                                style="margin-right:0.02691em;">w</span></span></span></span></eq> in the formula, the
            <strong>sssWidth</strong>, which is <strong>ScatterRadius</strong> in the UE4, is impossible to be
            considered as the <strong>width</strong> of the diffusion profile or the <strong>width</strong> in the
            formula. And since the shader code of the demo source code demonstrates that the transformation is
            calculated as <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mtext>TextureSpace</mtext>
                                        <mo>=</mo>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mrow>
                                                <mi>tan</mi>
                                                <mo>⁡</mo>
                                                <mo stretchy="false">(</mo>
                                                <mtext>FOVY</mtext>
                                                <mo>×</mo>
                                                <mn>0.5</mn>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mfrac>
                                        <mo>×</mo>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mtext>ViewPositionZInWorldSpaceUnit</mtext>
                                        </mfrac>
                                        <mo>×</mo>
                                        <mfrac>
                                            <mtext>sssWidth</mtext>
                                            <mn>3</mn>
                                        </mfrac>
                                        <mo>×</mo>
                                        <mtext>WorldSpaceDeltaXInMM</mtext>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \text{TextureSpace} =
                                    \frac{1}{\tan(\text{FOVY} \times 0.5)} \times
                                    \frac{1}{\text{ViewPositionZInWorldSpaceUnit}} \times\frac{\text{sssWidth}}{3}
                                    \times \text{WorldSpaceDeltaXInMM}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord text"><span class="mord">TextureSpace</span></span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.25744em;vertical-align:-0.936em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mop">tan</span><span
                                                            class="mopen">(</span><span class="mord text"><span
                                                                class="mord">FOVY</span></span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord">0.5</span><span
                                                            class="mclose">)</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.936em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord text"><span
                                                                class="mord">ViewPositionZInWorldSpaceUnit</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.37144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">3</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord text"><span
                                                                class="mord">sssWidth</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord text"><span
                                    class="mord">WorldSpaceDeltaXInMM</span></span></span></span></span></eq>, by
            comparing these two formulas, a hypothesis can be proposed that <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mtext>MetersPerWorldSpaceUnit</mtext>
                                        <mo>=</mo>
                                        <mfrac>
                                            <mn>3</mn>
                                            <mrow>
                                                <mn>1000</mn>
                                                <mo>×</mo>
                                                <mn>2</mn>
                                                <mo>×</mo>
                                                <mtext>sssWidth</mtext>
                                            </mrow>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \text{MetersPerWorldSpaceUnit} =
                                    \frac{3}{1000 \times 2 \times \text{sssWidth}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord text"><span class="mord">MetersPerWorldSpaceUnit</span></span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                class="mrel">=</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                                class="strut"
                                style="height:2.09077em;vertical-align:-0.7693300000000001em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">1000</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord">2</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">sssWidth</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">3</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq>. The default
            of the <strong>sssWidth</strong> in the demo source code is 0.012, and thus the hypothesis implies that the
            <strong>MetersPerWorldSpaceUnit</strong> of the demo is <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mn>1</mn>
                                            <mn>8</mn>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \frac{1}{8}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">8</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq>. Actually, I
            check the vertex data of the head mesh in the demo, and fortunately, I find the vertex data is consistent
            with this result.
        </li>
        <li dir="auto">The <strong>SSSS_STRENGTH_SOURCE</strong> in the shader code has nothing to do with the
            <strong>strength</strong> in the paper at all. In the demo source code, the
            <strong>SSSS_STREGTH_SOURCE</strong> is the alpha channel of the albedo texture, and is used to skip the
            pixels which represent the eyebrow rather than the skin. However, this empirical <strong>strength</strong>
            value is adopted by both UE4 and Unity3D. The equivalent in UE4 is called <a
                href="https://docs.unrealengine.com/4.26/en-US/RenderingAndGraphics/Materials/LightingModels/SubSurfaceProfile/#materialinputchannels">Opacity
                Map</a>, and the equivalent in Unity3D is called <a
                href="https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@10.8/manual/Material-Type.html">Subsurface
                Mask Map</a>.
        </li>
    </ol>
    <p dir="auto">Canonically, we should <strong>NOT</strong> blur the specular lighting. Thus, a dedicated <a
            href="https://github.com/iryoku/separable-sss/blob/master/Demo/Shaders/Main.fx#L272">specularRT</a> is added
        in the demo source code provided by [Jimenez 2015] to store the specular lighting. However, the <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/LightAccumulator.ush#L18">checkerboard
            rendering</a>, which is a bit tricky, is applied in UE4 to store the diffuse lighting and specular lighting
        in adjacent pixels. And the gbuffer data is modified by <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/DeferredShadingCommon.ush#L605">AdjustBaseColorAndSpecularColorForSubsurfaceProfileLighting</a>
        in UE4 before the lighting is calculated.</p>
    <h3 dir="auto" id="1-4-disney-sss">1-4. Disney SSS</h3>
    <p dir="auto">The <strong>diffuse reflectance</strong> term of <a
            href="https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@10.8/manual/Diffusion-Profile.html">Unity3D</a>
        and the <strong>Subsurface Profile</strong> <a
            href="https://docs.unrealengine.com/4.27/en-US/RenderingAndGraphics/Materials/MaterialProperties/LightingModels/">Shading
            Model</a> with <a
            href="https://docs.unrealengine.com/4.27/en-US/RenderingAndGraphics/Materials/LightingModels/SubSurfaceProfile/">Enable
            Burley</a> of UE4 is based on the <strong>Disney SSS</strong> [Golubev 2018].</p>
    <h4 dir="auto" id="1-4-1-importance-sampling">1-4-1. Importance Sampling</h4>
    <h5 dir="auto" id="1-4-1-1-pdf">1-4-1-1. PDF</h5>
    <p dir="auto">The diffusion profile <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi>A</mi>
                                            <mi>s</mi>
                                        </mrow>
                                        <mrow>
                                            <mn>8</mn>
                                            <mi>π</mi>
                                            <mi>r</mi>
                                        </mrow>
                                    </mfrac>
                                    <mo stretchy="false">(</mo>
                                    <msup>
                                        <mi>e</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mi>s</mi>
                                            <mi>r</mi>
                                        </mrow>
                                    </msup>
                                    <mo>+</mo>
                                    <msup>
                                        <mi>e</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mfrac>
                                                <mn>1</mn>
                                                <mn>3</mn>
                                            </mfrac>
                                            <mi>s</mi>
                                            <mi>r</mi>
                                        </mrow>
                                    </msup>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(r) = \frac{A s}{8
                                \pi r}(e^{-sr}+e^{-\frac{1}{3}sr})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">8</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">A</span><span
                                                        class="mord mathnormal">s</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.02778em;">sr</span></span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.2540200000000001em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:1.0040200000000001em;"><span
                                                style="top:-3.4130000000000003em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:3em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight"><span
                                                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                                class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.8443142857142858em;"><span
                                                                                style="top:-2.656em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">3</span></span></span></span><span
                                                                                style="top:-3.2255000000000003em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="frac-line mtight"
                                                                                    style="border-bottom-width:0.049em;"></span></span><span
                                                                                style="top:-3.384em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">1</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.344em;"><span></span></span></span></span></span><span
                                                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.02778em;">sr</span></span></span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>, where the A is the albedo and the s is
        the scaling factor, proposed by [Christensen 2015] is applied.</p>
    <p dir="auto">Analogously to &quot;Figure 13.10&quot; of <a
            href="https://pbr-book.org/3ed-2018/Monte_Carlo_Integration/2D_Sampling_with_Multidimensional_Transformations#SamplingaUnitDisk">PBR
            Book</a>, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mrow>
                                            <mo>−</mo>
                                            <mi mathvariant="normal">∞</mi>
                                        </mrow>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mrow>
                                            <mo>−</mo>
                                            <mi mathvariant="normal">∞</mi>
                                        </mrow>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mrow>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                    </mrow>
                                    <mo separator="true">,</mo>
                                    <mrow>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>y</mi>
                                    </mrow>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mrow>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                    </mrow>
                                    <mi>d</mi>
                                    <mrow>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>y</mi>
                                    </mrow>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mrow>
                                            <mn>2</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </msubsup>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo stretchy="false">)</mo>
                                    <mi>r</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>θ</mi>
                                    <mi>d</mi>
                                    <mi>r</mi>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mi>o</mi>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo stretchy="false">)</mo>
                                    <mn>2</mn>
                                    <mi>π</mi>
                                    <mi>r</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>r</mi>
                                    <mo>=</mo>
                                    <mi>A</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_{-\infin}^\infin
                                \int_{-\infin}^\infin \operatorname{R}({\Delta x}, {\Delta y}) \, d {\Delta x} d {\Delta
                                y} = \int_0^\infin \int_0^{2\pi} \operatorname{R}(r) r \, d \theta dr = \int_o^\infin
                                \operatorname{R} (r) 2 \pi r \, dr = A</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.384573em;vertical-align:-0.970281em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">∞</span></span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.970281em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">∞</span></span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.970281em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord">Δ</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span></span><span class="mclose">)</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord">Δ</span><span
                                class="mord mathnormal">x</span></span><span class="mord mathnormal">d</span><span
                            class="mord"><span class="mord">Δ</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.5640080000000003em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">2</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mclose">)</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.3262420000000006em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.4142920000000005em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span><span
                                                style="top:-3.812900000000001em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mclose">)</span><span class="mord">2</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span
                            class="mord mathnormal">A</span></span></span></span></eq>. Evidently, by [Golubev 2018],
        the normalized function can be used as the PDF <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">p</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo separator="true">,</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">R</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>r</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>A</mi>
                                    </mfrac>
                                    <mi>r</mi>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mi>s</mi>
                                        <mrow>
                                            <mn>8</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </mfrac>
                                    <mo stretchy="false">(</mo>
                                    <msup>
                                        <mi>e</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mi>s</mi>
                                            <mi>r</mi>
                                        </mrow>
                                    </msup>
                                    <mo>+</mo>
                                    <msup>
                                        <mi>e</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mfrac>
                                                <mrow>
                                                    <mi>s</mi>
                                                    <mi>r</mi>
                                                </mrow>
                                                <mn>3</mn>
                                            </mfrac>
                                        </mrow>
                                    </msup>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{p}(r, \theta) =
                                \frac{\operatorname{R}(r)}{A} r = \frac{s}{8 \pi}(e^{-sr}+e^{-\frac{sr}{3}})
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">p</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">A</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">R</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">8</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">s</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.02778em;">sr</span></span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.1470799999999999em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.89708em;"><span
                                                style="top:-3.4130000000000003em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:3em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight"><span
                                                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                                class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.6915428571428572em;"><span
                                                                                style="top:-2.656em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">3</span></span></span></span><span
                                                                                style="top:-3.2255000000000003em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="frac-line mtight"
                                                                                    style="border-bottom-width:0.049em;"></span></span><span
                                                                                style="top:-3.384em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathnormal mtight"
                                                                                            style="margin-right:0.02778em;">sr</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.344em;"><span></span></span></span></span></span><span
                                                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.</p>
    <p dir="auto">Analogously to &quot;Equation (14.1)&quot; of <a
            href="https://pbr-book.org/3ed-2018/Light_Transport_I_Surface_Reflection/Sampling_Reflection_Functions#MicrofacetBxDFs">PBR
            Book</a>, we can derive the sampling of diffusion profile. Since the diffusion profile is isotropic
        (radially symmetric), we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">p</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>θ</mi>
                                        <mi mathvariant="normal">∣</mi>
                                        <mi>r</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mrow>
                                                <mn>2</mn>
                                                <mi>π</mi>
                                            </mrow>
                                        </mfrac>
                                        <mo>⇒</mo>
                                        <mi>θ</mi>
                                        <mo>=</mo>
                                        <mn>2</mn>
                                        <mi>π</mi>
                                        <msub>
                                            <mi>ξ</mi>
                                            <mn>2</mn>
                                        </msub>
                                    </mstyle>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \displaystyle \operatorname{p}(\theta
                                | r) = \frac{1}{2 \pi} \Rightarrow \theta = 2 \pi \xi_2</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">p</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                            class="mord">∣</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">2</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">⇒</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord">2</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.04601em;">ξ</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">2</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>. Since the PDF is <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">p</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo separator="true">,</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">R</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>r</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>A</mi>
                                    </mfrac>
                                    <mi>r</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{p}(r, \theta) =
                                \frac{\operatorname{R}(r)}{A} r</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">p</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">A</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">R</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span></span></span></span></eq>, we have the marginal PDF
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">p</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mrow>
                                            <mn>2</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </msubsup>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>θ</mi>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo stretchy="false">)</mo>
                                    <mn>2</mn>
                                    <mi>π</mi>
                                    <mi>r</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{p}(r) = \int_0^{2 \pi}
                                \operatorname{R}(r) \, d \theta = \operatorname{R}(r) 2 \pi r</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">p</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.5640080000000003em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">2</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mclose">)</span><span class="mord">2</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span></span></span></span></eq> and the CDF <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">P</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi>r</mi>
                                    </msubsup>
                                    <mi mathvariant="normal">p</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msup>
                                        <mi>r</mi>
                                        <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                    </msup>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msup>
                                        <mi>r</mi>
                                        <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                    </msup>
                                    <mo>=</mo>
                                    <msub>
                                        <mi>ξ</mi>
                                        <mn>1</mn>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{P}(r) = \int_0^{r}
                                \operatorname{p}(r&#x27;) \, d r&#x27; = \xi_1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">P</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.02778em;">r</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">p</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.801892em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.801892em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>. Fortunately, by [Golubev 2018], the inverse of the CDF is closed-form and we have <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>s</mi>
                                    <mi>r</mi>
                                    <mo>=</mo>
                                    <mn>3</mn>
                                    <msub>
                                        <mrow>
                                            <mi>log</mi>
                                            <mo>⁡</mo>
                                        </mrow>
                                        <mn>2</mn>
                                    </msub>
                                    <mo stretchy="false">(</mo>
                                    <mfrac>
                                        <mrow>
                                            <mn>1</mn>
                                            <mo>+</mo>
                                            <msup>
                                                <mrow>
                                                    <mi mathvariant="normal">G</mi>
                                                    <mo>⁡</mo>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>u</mi>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                                <mrow>
                                                    <mo>−</mo>
                                                    <mfrac>
                                                        <mn>1</mn>
                                                        <mn>3</mn>
                                                    </mfrac>
                                                </mrow>
                                            </msup>
                                            <mo>+</mo>
                                            <msup>
                                                <mrow>
                                                    <mi mathvariant="normal">G</mi>
                                                    <mo>⁡</mo>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>u</mi>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                                <mfrac>
                                                    <mn>1</mn>
                                                    <mn>3</mn>
                                                </mfrac>
                                            </msup>
                                        </mrow>
                                        <mrow>
                                            <mn>4</mn>
                                            <mi>u</mi>
                                        </mrow>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle s r = 3 \log_2(\frac{1 +
                                {\operatorname{G}(u)}^{-\frac{1}{3}} + {\operatorname{G}(u)}^{\frac{1}{3}}}{4 u})
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">sr</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.45692em;vertical-align:-0.686em;"></span><span
                            class="mord">3</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.20696799999999996em;"><span
                                                style="top:-2.4558600000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">2</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.24414em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.77092em;"><span style="top:-2.40792em;"><span class="pstrut"
                                                    style="height:3.09392em;"></span><span class="mord"><span
                                                        class="mord">4</span><span
                                                        class="mord mathnormal">u</span></span></span><span
                                                style="top:-3.3239199999999998em;"><span class="pstrut"
                                                    style="height:3.09392em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.77092em;"><span class="pstrut"
                                                    style="height:3.09392em;"></span><span class="mord"><span
                                                        class="mord">1</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">+</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord"><span class="mord"><span class="mop"><span
                                                                    class="mord mathrm">G</span></span><span
                                                                class="mopen">(</span><span
                                                                class="mord mathnormal">u</span><span
                                                                class="mclose">)</span></span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:1.09392em;"><span
                                                                            style="top:-3.5029000000000003em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">−</span><span
                                                                                        class="mord mtight"><span
                                                                                            class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                                                            class="mfrac"><span
                                                                                                class="vlist-t vlist-t2"><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.8443142857142858em;"><span
                                                                                                            style="top:-2.656em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height:3em;"></span><span
                                                                                                                class="sizing reset-size3 size1 mtight"><span
                                                                                                                    class="mord mtight"><span
                                                                                                                        class="mord mtight">3</span></span></span></span><span
                                                                                                            style="top:-3.2255000000000003em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height:3em;"></span><span
                                                                                                                class="frac-line mtight"
                                                                                                                style="border-bottom-width:0.049em;"></span></span><span
                                                                                                            style="top:-3.384em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height:3em;"></span><span
                                                                                                                class="sizing reset-size3 size1 mtight"><span
                                                                                                                    class="mord mtight"><span
                                                                                                                        class="mord mtight">1</span></span></span></span></span><span
                                                                                                        class="vlist-s">​</span></span><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.344em;"><span></span></span></span></span></span><span
                                                                                            class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">+</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord"><span class="mord"><span class="mop"><span
                                                                    class="mord mathrm">G</span></span><span
                                                                class="mopen">(</span><span
                                                                class="mord mathnormal">u</span><span
                                                                class="mclose">)</span></span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:1.09392em;"><span
                                                                            style="top:-3.5029000000000003em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                                                            class="mfrac"><span
                                                                                                class="vlist-t vlist-t2"><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.8443142857142858em;"><span
                                                                                                            style="top:-2.656em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height:3em;"></span><span
                                                                                                                class="sizing reset-size3 size1 mtight"><span
                                                                                                                    class="mord mtight"><span
                                                                                                                        class="mord mtight">3</span></span></span></span><span
                                                                                                            style="top:-3.2255000000000003em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height:3em;"></span><span
                                                                                                                class="frac-line mtight"
                                                                                                                style="border-bottom-width:0.049em;"></span></span><span
                                                                                                            style="top:-3.384em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height:3em;"></span><span
                                                                                                                class="sizing reset-size3 size1 mtight"><span
                                                                                                                    class="mord mtight"><span
                                                                                                                        class="mord mtight">1</span></span></span></span></span><span
                                                                                                        class="vlist-s">​</span></span><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.344em;"><span></span></span></span></span></span><span
                                                                                            class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span
                            class="mclose">)</span></span></span></span></eq> where <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">G</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>u</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                    <mo>+</mo>
                                    <mn>4</mn>
                                    <mi>u</mi>
                                    <mo stretchy="false">(</mo>
                                    <mn>2</mn>
                                    <mi>u</mi>
                                    <mo>+</mo>
                                    <msqrt>
                                        <mrow>
                                            <mn>1</mn>
                                            <mo>+</mo>
                                            <mn>4</mn>
                                            <msup>
                                                <mi>u</mi>
                                                <mn>2</mn>
                                            </msup>
                                        </mrow>
                                    </msqrt>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{G}(u) = 1 + 4u(2u +
                                \sqrt{1 + 4u^2})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">G</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">u</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">4</span><span class="mord mathnormal">u</span><span class="mopen">(</span><span
                            class="mord">2</span><span class="mord mathnormal">u</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.3122639999999999em;vertical-align:-0.25em;"></span><span
                            class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.0622639999999999em;"><span class="svg-align"
                                            style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span
                                                class="mord" style="padding-left:1em;"><span class="mord">1</span><span
                                                    class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mbin">+</span><span class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mord">4</span><span class="mord"><span
                                                        class="mord mathnormal">u</span><span class="msupsub"><span
                                                            class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                    style="height:0.740108em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                            style="top:-3.0222640000000003em;"><span class="pstrut"
                                                style="height:3.2em;"></span><span class="hide-tail"
                                                style="min-width:1.02em;height:1.28em;"><svg width='400em'
                                                    height='1.28em' viewBox='0 0 400000 1296'
                                                    preserveAspectRatio='xMinYMin slice'>
                                                    <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.177736em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> and <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>u</mi>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>ξ</mi>
                                        <mn>1</mn>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle u = 1 - \xi_1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span
                            class="mord mathnormal">u</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.
    </p>
    <p dir="auto">The sampling of diffusion profile is calculated by <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/SubsurfaceBurleyNormalized.ush#L347">RadiusRootFindAnalytic</a>
        in UE4 and <a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/SubsurfaceScattering/SubsurfaceScattering.compute#L182">SampleBurleyDiffusionProfile</a>
        in Unity3D.</p>
    <h5 dir="auto" id="1-4-1-2-low-discrepancy">1-4-1-2. Low-Discrepancy</h5>
    <p dir="auto">By &quot;20.3 Quasirandom Low-Discrepancy Sequences&quot; of [Colbert 2007], <strong>Quasi Monte
            Carlo</strong> (&quot;13.8.2 Quasi Monte Carlo&quot; of <a
            href="https://pbr-book.org/3ed-2018/Monte_Carlo_Integration/Careful_Sample_Placement#QuasiMonteCarlo">PBR
            Book</a>) is preferred and the pseudo-random sequence is replaced by the low-discrepancy <strong>Hammersley
            sequence</strong> (&quot;7.4.1 Hammersley and Halton Sequences&quot; of <a
            href="https://pbr-book.org/3ed-2018/Sampling_and_Reconstruction/The_Halton_Sampler#HammersleyandHaltonSequences">PBR
            Book</a>) to generate the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ξ</mi>
                                        <mn>1</mn>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \xi_1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ξ</mi>
                                        <mn>2</mn>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \xi_2</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">2</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.</p>
    <p dir="auto">The <strong>Hammersley sequence</strong> is calculated by <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/MonteCarlo.ush#L34">Hammersley</a>
        in UE4 and <a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.core/ShaderLibrary/Sampling/Hammersley.hlsl#L415">Hammersley2d</a>
        in Unity3D.</p>
    <p dir="auto">However, the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ξ</mi>
                                        <mn>1</mn>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \xi_1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is generated by pseudo-random sequence in UE4 and by evenly spaced sequence in Unity3D.</p>
    <p dir="auto">The <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ξ</mi>
                                        <mn>1</mn>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \xi_1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is calculated by <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/SubsurfaceBurleyNormalized.ush#L935">Generate2DRandomNumber</a>
        in UE4 and <a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/SubsurfaceScattering/SubsurfaceScattering.compute#L182">i
            * scale + offset</a> in Unity3D.</p>
    <p dir="auto">And the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ξ</mi>
                                        <mn>2</mn>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \xi_2</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.04601em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">2</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is generated by <strong>Fibonacci sequence</strong>, which is related to the <a
            href="https://en.wikipedia.org/wiki/Golden_ratio#Relationship_to_Fibonacci_sequence">Golden Ratio</a>, in
        both UE4 and Unity3D.</p>
    <p dir="auto">The <strong>Fibonacci sequence</strong> is calculated by <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/SubsurfaceBurleyNormalized.ush#L332">FIBONACCI_SEQUENCE_ANGLE</a>
        in UE4 and <a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.core/ShaderLibrary/Sampling/Fibonacci.hlsl#L248">Fibonacci2d</a>
        in Unity3D.</p>
    <h5 dir="auto" id="1-4-1-3-stratified-sampling">1-4-1-3. Stratified Sampling</h5>
    <p dir="auto">In UE4, the <strong>Center Sample Reweighting</strong>, which is controlled by the macro
        <strong>REWEIGHT_CENTER_SAMPLE</strong>, is used, and the <strong>CDF</strong> of the center sample is
        calculated and removed from the vicinal samples. The UE4 claims that the result of this approach is still
        unbiased.
    </p>
    <h4 dir="auto" id="1-4-2-albedo">1-4-2. Albedo</h4>
    <p dir="auto">By appealing <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">p</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo separator="true">,</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">R</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>r</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>A</mi>
                                    </mfrac>
                                    <mi>r</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{p}(r, \theta) =
                                \frac{\operatorname{R}(r)}{A} r</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">p</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">A</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">R</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span></span></span></span></eq> to <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">v</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msup>
                                            <mi mathvariant="double-struck">R</mi>
                                            <mn>2</mn>
                                        </msup>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>p</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_v}(p_o) =
                                \int_{{\reals}^2} \operatorname{R}(p - p_o) \cdot \operatorname{F}(p) \, dp</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight"
                                                            style="margin-right:0.01389em;">v</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.38952999999999993em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mtight"><span
                                                                    class="mord mathbb mtight">R</span></span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.7463142857142857em;"><span
                                                                                style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span></span>
        </eq>, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">v</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msup>
                                            <mi mathvariant="double-struck">R</mi>
                                            <mn>2</mn>
                                        </msup>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>p</mi>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mrow>
                                            <mo>−</mo>
                                            <mi mathvariant="normal">∞</mi>
                                        </mrow>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mrow>
                                            <mo>−</mo>
                                            <mi mathvariant="normal">∞</mi>
                                        </mrow>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mrow>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                    </mrow>
                                    <mo separator="true">,</mo>
                                    <mrow>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>y</mi>
                                    </mrow>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mrow>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                    </mrow>
                                    <mi>d</mi>
                                    <mrow>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>y</mi>
                                    </mrow>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mrow>
                                            <mn>2</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </msubsup>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo stretchy="false">)</mo>
                                    <mi>r</mi>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>θ</mi>
                                    <mi>d</mi>
                                    <mi>r</mi>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mrow>
                                            <mn>2</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </msubsup>
                                    <mfrac>
                                        <mrow>
                                            <mi>A</mi>
                                            <mo>⋅</mo>
                                            <mi mathvariant="normal">p</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>r</mi>
                                            <mo separator="true">,</mo>
                                            <mi>θ</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>r</mi>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <mi>r</mi>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>θ</mi>
                                    <mi>d</mi>
                                    <mi>r</mi>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mrow>
                                            <mn>2</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </msubsup>
                                    <mi>A</mi>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">p</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo separator="true">,</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>θ</mi>
                                    <mi>d</mi>
                                    <mi>r</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_v}(p_o) =
                                \int_{{\reals}^2} \operatorname{R}(p - p_o) \cdot \operatorname{F}(p) \, dp =
                                \int_{-\infin}^\infin \int_{-\infin}^\infin \operatorname{R}({\Delta x}, {\Delta y})
                                \cdot \operatorname{F}(p) \, d {\Delta x} d {\Delta y} = \int_0^\infin \int_0^{2\pi}
                                \operatorname{R}(r) r \cdot \operatorname{F}(p) \, d \theta dr = \int_0^\infin
                                \int_0^{2\pi} \frac{A \cdot \operatorname{p}(r, \theta)}{r} \cdot r \cdot
                                \operatorname{F}(p) \, d \theta dr = \int_0^\infin \int_0^{2\pi} A \cdot
                                \operatorname{p}(r, \theta) \cdot \operatorname{F}(p) \, d \theta dr</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight"
                                                            style="margin-right:0.01389em;">v</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.38952999999999993em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mtight"><span
                                                                    class="mord mathbb mtight">R</span></span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.7463142857142857em;"><span
                                                                                style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.384573em;vertical-align:-0.970281em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">∞</span></span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.970281em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">∞</span></span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.970281em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord">Δ</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span></span><span class="mclose">)</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">F</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord">Δ</span><span
                                class="mord mathnormal">x</span></span><span class="mord mathnormal">d</span><span
                            class="mord"><span class="mord">Δ</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.5640080000000003em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">2</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mclose">)</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.5640080000000003em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">2</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">A</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mop"><span class="mord mathrm">p</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span
                                                        class="mpunct">,</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.5640080000000003em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">2</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">A</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">p</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></eq>.
    </p>
    <p dir="auto">And by &quot;Equation (13.3)&quot; of <a
            href="https://pbr-book.org/3ed-2018/Monte_Carlo_Integration/The_Monte_Carlo_Estimator">PBR Book</a>, we have
        the <strong>Monte Carlo estimator</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">v</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mrow>
                                            <mn>2</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </msubsup>
                                    <mi>A</mi>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">p</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo separator="true">,</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>θ</mi>
                                    <mi>d</mi>
                                    <mi>r</mi>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>N</mi>
                                    </mfrac>
                                    <mfrac>
                                        <mrow>
                                            <mi>A</mi>
                                            <mo>⋅</mo>
                                            <mi mathvariant="normal">p</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>r</mi>
                                            <mo separator="true">,</mo>
                                            <mi>θ</mi>
                                            <mo stretchy="false">)</mo>
                                            <mo>⋅</mo>
                                            <mi mathvariant="normal">F</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>p</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mrow>
                                            <mi mathvariant="normal">p</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>r</mi>
                                            <mo separator="true">,</mo>
                                            <mi>θ</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_v}(p_o) =
                                \int_0^\infin \int_0^{2\pi} A \cdot \operatorname{p}(r, \theta) \cdot
                                \operatorname{F}(p) \, d \theta dr = \frac{1}{N} \frac{A \cdot \operatorname{p}(r,
                                \theta) \cdot \operatorname{F}(p)}{\operatorname{p}(r, \theta)}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight"
                                                            style="margin-right:0.01389em;">v</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.5640080000000003em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">2</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">A</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">p</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.10903em;">N</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">p</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span
                                                        class="mpunct">,</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span><span
                                                        class="mclose">)</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">A</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mop"><span class="mord mathrm">p</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span
                                                        class="mpunct">,</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span><span
                                                        class="mclose">)</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mop"><span class="mord mathrm">F</span></span><span
                                                        class="mopen">(</span><span
                                                        class="mord mathnormal">p</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>.
    </p>
    <p dir="auto">Technically, <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">p</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo separator="true">,</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{p}(r, \theta)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">p</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>
        </eq> is &quot;wavelengh dependent&quot;. This means that <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">p</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo separator="true">,</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{p}(r, \theta)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">p</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>
        </eq> should be represented by the vector &quot;RGB&quot; instead of the scalar &quot;float&quot;. However, we
        need a scalar PDF to calcuate the sampling of the <strong>Monte Carlo estimator</strong>. And ususally, the
        maximum of &quot;RGB&quot; of the <strong>scattering distance</strong> is used.</p>
    <p dir="auto">However, the A depends on the position. This means that the formula should be technically written as
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">v</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mrow>
                                            <mn>2</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </msubsup>
                                    <mi>A</mi>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">p</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo separator="true">,</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>θ</mi>
                                    <mi>d</mi>
                                    <mi>r</mi>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mrow>
                                            <mn>2</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </msubsup>
                                    <mi mathvariant="normal">A</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">p</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo separator="true">,</mo>
                                    <mi>θ</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">F</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>θ</mi>
                                    <mi>d</mi>
                                    <mi>r</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_v}(p_o) =
                                \int_0^\infin \int_0^{2\pi} A \cdot \operatorname{p}(r, \theta) \cdot
                                \operatorname{F}(p) \, d \theta dr = \int_0^\infin \int_0^{2\pi} \operatorname{A}(p)
                                \cdot \operatorname{p}(r, \theta) \cdot \operatorname{F}(p) \, d \theta dr</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight"
                                                            style="margin-right:0.01389em;">v</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.5640080000000003em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">2</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">A</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">p</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.5640080000000003em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">2</span><span
                                                            class="mord mathnormal mtight"
                                                            style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">A</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">p</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">F</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></eq>.
    </p>
    <p dir="auto">There are two <a
            href="https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@10.8/manual/Diffusion-Profile.html">Texturing
            Mode</a>s in Unity3D: <strong>Post-Scatter</strong> and <strong>Pre- and Post-Scatter</strong>. The
        <strong>Post-Scatter</strong> mode assumes that the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">A</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{A}(p)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">A</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></eq> of
        each vicinal location equals the constant <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">A</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{A}(p_o)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">A</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> of the center, and thus we have <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">v</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>N</mi>
                                    </mfrac>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">A</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>o</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                            <mo>⋅</mo>
                                            <mi mathvariant="normal">p</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>r</mi>
                                            <mo separator="true">,</mo>
                                            <mi>θ</mi>
                                            <mo stretchy="false">)</mo>
                                            <mo>⋅</mo>
                                            <mi mathvariant="normal">F</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>p</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mrow>
                                            <mi mathvariant="normal">p</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>r</mi>
                                            <mo separator="true">,</mo>
                                            <mi>θ</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_v}(p_o) = \frac{1}{N}
                                \frac{\operatorname{A}(p_o) \cdot \operatorname{p}(r, \theta) \cdot
                                \operatorname{F}(p)}{\operatorname{p}(r, \theta)}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight"
                                                            style="margin-right:0.01389em;">v</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.10903em;">N</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">p</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span
                                                        class="mpunct">,</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span><span
                                                        class="mclose">)</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">A</span></span><span
                                                        class="mopen">(</span><span class="mord"><span
                                                            class="mord mathnormal">p</span><span class="msupsub"><span
                                                                class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                        class="mclose">)</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mop"><span class="mord mathrm">p</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span
                                                        class="mpunct">,</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span><span
                                                        class="mclose">)</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mop"><span class="mord mathrm">F</span></span><span
                                                        class="mopen">(</span><span
                                                        class="mord mathnormal">p</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq> where the A is
        applied after the blur pass. However, the <strong>Pre- and Post-Scatter</strong> mode assumes that the
        &quot;square root&quot; <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msqrt>
                                        <mrow>
                                            <mi mathvariant="normal">A</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>p</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                    </msqrt>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \sqrt{\operatorname{A}(p)}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.24em;vertical-align:-0.25612499999999994em;"></span><span
                            class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.983875em;"><span class="svg-align" style="top:-3.2em;"><span
                                                class="pstrut" style="height:3.2em;"></span><span class="mord"
                                                style="padding-left:1em;"><span class="mop"><span
                                                        class="mord mathrm">A</span></span><span
                                                    class="mopen">(</span><span class="mord mathnormal">p</span><span
                                                    class="mclose">)</span></span></span><span
                                            style="top:-2.9438750000000002em;"><span class="pstrut"
                                                style="height:3.2em;"></span><span class="hide-tail"
                                                style="min-width:1.02em;height:1.28em;"><svg width='400em'
                                                    height='1.28em' viewBox='0 0 400000 1296'
                                                    preserveAspectRatio='xMinYMin slice'>
                                                    <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.25612499999999994em;"><span></span></span></span></span></span></span></span></span>
        </eq> of each vicinal location equals the constant <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msqrt>
                                        <mrow>
                                            <mi mathvariant="normal">A</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>o</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                    </msqrt>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \sqrt{\operatorname{A}(p_o)}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.24em;vertical-align:-0.25612499999999994em;"></span><span
                            class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.983875em;"><span class="svg-align" style="top:-3.2em;"><span
                                                class="pstrut" style="height:3.2em;"></span><span class="mord"
                                                style="padding-left:1em;"><span class="mop"><span
                                                        class="mord mathrm">A</span></span><span
                                                    class="mopen">(</span><span class="mord"><span
                                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                    class="vlist" style="height:0.151392em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">o</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                    class="mclose">)</span></span></span><span
                                            style="top:-2.9438750000000002em;"><span class="pstrut"
                                                style="height:3.2em;"></span><span class="hide-tail"
                                                style="min-width:1.02em;height:1.28em;"><svg width='400em'
                                                    height='1.28em' viewBox='0 0 400000 1296'
                                                    preserveAspectRatio='xMinYMin slice'>
                                                    <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.25612499999999994em;"><span></span></span></span></span></span></span></span></span>
        </eq> of the center, and thus we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">v</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>N</mi>
                                    </mfrac>
                                    <mfrac>
                                        <mrow>
                                            <msqrt>
                                                <mrow>
                                                    <mi mathvariant="normal">A</mi>
                                                    <mo>⁡</mo>
                                                    <mo stretchy="false">(</mo>
                                                    <msub>
                                                        <mi>p</mi>
                                                        <mi>o</mi>
                                                    </msub>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                            </msqrt>
                                            <mo>⋅</mo>
                                            <mi mathvariant="normal">p</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>r</mi>
                                            <mo separator="true">,</mo>
                                            <mi>θ</mi>
                                            <mo stretchy="false">)</mo>
                                            <mo>⋅</mo>
                                            <msqrt>
                                                <mrow>
                                                    <mi mathvariant="normal">A</mi>
                                                    <mo>⁡</mo>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>p</mi>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                            </msqrt>
                                            <mo>⋅</mo>
                                            <mi mathvariant="normal">F</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>p</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mrow>
                                            <mi mathvariant="normal">p</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>r</mi>
                                            <mo separator="true">,</mo>
                                            <mi>θ</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_v}(p_o) = \frac{1}{N}
                                \frac{\sqrt{\operatorname{A}(p_o)} \cdot \operatorname{p}(r, \theta) \cdot
                                \sqrt{\operatorname{A}(p)} \cdot \operatorname{F}(p)}{\operatorname{p}(r, \theta)}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight"
                                                            style="margin-right:0.01389em;">v</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.566em;vertical-align:-0.936em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.10903em;">N</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.63em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">p</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span
                                                        class="mpunct">,</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span><span
                                                        class="mclose">)</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.6950000000000003em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord sqrt"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.935em;"><span class="svg-align"
                                                                        style="top:-3.2em;"><span class="pstrut"
                                                                            style="height:3.2em;"></span><span
                                                                            class="mord" style="padding-left:1em;"><span
                                                                                class="mop"><span
                                                                                    class="mord mathrm">A</span></span><span
                                                                                class="mopen">(</span><span
                                                                                class="mord"><span
                                                                                    class="mord mathnormal">p</span><span
                                                                                    class="msupsub"><span
                                                                                        class="vlist-t vlist-t2"><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.151392em;"><span
                                                                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                                        class="pstrut"
                                                                                                        style="height:2.7em;"></span><span
                                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                                                                class="vlist-s">​</span></span><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                class="mclose">)</span></span></span><span
                                                                        style="top:-2.8950000000000005em;"><span
                                                                            class="pstrut"
                                                                            style="height:3.2em;"></span><span
                                                                            class="hide-tail"
                                                                            style="min-width:1.02em;height:1.28em;"><svg
                                                                                width='400em' height='1.28em'
                                                                                viewBox='0 0 400000 1296'
                                                                                preserveAspectRatio='xMinYMin slice'>
                                                                                <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                                                                            </svg></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.30499999999999994em;"><span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mop"><span class="mord mathrm">p</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span
                                                        class="mpunct">,</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span><span
                                                        class="mclose">)</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord sqrt"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.935em;"><span class="svg-align"
                                                                        style="top:-3.2em;"><span class="pstrut"
                                                                            style="height:3.2em;"></span><span
                                                                            class="mord" style="padding-left:1em;"><span
                                                                                class="mop"><span
                                                                                    class="mord mathrm">A</span></span><span
                                                                                class="mopen">(</span><span
                                                                                class="mord mathnormal">p</span><span
                                                                                class="mclose">)</span></span></span><span
                                                                        style="top:-2.8950000000000005em;"><span
                                                                            class="pstrut"
                                                                            style="height:3.2em;"></span><span
                                                                            class="hide-tail"
                                                                            style="min-width:1.02em;height:1.28em;"><svg
                                                                                width='400em' height='1.28em'
                                                                                viewBox='0 0 400000 1296'
                                                                                preserveAspectRatio='xMinYMin slice'>
                                                                                <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                                                                            </svg></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.30499999999999994em;"><span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mop"><span class="mord mathrm">F</span></span><span
                                                        class="mopen">(</span><span
                                                        class="mord mathnormal">p</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq> where the albedo
        is applied before and after the blur pass.
    </p>
    <p dir="auto">However, in UE4, only the <strong>Post-Scatter</strong> mode is supported.</p>
    <p dir="auto">The <strong>Texturing Mode</strong> is controlled by <a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/Lit/Lit.hlsl#L2023">GetModifiedDiffuseColorForSSS</a>
        and <a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/Material/SubsurfaceScattering/SubsurfaceScattering.compute#L395">ApplySubsurfaceScatteringTexturingMode</a>
        in Unity3D, and <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/DeferredShadingCommon.ush#L605">AdjustBaseColorAndSpecularColorForSubsurfaceProfileLighting</a>
        and <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/PostProcessSubsurface.usf#L741">SubsurfaceRecombinePS</a>
        in UE4.</p>
    <h4 dir="auto" id="1-4-3-bilateral-filter">1-4-3. Bilateral Filter</h4>
    <p dir="auto">The approach of [Mikkelsen 2010] is used by [Golubev 2018] to the estimated surface area based on the
        screen space area.</p>
    <p dir="auto">We assume that x is the point on the surface, and p is the perspective projection of x on the screen
        space. Let <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mrow>
                                                <mi mathvariant="normal">Δ</mi>
                                                <mi mathvariant="normal">x</mi>
                                            </mrow>
                                            <mrow>
                                                <mi mathvariant="normal">x</mi>
                                                <mi mathvariant="normal">y</mi>
                                            </mrow>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo>=</mo>
                                    <msqrt>
                                        <mrow>
                                            <msup>
                                                <mrow>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>x</mi>
                                                    <mi mathvariant="normal">.</mi>
                                                    <mi>x</mi>
                                                    <mo>−</mo>
                                                    <msub>
                                                        <mi>x</mi>
                                                        <mi>o</mi>
                                                    </msub>
                                                    <mi mathvariant="normal">.</mi>
                                                    <mi>x</mi>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                                <mn>2</mn>
                                            </msup>
                                            <mo>+</mo>
                                            <msup>
                                                <mrow>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>x</mi>
                                                    <mi mathvariant="normal">.</mi>
                                                    <mi>y</mi>
                                                    <mo>−</mo>
                                                    <msub>
                                                        <mi>x</mi>
                                                        <mi>o</mi>
                                                    </msub>
                                                    <mi mathvariant="normal">.</mi>
                                                    <mi>y</mi>
                                                    <mo stretchy="false">)</mo>
                                                </mrow>
                                                <mn>2</mn>
                                            </msup>
                                        </mrow>
                                    </msqrt>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{{\Delta x}_{xy}} =
                                \sqrt{{(x.x - x_o.x)}^2 + {(x.y - x_o.y)}^2}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mop"><span
                                class="mord"><span class="mord"><span class="mord mathrm">Δx</span></span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.15139200000000003em;"><span
                                                    style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathrm mtight"
                                                                style="margin-right:0.01389em;">xy</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.286108em;"><span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1.84em;vertical-align:-0.454121em;"></span><span
                            class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.385879em;"><span class="svg-align" style="top:-3.8em;"><span
                                                class="pstrut" style="height:3.8em;"></span><span class="mord"
                                                style="padding-left:1em;"><span class="mord"><span class="mord"><span
                                                            class="mopen">(</span><span
                                                            class="mord mathnormal">x</span><span
                                                            class="mord">.</span><span
                                                            class="mord mathnormal">x</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord"><span class="mord mathnormal">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.151392em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mord">.</span><span
                                                            class="mord mathnormal">x</span><span
                                                            class="mclose">)</span></span><span class="msupsub"><span
                                                            class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                    style="height:0.954008em;"><span
                                                                        style="top:-3.2029em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mbin">+</span><span class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mord"><span class="mord"><span class="mopen">(</span><span
                                                            class="mord mathnormal">x</span><span
                                                            class="mord">.</span><span class="mord mathnormal"
                                                            style="margin-right:0.03588em;">y</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord"><span class="mord mathnormal">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.151392em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mord">.</span><span class="mord mathnormal"
                                                            style="margin-right:0.03588em;">y</span><span
                                                            class="mclose">)</span></span><span class="msupsub"><span
                                                            class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                    style="height:0.954008em;"><span
                                                                        style="top:-3.2029em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                            style="top:-3.345879em;"><span class="pstrut"
                                                style="height:3.8em;"></span><span class="hide-tail"
                                                style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em'
                                                    height='1.8800000000000001em' viewBox='0 0 400000 1944'
                                                    preserveAspectRatio='xMinYMin slice'>
                                                    <path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.454121em;"><span></span></span></span></span></span></span></span></span>
        </eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mrow>
                                            <mi mathvariant="normal">Δ</mi>
                                            <mi>x</mi>
                                        </mrow>
                                        <mi>z</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>x</mi>
                                    <mi mathvariant="normal">.</mi>
                                    <mi>z</mi>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>x</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mi mathvariant="normal">.</mi>
                                    <mi>z</mi>
                                    <mi mathvariant="normal">∣</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle {\Delta x}_z = |x.z - x_o.z|
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord"><span class="mord">Δ</span><span
                                    class="mord mathnormal">x</span></span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.04398em;">z</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">∣</span><span class="mord mathnormal">x</span><span class="mord">.</span><span
                            class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">.</span><span class="mord mathnormal"
                            style="margin-right:0.04398em;">z</span><span class="mord">∣</span></span></span></span>
        </eq>. We have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">∥</mi>
                                    <mi>x</mi>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>x</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mi mathvariant="normal">∥</mi>
                                    <mo>=</mo>
                                    <msqrt>
                                        <mrow>
                                            <msup>
                                                <msub>
                                                    <mrow>
                                                        <mi mathvariant="normal">Δ</mi>
                                                        <mi>x</mi>
                                                    </mrow>
                                                    <mrow>
                                                        <mi>x</mi>
                                                        <mi>y</mi>
                                                    </mrow>
                                                </msub>
                                                <mn>2</mn>
                                            </msup>
                                            <mo>+</mo>
                                            <msup>
                                                <msub>
                                                    <mrow>
                                                        <mi mathvariant="normal">Δ</mi>
                                                        <mi>x</mi>
                                                    </mrow>
                                                    <mi>z</mi>
                                                </msub>
                                                <mn>2</mn>
                                            </msup>
                                        </mrow>
                                    </msqrt>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \|x - x_o\| = \sqrt{{{\Delta
                                x}_{xy}}^2 + {{\Delta x}_z}^2}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span
                            class="mord mathnormal">x</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∥</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.84em;vertical-align:-0.5055099999999999em;"></span><span
                            class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.3344900000000002em;"><span class="svg-align"
                                            style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span
                                                class="mord" style="padding-left:1em;"><span class="mord"><span
                                                        class="mord"><span class="mord"><span class="mord"><span
                                                                    class="mord">Δ</span><span
                                                                    class="mord mathnormal">x</span></span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15139200000000003em;"><span
                                                                                style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathnormal mtight">x</span><span
                                                                                            class="mord mathnormal mtight"
                                                                                            style="margin-right:0.03588em;">y</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.286108em;"><span></span></span></span></span></span></span></span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.887338em;"><span
                                                                        style="top:-3.1362300000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mbin">+</span><span class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mord"><span class="mord"><span class="mord"><span
                                                                class="mord"><span class="mord">Δ</span><span
                                                                    class="mord mathnormal">x</span></span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.151392em;"><span
                                                                                style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.04398em;">z</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.887338em;"><span
                                                                        style="top:-3.1362300000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                            style="top:-3.2944899999999997em;"><span class="pstrut"
                                                style="height:3.8em;"></span><span class="hide-tail"
                                                style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em'
                                                    height='1.8800000000000001em' viewBox='0 0 400000 1944'
                                                    preserveAspectRatio='xMinYMin slice'>
                                                    <path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.5055099999999999em;"><span></span></span></span></span></span></span></span></span>
        </eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mrow>
                                                <mi mathvariant="normal">Δ</mi>
                                                <mi mathvariant="normal">x</mi>
                                            </mrow>
                                            <mrow>
                                                <mi mathvariant="normal">x</mi>
                                                <mi mathvariant="normal">y</mi>
                                            </mrow>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{{\Delta x}_{xy}}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mop"><span
                                class="mord"><span class="mord"><span class="mord mathrm">Δx</span></span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.15139200000000003em;"><span
                                                    style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathrm mtight"
                                                                style="margin-right:0.01389em;">xy</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span>
        </eq> can be approximated by <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>K</mi>
                                        <msub>
                                            <mi>p</mi>
                                            <mi>o</mi>
                                        </msub>
                                    </msub>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">∥</mi>
                                    <mi>p</mi>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mi mathvariant="normal">∥</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle K_{p_o} \cdot \|p - p_o\|
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">K</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.15139200000000003em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight">p</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">∥</span><span class="mord mathnormal">p</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∥</span></span></span></span></eq> where <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>K</mi>
                                        <msub>
                                            <mi>p</mi>
                                            <mi>o</mi>
                                        </msub>
                                    </msub>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mn>2</mn>
                                            <mo>⋅</mo>
                                            <msub>
                                                <mi>r</mi>
                                                <mrow>
                                                    <mi>m</mi>
                                                    <mi>a</mi>
                                                    <mi>x</mi>
                                                </mrow>
                                            </msub>
                                            <mo>⋅</mo>
                                            <mi mathvariant="normal">∣</mi>
                                            <mi>cos</mi>
                                            <mo>⁡</mo>
                                            <msub>
                                                <mi>θ</mi>
                                                <mi>o</mi>
                                            </msub>
                                            <mi mathvariant="normal">∣</mi>
                                        </mrow>
                                        <mrow>
                                            <mi>d</mi>
                                            <mo>⋅</mo>
                                            <mi>cos</mi>
                                            <mo>⁡</mo>
                                            <msub>
                                                <mi>ϕ</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle K_{p_o} = \frac{2 \cdot r_{max} \cdot
                                |\cos \theta_o|}{d \cdot \cos \phi_o}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">K</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.15139200000000003em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight">p</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.30744em;vertical-align:-0.8804400000000001em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mop">cos</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord"><span class="mord mathnormal">ϕ</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">2</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">r</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mathnormal mtight">ma</span><span
                                                                                        class="mord mathnormal mtight">x</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord">∣</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mop">cos</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">θ</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                        class="mord">∣</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>. The form of this
        equation may remind us of the one degree <a href="https://en.wikipedia.org/wiki/Taylor%27s_theorem">Taylor
            polynomial</a>, but <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>r</mi>
                                        <mrow>
                                            <mi>m</mi>
                                            <mi>a</mi>
                                            <mi>x</mi>
                                        </mrow>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle r_{max}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">ma</span><span
                                                            class="mord mathnormal mtight">x</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">d</span></span></span></span></eq> are the macro quantities which
        can <strong>NOT</strong> be explained by the micro differential.</p>
    <p dir="auto">By [Mikkelsen 2010], the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>K</mi>
                                        <msub>
                                            <mi>p</mi>
                                            <mi>o</mi>
                                        </msub>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle K_{p_o}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">K</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.15139200000000003em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight">p</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> does <strong>NOT</strong> need to be calculated when the diffusion profile <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(x)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq> is
        the Gaussian function <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">G</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>σ</mi>
                                    <mo separator="true">,</mo>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{G}(\sigma, x)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">G</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq>.
        However, the diffusion profile <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(x)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq> of
        [Golubev 2018] is <strong>NOT</strong> the Gaussian function, and thus the formula provided by [Mikkelsen 2010]
        does <strong>NOT</strong> apply. The Unity3D and the UE4 both merely assume that <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>K</mi>
                                        <msub>
                                            <mi>p</mi>
                                            <mi>o</mi>
                                        </msub>
                                    </msub>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle K_{p_o} = 1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.07153em;">K</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.15139200000000003em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight">p</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span></span></span></span></eq>, and the <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">∥</mi>
                                    <mi>x</mi>
                                    <mo>−</mo>
                                    <msub>
                                        <mi>x</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mi mathvariant="normal">∥</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \|x - x_o\|</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span
                            class="mord mathnormal">x</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∥</span></span></span></span></eq> can be estimated as <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msqrt>
                                    <mrow>
                                        <msup>
                                            <mrow>
                                                <mi mathvariant="normal">∥</mi>
                                                <mi>p</mi>
                                                <mo>−</mo>
                                                <msub>
                                                    <mi>p</mi>
                                                    <mi>o</mi>
                                                </msub>
                                                <mi mathvariant="normal">∥</mi>
                                            </mrow>
                                            <mn>2</mn>
                                        </msup>
                                        <mo>+</mo>
                                        <msup>
                                            <msub>
                                                <mrow>
                                                    <mi mathvariant="normal">Δ</mi>
                                                    <mi>x</mi>
                                                </mrow>
                                                <mi>z</mi>
                                            </msub>
                                            <mn>2</mn>
                                        </msup>
                                    </mrow>
                                </msqrt>
                            </mrow>
                            <annotation encoding="application/x-tex">\sqrt{{\|p - p_o\|}^2 + {{\Delta x}_z}^2}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.84em;vertical-align:-0.502996em;"></span><span class="mord sqrt"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.337004em;"><span class="svg-align" style="top:-3.8em;"><span
                                                class="pstrut" style="height:3.8em;"></span><span class="mord"
                                                style="padding-left:1em;"><span class="mord"><span class="mord"><span
                                                            class="mord">∥</span><span
                                                            class="mord mathnormal">p</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord"><span class="mord mathnormal">p</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.151392em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mord">∥</span></span><span class="msupsub"><span
                                                            class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                                    style="height:0.954008em;"><span
                                                                        style="top:-3.2029em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mbin">+</span><span class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mord"><span class="mord"><span class="mord"><span
                                                                class="mord"><span class="mord">Δ</span><span
                                                                    class="mord mathnormal">x</span></span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.151392em;"><span
                                                                                style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.04398em;">z</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.887338em;"><span
                                                                        style="top:-3.1362300000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                            style="top:-3.297004em;"><span class="pstrut"
                                                style="height:3.8em;"></span><span class="hide-tail"
                                                style="min-width:1.02em;height:1.8800000000000001em;"><svg width='400em'
                                                    height='1.8800000000000001em' viewBox='0 0 400000 1944'
                                                    preserveAspectRatio='xMinYMin slice'>
                                                    <path d='M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.502996em;"><span></span></span></span></span></span></span></span></span>
        </eq>.</p>
    <p dir="auto">The <strong>Bilateral Filter</strong> is controlled by the macro <strong>SSS_BILATERAL_FILTER</strong>
        in the Unity3D and the macro <strong>USE_BILATERAL_FILTERING</strong> in the UE4.</p>
    <h4 dir="auto" id="1-4-4-properties-between-unity3d-and-ue4">1-4-4. Properties between Unity3D and UE4</h4>
    <table dir="auto">
        <thead dir="auto">
            <tr dir="auto">
                <th style="text-align:center">Formula Name</th>
                <th style="text-align:center"><a
                        href="https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@10.8/manual/Diffusion-Profile.html">Unity3D
                        Name</a></th>
                <th style="text-align:center"><a
                        href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.high-definition/Runtime/RenderPipelineResources/Skin%20Diffusion%20Profile.asset#L17">Unity3D
                        Default</a></th>
                <th style="text-align:center"><a
                        href="https://docs.unrealengine.com/4.27/en-US/RenderingAndGraphics/Materials/LightingModels/SubSurfaceProfile/">UE4
                        Name</a></th>
                <th style="text-align:center"><a
                        href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Source/Runtime/Engine/Classes/Engine/SubsurfaceProfile.h#L113">UE4
                        Default</a></th>
            </tr>
        </thead>
        <tbody dir="auto">
            <tr dir="auto">
                <td style="text-align:center">A</td>
                <td style="text-align:center">Diffuse Color</td>
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">Base Color</td>
                <td style="text-align:center">N/A</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">Surface Albedo</td>
                <td style="text-align:center">(0.91058, 0.338275, 0.2718)</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">Mean Free Path Color</td>
                <td style="text-align:center">(1.0, 0.1983/2.229, (0.1607/2.229)</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">Mean Free Path Distance</td>
                <td style="text-align:center">(1.2*2.229, 1.2*2.229, 1.2*2.229)</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">Scattering Distance</td>
                <td style="text-align:center">(0.7568628, 0.32156864, 0.20000002)</td>
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">N/A</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">s</td>
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <mfrac>
                                                    <mn>1</mn>
                                                    <mrow>
                                                        <mi mathvariant="normal">S</mi>
                                                        <mi mathvariant="normal">c</mi>
                                                        <mi mathvariant="normal">a</mi>
                                                        <mi mathvariant="normal">t</mi>
                                                        <mi mathvariant="normal">t</mi>
                                                        <mi mathvariant="normal">e</mi>
                                                        <mi mathvariant="normal">r</mi>
                                                        <mi mathvariant="normal">i</mi>
                                                        <mi mathvariant="normal">n</mi>
                                                        <mi mathvariant="normal">g</mi>
                                                        <mi mathvariant="normal">D</mi>
                                                        <mi mathvariant="normal">i</mi>
                                                        <mi mathvariant="normal">s</mi>
                                                        <mi mathvariant="normal">t</mi>
                                                        <mi mathvariant="normal">a</mi>
                                                        <mi mathvariant="normal">n</mi>
                                                        <mi mathvariant="normal">c</mi>
                                                        <mi mathvariant="normal">e</mi>
                                                    </mrow>
                                                </mfrac>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle
                                            \frac{1}{\mathrm{ScatteringDistance}}</annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut"
                                        style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span
                                        class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                        style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                                class="pstrut" style="height:3em;"></span><span
                                                                class="mord"><span class="mord"><span
                                                                        class="mord mathrm">ScatteringDistance</span></span></span></span><span
                                                            style="top:-3.23em;"><span class="pstrut"
                                                                style="height:3em;"></span><span class="frac-line"
                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                            style="top:-3.677em;"><span class="pstrut"
                                                                style="height:3em;"></span><span class="mord"><span
                                                                    class="mord">1</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                                            class="mclose nulldelimiter"></span></span></span></span></span></eq>
                </td>
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <mfrac>
                                                    <mrow>
                                                        <mi mathvariant="normal">GetScalingFactor</mi>
                                                        <mo>⁡</mo>
                                                        <mo stretchy="false">(</mo>
                                                        <mrow>
                                                            <mi mathvariant="normal">S</mi>
                                                            <mi mathvariant="normal">u</mi>
                                                            <mi mathvariant="normal">r</mi>
                                                            <mi mathvariant="normal">f</mi>
                                                            <mi mathvariant="normal">a</mi>
                                                            <mi mathvariant="normal">c</mi>
                                                            <mi mathvariant="normal">e</mi>
                                                            <mi mathvariant="normal">A</mi>
                                                            <mi mathvariant="normal">l</mi>
                                                            <mi mathvariant="normal">b</mi>
                                                            <mi mathvariant="normal">e</mi>
                                                            <mi mathvariant="normal">d</mi>
                                                            <mi mathvariant="normal">o</mi>
                                                        </mrow>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mrow>
                                                        <mrow>
                                                            <mi mathvariant="normal">M</mi>
                                                            <mi mathvariant="normal">e</mi>
                                                            <mi mathvariant="normal">a</mi>
                                                            <mi mathvariant="normal">n</mi>
                                                            <mi mathvariant="normal">F</mi>
                                                            <mi mathvariant="normal">r</mi>
                                                            <mi mathvariant="normal">e</mi>
                                                            <mi mathvariant="normal">e</mi>
                                                            <mi mathvariant="normal">P</mi>
                                                            <mi mathvariant="normal">a</mi>
                                                            <mi mathvariant="normal">t</mi>
                                                            <mi mathvariant="normal">h</mi>
                                                            <mi mathvariant="normal">C</mi>
                                                            <mi mathvariant="normal">o</mi>
                                                            <mi mathvariant="normal">l</mi>
                                                            <mi mathvariant="normal">o</mi>
                                                            <mi mathvariant="normal">r</mi>
                                                        </mrow>
                                                        <mo>⋅</mo>
                                                        <mrow>
                                                            <mi mathvariant="normal">M</mi>
                                                            <mi mathvariant="normal">e</mi>
                                                            <mi mathvariant="normal">a</mi>
                                                            <mi mathvariant="normal">n</mi>
                                                            <mi mathvariant="normal">F</mi>
                                                            <mi mathvariant="normal">r</mi>
                                                            <mi mathvariant="normal">e</mi>
                                                            <mi mathvariant="normal">e</mi>
                                                            <mi mathvariant="normal">P</mi>
                                                            <mi mathvariant="normal">a</mi>
                                                            <mi mathvariant="normal">t</mi>
                                                            <mi mathvariant="normal">h</mi>
                                                            <mi mathvariant="normal">D</mi>
                                                            <mi mathvariant="normal">i</mi>
                                                            <mi mathvariant="normal">s</mi>
                                                            <mi mathvariant="normal">t</mi>
                                                            <mi mathvariant="normal">a</mi>
                                                            <mi mathvariant="normal">n</mi>
                                                            <mi mathvariant="normal">c</mi>
                                                            <mi mathvariant="normal">e</mi>
                                                        </mrow>
                                                    </mrow>
                                                </mfrac>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle
                                            \frac{\operatorname{GetScalingFactor}(\mathrm{SurfaceAlbedo})}{\mathrm{MeanFreePathColor}
                                            \cdot \mathrm{MeanFreePathDistance}}</annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                                        class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                        style="height:1.427em;"><span style="top:-2.314em;"><span
                                                                class="pstrut" style="height:3em;"></span><span
                                                                class="mord"><span class="mord"><span
                                                                        class="mord mathrm">MeanFreePathColor</span></span><span
                                                                    class="mspace"
                                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                                    class="mbin">⋅</span><span class="mspace"
                                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                                    class="mord"><span
                                                                        class="mord mathrm">MeanFreePathDistance</span></span></span></span><span
                                                            style="top:-3.23em;"><span class="pstrut"
                                                                style="height:3em;"></span><span class="frac-line"
                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                            style="top:-3.677em;"><span class="pstrut"
                                                                style="height:3em;"></span><span class="mord"><span
                                                                    class="mop"><span
                                                                        class="mord mathrm">GetScalingFactor</span></span><span
                                                                    class="mopen">(</span><span class="mord"><span
                                                                        class="mord mathrm">SurfaceAlbedo</span></span><span
                                                                    class="mclose">)</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:0.686em;"><span></span></span></span></span></span><span
                                            class="mclose nulldelimiter"></span></span></span></span></span></eq>
                </td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">Texturing Mode</td>
                <td style="text-align:center">Pre- and Post-Scatter</td>
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">Post-Scatter</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">N/A</td>
                <td style="text-align:center">World Scale</td>
                <td style="text-align:center">1 (Meters Per Unit)</td>
                <td style="text-align:center">World Unit Scale</td>
                <td style="text-align:center">0.1 (Units Per Centimeter)</td>
            </tr>
        </tbody>
    </table>
    <p dir="auto">Note that, in UE4, the scaling factor is calculated by <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>s</mi>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">GetScalingFactor</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mrow>
                                                <mi mathvariant="normal">S</mi>
                                                <mi mathvariant="normal">u</mi>
                                                <mi mathvariant="normal">r</mi>
                                                <mi mathvariant="normal">f</mi>
                                                <mi mathvariant="normal">a</mi>
                                                <mi mathvariant="normal">c</mi>
                                                <mi mathvariant="normal">e</mi>
                                                <mi mathvariant="normal">A</mi>
                                                <mi mathvariant="normal">l</mi>
                                                <mi mathvariant="normal">b</mi>
                                                <mi mathvariant="normal">e</mi>
                                                <mi mathvariant="normal">d</mi>
                                                <mi mathvariant="normal">o</mi>
                                            </mrow>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mrow>
                                            <mrow>
                                                <mi mathvariant="normal">M</mi>
                                                <mi mathvariant="normal">e</mi>
                                                <mi mathvariant="normal">a</mi>
                                                <mi mathvariant="normal">n</mi>
                                                <mi mathvariant="normal">F</mi>
                                                <mi mathvariant="normal">r</mi>
                                                <mi mathvariant="normal">e</mi>
                                                <mi mathvariant="normal">e</mi>
                                                <mi mathvariant="normal">P</mi>
                                                <mi mathvariant="normal">a</mi>
                                                <mi mathvariant="normal">t</mi>
                                                <mi mathvariant="normal">h</mi>
                                                <mi mathvariant="normal">C</mi>
                                                <mi mathvariant="normal">o</mi>
                                                <mi mathvariant="normal">l</mi>
                                                <mi mathvariant="normal">o</mi>
                                                <mi mathvariant="normal">r</mi>
                                            </mrow>
                                            <mo>⋅</mo>
                                            <mrow>
                                                <mi mathvariant="normal">M</mi>
                                                <mi mathvariant="normal">e</mi>
                                                <mi mathvariant="normal">a</mi>
                                                <mi mathvariant="normal">n</mi>
                                                <mi mathvariant="normal">F</mi>
                                                <mi mathvariant="normal">r</mi>
                                                <mi mathvariant="normal">e</mi>
                                                <mi mathvariant="normal">e</mi>
                                                <mi mathvariant="normal">P</mi>
                                                <mi mathvariant="normal">a</mi>
                                                <mi mathvariant="normal">t</mi>
                                                <mi mathvariant="normal">h</mi>
                                                <mi mathvariant="normal">D</mi>
                                                <mi mathvariant="normal">i</mi>
                                                <mi mathvariant="normal">s</mi>
                                                <mi mathvariant="normal">t</mi>
                                                <mi mathvariant="normal">a</mi>
                                                <mi mathvariant="normal">n</mi>
                                                <mi mathvariant="normal">c</mi>
                                                <mi mathvariant="normal">e</mi>
                                            </mrow>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle s =
                                \frac{\operatorname{GetScalingFactor}(\mathrm{SurfaceAlbedo})}{\mathrm{MeanFreePathColor}
                                \cdot \mathrm{MeanFreePathDistance}}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span
                            class="mord mathnormal">s</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span
                                                            class="mord mathrm">MeanFreePathColor</span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord"><span
                                                            class="mord mathrm">MeanFreePathDistance</span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span
                                                            class="mord mathrm">GetScalingFactor</span></span><span
                                                        class="mopen">(</span><span class="mord"><span
                                                            class="mord mathrm">SurfaceAlbedo</span></span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq> where the <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">GetScalingFactor</mi>
                                    <mo>⁡</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{GetScalingFactor}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mop"><span class="mord mathrm">GetScalingFactor</span></span></span></span></span>
        </eq> follows the Equation 5, 6, 7 of [Christensen 2015]. But, by [Christensen 2015], the result of the <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">GetScalingFactor</mi>
                                    <mo>⁡</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{GetScalingFactor}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mop"><span class="mord mathrm">GetScalingFactor</span></span></span></span></span>
        </eq> is exactly the scaling factor. Thus, the denominator is <strong>NOT</strong> reasonable.</p>
    <h3 dir="auto" id="1-5-disney-diffuse">1-5. Disney Diffuse</h3>
    <p dir="auto">TODO</p>
    <h2 dir="auto" id="2-diffuse-transmittance-term">2. Diffuse Transmittance Term</h2>
    <h3 dir="auto" id="2-1-deep-scatter">2-1. Deep Scatter</h3>
    <p dir="auto">The <strong>diffuse transmittance</strong> term of the FaceWorks is based on the <strong>16.3
            Simulating Absorption Using Depth Maps</strong> of [Green 2004].</p>
    <p dir="auto">The main idea of [Green 2004] is that the objects are assumed to be convex, and thus the thickness
        (the distance a light ray travels inside an object) can be estimated by using the shadow maps. According to the
        thickness, the <a href="https://en.wikipedia.org/wiki/Beer%E2%80%93Lambert_law">Beer–Lambert law</a> can be
        applied to calculate the transmittance coefficient.</p>
    <p dir="auto">In the FaceWorks, the <strong>thickness</strong> is calculated by
        <strong>GFSDK_FaceWorks_EstimateThicknessFromParallelShadowPoisson32</strong> and the <strong>transmittance
            coefficient</strong> is calculated by <strong>GFSDK_FaceWorks_EvaluateDeepScatterDirectLight</strong>.
    </p>
    <h3 dir="auto" id="2-2-analytically-integrated-translucency">2-2. Analytically-Integrated Translucency</h3>
    <p dir="auto">The <strong>diffuse transmittance</strong> term of demo source code provided by [Jimenez 2015] is
        based on [Jimenez 2010].</p>
    <p dir="auto">The main idea of [Jimenez 2010] is that the approach proposed by [Green 2004] is applied to calculate
        the thickness while the transmittance coefficient is calculated based on the diffusion profile rather than the
        <strong>Beer–Lambert law</strong>. According to [Jimenez 2010], the idea of the <strong>14.5.3 Modified
            Translucent Shadow Maps</strong> of [dEon 2007] is applied, and the transmittance coefficient is calculated
        as <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">T</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>d</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mi>o</mi>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <mn>2</mn>
                                    <mi>π</mi>
                                    <mi>r</mi>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msqrt>
                                        <mrow>
                                            <msup>
                                                <mi>r</mi>
                                                <mn>2</mn>
                                            </msup>
                                            <mo>+</mo>
                                            <msup>
                                                <mi>d</mi>
                                                <mn>2</mn>
                                            </msup>
                                        </mrow>
                                    </msqrt>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>r</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{T}(d) = \int_o^\infin 2
                                \pi r \cdot \operatorname{R} (\sqrt{r^2 + d^2}) \, dr</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">T</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.3262420000000006em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.4142920000000005em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span><span
                                                style="top:-3.812900000000001em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord">2</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.3122639999999999em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.0622639999999999em;"><span class="svg-align"
                                            style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span
                                                class="mord" style="padding-left:1em;"><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.740108em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mbin">+</span><span class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mord"><span class="mord mathnormal">d</span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.740108em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                            style="top:-3.0222640000000003em;"><span class="pstrut"
                                                style="height:3.2em;"></span><span class="hide-tail"
                                                style="min-width:1.02em;height:1.28em;"><svg width='400em'
                                                    height='1.28em' viewBox='0 0 400000 1296'
                                                    preserveAspectRatio='xMinYMin slice'>
                                                    <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.177736em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span></span></span></span></eq> where the R is the 1D
        diffusion profile and the r is the distance over the surface. If the diffusion profile is approximated by the
        Gaussians proposed by [Green 2004], the result of the integral is analytical and can be calculated as <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">T</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>d</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mi>i</mi>
                                        <mi>k</mi>
                                    </munderover>
                                    <msub>
                                        <mi>w</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msup>
                                        <mi>e</mi>
                                        <mfrac>
                                            <mrow>
                                                <mo>−</mo>
                                                <msup>
                                                    <mi>d</mi>
                                                    <mn>2</mn>
                                                </msup>
                                            </mrow>
                                            <msub>
                                                <mi>v</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mfrac>
                                    </msup>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{T}(d) = \sum_i^k w_i
                                e^{\frac{-d^2}{v_i}}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">T</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.8361130000000003em;"><span
                                            style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">i</span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight"
                                                    style="margin-right:0.03148em;">k</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.277669em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02691em;">w</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:1.2989300000000001em;"><span
                                                style="top:-3.50591em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:3em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                                class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:1.1328857142857145em;"><span
                                                                                style="top:-2.656em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight"
                                                                                                style="margin-right:0.03588em;">v</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.3448em;"><span
                                                                                                                style="top:-2.3448em;margin-left:-0.03588em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span><span
                                                                                style="top:-3.2255000000000003em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="frac-line mtight"
                                                                                    style="border-bottom-width:0.049em;"></span></span><span
                                                                                style="top:-3.384em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">−</span><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">d</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:1.04844em;"><span
                                                                                                                style="top:-3.04844em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.64444em;"></span><span
                                                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.5688em;"><span></span></span></span></span></span><span
                                                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span>
        </eq>.
    </p>
    <p dir="auto">The <strong>transmittance coefficient</strong> is calculated by the <strong>SSSSTransmittance</strong>
        in the demo source code provided by [Jimenez 2015]. And there are some points to note.</p>
    <ol dir="auto">
        <li dir="auto">The demo uses <strong>0.005</strong> to shrink the object in the normal direction to avoid
            artifacts. Evidently, this value is proportional to the <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mn>1</mn>
                                            <mtext>MetersPerWorldSpaceUnit</mtext>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle
                                    \frac{1}{\text{MetersPerWorldSpaceUnit}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord text"><span
                                                                class="mord">MetersPerWorldSpaceUnit</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq>.</li>
        <li dir="auto">Actually, the mere purpose of the <strong>scale</strong> in the shader code is to transform the
            thickness from world space unit to mm. The shader code of the demo source code demonstrates that the
            <strong>scale</strong> is calculated as <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>8.25</mn>
                                        <mo>×</mo>
                                        <mo stretchy="false">(</mo>
                                        <mn>1</mn>
                                        <mo>−</mo>
                                        <mtext>translucency</mtext>
                                        <mo stretchy="false">)</mo>
                                        <mo>×</mo>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mtext>sssWidth</mtext>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 8.25 \times (1 -
                                    \text{translucency}) \times \frac{1}{\text{sssWidth}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                                class="mord">8.25</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mopen">(</span><span class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord text"><span class="mord">translucency</span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord text"><span
                                                                class="mord">sssWidth</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq>. According to
            the <strong>1-3. Separable SSS</strong> of this page, the <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mn>1</mn>
                                            <mtext>sssWidth</mtext>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \frac{1}{\text{sssWidth}}
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord text"><span
                                                                class="mord">sssWidth</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq> can be
            substituted as <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mrow>
                                                <mn>1000</mn>
                                                <mo>×</mo>
                                                <mn>2</mn>
                                                <mo>×</mo>
                                                <mtext>MetersPerWorldSpaceUnit</mtext>
                                            </mrow>
                                            <mn>3</mn>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \frac{1000 \times 2 \times
                                    \text{MetersPerWorldSpaceUnit}}{3}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.0574399999999997em;vertical-align:-0.686em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">3</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1000</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord">2</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">MetersPerWorldSpaceUnit</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq>, and thus the
            <strong>scale</strong> is actually calculated as <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>8.25</mn>
                                        <mo>×</mo>
                                        <mo stretchy="false">(</mo>
                                        <mn>1</mn>
                                        <mo>−</mo>
                                        <mtext>translucency</mtext>
                                        <mo stretchy="false">)</mo>
                                        <mo>×</mo>
                                        <mfrac>
                                            <mn>2</mn>
                                            <mn>3</mn>
                                        </mfrac>
                                        <mo>×</mo>
                                        <mn>1000</mn>
                                        <mo>×</mo>
                                        <mtext>MetersPerWorldSpaceUnit</mtext>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 8.25 \times (1 -
                                    \text{translucency}) \times \frac{2}{3} \times 1000 \times
                                    \text{MetersPerWorldSpaceUnit}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                                class="mord">8.25</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mopen">(</span><span class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord text"><span class="mord">translucency</span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">3</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">2</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                                class="mord">1000</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord text"><span
                                    class="mord">MetersPerWorldSpaceUnit</span></span></span></span></span></eq>. The
            default of the <strong>translucency</strong> in the demo source code is 0.83, and thus the value of <eq>
                <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>8.25</mn>
                                        <mo>×</mo>
                                        <mo stretchy="false">(</mo>
                                        <mn>1</mn>
                                        <mo>−</mo>
                                        <mtext>translucency</mtext>
                                        <mo stretchy="false">)</mo>
                                        <mo>×</mo>
                                        <mfrac>
                                            <mn>2</mn>
                                            <mn>3</mn>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 8.25 \times (1 -
                                    \text{translucency}) \times \frac{2}{3}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                                class="mord">8.25</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mopen">(</span><span class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord text"><span class="mord">translucency</span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">3</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">2</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span>
            </eq> is 0.935 which
            is really close to 1. This implies that the <strong>scale</strong> is actually calculated as <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>1000</mn>
                                        <mo>×</mo>
                                        <mtext>MetersPerWorldSpaceUnit</mtext>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 1000 \times
                                    \text{MetersPerWorldSpaceUnit}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                                class="mord">1000</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord text"><span
                                    class="mord">MetersPerWorldSpaceUnit</span></span></span></span></span></eq> which
            is exactly the transformation from world space unit to mm.
        </li>
    </ol>
    <h3 dir="auto" id="2-3-baked-textured-thickness">2-3. Baked Textured Thickness</h3>
    <p dir="auto">The <strong>diffuse transmittance</strong> term of Unity3D is based on [Golubev 2018].</p>
    <p dir="auto">[Golubev 2018] follows the analytically-integrated formula of [Jimenez 2010] while the diffuse profile
        of [Christensen 2015] is applied. And thus, we have that <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">T</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>d</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mi>o</mi>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <mn>2</mn>
                                    <mi>π</mi>
                                    <mi>r</mi>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msqrt>
                                        <mrow>
                                            <msup>
                                                <mi>r</mi>
                                                <mn>2</mn>
                                            </msup>
                                            <mo>+</mo>
                                            <msup>
                                                <mi>d</mi>
                                                <mn>2</mn>
                                            </msup>
                                        </mrow>
                                    </msqrt>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>r</mi>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mn>4</mn>
                                    </mfrac>
                                    <mi>A</mi>
                                    <mo stretchy="false">(</mo>
                                    <msup>
                                        <mi>e</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mi>s</mi>
                                            <mi>d</mi>
                                        </mrow>
                                    </msup>
                                    <mo>+</mo>
                                    <mn>3</mn>
                                    <msup>
                                        <mi>e</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mfrac>
                                                <mrow>
                                                    <mi>s</mi>
                                                    <mi>d</mi>
                                                </mrow>
                                                <mn>3</mn>
                                            </mfrac>
                                        </mrow>
                                    </msup>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{T}(d) = \int_o^\infin 2
                                \pi r \cdot \operatorname{R} (\sqrt{r^2 + d^2}) \, dr = \frac{1}{4} A (e^{-sd} +
                                3e^{-\frac{sd}{3}})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">T</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.3262420000000006em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.4142920000000005em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span><span
                                                style="top:-3.812900000000001em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord">2</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">π</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.3122639999999999em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.0622639999999999em;"><span class="svg-align"
                                            style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span
                                                class="mord" style="padding-left:1em;"><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.740108em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mbin">+</span><span class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mord"><span class="mord mathnormal">d</span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.740108em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                            style="top:-3.0222640000000003em;"><span class="pstrut"
                                                style="height:3.2em;"></span><span class="hide-tail"
                                                style="min-width:1.02em;height:1.28em;"><svg width='400em'
                                                    height='1.28em' viewBox='0 0 400000 1296'
                                                    preserveAspectRatio='xMinYMin slice'>
                                                    <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.177736em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">4</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord mathnormal">A</span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">e</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.8991079999999999em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mathnormal mtight">s</span><span
                                                            class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1.27902em;vertical-align:-0.25em;"></span><span
                            class="mord">3</span><span class="mord"><span class="mord mathnormal">e</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:1.02902em;"><span
                                                style="top:-3.4130000000000003em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:3em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight"><span
                                                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                                class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.8800285714285714em;"><span
                                                                                style="top:-2.656em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">3</span></span></span></span><span
                                                                                style="top:-3.2255000000000003em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="frac-line mtight"
                                                                                    style="border-bottom-width:0.049em;"></span></span><span
                                                                                style="top:-3.384em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathnormal mtight">s</span><span
                                                                                            class="mord mathnormal mtight">d</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.344em;"><span></span></span></span></span></span><span
                                                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>.</p>
    <p dir="auto">There are two <a
            href="https://docs.unity3d.com/Packages/com.unity.render-pipelines.high-definition@10.8/manual/Diffusion-Profile.html">Transmission
            Mode</a>s in Unity3D: <strong>Thick Object</strong> and <strong>Thin Object</strong>. The <strong>Thick
            Object</strong> mode merely follows the approach of [Jimenez 2010] which uses the shadow map to calculate
        the thickness. And the <strong>Thin Object</strong> mode uses the baked textured thickness which can be provided
        by the <a
            href="https://substance3d.adobe.com/documentation/bake/thickness-map-from-mesh-172818642.html">Substance</a>.
    </p>
    <p dir="auto">In the <a href="https://github.com/Unity-Technologies/Graphics">Unity3D</a>, the
        <strong>thickness</strong> is calculated by the <strong>FillMaterialTransmission</strong>, the
        <strong>ShouldEvaluateThickObjectTransmission</strong> and the <strong>EvaluateTransmittance_Punctual</strong>.
    </p>
    <h2 dir="auto" id="3-specular-term">3. Specular Term</h2>
    <h3 dir="auto" id="3-1-two-lobe-blinn-phong">3-1. Two-lobe Blinn-Phong</h3>
    <p dir="auto">TODO</p>
    <h3 dir="auto" id="3-2-dual-ggx">3-2. Dual GGX</h3>
    <p dir="auto">TODO</p>
    <h2 dir="auto" id="references">References</h2>
    <p dir="auto">[Kelemen 2001] <a href="http://cg.iit.bme.hu/~szirmay/scook_link.htm">Csaba Kelemen, László
            Szirmay-Kalos. &quot;A Microfacet Based Coupled Specular-Matte BRDF Model with Importance Sampling.&quot;
            EGSR 2001.</a><br>
        [Green 2004] <a
            href="https://developer.nvidia.com/gpugems/gpugems/part-iii-materials/chapter-16-real-time-approximations-subsurface-scattering">Simon
            Green. &quot;Chapter 16. Real-Time Approximations to Subsurface Scattering.&quot; GPU Gems 1.</a><br>
        [dEon 2007] <a
            href="https://developer.nvidia.com/gpugems/gpugems3/part-iii-rendering/chapter-14-advanced-techniques-realistic-real-time-skin">Eugene
            dEon, David Luebke. &quot;Advanced Techniques for Realistic Real-Time Skin Rendering.&quot; GPU Gem
            3.</a><br>
        [Colbert 2007] <a
            href="https://developer.nvidia.com/gpugems/gpugems3/part-iii-rendering/chapter-20-gpu-based-importance-sampling">Mark
            Colbert, Jaroslav Krivanek. &quot;GPU-Based Importance Sampling.&quot; GPU Gems 3.</a><br>
        [Jimenez 2009] <a href="https://www.iryoku.com/sssss/">Jorge Jimenez, Veronica Sundstedt, Diego Gutierrez.
            &quot;Screen-Space Perceptual Rendering of Human Skin.&quot; ACM TAP 2009.</a><br>
        [Jimenez 2009] Jorge Jimenez, Diego Gutierrez. &quot;Screen-Space Subsurface Scattering.&quot; GPU Pro 1.<br>
        [Jimenez 2010] <a href="http://www.iryoku.com/translucency/">Jorge Jimenez, David Whelan, Veronica Sundstedt,
            Diego Gutierrez. &quot;Real-Time Realistic Skin Translucency.&quot; IEEE 2010.</a><br>
        [Mikkelsen 2010] <a href="https://mmikk.github.io/papers3d/cbf_skin.pdf">Morten Mikkelsen. &quot;Skin Rendering
            by Pseudo–Separable Cross Bilateral Filtering.&quot; Naughty Dog.</a><br>
        [Penner 2011] Eric Penner, George Borshukov. &quot;Pre-Integrated Skin Shading.&quot; GPU Pro 2.<br>
        [Penner 2011] <a href="http://advances.realtimerendering.com/s2011/">Eric Penner. &quot;Pre-Integrated Skin
            Shading.&quot; SIGGRAPH 2011.</a><br>
        [Lazarov 2011] <a href="http://advances.realtimerendering.com/s2011/">Dimitar Lazarov. &quot;Physically Based
            Lighting in Call of Duty : Black Ops.&quot; SIGGRAPH 2011.</a><br>
        [Jimenez 2012] <a href="https://graphics.unizar.es/publications.html#year_2012">Jorge Jimenez, Adrian Jarabo,
            Diego Gutierrez. &quot;Separable Subsurface Scattering.&quot; Technical Report 2012.</a><br>
        [Jimenez 2012] <a href="http://advances.realtimerendering.com/s2012/index.html">Jorge Jimenez, Adrian Jarabo,
            Diego Gutierrez, Etienne Danvoye, Javier von der Pahlen. &quot;Separable Subsurface Scattering and
            Photorealistic Eyes Rendering.&quot; SIGGRAPH 2012.</a><br>
        [Jimenez 2015] <a href="http://www.iryoku.com/separable-sss/">Jorge Jimenez, Karoly Zsolnai, Adrian Jarabo1,
            Christian Freude, Thomas Auzinger, Xian-Chun Wu, Javier von der Pahlen, Michael Wimmer, Diego Gutierrez.
            &quot;Separable Subsurface Scattering.&quot; EGSR 2015.</a><br>
        [Christensen 2015] <a href="https://graphics.pixar.com/library/">Per Christensen, Brent Burley.
            &quot;Approximate Reflectance Profiles for Efficient Subsurface Scattering.&quot; SIGGRAPH 2015.</a><br>
        [Golubev 2018] <a href="https://zero-radiance.github.io/post/sampling-diffusion/">Evgenii Golubev.
            &quot;Efficient Screen-Space Subsurface Scattering Using Burley's Normalized Diffusion in Real-Time.&quot;
            SIGGRAPH 2018.</a></p>

</body>

</html>