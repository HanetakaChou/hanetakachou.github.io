<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/default.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
</head>

<body class="markdown-body">
    <h2 dir="auto" id="1-ltc">1. LTC</h2>
    <h3 dir="auto" id="1-1-ltsd-linearly-transformed-spherical-distribution">1-1. LTSD (Linearly Transformed Spherical
        Distribution)</h3>
    <p dir="auto">We assume that <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D_o}(\omega_o)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is the arbitrary <strong>original
            distribution</strong>, M is the linear transform matrix, and <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">normalize</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>M</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega = \operatorname{normalize}(M
                                \omega_o)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">normalize</span></span><span
                            class="mopen">(</span><span class="mord mathnormal"
                            style="margin-right:0.10903em;">M</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>. The <strong>linearly transformed
            spherical distribution</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\omega)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span></span></span></span></eq> is defined as <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi>d</mi>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </mrow>
                                        <mrow>
                                            <mi>d</mi>
                                            <mi>ω</mi>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\omega) =
                                \operatorname{D_o}(\omega_o) \frac{d\omega_o}{d\omega}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>. Evidently, we
        have <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">normalize</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega_o =
                                \operatorname{normalize}(M^{-1} \omega)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">normalize</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.10903em;">M</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span></span></span></span></eq>. And the relationship between <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.84444em;vertical-align:-0.15em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span></span></span></span></eq> is closed-form <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mrow>
                                            <mi>d</mi>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </mrow>
                                        <mrow>
                                            <mi>d</mi>
                                            <mi>ω</mi>
                                        </mrow>
                                    </mfrac>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">∣</mi>
                                            <msup>
                                                <mi>M</mi>
                                                <mrow>
                                                    <mo>−</mo>
                                                    <mn>1</mn>
                                                </mrow>
                                            </msup>
                                            <mi mathvariant="normal">∣</mi>
                                        </mrow>
                                        <msup>
                                            <mrow>
                                                <mi mathvariant="normal">∥</mi>
                                                <msup>
                                                    <mi>M</mi>
                                                    <mrow>
                                                        <mo>−</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msup>
                                                <mi>w</mi>
                                                <mi mathvariant="normal">∥</mi>
                                            </mrow>
                                            <mn>3</mn>
                                        </msup>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \frac{d\omega_o}{d\omega} =
                                \frac{|M^{-1}|}{{\|M^{-1}w\|}^3}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.585116em;vertical-align:-1.094008em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.491108em;"><span style="top:-2.155992em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord"><span class="mord">∥</span><span
                                                                class="mord"><span class="mord mathnormal"
                                                                    style="margin-right:0.10903em;">M</span><span
                                                                    class="msupsub"><span class="vlist-t"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.740108em;"><span
                                                                                    style="top:-2.989em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mtight">−</span><span
                                                                                                class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                                class="mord mathnormal"
                                                                style="margin-right:0.02691em;">w</span><span
                                                                class="mord">∥</span></span><span class="msupsub"><span
                                                                class="vlist-t"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.954008em;"><span
                                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">∣</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.10903em;">M</span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.8141079999999999em;"><span
                                                                            style="top:-3.063em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">−</span><span
                                                                                        class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                        class="mord">∣</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.094008em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>. The proof of this
        closed-form formula is provided in <strong>Appendix A</strong> of [Heitz 2016]. Note that <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>ω</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span></span></span></span></eq> are
        <strong>vectors</strong> which represent the <strong>direction</strong>, while <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.84444em;vertical-align:-0.15em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span></span></span></span></eq> are <strong>solid
            angles</strong> which represent the <strong>area</strong> on the <strong>sphere surface</strong>. By <a
            href="https://pbr-book.org/3ed-2018/Color_and_Radiometry/Working_with_Radiometric_Integrals#IntegralsoverArea">the
            Equation (5.6) of the PBR Book</a>, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mo stretchy="false">(</mo>
                                            <mi>A</mi>
                                            <mi>d</mi>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                            <mi>cos</mi>
                                            <mo>⁡</mo>
                                            <mi>θ</mi>
                                        </mrow>
                                        <msup>
                                            <mi>r</mi>
                                            <mn>2</mn>
                                        </msup>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega = \frac{(A d\omega_o)
                                \cos\theta}{r^2}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">r</span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.740108em;"><span
                                                                            style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mopen">(</span><span
                                                        class="mord mathnormal">A</span><span
                                                        class="mord mathnormal">d</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                        class="mclose">)</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mop">cos</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq> where the A is the
        ratio, and the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>A</mi>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle A d\omega_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.84444em;vertical-align:-0.15em;"></span><span
                            class="mord mathnormal">A</span><span class="mord mathnormal">d</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is the area subtended by the solid angle <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\omega</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span></span></span></span></eq>.
    </p>
    <h3 dir="auto" id="1-2-clamped-cosine">1-2. Clamped Cosine</h3>
    <p dir="auto">We assume that the normal direction in the tangent space is (0, 0, 1), which is called the
        <strong>Median Vector</strong> in [Heitz 2016]. The <strong>clamped cosine</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi mathvariant="normal">dot</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">vec3</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>0</mn>
                                    <mo separator="true">,</mo>
                                    <mn>0</mn>
                                    <mo separator="true">,</mo>
                                    <mn>1</mn>
                                    <mo stretchy="false">)</mo>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>x</mi>
                                    <mo separator="true">,</mo>
                                    <mi>y</mi>
                                    <mo separator="true">,</mo>
                                    <mi>z</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mi>max</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>z</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D_o}(\omega_o) =
                                \frac{1}{\pi} |\cos \theta_o| = \frac{1}{\pi}
                                |\operatorname{dot}(\operatorname{vec3}(0,0,1), \omega_o = (x, y, z))| = \frac{1}{\pi}
                                \max(z)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord">∣</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord">∣</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">dot</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">vec3</span></span><span class="mopen">(</span><span
                            class="mord">0</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span
                            class="mclose">)</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mopen">(</span><span class="mord mathnormal">x</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                            style="margin-right:0.04398em;">z</span><span class="mclose">))</span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">max</span><span
                            class="mopen">(</span><span class="mord mathnormal"
                            style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span>
        </eq> is used as the <strong>original distribution</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D_o}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
        </eq>. Evidently, by <a
            href="https://pbr-book.org/3ed-2018/Color_and_Radiometry/Working_with_Radiometric_Integrals#IntegralsoverProjectedSolidAngle">the
            Figure 5.13 of the PBR Book</a>, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mn>1</mn>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msup>
                                        <mi>ω</mi>
                                        <mo lspace="0em" rspace="0em">⊥</mo>
                                    </msup>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <mi>π</mi>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_\Omega \operatorname{D_o} \,
                                d\omega_o = \frac{1}{\pi} \int_\Omega |\cos \theta_o| \, d\omega_o = \frac{1}{\pi}
                                \int_\Omega 1 \, d\omega^{\perp} = \frac{1}{\pi} \cdot \pi = 1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord">1</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.8991079999999999em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mrel mtight">⊥</span></span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span></span></span></span></eq>, and thus <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D_o}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
        </eq> is normalized.
    </p>
    <h3 dir="auto" id="1-3-ltc-linearly-transformed-cosine">1-3. LTC (Linearly Transformed Cosine)</h3>
    <p dir="auto">When the <strong>clamped cosine</strong> is used as the <strong>original distribution</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D_o}(\omega_o)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq>, the corresponding <strong>linearly
            transformed spherical distribution</strong>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\omega)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span></span></span></span></eq> is called the <strong>linearly transformed
            cosine</strong>.
    </p>
    <h2 dir="auto" id="2-lut">2. LUT</h2>
    <p dir="auto">By <a href="https://pbr-book.org/3ed-2018/Color_and_Radiometry/Surface_Reflection#TheBRDF">the
            Equation (5.9) of the PBR Book</a>, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">v</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msup>
                                            <mi>S</mi>
                                            <mn>2</mn>
                                        </msup>
                                    </msub>
                                    <mi mathvariant="normal">BRDF</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_v}(\omega_v) =
                                \int_{S^2} \operatorname{BRDF}(\omega_v, \omega_l) \operatorname{L_l}(\omega_l) |\cos
                                \theta_l| \, d\omega_l</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight"
                                                            style="margin-right:0.01389em;">v</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.38952999999999993em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.05764em;">S</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.7463142857142857em;"><span
                                                                                style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">BRDF</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">l</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>. And we try to approximate the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">BRDF</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{BRDF}(\omega_v,
                                \omega_l)|\cos \theta_l|</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">BRDF</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∣</span></span></span></span></eq> part of this formula by using the LTCs.</p>
    <h3 dir="auto" id="2-1-uv">2-1. UV</h3>
    <p dir="auto">Since the GGX BRDF is isotropic, the distribution can be determined by the outgoing direction <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega_v</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> (in tangent space) and the roughness <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>α</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \alpha</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.0037em;">α</span></span></span></span></eq>, which are used as the UV
        of the LUT.</p>
    <h3 dir="auto" id="2-2-m">2-2. M</h3>
    <p dir="auto">Actually, when M is the scaling transformation <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>M</mi>
                                    <mo>=</mo>
                                    <mi>λ</mi>
                                    <mi>I</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle M = \lambda I</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.10903em;">M</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span
                            class="mord mathnormal">λ</span><span class="mord mathnormal"
                            style="margin-right:0.07847em;">I</span></span></span></span></eq>, we have <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mrow>
                                            <mi>d</mi>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </mrow>
                                        <mrow>
                                            <mi>d</mi>
                                            <mi>ω</mi>
                                        </mrow>
                                    </mfrac>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">∣</mi>
                                            <msup>
                                                <mi>M</mi>
                                                <mrow>
                                                    <mo>−</mo>
                                                    <mn>1</mn>
                                                </mrow>
                                            </msup>
                                            <mi mathvariant="normal">∣</mi>
                                        </mrow>
                                        <msup>
                                            <mrow>
                                                <mi mathvariant="normal">∥</mi>
                                                <msup>
                                                    <mi>M</mi>
                                                    <mrow>
                                                        <mo>−</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msup>
                                                <mi>w</mi>
                                                <mi mathvariant="normal">∥</mi>
                                            </mrow>
                                            <mn>3</mn>
                                        </msup>
                                    </mfrac>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mfrac>
                                            <mn>1</mn>
                                            <msup>
                                                <mi>λ</mi>
                                                <mn>3</mn>
                                            </msup>
                                        </mfrac>
                                        <msup>
                                            <mrow>
                                                <mo stretchy="false">(</mo>
                                                <mfrac>
                                                    <mn>1</mn>
                                                    <mi>λ</mi>
                                                </mfrac>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                            <mn>3</mn>
                                        </msup>
                                    </mfrac>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \frac{d\omega_o}{d\omega} =
                                \frac{|M^{-1}|}{{\|M^{-1}w\|}^3} = \frac{\frac{1}{{\lambda}^3}}{{(\frac{1}{\lambda})}^3}
                                = 1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.585116em;vertical-align:-1.094008em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.491108em;"><span style="top:-2.155992em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord"><span class="mord">∥</span><span
                                                                class="mord"><span class="mord mathnormal"
                                                                    style="margin-right:0.10903em;">M</span><span
                                                                    class="msupsub"><span class="vlist-t"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.740108em;"><span
                                                                                    style="top:-2.989em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mtight">−</span><span
                                                                                                class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                                class="mord mathnormal"
                                                                style="margin-right:0.02691em;">w</span><span
                                                                class="mord">∥</span></span><span class="msupsub"><span
                                                                class="vlist-t"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.954008em;"><span
                                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">∣</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.10903em;">M</span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.8141079999999999em;"><span
                                                                            style="top:-3.063em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">−</span><span
                                                                                        class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                        class="mord">∣</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.094008em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.864224em;vertical-align:-1.284116em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.580108em;"><span style="top:-2.1099999999999994em;"><span
                                                    class="pstrut" style="height:3.0491159999999997em;"></span><span
                                                    class="mord"><span class="mord"><span class="mord"><span
                                                                class="mopen">(</span><span class="mord"><span
                                                                    class="mopen nulldelimiter"></span><span
                                                                    class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.845108em;"><span
                                                                                    style="top:-2.6550000000000002em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">λ</span></span></span></span><span
                                                                                    style="top:-3.23em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3em;"></span><span
                                                                                        class="frac-line"
                                                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                                                    style="top:-3.394em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mtight">1</span></span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.345em;"><span></span></span></span></span></span><span
                                                                    class="mclose nulldelimiter"></span></span><span
                                                                class="mclose">)</span></span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:1.049116em;"><span
                                                                            style="top:-3.2980080000000003em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.2791159999999997em;"><span class="pstrut"
                                                    style="height:3.0491159999999997em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.784116em;"><span class="pstrut"
                                                    style="height:3.0491159999999997em;"></span><span class="mord"><span
                                                        class="mord"><span class="mopen nulldelimiter"></span><span
                                                            class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.845108em;"><span
                                                                            style="top:-2.6550000000000002em;"><span
                                                                                class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">λ</span></span><span
                                                                                            class="msupsub"><span
                                                                                                class="vlist-t"><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.7463142857142857em;"><span
                                                                                                            style="top:-2.786em;margin-right:0.07142857142857144em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height:2.5em;"></span><span
                                                                                                                class="sizing reset-size3 size1 mtight"><span
                                                                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span><span
                                                                            style="top:-3.23em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="frac-line"
                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                            style="top:-3.394em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">1</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.345em;"><span></span></span></span></span></span><span
                                                            class="mclose nulldelimiter"></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.284116em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span></span></span></span></eq>, and thus the LTSC is scale invariant. And
        since GGX BRDF is planar symmetry and isotropic, by [Heitz 2016], the M can be represented by only 4 parameters.
        The the inverse <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mo>=</mo>
                                    <mrow>
                                        <mo fence="true">[</mo>
                                        <mtable rowspacing="0.1600em" columnalign="center center center"
                                            columnspacing="1em">
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mn>1</mn>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mn>0</mn>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mi>G</mi>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mn>0</mn>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mi>B</mi>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mn>0</mn>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mi>A</mi>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mn>0</mn>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mi>R</mi>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                        </mtable>
                                        <mo fence="true">]</mo>
                                    </mrow>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle M^{-1} = \begin{bmatrix} 1 &amp; 0
                                &amp; G \\ 0 &amp; B &amp; 0 \\ A &amp; 0 &amp; R \end{bmatrix}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.10903em;">M</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span
                            class="minner"><span class="mopen"><span class="delimsizing mult"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span
                                                        class="pstrut" style="height:3.1550000000000002em;"></span><span
                                                        class="delimsizinginner delim-size4"><span>⎣</span></span></span><span
                                                    style="top:-3.3970000000000002em;"><span class="pstrut"
                                                        style="height:3.1550000000000002em;"></span><span
                                                        style="height:0.016em;width:0.667em;"><svg width='0.667em'
                                                            height='0.016em' style='width:0.667em' viewBox='0 0 667 16'
                                                            preserveAspectRatio='xMinYMin'>
                                                            <path d='M319 0 H403 V16 H319z M319 0 H403 V16 H319z' />
                                                        </svg></span></span><span style="top:-4.05002em;"><span
                                                        class="pstrut" style="height:3.1550000000000002em;"></span><span
                                                        class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.55002em;"><span></span></span></span></span></span></span><span
                                class="mord"><span class="mtable"><span class="col-align-c"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:2.05em;"><span style="top:-4.21em;"><span
                                                            class="pstrut" style="height:3em;"></span><span
                                                            class="mord"><span class="mord">1</span></span></span><span
                                                        style="top:-3.0099999999999993em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord">0</span></span></span><span
                                                        style="top:-1.8099999999999994em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord mathnormal">A</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:1.5500000000000007em;"><span></span></span></span></span></span><span
                                        class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep"
                                        style="width:0.5em;"></span><span class="col-align-c"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:2.05em;"><span style="top:-4.21em;"><span
                                                            class="pstrut" style="height:3em;"></span><span
                                                            class="mord"><span class="mord">0</span></span></span><span
                                                        style="top:-3.0099999999999993em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord mathnormal"
                                                                style="margin-right:0.05017em;">B</span></span></span><span
                                                        style="top:-1.8099999999999994em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord">0</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:1.5500000000000007em;"><span></span></span></span></span></span><span
                                        class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep"
                                        style="width:0.5em;"></span><span class="col-align-c"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:2.05em;"><span style="top:-4.21em;"><span
                                                            class="pstrut" style="height:3em;"></span><span
                                                            class="mord"><span
                                                                class="mord mathnormal">G</span></span></span><span
                                                        style="top:-3.0099999999999993em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord">0</span></span></span><span
                                                        style="top:-1.8099999999999994em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord mathnormal"
                                                                style="margin-right:0.00773em;">R</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span
                                class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist" style="height:2.05002em;"><span
                                                    style="top:-2.2500000000000004em;"><span class="pstrut"
                                                        style="height:3.1550000000000002em;"></span><span
                                                        class="delimsizinginner delim-size4"><span>⎦</span></span></span><span
                                                    style="top:-3.3970000000000002em;"><span class="pstrut"
                                                        style="height:3.1550000000000002em;"></span><span
                                                        style="height:0.016em;width:0.667em;"><svg width='0.667em'
                                                            height='0.016em' style='width:0.667em' viewBox='0 0 667 16'
                                                            preserveAspectRatio='xMinYMin'>
                                                            <path d='M263 0 H347 V16 H263z M263 0 H347 V16 H263z' />
                                                        </svg></span></span><span style="top:-4.05002em;"><span
                                                        class="pstrut" style="height:3.1550000000000002em;"></span><span
                                                        class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span>
        </eq>, which is used when rendering, is stored in the LUT. This LUT is called the <a
            href="https://blog.selfshadow.com/sandbox/js/ltc_tables.js"><strong>g_ltc_mat</strong></a> in the
        <strong>WebGL Demo</strong> provided by [Heitz 2016].</p>
    <h3 dir="auto" id="2-3-norm">2-3. Norm</h3>
    <p dir="auto">By <a href="https://en.wikipedia.org/wiki/Integration_by_substitution">Integration by
            Substitution</a>, we can comprehend intuitively that <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi>d</mi>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </mrow>
                                        <mrow>
                                            <mi>d</mi>
                                            <mi>ω</mi>
                                        </mrow>
                                    </mfrac>
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_{\Omega}
                                \operatorname{D}(\omega) \, d\omega = \int_{\Omega} \operatorname{D_o}(\omega_o)
                                \frac{d\omega_o}{d\omega} d\omega = \int_{\Omega} \operatorname{D_o}(\omega_o) d\omega_o
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">Ω</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.28339em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">Ω</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">Ω</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>. Since the <strong>clamped cosine</strong> is normalied, the LTC must be normalized. However, <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">BRDF</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{BRDF}(\omega_v,
                                \omega_l)|\cos \theta_l|</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">BRDF</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∣</span></span></span></span></eq> is <strong>NOT</strong> normalized. And thus
        the <strong>norm</strong> should be stored in the LUT to accomplish the approximation. This means that <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi mathvariant="normal">D</mi>
                                <mo>⁡</mo>
                                <mo stretchy="false">(</mo>
                                <msub>
                                    <mi>ω</mi>
                                    <mi>l</mi>
                                </msub>
                                <mo stretchy="false">)</mo>
                                <mo>≈</mo>
                                <mfrac>
                                    <mrow>
                                        <mi mathvariant="normal">BRDF</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>l</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <mi mathvariant="normal">∣</mi>
                                        <mi>cos</mi>
                                        <mo>⁡</mo>
                                        <msub>
                                            <mi>θ</mi>
                                            <mi>l</mi>
                                        </msub>
                                        <mi mathvariant="normal">∣</mi>
                                    </mrow>
                                    <mrow>
                                        <msub>
                                            <mo>∫</mo>
                                            <mi mathvariant="normal">Ω</mi>
                                        </msub>
                                        <mi mathvariant="normal">BRDF</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>v</mi>
                                        </msub>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>l</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <mi mathvariant="normal">∣</mi>
                                        <mi>cos</mi>
                                        <mo>⁡</mo>
                                        <msub>
                                            <mi>θ</mi>
                                            <mi>l</mi>
                                        </msub>
                                        <mi mathvariant="normal">∣</mi>
                                        <mtext> </mtext>
                                        <mi>d</mi>
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>l</mi>
                                        </msub>
                                    </mrow>
                                </mfrac>
                            </mrow>
                            <annotation encoding="application/x-tex">\operatorname{D}(\omega_l) \approx
                                \frac{\operatorname{BRDF}(\omega_v, \omega_l)|\cos \theta_l|}{\int_{\Omega}
                                \operatorname{BRDF}(\omega_v, \omega_l)|\cos \theta_l| \, d\omega_l}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.6477840000000001em;vertical-align:-0.637784em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.01em;"><span style="top:-2.6265em;"><span class="pstrut"
                                                    style="height:3em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mop mtight"><span
                                                                class="mop op-symbol small-op mtight"
                                                                style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.1105442857142857em;"><span
                                                                                style="top:-2.1224514285714284em;margin-left:-0.19445em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">Ω</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.37754857142857146em;"><span></span></span></span></span></span></span><span
                                                            class="mspace mtight"
                                                            style="margin-right:0.19516666666666668em;"></span><span
                                                            class="mop mtight"><span
                                                                class="mord mathrm mtight">BRDF</span></span><span
                                                            class="mopen mtight">(</span><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">ω</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mpunct mtight">,</span><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">ω</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3448em;"><span
                                                                                style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span><span
                                                            class="mord mtight">∣</span><span class="mspace mtight"
                                                            style="margin-right:0.19516666666666668em;"></span><span
                                                            class="mop mtight"><span class="mtight">c</span><span
                                                                class="mtight">o</span><span
                                                                class="mtight">s</span></span><span
                                                            class="mspace mtight"
                                                            style="margin-right:0.19516666666666668em;"></span><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.02778em;">θ</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3448em;"><span
                                                                                style="top:-2.3487714285714287em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span
                                                            class="mord mtight">∣</span><span class="mspace mtight"
                                                            style="margin-right:0.19516666666666668em;"></span><span
                                                            class="mord mathnormal mtight">d</span><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">ω</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3448em;"><span
                                                                                style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.485em;"><span class="pstrut"
                                                    style="height:3em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mop mtight"><span
                                                                class="mord mathrm mtight">BRDF</span></span><span
                                                            class="mopen mtight">(</span><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">ω</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span><span
                                                            class="mpunct mtight">,</span><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">ω</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3448em;"><span
                                                                                style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span
                                                            class="mclose mtight">)</span><span
                                                            class="mord mtight">∣</span><span class="mspace mtight"
                                                            style="margin-right:0.19516666666666668em;"></span><span
                                                            class="mop mtight"><span class="mtight">c</span><span
                                                                class="mtight">o</span><span
                                                                class="mtight">s</span></span><span
                                                            class="mspace mtight"
                                                            style="margin-right:0.19516666666666668em;"></span><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.02778em;">θ</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3448em;"><span
                                                                                style="top:-2.3487714285714287em;margin-left:-0.02778em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span
                                                            class="mord mtight">∣</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.637784em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>. This LUT is
        called the <a href="https://blog.selfshadow.com/sandbox/js/ltc_tables.js"><strong>g_ltc_mag</strong></a> in the
        <strong>WebGL Demo</strong> provided by [Heitz 2016].</p>
    <h2 dir="auto" id="3-light">3. Light</h2>
    <h3 dir="auto" id="3-1-integration-over-polygons">3-1. Integration over Polygons</h3>
    <p dir="auto">By <a href="https://en.wikipedia.org/wiki/Integration_by_substitution">Integration by
            Substitution</a>, we can comprehend intuitively that <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>P</mi>
                                    </msub>
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>P</mi>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi>d</mi>
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>o</mi>
                                            </msub>
                                        </mrow>
                                        <mrow>
                                            <mi>d</mi>
                                            <mi>ω</mi>
                                        </mrow>
                                    </mfrac>
                                    <mi>d</mi>
                                    <mi>ω</mi>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>P</mi>
                                            <mi>o</mi>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_{P} \operatorname{D}(\omega) \,
                                d\omega = \int_{P} \operatorname{D_o}(\omega_o) \frac{d\omega_o}{d\omega} d\omega =
                                \int_{P_o} \operatorname{D_o}(\omega_o) d\omega_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.28339em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal">d</span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">ω</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mord mathnormal">d</span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.3720499999999998em;vertical-align:-1.01205em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000004em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">P</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.01205em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mi>P</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle P_o = M^{-1} P</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.10903em;">M</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></eq>.
        Evidently, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">normalize</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mi>P</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle P_o = \operatorname{normalize}(M^{-1}
                                P)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">normalize</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.10903em;">M</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                            class="mclose">)</span></span></span></span></eq> is more consistent with <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">normalize</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mi>ω</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \omega_o =
                                \operatorname{normalize}(M^{-1} \omega)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">normalize</span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.10903em;">M</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                            class="mclose">)</span></span></span></span></eq>. However, even if the <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mi>P</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle M^{-1} P</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.10903em;">M</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></eq>
        is <strong>NOT</strong> normalized, the area on the sphere surface subtended by the polygon remains the same.
        Thus, the normalize operator is <strong>NOT</strong> necessary.</p>
    <h3 dir="auto" id="3-2-shading-with-constant-polygonal-lights">3-2. Shading with Constant Polygonal Lights</h3>
    <p dir="auto">When the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_l}(\omega_l)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">l</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is assumed to be constant <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>L</mi>
                                        <mi>l</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle L_l</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>, we have <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">v</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>P</mi>
                                    </msub>
                                    <mi mathvariant="normal">BRDF</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mi>L</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>P</mi>
                                    </msub>
                                    <mi mathvariant="normal">BRDF</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>v</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo>≈</mo>
                                    <msub>
                                        <mi>L</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi>P</mi>
                                    </msub>
                                    <mrow>
                                        <mi mathvariant="normal">n</mi>
                                        <mi mathvariant="normal">o</mi>
                                        <mi mathvariant="normal">r</mi>
                                        <mi mathvariant="normal">m</mi>
                                    </mrow>
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mi>L</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo>⋅</mo>
                                    <mrow>
                                        <mi mathvariant="normal">n</mi>
                                        <mi mathvariant="normal">o</mi>
                                        <mi mathvariant="normal">r</mi>
                                        <mi mathvariant="normal">m</mi>
                                    </mrow>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>P</mi>
                                            <mi>o</mi>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">D</mi>
                                            <mi mathvariant="normal">o</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mi>L</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo>⋅</mo>
                                    <mrow>
                                        <mi mathvariant="normal">n</mi>
                                        <mi mathvariant="normal">o</mi>
                                        <mi mathvariant="normal">r</mi>
                                        <mi mathvariant="normal">m</mi>
                                    </mrow>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>P</mi>
                                            <mi>o</mi>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mi mathvariant="normal">∣</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mi>L</mi>
                                        <mi>l</mi>
                                    </msub>
                                    <mo>⋅</mo>
                                    <mrow>
                                        <mi mathvariant="normal">n</mi>
                                        <mi mathvariant="normal">o</mi>
                                        <mi mathvariant="normal">r</mi>
                                        <mi mathvariant="normal">m</mi>
                                    </mrow>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L_v}(\omega_v) =
                                \int_{P} \operatorname{BRDF}(\omega_v, \omega_l) \operatorname{L_l}(\omega_l) |\cos
                                \theta_l| \, d\omega_l = L_l \int_{P} \operatorname{BRDF}(\omega_v, \omega_l) |\cos
                                \theta_l| \, d\omega_l \approx L_l \int_{P} \mathrm{norm} \operatorname{D}(\omega_l) \,
                                d\omega_l = L_l \cdot \mathrm{norm} \int_{P_o} \operatorname{D_o}(\omega_o) \, d\omega_o
                                = L_l \cdot \mathrm{norm} \int_{P_o} |\cos \theta_o| \, d\omega_o = L_l \cdot
                                \mathrm{norm} \cdot \operatorname{E}(P_o)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight"
                                                            style="margin-right:0.01389em;">v</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">BRDF</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">l</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">BRDF</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">v</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">≈</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mathnormal mtight"
                                                            style="margin-right:0.13889em;">P</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathrm">norm</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:2.3720499999999998em;vertical-align:-1.01205em;"></span><span
                            class="mord"><span class="mord mathrm">norm</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000004em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">P</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.01205em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">D</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:2.3720499999999998em;vertical-align:-1.01205em;"></span><span
                            class="mord"><span class="mord mathrm">norm</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000004em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.13889em;">P</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.16454285714285719em;"><span
                                                                                style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.01205em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.01968em;">l</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⋅</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathrm">norm</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">E</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> where <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msup>
                                        <mi>M</mi>
                                        <mrow>
                                            <mo>−</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msup>
                                    <mi>P</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle P_o = M^{-1} P</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.10903em;">M</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.864108em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight">−</span><span
                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                            class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></eq>
        .<br>
        We assume the vertices <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>p</mi>
                                        <mn>1</mn>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle p_1</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>p</mi>
                                        <mn>2</mn>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle p_2</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.30110799999999993em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">2</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>, ..., <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>p</mi>
                                        <mi>n</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle p_n</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">n</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> of the polygon <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle P_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> are in the tangent space, normalized, and located in the upper hemisphere. By [Heitz 2017], the irradiance
        is closed-form <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mrow>
                                            <mn>2</mn>
                                            <mi>π</mi>
                                        </mrow>
                                    </mfrac>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>1</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                    <mi>arccos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">dot</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>j</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">dot</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">normalize</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">cross</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>j</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo separator="true">,</mo>
                                    <mi mathvariant="normal">vec3</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>0</mn>
                                    <mo separator="true">,</mo>
                                    <mn>0</mn>
                                    <mo separator="true">,</mo>
                                    <mn>1</mn>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{E}(P_o) =
                                \frac{1}{2\pi} \sum_{i=1}^n \arccos(\operatorname{dot}(p_i, p_j)) \cdot
                                \operatorname{dot}(\operatorname{normalize}(\operatorname{cross}(p_i, p_j)),
                                \operatorname{vec3}(0, 0, 1))</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">E</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">2</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.6513970000000002em;"><span
                                            style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal mtight">i</span><span
                                                        class="mrel mtight">=</span><span
                                                        class="mord mtight">1</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">n</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.277669em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mop">arccos</span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">dot</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mop"><span
                                class="mord mathrm">dot</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">normalize</span></span><span class="mopen">(</span><span
                            class="mop"><span class="mord mathrm">cross</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.311664em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.05724em;">j</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">vec3</span></span><span class="mopen">(</span><span
                            class="mord">0</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span
                            class="mclose">))</span></span></span></span></eq> where (0, 0, 1) is the normal direction
        in the tangent space.<br>
        The irradiance <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>P</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{E}(P_o)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">E</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.13889em;">P</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is calculated by the <a
            href="https://blog.selfshadow.com/sandbox/shaders/ltc/ltc.fs"><strong>LTC_Evaluate</strong></a> in the
        <strong>WebGL Demo</strong> provided by [Heitz 2016].</p>
    <h2 dir="auto" id="references">References</h2>
    <p dir="auto">[Heitz 2016] <a href="https://eheitzresearch.wordpress.com/415-2/">Eric Heitz, Jonathan Dupuy, Stephen
            Hill, David Neubelt. &quot;Real-Time Polygonal-Light Shading with Linearly Transformed Cosines.&quot;
            SIGGRAPH 2016.</a><br>
        [Heitz 2017] <a href="https://hal.archives-ouvertes.fr/hal-01458129">Eric Heitz. &quot;Geometric Derivation of
            the Irradiance of Polygonal Lights.&quot; Technical report 2017.</a></p>

</body>

</html>