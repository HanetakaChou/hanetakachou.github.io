<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/default.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
</head>

<body class="markdown-body">
    <table>
        <thead>
            <tr>
                <th style="text-align:center">N/A</th>
                <th style="text-align:center"><a
                        href="https://github.com/NVIDIAGameWorks/FaceWorks/blob/master/doc/slides/FaceWorks-Overview-GTC14.pdf">NVIDIA
                        FaceWorks</a></th>
                <th style="text-align:center">UE4</th>
                <th style="text-align:center"><a href="(http://www.iryoku.com/separable-sss/)">Jimenez 2015</a></th>
                <th style="text-align:center">Unity3D</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td style="text-align:center">Diffuse Reflectance Term</td>
                <td style="text-align:center">Pre-Integrated</td>
                <td style="text-align:center"><a
                        href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Shaders/Private/SeparableSSS.ush">Separable
                        SSS</a></td>
                <td style="text-align:center"><a href="https://graphics.unizar.es/publications.html#year_2012">Separable
                        SSS</a></td>
                <td style="text-align:center"><a
                        href="https://github.com/Unity-Technologies/Graphics/blob/master/com.unity.render-pipelines.high-definition/Runtime/Material/SubsurfaceScattering/SubsurfaceScattering.hlsl">Disney
                        SSS</a></td>
            </tr>
            <tr>
                <td style="text-align:center">Transmittance</td>
                <td style="text-align:center">Deep Scatter</td>
                <td style="text-align:center">TODO</td>
                <td style="text-align:center"><a href="http://www.iryoku.com/translucency/">Realistic Skin
                        Translucency</a></td>
                <td style="text-align:center">TODO</td>
            </tr>
            <tr>
                <td style="text-align:center">Specular Term</td>
                <td style="text-align:center">TODO</td>
                <td style="text-align:center">TODO</td>
                <td style="text-align:center">TODO</td>
                <td style="text-align:center">TODO</td>
            </tr>
        </tbody>
    </table>
    <h2 id="1-diffuse-term">1. Diffuse Term</h2>
    <h3 id="1-1-diffusion-profile">1-1. Diffusion Profile</h3>
    <p>Currently, all real time approaches are based on the diffusion profile(<strong>14.4.2 Rendering with Diffusion
            Profile</strong> of [dEon 2007]) rather than the <a
            href="https://www.pbr-book.org/3ed-2018/Color_and_Radiometry/Surface_Reflection#TheBSSRDF">BSSRDF</a>.</p>
    <p>By using the diffusion profile, the subsurface scattering, which was described by the BSSRDF, is simplified by
        scattering the <strong>amount</strong> of light (technically, the <strong>irradiance E</strong>) of each
        location to the vicinal locations according to the weights indicated by the diffusion profile. Note that the
        <strong>outgoing</strong> irradiance E can also be called <strong>radiant exitance M</strong> and might be
        called <strong>radiosity B</strong> in the last century. Evidently, an equivalent gather operation can be used
        to replace the scatter operation, and the total <strong>radiant exitance</strong> can be considered as <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">M</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>S</mi>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{M}(p_o) =
                                \int_{S_{p_i}} \operatorname{R}(p_o, p_i) \cdot \operatorname{E}(p_i) \, dp_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">M</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.5294100000000004em;vertical-align:-1.16941em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.4336190000000001em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.05764em;">S</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.1645428571428572em;"><span
                                                                                style="top:-2.357em;margin-left:-0.05764em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">p</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.3448em;"><span
                                                                                                                style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3678em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.16941em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">E</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> where the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(p_o, p_i)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is the diffusion profile. And, currently,
        all real time approaches assume that the material is homogeneous. This means that the 2D diffusion profile <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(p_o, p_i)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is radially symmetric, and can be reduced
        to the 1D diffusion profile <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">distance</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{R}(\operatorname{distance}(p_o, p_i))</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">distance</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span></span></span></span></eq>. And for the diffuse term, the outgoing
        radiance is assumed to be the same in all directions. Thus, the diffuse term can be simplified to <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mrow>
                                            <mi mathvariant="normal">L</mi>
                                            <mo>⁡</mo>
                                        </mrow>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">M</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>o</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>S</mi>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">distance</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>S</mi>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">distance</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi>π</mi>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">i</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>S</mi>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">distance</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">i</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L}_o(p_o) =
                                \frac{\operatorname{M}(p_o)}{\pi} = \frac{1}{\pi} \cdot \int_{S_{p_i}}
                                \operatorname{R}(\operatorname{distance}(p_o, p_i)) \cdot \operatorname{E}(p_i) \, dp_i
                                = \frac{1}{\pi} \cdot \int_{S_{p_i}} \operatorname{R}(\operatorname{distance}(p_o, p_i))
                                \cdot \pi \cdot \operatorname{L_i}(p_i) \, dp_i = \int_{S_{p_i}}
                                \operatorname{R}(\operatorname{distance}(p_o, p_i)) \cdot \operatorname{L_i}(p_i) \,
                                dp_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop"><span
                                    class="mord mathrm">L</span></span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">M</span></span><span
                                                        class="mopen">(</span><span class="mord"><span
                                                            class="mord mathnormal">p</span><span class="msupsub"><span
                                                                class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.5294100000000004em;vertical-align:-1.16941em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.4336190000000001em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.05764em;">S</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.1645428571428572em;"><span
                                                                                style="top:-2.357em;margin-left:-0.05764em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">p</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.3448em;"><span
                                                                                                                style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3678em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.16941em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">distance</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">E</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.5294100000000004em;vertical-align:-1.16941em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.4336190000000001em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.05764em;">S</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.1645428571428572em;"><span
                                                                                style="top:-2.357em;margin-left:-0.05764em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">p</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.3448em;"><span
                                                                                                                style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3678em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.16941em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">distance</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span
                            class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31750199999999995em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.5294100000000004em;vertical-align:-1.16941em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.4336190000000001em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.05764em;">S</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.1645428571428572em;"><span
                                                                                style="top:-2.357em;margin-left:-0.05764em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">p</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.3448em;"><span
                                                                                                                style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3678em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.16941em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">distance</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31750199999999995em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.</p>
    <p>However, things are far from simple. Although the proposals based on the diffusion profile are much simpler than
        the BSSRDF, a general 2D convolution is still too expensive for real time rendering. Actually, according to
        [dEon 2007], if the width (technically, the range of the significant contribution domain) of the diffusion
        profile is about 16 mm, and the width of pixel is about 0.25 mm, we would need 4096(64 x 64) samples per pixel
        in the shader. Thus, we have to propose more efficient approaches to settle this problem.</p>
    <h3 id="1-2-pre-integrated">1-2. Pre-Integrated</h3>
    <p>The <strong>diffuse reflectance</strong> term of FaceWorks is based on the <strong>Pre-Integrated</strong>
        [Penner 2011].</p>
    <p>In real time rendering, the light is assumed to be the punctual light rather than the area light. The <a
            href="https://www.pbr-book.org/3ed-2018/Light_Transport_I_Surface_Reflection/Sampling_Light_Sources#LightswithSingularities">Delta
            Distribution</a> is applied, and the reflectance equation is simplified to <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mrow>
                                            <mi mathvariant="normal">L</mi>
                                            <mo>⁡</mo>
                                        </mrow>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mi mathvariant="normal">BRDF</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">i</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">BRDF</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>ω</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⊗</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">E</mi>
                                            <mi mathvariant="normal">L</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⊗</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L}_o(p, \omega_o) =
                                \int_\Omega \operatorname{BRDF}(p, \omega_o, \omega_i) \cdot \operatorname{L_i}(p,
                                \omega_i) \cdot |\cos(\theta_i)| \, d\omega_i = \operatorname{BRDF}(p_i, \omega_o,
                                \omega_i) \otimes \operatorname{E_{L}}(p) \otimes |\cos(\theta_i)|</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop"><span
                                    class="mord mathrm">L</span></span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">BRDF</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31750199999999995em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">BRDF</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">E</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathrm mtight">L</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span></span></span></span></eq> where the <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">E</mi>
                                            <mi mathvariant="normal">L</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{E_{L}}(p)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm">E</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathrm mtight">L</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span></span></span></span></eq> is the irradiance perpendicular to the
        light direction. And since the diffuse BRDF equals <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <msub>
                                            <mi>c</mi>
                                            <mrow>
                                                <mi>d</mi>
                                                <mi>i</mi>
                                                <mi>f</mi>
                                                <mi>f</mi>
                                                <mi>u</mi>
                                                <mi>s</mi>
                                                <mi>e</mi>
                                            </mrow>
                                        </msub>
                                        <mi>π</mi>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \frac{c_{diffuse}}{\pi}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.7935599999999998em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.1075599999999999em;"><span style="top:-2.314em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord"><span class="mord mathnormal">c</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.3361079999999999em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mathnormal mtight">d</span><span
                                                                                        class="mord mathnormal mtight">i</span><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.10764em;">ff</span><span
                                                                                        class="mord mathnormal mtight">u</span><span
                                                                                        class="mord mathnormal mtight">se</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq> which is
        irrelevant to the the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>w</mi>
                                        <mi>o</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle w_o</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02691em;">w</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi>w</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle w_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02691em;">w</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>, the reflectance equation can be simplified further to <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mrow>
                                            <mi mathvariant="normal">L</mi>
                                            <mo>⁡</mo>
                                        </mrow>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">
                                                <msub>
                                                    <mi mathvariant="normal">c</mi>
                                                    <mrow>
                                                        <mi mathvariant="normal">d</mi>
                                                        <mi mathvariant="normal">i</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">u</mi>
                                                        <mi mathvariant="normal">s</mi>
                                                        <mi mathvariant="normal">e</mi>
                                                    </mrow>
                                                </msub>
                                            </mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>p</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⊗</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">E</mi>
                                            <mi mathvariant="normal">L</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⊗</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L}_o(p) =
                                \frac{\operatorname{c_{diffuse}}(p)}{\pi} \otimes \operatorname{E_{L}}(p) \otimes
                                |\cos(\theta_i)|</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop"><span
                                    class="mord mathrm">L</span></span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord"><span
                                                                class="mord mathrm">c</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathrm mtight">diffuse</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                        class="mopen">(</span><span
                                                        class="mord mathnormal">p</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">E</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathrm mtight">L</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span></span></span></span></eq>. Thus, the
        diffuse term is simplified to <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mrow>
                                            <mi mathvariant="normal">L</mi>
                                            <mo>⁡</mo>
                                        </mrow>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>S</mi>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">distance</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">L</mi>
                                            <mi mathvariant="normal">i</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>S</mi>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">distance</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">
                                                <msub>
                                                    <mi mathvariant="normal">c</mi>
                                                    <mrow>
                                                        <mi mathvariant="normal">d</mi>
                                                        <mi mathvariant="normal">i</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">u</mi>
                                                        <mi mathvariant="normal">s</mi>
                                                        <mi mathvariant="normal">e</mi>
                                                    </mrow>
                                                </msub>
                                            </mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">E</mi>
                                            <mi mathvariant="normal">L</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{L}_o(p_o) =
                                \int_{S_{p_i}} \operatorname{R}(\operatorname{distance}(p_o, p_i)) \cdot
                                \operatorname{L_i}(p_i) \, dp_i = \int_{S_{p_i}}
                                \operatorname{R}(\operatorname{distance}(p_o, p_i)) \cdot
                                \frac{\operatorname{c_{diffuse}}(p_i)}{\pi} \cdot \operatorname{E_{L}}(p_i) \cdot
                                |\cos(\theta_i)| \, dp_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop"><span
                                    class="mord mathrm">L</span></span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.5294100000000004em;vertical-align:-1.16941em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.4336190000000001em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.05764em;">S</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.1645428571428572em;"><span
                                                                                style="top:-2.357em;margin-left:-0.05764em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">p</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.3448em;"><span
                                                                                                                style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3678em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.16941em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">distance</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">L</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31750199999999995em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.5294100000000004em;vertical-align:-1.16941em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.4336190000000001em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.05764em;">S</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.1645428571428572em;"><span
                                                                                style="top:-2.357em;margin-left:-0.05764em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">p</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.3448em;"><span
                                                                                                                style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3678em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.16941em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">distance</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord"><span
                                                                class="mord mathrm">c</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathrm mtight">diffuse</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                        class="mopen">(</span><span class="mord"><span
                                                            class="mord mathnormal">p</span><span class="msupsub"><span
                                                                class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                        class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">E</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathrm mtight">L</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.</p>
    <p>The main idea of [Penner 2011] is that the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">
                                                <msub>
                                                    <mi mathvariant="normal">c</mi>
                                                    <mrow>
                                                        <mi mathvariant="normal">d</mi>
                                                        <mi mathvariant="normal">i</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">u</mi>
                                                        <mi mathvariant="normal">s</mi>
                                                        <mi mathvariant="normal">e</mi>
                                                    </mrow>
                                                </msub>
                                            </mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \frac{\operatorname{c_{diffuse}}(p_i)}{\pi} \cdot \operatorname{E}(p_i)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord"><span
                                                                class="mord mathrm">c</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathrm mtight">diffuse</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                        class="mopen">(</span><span class="mord"><span
                                                            class="mord mathnormal">p</span><span class="msupsub"><span
                                                                class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                        class="vlist"
                                                                        style="height:0.31166399999999994em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">i</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">E</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is assumed to be the constant <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">
                                                <msub>
                                                    <mi mathvariant="normal">c</mi>
                                                    <mrow>
                                                        <mi mathvariant="normal">d</mi>
                                                        <mi mathvariant="normal">i</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">u</mi>
                                                        <mi mathvariant="normal">s</mi>
                                                        <mi mathvariant="normal">e</mi>
                                                    </mrow>
                                                </msub>
                                            </mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>o</mi>
                                            </msub>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \frac{\operatorname{c_{diffuse}}(p_o)}{\pi} \cdot \operatorname{E}(p_o)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord"><span
                                                                class="mord mathrm">c</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathrm mtight">diffuse</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                        class="mopen">(</span><span class="mord"><span
                                                            class="mord mathnormal">p</span><span class="msupsub"><span
                                                                class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.151392em;"><span
                                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathnormal mtight">o</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">E</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> for all vicinal locations, and thus the
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">distance</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">∣</mi>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mi mathvariant="normal">∣</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{R}(\operatorname{distance}(p_o, p_i)) \cdot |\cos(\theta_i)|</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">distance</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">∣</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">cos</span><span
                            class="mopen">(</span><span class="mord"><span class="mord mathnormal"
                                style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mord">∣</span></span></span></span></eq> part of the
        diffuse term can be <strong>pre-integrated</strong> and stored in a LUT(Look Up Texture) which is called the
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>θ</mi>
                                    <mo separator="true">,</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>r</mi>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, \frac{1}{r})
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span
                            class="mclose">)</span></span></span></span></eq>. The <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>θ</mi>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \theta</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">θ</span></span></span></span></eq> is merely the traditional
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">dot</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>N</mi>
                                    <mo separator="true">,</mo>
                                    <mi>L</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{dot}(N,L)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">dot</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.10903em;">N</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span></eq>, and
        the <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>r</mi>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \frac{1}{r}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>, which is called
        <strong>curvature</strong> by [Penner 2011], can be calculated on-the-fly as <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>r</mi>
                                    </mfrac>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">ddx</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>N</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mrow>
                                            <mi mathvariant="normal">ddx</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>P</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \frac{1}{r} =
                                \frac{\operatorname{ddx}(N)}{\operatorname{ddx}(P)}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">ddx</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.13889em;">P</span><span
                                                        class="mclose">)</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">ddx</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.10903em;">N</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>. However, the
        on-the-fly method may be inaccurate since the FaceWorks chooses to precompute the curvature instead. In
        conclusion, the diffuse term can be calculated as <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">dot</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>N</mi>
                                    <mo separator="true">,</mo>
                                    <mi>L</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo separator="true">,</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">ddx</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>N</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mrow>
                                            <mi mathvariant="normal">ddx</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>P</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                    <mo>⊗</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">
                                                <msub>
                                                    <mi mathvariant="normal">c</mi>
                                                    <mrow>
                                                        <mi mathvariant="normal">d</mi>
                                                        <mi mathvariant="normal">i</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">f</mi>
                                                        <mi mathvariant="normal">u</mi>
                                                        <mi mathvariant="normal">s</mi>
                                                        <mi mathvariant="normal">e</mi>
                                                    </mrow>
                                                </msub>
                                            </mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>p</mi>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mo>⊗</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">E</mi>
                                            <mi mathvariant="normal">L</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>p</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{D}(\operatorname{dot}(N,L),
                                \frac{\operatorname{ddx}(N)}{\operatorname{ddx}(P)}) \otimes
                                \frac{\operatorname{c_{diffuse}}(p)}{\pi} \otimes \operatorname{E_{L}}(p)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.363em;vertical-align:-0.936em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span class="mop"><span
                                class="mord mathrm">dot</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.10903em;">N</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">L</span><span class="mclose">)</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">ddx</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.13889em;">P</span><span
                                                        class="mclose">)</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord mathrm">ddx</span></span><span
                                                        class="mopen">(</span><span class="mord mathnormal"
                                                        style="margin-right:0.10903em;">N</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">⊗</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mord"><span
                                                                class="mord mathrm">c</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathrm mtight">diffuse</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                        class="mopen">(</span><span
                                                        class="mord mathnormal">p</span><span
                                                        class="mclose">)</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">E</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathrm mtight">L</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathnormal">p</span><span
                            class="mclose">)</span></span></span></span></eq>.</p>
    <p>Usually, the diffusion profile is normalized which indicates the energy conservation. This means that <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msubsup>
                                        <mo>∫</mo>
                                        <mn>0</mn>
                                        <mi mathvariant="normal">∞</mi>
                                    </msubsup>
                                    <mi>R</mi>
                                    <mo stretchy="false">(</mo>
                                    <mi>r</mi>
                                    <mo stretchy="false">)</mo>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mi>r</mi>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_0^\infin R(r) \, dr =1
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.414292em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">0</span></span></span><span
                                                style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">∞</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal" style="margin-right:0.00773em;">R</span><span
                            class="mopen">(</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord mathnormal"
                            style="margin-right:0.02778em;">r</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span></span></span></span></eq>. However, according to [Penner 2011], <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>θ</mi>
                                    <mo separator="true">,</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>r</mi>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mrow>
                                            <msubsup>
                                                <mo>∫</mo>
                                                <mrow>
                                                    <mo>−</mo>
                                                    <mi>π</mi>
                                                </mrow>
                                                <mi>π</mi>
                                            </msubsup>
                                            <mi mathvariant="normal">∣</mi>
                                            <mi>cos</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi>θ</mi>
                                            <mo>+</mo>
                                            <mi>x</mi>
                                            <mo stretchy="false">)</mo>
                                            <mi mathvariant="normal">∣</mi>
                                            <mo>⋅</mo>
                                            <mi>R</mi>
                                            <mo stretchy="false">(</mo>
                                            <mn>2</mn>
                                            <mi>r</mi>
                                            <mi>sin</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mfrac>
                                                <mi>x</mi>
                                                <mn>2</mn>
                                            </mfrac>
                                            <mo stretchy="false">)</mo>
                                            <mo stretchy="false">)</mo>
                                            <mtext> </mtext>
                                            <mi>d</mi>
                                            <mi>x</mi>
                                        </mrow>
                                        <mrow>
                                            <msubsup>
                                                <mo>∫</mo>
                                                <mrow>
                                                    <mo>−</mo>
                                                    <mi>π</mi>
                                                </mrow>
                                                <mi>π</mi>
                                            </msubsup>
                                            <mi>R</mi>
                                            <mo stretchy="false">(</mo>
                                            <mn>2</mn>
                                            <mi>r</mi>
                                            <mi>sin</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mfrac>
                                                <mi>y</mi>
                                                <mn>2</mn>
                                            </mfrac>
                                            <mo stretchy="false">)</mo>
                                            <mo stretchy="false">)</mo>
                                            <mtext> </mtext>
                                            <mi>d</mi>
                                            <mi>y</mi>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, \frac{1}{r})
                                = \frac{\int_{-\pi}^{\pi} | \cos (\theta + x) | \cdot R(2r\sin(\frac{x}{2}))
                                \,dx}{\int_{-\pi}^{\pi} R(2r\sin(\frac{y}{2})) \,dy}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.826886em;vertical-align:-1.163443em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.663443em;"><span style="top:-2.250708em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mop op-symbol small-op"
                                                            style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.8592920000000001em;"><span
                                                                            style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">−</span><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.03588em;">π</span></span></span></span><span
                                                                            style="top:-3.2579000000000002em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.41415100000000005em;"><span></span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.00773em;">R</span><span
                                                        class="mopen">(</span><span class="mord">2</span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mop">sin</span><span class="mopen">(</span><span
                                                        class="mord"><span class="mopen nulldelimiter"></span><span
                                                            class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.7475em;"><span
                                                                            style="top:-2.6550000000000002em;"><span
                                                                                class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span><span
                                                                            style="top:-3.23em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="frac-line"
                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                            style="top:-3.446108em;"><span
                                                                                class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.03588em;">y</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.345em;"><span></span></span></span></span></span><span
                                                            class="mclose nulldelimiter"></span></span><span
                                                        class="mclose">))</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal">d</span><span class="mord mathnormal"
                                                        style="margin-right:0.03588em;">y</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.804151em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mop"><span class="mop op-symbol small-op"
                                                            style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span
                                                            class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.8592920000000001em;"><span
                                                                            style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">−</span><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.03588em;">π</span></span></span></span><span
                                                                            style="top:-3.2579000000000002em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mathnormal mtight"
                                                                                        style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.41415100000000005em;"><span></span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord">∣</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mop">cos</span><span class="mopen">(</span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">θ</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">+</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord mathnormal">x</span><span
                                                        class="mclose">)</span><span class="mord">∣</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.00773em;">R</span><span
                                                        class="mopen">(</span><span class="mord">2</span><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mop">sin</span><span class="mopen">(</span><span
                                                        class="mord"><span class="mopen nulldelimiter"></span><span
                                                            class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.695392em;"><span
                                                                            style="top:-2.6550000000000002em;"><span
                                                                                class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span><span
                                                                            style="top:-3.23em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="frac-line"
                                                                                style="border-bottom-width:0.04em;"></span></span><span
                                                                            style="top:-3.394em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight"><span
                                                                                        class="mord mathnormal mtight">x</span></span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.345em;"><span></span></span></span></span></span><span
                                                            class="mclose nulldelimiter"></span></span><span
                                                        class="mclose">))</span><span class="mspace"
                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                        class="mord mathnormal">d</span><span
                                                        class="mord mathnormal">x</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.163443em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq> where denominator
        is added to make sure the diffusion profile is normalized.</p>
    <p>In the GPU Pro 2, the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>θ</mi>
                                    <mo separator="true">,</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>r</mi>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, \frac{1}{r})
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span
                            class="mclose">)</span></span></span></span></eq> is calculated by
        <strong>integrateDiffuseScatteringOnRing</strong>. And there are some points to note.</p>
    <ol>
        <li>[Penner 2011] merely follows [dEon 2007] and the diffusion profile is approximated by the Gaussians (the
            <strong>Scatter</strong> in the code). However, the motivation of [dEon 2007] is that the <a
                href="https://en.wikipedia.org/wiki/Gaussian_blur">Gaussian blur</a> is a <a
                href="https://en.wikipedia.org/wiki/Separable_filter">separable filter</a>, and thus the general 2D
            convolution can be replaced by 1D convolutions to improve the performance. In my opinion, it is acceptable
            to perform a general 2D convolution even by using the exact accurate diffusion profile, since the approach
            proposed by [Penner 2011] <strong>pre-integrates</strong> the convolution, and the efficiency doesn't matter
            too much for offline precomputing.</li>
        <li>The <strong>pre-integral</strong> is performed on a ring rather than on a sphere. This is reasonable since
            it is assumed that the diffusion profile is radially symmetric.</li>
        <li>In the FaceWorks, according to the <strong>numerical quadrature</strong>, the funtion value <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mi mathvariant="normal">f</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                </mrow>
                                <annotation encoding="application/x-tex">\operatorname{f}(x)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                                class="mopen">(</span><span class="mord mathnormal">x</span><span
                                class="mclose">)</span></span></span></span></eq> is multiplied by the difference of the
            domain <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">Δ</mi>
                                        <mo>⁡</mo>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta}x
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.68333em;vertical-align:0em;"></span><span class="mop"><span
                                    class="mord mathrm">Δ</span></span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">x</span></span></span></span></eq> (the <strong>scale</strong>
            in the code).<br>
            However, in the GPU Pro 2, there is no such code like <strong>scale</strong> since the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">Δ</mi>
                                        <mo>⁡</mo>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta}x
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.68333em;vertical-align:0em;"></span><span class="mop"><span
                                    class="mord mathrm">Δ</span></span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">x</span></span></span></span></eq> appears in both numerator and
            denominator, and the it is not necessary to multiply <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">f</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>x</mi>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{f}(x)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span
                                class="mopen">(</span><span class="mord mathnormal">x</span><span
                                class="mclose">)</span></span></span></span></eq> by <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">Δ</mi>
                                        <mo>⁡</mo>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta}x
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.68333em;vertical-align:0em;"></span><span class="mop"><span
                                    class="mord mathrm">Δ</span></span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">x</span></span></span></span></eq>.</li>
    </ol>
    <p>In the FaceWorks, the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">D</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>θ</mi>
                                    <mo separator="true">,</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>r</mi>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta, \frac{1}{r})
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mop"><span
                                class="mord mathrm">D</span></span><span class="mopen">(</span><span
                            class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.02778em;">r</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span
                            class="mclose">)</span></span></span></span></eq> is calculated by
        <strong>GFSDK_FaceWorks_GenerateCurvatureLUT</strong>. However, there is some subtle modification.</p>
    <ol>
        <li>The <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>2</mn>
                                        <mi>r</mi>
                                        <mi>sin</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mfrac>
                                            <mi>x</mi>
                                            <mn>2</mn>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 2r\sin(\frac{x}{2})</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span
                                class="mord">2</span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                                class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                    class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.10756em;"><span
                                                    style="top:-2.314em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">2</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathnormal">x</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span
                                class="mclose">)</span></span></span></span></eq> is replaced by the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi>r</mi>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle rx</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span
                                class="mord mathnormal">x</span></span></span></span></eq> (the <strong>delta</strong>
            in the code). Technically, the <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>2</mn>
                                        <mi>r</mi>
                                        <mi>sin</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mfrac>
                                            <mi>x</mi>
                                            <mn>2</mn>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 2r\sin(\frac{x}{2})</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span
                                class="mord">2</span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                                class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                    class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.10756em;"><span
                                                    style="top:-2.314em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">2</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathnormal">x</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span
                                class="mclose">)</span></span></span></span></eq> is more correct since the diffusion
            profile describes the light absorption inside the medium rather than over the surface. Perhaps the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>2</mn>
                                        <mi>r</mi>
                                        <mi>sin</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mfrac>
                                            <mi>x</mi>
                                            <mn>2</mn>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 2r\sin(\frac{x}{2})</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1.7935600000000003em;vertical-align:-0.686em;"></span><span
                                class="mord">2</span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                                class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                    class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.10756em;"><span
                                                    style="top:-2.314em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">2</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathnormal">x</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span
                                class="mclose">)</span></span></span></span></eq> and the <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi>r</mi>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle rx</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span
                                class="mord mathnormal">x</span></span></span></span></eq> are close when the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle x</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.43056em;vertical-align:0em;"></span><span
                                class="mord mathnormal">x</span></span></span></span></eq> is small.</li>
        <li>The denominator <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <msubsup>
                                            <mo>∫</mo>
                                            <mrow>
                                                <mo>−</mo>
                                                <mi>π</mi>
                                            </mrow>
                                            <mi>π</mi>
                                        </msubsup>
                                        <mi>R</mi>
                                        <mo stretchy="false">(</mo>
                                        <mn>2</mn>
                                        <mi>r</mi>
                                        <mi>sin</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mfrac>
                                            <mi>y</mi>
                                            <mn>2</mn>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                        <mo stretchy="false">)</mo>
                                        <mtext> </mtext>
                                        <mi>d</mi>
                                        <mi>y</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \int_{-\pi}^{\pi}
                                    R(2r\sin(\frac{y}{2})) \,dy</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.384573em;vertical-align:-0.970281em;"></span><span class="mop"><span
                                    class="mop op-symbol large-op"
                                    style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.414292em;"><span
                                                    style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight">−</span><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">π</span></span></span></span><span
                                                    style="top:-3.8129000000000004em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mathnormal mtight"
                                                                style="margin-right:0.03588em;">π</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.970281em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal" style="margin-right:0.00773em;">R</span><span
                                class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">r</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span
                                class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span
                                    class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.1075599999999999em;"><span
                                                    style="top:-2.314em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">2</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathnormal"
                                                            style="margin-right:0.03588em;">y</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mclose">))</span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">d</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span></span></span></span></eq> is omitted perhaps
            due to the fact that the diffusion profile has been normalized. Actually, I try to calculate the denominator
            by myself, and I find the denominator is really close to one.</li>
        <li>In the GPU Pro 2, three normals should be used for different RGB components and the LUT should be sampled
            three times according to three different <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi>θ</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \theta</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal"
                                style="margin-right:0.02778em;">θ</span></span></span></span></eq>s. Perhaps this method
            is not efficient and the FaceWorks detaches the <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">dot</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>N</mi>
                                        <mo separator="true">,</mo>
                                        <mi>L</mi>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{dot}(N,L)
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">dot</span></span><span class="mopen">(</span><span
                                class="mord mathnormal" style="margin-right:0.10903em;">N</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span></eq>,
            which denotes the part of the integral where x is close to zero and the diffuse profile is close to one,
            from the total integral <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">D</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>θ</mi>
                                        <mo separator="true">,</mo>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mi>r</mi>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{D}(\theta,
                                    \frac{1}{r})</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mop"><span
                                    class="mord mathrm">D</span></span><span class="mopen">(</span><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.02778em;">r</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span
                                class="mclose">)</span></span></span></span></eq>. Evidently, the remaining part of the
            integral is relatively small, and thus FaceWorks maps the remaining part of the integral from [-0.25, 0.25]
            to [0, 1] to fully use the precision of the texture (the <strong>rgbAdjust</strong> in the code). The
            <strong>GFSDK_FaceWorks_EvaluateSSSDirectLight</strong> is used to calculate the diffuse term. The LUT is
            only sampled once and three normals are used to calculate the <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">dot</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>N</mi>
                                        <mo separator="true">,</mo>
                                        <mi>L</mi>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{dot}(N,L)
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">dot</span></span><span class="mopen">(</span><span
                                class="mord mathnormal" style="margin-right:0.10903em;">N</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span></eq>
            which is detached from the total integral.</li>
    </ol>
    <h3 id="1-3-separable-sss">1-3. Separable SSS</h3>
    <p>The <strong>diffuse reflectance</strong> term of UE4 is based on the <strong>Separable SSS</strong> [Jimenez
        2012].</p>
    <p>The approach of [dEon 2007] is to approximate the diffusion profile by the weighted sum of 6 Gaussians, and thus
        the general 2D convolution can be replaced by 12(2 x 6) 1D convolutions since the <a
            href="https://en.wikipedia.org/wiki/Gaussian_blur">Gaussian blur</a> is a <a
            href="https://en.wikipedia.org/wiki/Separable_filter">separable filter</a>. However, the approach proposed
        by [dEon 2007] is applied in texture space which is too weird according to the convention of the real time
        rendering. And the screen space approach is proposed by [Jimenez 2009]. However, the approach proposed by
        [Jimenez 2009] still needs 12(2 x 6) passes to perform the 12(2 x 6) 1D convolutions. Evidently, this is still
        too expensive for real time rendering. And thus, the 2 passes approach is proposed by [Jimenez 2012].</p>
    <p>According to the <strong>numerical quadrature</strong>, the funtion value sampled from the irradiance texture
        should be multiplied by the difference of the domain <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">Δ</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta} p_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                            class="mop"><span class="mord mathrm">Δ</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>. [dEon 2007] proposed the <strong>stretch texture</strong>, where the difference of the world position is
        stored, to described the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">Δ</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta} p_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                            class="mop"><span class="mord mathrm">Δ</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>. Definitely, the screen space depth can be used to calculate the world position and thus the <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">Δ</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta} p_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                            class="mop"><span class="mord mathrm">Δ</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> can be obtained. However, the <strong>stretch factor</strong> proposed by [Jimenez 2009] is not
        proportional to the difference of the world position, and in my opinion, is empirical. And [Mikkelsen 2010]
        proposed a more reasonable approach to calculate the <strong>kernel</strong> size which is based on the
        mathematical derivation. Note that in image processing, the <strong>filter</strong> is a (continuous) function
        which is approximated by a discrete and finite <strong>kernel</strong>.</p>
    <p>The the demo source code of [Jimenez 2012] is provided by [Jimenez 2015]. Perhaps you can not believe it but it
        is really the truth. <strong>The demo source code provided by [Jimenez 2015] has nothing to do with [Jimenez
            2015]</strong>. This is really arcane, and I do spend some time to realize this fact.</p>
    <p>The main idea of [Jimenez 2012] is that in real time rendering, the non-separable diffusion profile is
        represented by the discretized kernel where the SVD can be applied, and the SVD indicates that the diffusion
        profile kernel can be approximated by a separable kernel <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">M</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>x</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>y</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <munder>
                                        <mo>∑</mo>
                                        <mi>y</mi>
                                    </munder>
                                    <mo stretchy="false">(</mo>
                                    <munder>
                                        <mo>∑</mo>
                                        <mi>x</mi>
                                    </munder>
                                    <mi mathvariant="normal">E</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi>x</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>+</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo separator="true">,</mo>
                                    <msub>
                                        <mi>y</mi>
                                        <mi>o</mi>
                                    </msub>
                                    <mo>+</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>y</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">S</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <mi mathvariant="normal">
                                        <msup>
                                            <mi mathvariant="normal">S</mi>
                                            <mi mathvariant="normal">T</mi>
                                        </msup>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>y</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{M}(x_o, y_o) = \sum_y
                                (\sum_x \operatorname{E}(x_o + \Delta x, y_o + \Delta y) \cdot \operatorname{S}(\Delta
                                x)) \cdot \operatorname{S^T}(\Delta y)</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">M</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal">x</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.0500050000000003em;"><span
                                            style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight"
                                                    style="margin-right:0.03588em;">y</span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.386113em;"><span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:1.050005em;"><span
                                            style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">x</span></span></span><span
                                            style="top:-3.0500049999999996em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.250005em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">E</span></span><span class="mopen">(</span><span class="mord"><span
                                class="mord mathnormal">x</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">o</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord">Δ</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord mathrm">S</span></span><span class="mopen">(</span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mclose">))</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">S</span><span class="msupsub"><span
                                        class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                style="height:0.8913309999999999em;"><span
                                                    style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                        style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord">Δ</span><span class="mord mathnormal"
                            style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>
        </eq> where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">S</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mfrac>
                                        <mrow>
                                            <mi mathvariant="normal">Δ</mi>
                                            <mi>x</mi>
                                            <mo>∗</mo>
                                            <mtext>width</mtext>
                                        </mrow>
                                        <mrow>
                                            <mn>0.001</mn>
                                            <mo>+</mo>
                                            <mtext>falloff</mtext>
                                        </mrow>
                                    </mfrac>
                                    <mo stretchy="false">)</mo>
                                    <mo>∗</mo>
                                    <mtext>strength</mtext>
                                    <mo>+</mo>
                                    <mi mathvariant="normal">δ</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>∗</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <mtext>strength</mtext>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{S}(\Delta x) =
                                \operatorname{R}(\frac{\Delta x*\text{width}}{0.001 + \text{falloff}})*\text{strength} +
                                \operatorname{\delta}(\Delta x)*(1-\text{strength})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">S</span></span><span class="mopen">(</span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.14077em;vertical-align:-0.7693300000000001em;"></span><span
                            class="mop"><span class="mord mathrm">R</span></span><span class="mopen">(</span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">0.001</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">+</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord text"><span
                                                            class="mord">falloff</span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">∗</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord text"><span
                                                            class="mord">width</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">∗</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord text"><span class="mord">strength</span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mop"><span class="mord">δ</span></span><span class="mopen">(</span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord text"><span class="mord">strength</span></span><span
                            class="mclose">)</span></span></span></span></eq> where <strong>R</strong> denotes the 1D
        diffusion profile and <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">δ</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{\delta}(\Delta x)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord">δ</span></span><span class="mopen">(</span><span class="mord">Δ</span><span
                            class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></eq>
        denotes the <a href="https://en.wikipedia.org/wiki/Dirac_delta_function">delta function</a> such that <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">δ</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>0</mn>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{\delta}(0) = 1
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord">δ</span></span><span class="mopen">(</span><span class="mord">0</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">1</span></span></span></span></eq>.</p>
    <p>The <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">S</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi mathvariant="normal">Δ</mi>
                                    <mi>x</mi>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{S}(\Delta x)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">S</span></span><span class="mopen">(</span><span
                            class="mord">Δ</span><span class="mord mathnormal">x</span><span
                            class="mclose">)</span></span></span></span></eq> is calculated by the
        <strong>calculateKernel</strong> in the demo source code provided by [Jimenez 2015] and the
        <strong>ComputeMirroredSSSKernel</strong> in the UE4. And there are some points to note.</p>
    <ol>
        <li>The <strong>strength</strong>, which is the <strong>SubsurfaceColor</strong> in the UE4, is to lerp between
            the SSS diffuse term <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">R</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mfrac>
                                            <mrow>
                                                <mi mathvariant="normal">Δ</mi>
                                                <mi>x</mi>
                                                <mo>∗</mo>
                                                <mtext>width</mtext>
                                            </mrow>
                                            <mrow>
                                                <mn>0.001</mn>
                                                <mo>+</mo>
                                                <mtext>falloff</mtext>
                                            </mrow>
                                        </mfrac>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{R}(\frac{\Delta
                                    x*\text{width}}{0.001 + \text{falloff}})</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.14077em;vertical-align:-0.7693300000000001em;"></span><span
                                class="mop"><span class="mord mathrm">R</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.37144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">0.001</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">+</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">falloff</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">Δ</span><span
                                                            class="mord mathnormal">x</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">∗</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">width</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span
                                class="mclose">)</span></span></span></span></eq> and the conventional diffuse term <eq>
                <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">δ</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\delta}(\Delta x)
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mclose">)</span></span></span></span></eq>. Evidently, when the
            <strong>strength</strong> equals 0, since <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">S</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi mathvariant="normal">δ</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <mi mathvariant="normal">Δ</mi>
                                            <mi>x</mi>
                                            <mo stretchy="false">)</mo>
                                        </mstyle>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{S}(\Delta x) =
                                    \displaystyle \operatorname{\delta}(\Delta x)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">S</span></span><span class="mopen">(</span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mop"><span class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mclose">)</span></span></span></span></eq> and <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">δ</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mn>0</mn>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <mn>1</mn>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\delta}(0) = 1
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord">0</span><span class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                            class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                                class="mord">1</span></span></span></span></eq>, the formula is reduced to the
            conventional diffuse term <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">M</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>x</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>y</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <munder>
                                            <mo>∑</mo>
                                            <mi>y</mi>
                                        </munder>
                                        <mo stretchy="false">(</mo>
                                        <munder>
                                            <mo>∑</mo>
                                            <mi>x</mi>
                                        </munder>
                                        <mi mathvariant="normal">E</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>x</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo>+</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>y</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo>+</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>y</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo>⋅</mo>
                                        <mi mathvariant="normal">S</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo stretchy="false">)</mo>
                                        <mo>⋅</mo>
                                        <mi mathvariant="normal">
                                            <msup>
                                                <mi mathvariant="normal">S</mi>
                                                <mi mathvariant="normal">T</mi>
                                            </msup>
                                        </mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>y</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <munder>
                                            <mo>∑</mo>
                                            <mi>y</mi>
                                        </munder>
                                        <mo stretchy="false">(</mo>
                                        <munder>
                                            <mo>∑</mo>
                                            <mi>x</mi>
                                        </munder>
                                        <mi mathvariant="normal">E</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>x</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo>+</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>y</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo>+</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>y</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo>⋅</mo>
                                        <mi mathvariant="normal">δ</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>x</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo stretchy="false">)</mo>
                                        <mo>⋅</mo>
                                        <mi mathvariant="normal">δ</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi mathvariant="normal">Δ</mi>
                                        <mi>y</mi>
                                        <mo stretchy="false">)</mo>
                                        <mo>=</mo>
                                        <mi mathvariant="normal">E</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <msub>
                                            <mi>x</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo separator="true">,</mo>
                                        <msub>
                                            <mi>y</mi>
                                            <mi>o</mi>
                                        </msub>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{M}(x_o, y_o) =
                                    \sum_y (\sum_x \operatorname{E}(x_o + \Delta x, y_o + \Delta y) \cdot
                                    \operatorname{S}(\Delta x)) \cdot \operatorname{S^T}(\Delta y) = \sum_y (\sum_x
                                    \operatorname{E}(x_o + \Delta x, y_o + \Delta y) \cdot \operatorname{\delta}(\Delta
                                    x)) \cdot \operatorname{\delta}(\Delta y) = \operatorname{E}(x_o, y_o)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">M</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span
                                class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                            class="vlist" style="height:1.0500050000000003em;"><span
                                                style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">y</span></span></span><span
                                                style="top:-3.050005em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span><span
                                                        class="mop op-symbol large-op">∑</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.386113em;"><span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:1.050005em;"><span
                                                style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">x</span></span></span><span
                                                style="top:-3.0500049999999996em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span><span
                                                        class="mop op-symbol large-op">∑</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.250005em;"><span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mop"><span class="mord mathrm">E</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">+</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                                class="strut"
                                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">+</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord">Δ</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">⋅</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">S</span></span><span class="mopen">(</span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mclose">))</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span
                                class="mop"><span class="mord"><span class="mord mathrm">S</span><span
                                        class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                    style="height:0.8913309999999999em;"><span
                                                        style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                            style="height:2.7em;"></span><span
                                                            class="sizing reset-size6 size3 mtight"><span
                                                                class="mord mathrm mtight">T</span></span></span></span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mord">Δ</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                class="mrel">=</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                                class="strut"
                                style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span
                                class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                            class="vlist" style="height:1.0500050000000003em;"><span
                                                style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight"
                                                        style="margin-right:0.03588em;">y</span></span></span><span
                                                style="top:-3.050005em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span><span
                                                        class="mop op-symbol large-op">∑</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.386113em;"><span></span></span></span></span></span><span
                                class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:1.050005em;"><span
                                                style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">x</span></span></span><span
                                                style="top:-3.0500049999999996em;"><span class="pstrut"
                                                    style="height:3.05em;"></span><span><span
                                                        class="mop op-symbol large-op">∑</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.250005em;"><span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mop"><span class="mord mathrm">E</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">+</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                                class="strut"
                                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">+</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord">Δ</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">⋅</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord">Δ</span><span class="mord mathnormal">x</span><span
                                class="mclose">))</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mop"><span class="mord">δ</span></span><span class="mopen">(</span><span
                                class="mord">Δ</span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                class="mrel">=</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                                class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">E</span></span><span class="mopen">(</span><span
                                class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                    class="mord mathnormal" style="margin-right:0.03588em;">y</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">o</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose">)</span></span></span></span></eq>. The default of the
            <strong>strength</strong> in the demo source code is (0.48, 0.41, 0.28).</li>
        <li>According to [dEon 2007], the width of the diffusion profile is about 16 mm. The <strong>falloff</strong>,
            which is the <strong>FalloffColor</strong> in the UE4, is to make the diffusion profile narrower, and thus
            the width of the diffusion profile in the demo source code is reduced to 6(3x2) mm (the
            <strong>RANGE</strong> in the <strong>calculateKernel</strong> in the code). The default of the
            <strong>falloff</strong> in the demo source code is (1.0, 0.37, 0.3).</li>
        <li>Actually, the demo source code demonstrates that the <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mrow>
                                                <mi mathvariant="normal">Δ</mi>
                                                <mi>x</mi>
                                            </mrow>
                                            <mrow>
                                                <mn>0.001</mn>
                                                <mo>+</mo>
                                                <mtext>falloff</mtext>
                                            </mrow>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \frac{\Delta x}{0.001 +
                                    \text{falloff}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.36033em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">0.001</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">+</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">falloff</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">Δ</span><span
                                                            class="mord mathnormal">x</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq> is passed to
            the diffusion profile <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">P</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>r</mi>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{P}(r)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">P</span></span><span class="mopen">(</span><span
                                class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                                class="mclose">)</span></span></span></span></eq> directly without the
            <strong>width</strong> in the formula. This implies the <strong>width</strong> in the formula is actually
            fixed at 1.</li>
        <li>According to the <strong>numerical quadrature</strong>, the function value sampled from the irradiance
            texture should be multiplied by the difference of the domain the <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">Δ</mi>
                                        <mo>⁡</mo>
                                        <mi>x</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta} x
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.68333em;vertical-align:0em;"></span><span class="mop"><span
                                    class="mord mathrm">Δ</span></span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">x</span></span></span></span></eq> and the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">Δ</mi>
                                        <mo>⁡</mo>
                                        <mi>y</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{\Delta} y
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                                class="mop"><span class="mord mathrm">Δ</span></span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal"
                                style="margin-right:0.03588em;">y</span></span></span></span></eq> (the
            <strong>area</strong> in the <strong>calculateKernel</strong> in the code). And the demo source code
            demonstrates that the deviations of the locations of the samples in world space (in mm) is fixed and stored
            in the <strong>w</strong> component of the <strong>kernel</strong> member of the
            <strong>SeparableSSS</strong> class. Thus, the mere purpose of the <strong>SSSSBlurPS</strong> in the shader
            code is to transform the deviations from world space to texture space. Assuming that the deviations are from
            the origin of the Y axis, the transformation can be calculated as <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mtext>TextureSpace</mtext>
                                        <mo>=</mo>
                                        <mfrac>
                                            <mrow>
                                                <mn>0.001</mn>
                                                <mo>×</mo>
                                                <mtext>WorldSpaceUnitPerMeter</mtext>
                                            </mrow>
                                            <mrow>
                                                <mi>tan</mi>
                                                <mo>⁡</mo>
                                                <mo stretchy="false">(</mo>
                                                <mtext>FOVY</mtext>
                                                <mo>×</mo>
                                                <mn>0.5</mn>
                                                <mo stretchy="false">)</mo>
                                                <mo>×</mo>
                                                <mn>2</mn>
                                            </mrow>
                                        </mfrac>
                                        <mo>×</mo>
                                        <mtext>WorldSpaceInMM</mtext>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \text{TextureSpace} = \frac{0.001
                                    \times \text{WorldSpaceUnitPerMeter}}{\tan(\text{FOVY} \times 0.5) \times 2} \times
                                    \text{WorldSpaceInMM}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord text"><span class="mord">TextureSpace</span></span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.3074399999999997em;vertical-align:-0.936em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mop">tan</span><span
                                                            class="mopen">(</span><span class="mord text"><span
                                                                class="mord">FOVY</span></span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord">0.5</span><span class="mclose">)</span><span
                                                            class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord">2</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">0.001</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">WorldSpaceUnitPerMeter</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.936em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord text"><span class="mord">WorldSpaceInMM</span></span></span></span></span>
            </eq> where the 0.001 is to transform from mm to m, the <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mn>1</mn>
                                            <mrow>
                                                <mi>tan</mi>
                                                <mo>⁡</mo>
                                                <mo stretchy="false">(</mo>
                                                <mtext>FOVY</mtext>
                                                <mo>×</mo>
                                                <mn>0.5</mn>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \frac{1}{\tan(\text{FOVY} \times
                                    0.5)}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.25744em;vertical-align:-0.936em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mop">tan</span><span
                                                            class="mopen">(</span><span class="mord text"><span
                                                                class="mord">FOVY</span></span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord">0.5</span><span
                                                            class="mclose">)</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.936em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq> is the second
            row and the second column of the projection matrix, and the 2 is to transform from NDC to texture space.
            However, since the width of the diffusion profile is fixed at 6(3x2) mm and the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mrow>
                                                <mi mathvariant="normal">Δ</mi>
                                                <mi>x</mi>
                                            </mrow>
                                            <mrow>
                                                <mn>0.001</mn>
                                                <mo>+</mo>
                                                <mtext>falloff</mtext>
                                            </mrow>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \frac{\Delta x}{0.001 +
                                    \text{falloff}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.1296600000000003em;vertical-align:-0.7693300000000001em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.36033em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">0.001</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">+</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">falloff</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">Δ</span><span
                                                            class="mord mathnormal">x</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.7693300000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq> is passed to
            the diffusion profile <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi mathvariant="normal">P</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>r</mi>
                                        <mo stretchy="false">)</mo>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \operatorname{P}(r)</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                    class="mord mathrm">P</span></span><span class="mopen">(</span><span
                                class="mord mathnormal" style="margin-right:0.02778em;">r</span><span
                                class="mclose">)</span></span></span></span></eq> directly without the <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mi>w</mi>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle w</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal"
                                style="margin-right:0.02691em;">w</span></span></span></span></eq> in the formula, the
            <strong>sssWidth</strong>, which is <strong>ScatterRadius</strong> in the UE4, is impossible to be
            considered as the <strong>width</strong> of the diffusion profile or the <strong>width</strong> in the
            formula. And since the shader code of the demo source code demonstrates that the transformation is
            calculated as <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mtext>TextureSpace</mtext>
                                        <mo>=</mo>
                                        <mfrac>
                                            <mtext>sssWidth</mtext>
                                            <mrow>
                                                <mi>tan</mi>
                                                <mo>⁡</mo>
                                                <mo stretchy="false">(</mo>
                                                <mtext>FOVY</mtext>
                                                <mo>×</mo>
                                                <mn>0.5</mn>
                                                <mo stretchy="false">)</mo>
                                                <mo>×</mo>
                                                <mn>3</mn>
                                            </mrow>
                                        </mfrac>
                                        <mo>×</mo>
                                        <mtext>WorldSpaceInMM</mtext>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \text{TextureSpace} =
                                    \frac{\text{sssWidth}}{\tan(\text{FOVY} \times 0.5) \times 3} \times
                                    \text{WorldSpaceInMM}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord text"><span class="mord">TextureSpace</span></span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.30744em;vertical-align:-0.936em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.37144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mop">tan</span><span
                                                            class="mopen">(</span><span class="mord text"><span
                                                                class="mord">FOVY</span></span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord">0.5</span><span class="mclose">)</span><span
                                                            class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord">3</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord text"><span
                                                                class="mord">sssWidth</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.936em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord text"><span class="mord">WorldSpaceInMM</span></span></span></span></span>
            </eq>, by comparing these two formulas, a hypothesis can be proposed that <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mtext>WorldSpaceUnitPerMeter</mtext>
                                        <mo>=</mo>
                                        <mfrac>
                                            <mrow>
                                                <mn>1000</mn>
                                                <mo>×</mo>
                                                <mn>2</mn>
                                                <mo>×</mo>
                                                <mtext>sssWidth</mtext>
                                            </mrow>
                                            <mn>3</mn>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \text{WorldSpaceUnitPerMeter} =
                                    \frac{1000 \times 2 \times \text{sssWidth}}{3}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                                class="mord text"><span class="mord">WorldSpaceUnitPerMeter</span></span><span
                                class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                class="mrel">=</span><span class="mspace"
                                style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                                class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.37144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">3</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1000</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord">2</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">sssWidth</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq>. The default
            of the <strong>sssWidth</strong> in the demo source code is 0.012, and thus the hypothesis implies that the
            <strong>WorldSpaceUnitPerMeter</strong> of the demo is 8. Actually, I check the vertex data of the head mesh
            in the demo, and fortunately, I find the vertex data is consistent with this result.</li>
        <li>The <strong>SSSS_STREGTH_SOURCE</strong> in the shader code has nothing to do with the
            <strong>strength</strong> in the paper at all. In the demo source code, the
            <strong>SSSS_STREGTH_SOURCE</strong> is the alpha channel of the albedo texture, and is used to skip the
            pixels which represent the eyebrow rather than the skin.</li>
    </ol>
    <h3 id="1-4-disney-sss">1-4. Disney SSS</h3>
    <p>TODO</p>
    <h2 id="2-transmittance">2. Transmittance</h2>
    <h3 id="2-1-deep-scatter">2-1. Deep Scatter</h3>
    <p>The <strong>diffuse transmittance</strong> term of the FaceWorks is based on the <strong>16.3 Simulating
            Absorption Using Depth Maps</strong> of [Green 2004].</p>
    <p>The main idea of [Green 2004] is that the objects are assumed to be convex, and thus the thickness (the distance
        a light ray travels inside an object) can be estimated by using the shadow maps. According to the thickness, the
        <a href="https://en.wikipedia.org/wiki/Beer%E2%80%93Lambert_law">Beer–Lambert law</a> can be applied to
        calculate the transmittance coefficient.</p>
    <p>In the FaceWorks, the <strong>thickness</strong> is calculated by
        <strong>GFSDK_FaceWorks_EstimateThicknessFromParallelShadowPoisson32</strong> and the <strong>transmittance
            coefficient</strong> is calculated by <strong>GFSDK_FaceWorks_EvaluateDeepScatterDirectLight</strong>.</p>
    <h3 id="2-2-realistic-skin-translucency">2-2. Realistic Skin Translucency</h3>
    <p>The <strong>diffuse transmittance</strong> term of demo source code provided by [Jimenez 2015] is based on
        [Jimenez 2010].</p>
    <p>The main idea of [Jimenez 2010] is that the approach proposed by [Green 2004] is applied to calculate the
        thickness while the transmittance coefficient is calcuated based on the diffuse profile rather than the
        <strong>Beer–Lambert law</strong>. According to [Jimenez 2010], the idea of the <strong>14.5.3 Modified
            Translucent Shadow Maps</strong> of [dEon 2007] is applied, and the transmittance coefficient is calculated
        as <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">T</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>d</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi>S</mi>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">R</mi>
                                    <mo>⁡</mo>
                                    <msqrt>
                                        <mrow>
                                            <mi mathvariant="normal">distance</mi>
                                            <mo>⁡</mo>
                                            <mo stretchy="false">(</mo>
                                            <msub>
                                                <mi>p</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo separator="true">,</mo>
                                            <mtext>B</mtext>
                                            <msup>
                                                <mo stretchy="false">)</mo>
                                                <mn>2</mn>
                                            </msup>
                                            <mo>+</mo>
                                            <msup>
                                                <mi>d</mi>
                                                <mn>2</mn>
                                            </msup>
                                        </mrow>
                                    </msqrt>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <msub>
                                        <mi>p</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{T}(d) = \int_{S_{p_i}}
                                \operatorname{R} \sqrt{\operatorname{distance}(p_i, \text{B})^2 + d^2} \, dp_i
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">T</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.5294100000000004em;vertical-align:-1.16941em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.4336190000000001em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mathnormal mtight"
                                                                style="margin-right:0.05764em;">S</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.1645428571428572em;"><span
                                                                                style="top:-2.357em;margin-left:-0.05764em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">p</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.3448em;"><span
                                                                                                                style="top:-2.3448em;margin-left:0em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3678em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.16941em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm">R</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord sqrt"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.983875em;"><span class="svg-align" style="top:-3.2em;"><span
                                                class="pstrut" style="height:3.2em;"></span><span class="mord"
                                                style="padding-left:1em;"><span class="mop"><span
                                                        class="mord mathrm">distance</span></span><span
                                                    class="mopen">(</span><span class="mord"><span
                                                        class="mord mathnormal">p</span><span class="msupsub"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                    class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                    class="mpunct">,</span><span class="mspace"
                                                    style="margin-right:0.16666666666666666em;"></span><span
                                                    class="mord text"><span class="mord">B</span></span><span
                                                    class="mclose"><span class="mclose">)</span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.740108em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                    class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mbin">+</span><span class="mspace"
                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                    class="mord"><span class="mord mathnormal">d</span><span
                                                        class="msupsub"><span class="vlist-t"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.740108em;"><span
                                                                        style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                            style="top:-2.9438750000000002em;"><span class="pstrut"
                                                style="height:3.2em;"></span><span class="hide-tail"
                                                style="min-width:1.02em;height:1.28em;"><svg width='400em'
                                                    height='1.28em' viewBox='0 0 400000 1296'
                                                    preserveAspectRatio='xMinYMin slice'>
                                                    <path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.25612499999999994em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord"><span
                                class="mord mathnormal">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> where the R is the 1D diffusion profile and the B is the point where the light is assumed to exit. If the
        diffusion profile is approximated by the Gaussians proposed by [Green 2004], the result of the integral is
        analytical and can be calculated as <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">T</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>d</mi>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mi>i</mi>
                                        <mi>k</mi>
                                    </munderover>
                                    <msub>
                                        <mi>w</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msup>
                                        <mi>e</mi>
                                        <mfrac>
                                            <mrow>
                                                <mo>−</mo>
                                                <msup>
                                                    <mi>d</mi>
                                                    <mn>2</mn>
                                                </msup>
                                            </mrow>
                                            <msub>
                                                <mi>v</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </mfrac>
                                    </msup>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{T}(d) = \sum_i^k w_i
                                e^{\frac{-d^2}{v_i}}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm">T</span></span><span class="mopen">(</span><span
                            class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.8361130000000003em;"><span
                                            style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight">i</span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathnormal mtight"
                                                    style="margin-right:0.03148em;">k</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.277669em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02691em;">w</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:1.2989300000000001em;"><span
                                                style="top:-3.50591em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:3em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mopen nulldelimiter sizing reset-size3 size6"></span><span
                                                                class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:1.1328857142857145em;"><span
                                                                                style="top:-2.656em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight"
                                                                                                style="margin-right:0.03588em;">v</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.3448em;"><span
                                                                                                                style="top:-2.3448em;margin-left:-0.03588em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.65952em;"></span><span
                                                                                                                    class="mord mathnormal mtight">i</span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.31472em;"><span></span></span></span></span></span></span></span></span></span><span
                                                                                style="top:-3.2255000000000003em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="frac-line mtight"
                                                                                    style="border-bottom-width:0.049em;"></span></span><span
                                                                                style="top:-3.384em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">−</span><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">d</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:1.04844em;"><span
                                                                                                                style="top:-3.04844em;margin-right:0.1em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.64444em;"></span><span
                                                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.5688em;"><span></span></span></span></span></span><span
                                                                class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span>
        </eq>.</p>
    <p>The <strong>transmittance coefficient</strong> is calculated by the <strong>SSSSTransmittance</strong> in the
        demo source code provided by [Jimenez 2015]. And there are some points to note.</p>
    <ol>
        <li>Actually, the mere purpose of the <strong>scale</strong> in the shader code is to transform the thickness
            from world space unit to mm. The shader code of the demo source code demonstrates that the
            <strong>scale</strong> is calculated as <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>8.25</mn>
                                        <mo>×</mo>
                                        <mo stretchy="false">(</mo>
                                        <mn>1</mn>
                                        <mo>−</mo>
                                        <mtext>translucency</mtext>
                                        <mo stretchy="false">)</mo>
                                        <mo>×</mo>
                                        <mfrac>
                                            <mn>1</mn>
                                            <mtext>sssWidth</mtext>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 8.25 \times (1 -
                                    \text{translucency}) \times \frac{1}{\text{sssWidth}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                                class="mord">8.25</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mopen">(</span><span class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord text"><span class="mord">translucency</span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord text"><span
                                                                class="mord">sssWidth</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq>. According to
            the <strong>1-3. Separable SSS</strong> of this page, the <eq><span class="katex"><span
                        class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mn>1</mn>
                                            <mtext>sssWidth</mtext>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \frac{1}{\text{sssWidth}}
                                </annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord text"><span
                                                                class="mord">sssWidth</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq> can be
            substituted as <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mrow>
                                                <mn>1000</mn>
                                                <mo>×</mo>
                                                <mn>2</mn>
                                            </mrow>
                                            <mrow>
                                                <mn>3</mn>
                                                <mo>×</mo>
                                                <mtext>WorldSpaceUnitPerMeter</mtext>
                                            </mrow>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle \frac{1000 \times 2}{3 \times
                                    \text{WorldSpaceUnitPerMeter}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">3</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord text"><span
                                                                class="mord">WorldSpaceUnitPerMeter</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1000</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">×</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord">2</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq>, and thus the
            <strong>scale</strong> is actually calculated as <eq><span class="katex"><span class="katex-mathml"><math
                            xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>8.25</mn>
                                        <mo>×</mo>
                                        <mo stretchy="false">(</mo>
                                        <mn>1</mn>
                                        <mo>−</mo>
                                        <mtext>translucency</mtext>
                                        <mo stretchy="false">)</mo>
                                        <mo>×</mo>
                                        <mfrac>
                                            <mn>2</mn>
                                            <mn>3</mn>
                                        </mfrac>
                                        <mo>×</mo>
                                        <mfrac>
                                            <mn>1000</mn>
                                            <mtext>WorldSpaceUnitPerMeter</mtext>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 8.25 \times (1 -
                                    \text{translucency}) \times \frac{2}{3} \times
                                    \frac{1000}{\text{WorldSpaceUnitPerMeter}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                                class="mord">8.25</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mopen">(</span><span class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord text"><span class="mord">translucency</span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">3</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">2</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord text"><span
                                                                class="mord">WorldSpaceUnitPerMeter</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1000</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq>. The default
            of the <strong>translucency</strong> in the demo source code is 0.83, and thus the value of <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mn>8.25</mn>
                                        <mo>×</mo>
                                        <mo stretchy="false">(</mo>
                                        <mn>1</mn>
                                        <mo>−</mo>
                                        <mtext>translucency</mtext>
                                        <mo stretchy="false">)</mo>
                                        <mo>×</mo>
                                        <mfrac>
                                            <mn>2</mn>
                                            <mn>3</mn>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle 8.25 \times (1 -
                                    \text{translucency}) \times \frac{2}{3}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                                class="mord">8.25</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mopen">(</span><span class="mord">1</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                class="mord text"><span class="mord">translucency</span></span><span
                                class="mclose">)</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                            class="base"><span class="strut"
                                style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span
                                    class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">3</span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">2</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq> is 0.935 which
            is really close to 1. This implies that the <strong>scale</strong> is actually calculated as <eq><span
                    class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                            <semantics>
                                <mrow>
                                    <mstyle scriptlevel="0" displaystyle="true">
                                        <mfrac>
                                            <mn>1000</mn>
                                            <mtext>WorldSpaceUnitPerMeter</mtext>
                                        </mfrac>
                                    </mstyle>
                                </mrow>
                                <annotation encoding="application/x-tex">\displaystyle
                                    \frac{1000}{\text{WorldSpaceUnitPerMeter}}</annotation>
                            </semantics>
                        </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                                style="height:2.20188em;vertical-align:-0.8804400000000001em;"></span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.32144em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord text"><span
                                                                class="mord">WorldSpaceUnitPerMeter</span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">1000</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.8804400000000001em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span></span></span></span></eq> which is
            exactly the transformation from world space unit to mm.</li>
    </ol>
    <h2 id="references">References</h2>
    <p>[Green 2004] <a
            href="https://developer.nvidia.com/gpugems/gpugems/part-iii-materials/chapter-16-real-time-approximations-subsurface-scattering">Simon
            Green. &quot;Chapter 16. Real-Time Approximations to Subsurface Scattering.&quot; GPU Gems 1.</a><br>
        [dEon 2007] <a
            href="https://developer.nvidia.com/gpugems/gpugems3/part-iii-rendering/chapter-14-advanced-techniques-realistic-real-time-skin">Eugene
            dEon, David Luebke. &quot;Advanced Techniques for Realistic Real-Time Skin Rendering.&quot; GPU Gem
            3.</a><br>
        [Jimenez 2009] <a href="https://www.iryoku.com/sssss/">Jorge Jimenez, Veronica Sundstedt, Diego Gutierrez.
            &quot;Screen-Space Perceptual Rendering of Human Skin.&quot; ACM TAP 2009.</a><br>
        [Jimenez 2009] Jorge Jimenez, Diego Gutierrez. &quot;Screen-Space Subsurface Scattering.&quot; GPU Pro 1.<br>
        [Jimenez 2010] <a href="http://www.iryoku.com/translucency/">Jorge Jimenez, David Whelan, Veronica Sundstedt,
            Diego Gutierrez. &quot;Real-Time Realistic Skin Translucency.&quot; IEEE 2010.</a><br>
        [Mikkelsen 2010] <a href="https://mmikk.github.io/papers3d/cbf_skin.pdf">Morten Mikkelsen. &quot;Skin Rendering
            by Pseudo–Separable Cross Bilateral Filtering.&quot; Naughty Dog.</a><br>
        [Penner 2011] Eric Penner, George Borshukov. &quot;Pre-Integrated Skin Shading.&quot; GPU Pro 2.<br>
        [Penner 2011] <a href="http://advances.realtimerendering.com/s2011/">Eric Penner. &quot;Pre-Integrated Skin
            Shading.&quot; SIGGRAPH 2011.</a><br>
        [Jimenez 2012] <a href="https://graphics.unizar.es/publications.html#year_2012">Jorge Jimenez, Adrian Jarabo,
            Diego Gutierrez. &quot;Separable Subsurface Scattering.&quot; Technical Report 2012.</a><br>
        [Jimenez 2012] <a href="http://advances.realtimerendering.com/s2012/index.html">Jorge Jimenez, Adrian Jarabo,
            Diego Gutierrez, Etienne Danvoye, Javier von der Pahlen. &quot;Separable Subsurface Scattering and
            Photorealistic Eyes Rendering.&quot; SIGGRAPH 2012.</a><br>
        [Jimenez 2015] <a href="http://www.iryoku.com/separable-sss/">Jorge Jimenez, Karoly Zsolnai, Adrian Jarabo1,
            Christian Freude, Thomas Auzinger, Xian-Chun Wu, Javier von der Pahlen, Michael Wimmer, Diego Gutierrez.
            &quot;Separable Subsurface Scattering.&quot; EGSR 2015.</a></p>

</body>

</html>