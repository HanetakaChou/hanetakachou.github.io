<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/default.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
</head>

<body class="markdown-body">
    <h1 dir="auto" id="vxgi-voxel-global-illumintaion">VXGI (Voxel Global Illumintaion)</h1>
    <h2 dir="auto" id="1-workflow">1. Workflow</h2>
    <h3 dir="auto" id="1-1-photon-mapping">1-1. Photon Mapping</h3>
    <p dir="auto">By &quot;4.3 Overview&quot; of [Jensen 2001] and &quot;16.2.2 Photon Mapping&quot; of <a
            href="https://pbr-book.org/3ed-2018/Light_Transport_III_Bidirectional_Methods/Stochastic_Progressive_Photon_Mapping#PhotonMapping">PBR
            Book V3</a>, the <strong>photon mapping</strong> is composed of two steps: <strong>photon tracing</strong>
        and <strong>rendering</strong>. During the <strong>photon tracing</strong> step, the <strong>photon
            rays</strong> are traced from the light sources, and the lighting information of the intersection positions
        of these <strong>photon rays</strong> is recorded as the photons. During the <strong>rendering</strong> step,
        the <strong>primary rays</strong> are traced from the camera and the <strong>final gather rays</strong> are
        traced from the <a
            href="http://docs.autodesk.com/MENTALRAY/2015/ENU/mental-ray-help/files/manual/node52.html"><strong>final
                gather points</strong></a>, and the lighting information of the vicinal photons of the intersection
        positions of these <strong>primary rays</strong> or <strong>final gather rays</strong> is used to approximate
        the lighting of these intersection points by <strong>density estimation</strong>.</p>
    <p dir="auto">By &quot;7.5 Photon Gathering&quot; of [Jensen 2001], &quot;38.2.2 Final Gathering&quot; of [Hachisuka
        2005] and &quot;16.2.2 Photon Mapping&quot; of <a
            href="https://pbr-book.org/3ed-2018/Light_Transport_III_Bidirectional_Methods/Stochastic_Progressive_Photon_Mapping#PhotonMapping">PBR
            Book V3</a>, the rendering step of the photon mapping is usually composed of two steps: <strong>radiance
            estimate</strong> and <strong>final gathering</strong>. During the <strong>radiance estimate</strong> step,
        the <strong>primary rays</strong> are traced from the camera, and the lighting information of the vicinal
        photons of the intersection positions of these <strong>primary rays</strong> is used to approximate the lighting
        of these intersection points by <strong>density estimation</strong>. During the <strong>final gathering</strong>
        step, from some of the intersection positions of the <strong>primary rays</strong>, which are called the <a
            href="http://docs.autodesk.com/MENTALRAY/2015/ENU/mental-ray-help/files/manual/node52.html"><strong>final
                gather points</strong></a>, the <strong>final gather rays</strong> are traced, and the lighting
        information of the vicinal photons of the intersection positions of these <strong>final gather rays</strong> is
        used to approximate the lighting of these intersection positions by <strong>density estimation</strong>.</p>
    <table dir="auto">
        <thead dir="auto">
            <tr dir="auto">
                <th style="text-align:center"><strong>Photon Tracing</strong></th>
                <th style="text-align:center"><strong>Rendering / Radiance-Estimate</strong></th>
                <th style="text-align:center"><strong>Rendering / Final Gathering</strong></th>
            </tr>
        </thead>
        <tbody dir="auto">
            <tr dir="auto">
                <td style="text-align:center"><img src="Voxel-Global-Illumintaion-Photon-Mapping-Photon-Tracing.png"
                        alt="" data-src="Voxel-Global-Illumintaion-Photon-Mapping-Photon-Tracing.png"></td>
                <td style="text-align:center"><img
                        src="Voxel-Global-Illumintaion-Photon-Mapping-Rendering-Radiance-Estimate.png" alt=""
                        data-src="Voxel-Global-Illumintaion-Photon-Mapping-Rendering-Radiance-Estimate.png"></td>
                <td style="text-align:center"><img
                        src="Voxel-Global-Illumintaion-Photon-Mapping-Rendering-Final-Gathering.png" alt=""
                        data-src="Voxel-Global-Illumintaion-Photon-Mapping-Rendering-Final-Gathering.png"></td>
            </tr>
        </tbody>
    </table>
    <h3 dir="auto" id="1-2-vxgi-voxel-global-illumintaion">1-2. VXGI (Voxel Global Illumintaion)</h3>
    <p dir="auto">By [Crassin 2011], the <strong>VXGI (Voxel Global Illumintaion)</strong> is composed of three steps:
        <strong>light injection</strong>, <strong>filtering</strong> and <strong>cone tracing</strong>. The idea of the
        VXGI is intrinsically to implement the photon mapping by storing the photons in the voxels. The <strong>light
            injection</strong> step of the VXGI is analogous to the <strong>photon tracing</strong> step of the photon
        mapping. The <strong>cone tracing</strong> of the VXGI is analogous to the <strong>rendering / final
            gathering</strong> step of the photon mapping. The <strong>filtering</strong> step of the VXGI is analogous
        to the idea of the <strong>density estimation</strong> of the photon mapping.
    </p>
    <table dir="auto">
        <thead dir="auto">
            <tr dir="auto">
                <th style="text-align:center"><strong>Light Injection</strong></th>
                <th style="text-align:center"><strong>Filtering</strong></th>
                <th style="text-align:center"><strong>Cone Tracing</strong></th>
            </tr>
        </thead>
        <tbody dir="auto">
            <tr dir="auto">
                <td style="text-align:center"><img src="Voxel-Global-Illumintaion-VXGI-Light-Injection.png" alt=""
                        data-src="Voxel-Global-Illumintaion-VXGI-Light-Injection.png"></td>
                <td style="text-align:center"><img src="Voxel-Global-Illumintaion-VXGI-Filtering.png" alt=""
                        data-src="Voxel-Global-Illumintaion-VXGI-Filtering.png"></td>
                <td style="text-align:center"><img src="Voxel-Global-Illumintaion-VXGI-Cone-Tracing.png" alt=""
                        data-src="Voxel-Global-Illumintaion-VXGI-Cone-Tracing.png"></td>
            </tr>
        </tbody>
    </table>
    <h3 dir="auto" id="2-1-light-injection">2-1. Light Injection</h3>
    <p dir="auto">As per the original version by [Crassin 2011], the voxels are stored in the <strong>SVO (Sparse Voxel
            Octree)</strong>. However, by [McLaren 2015] and [Eric 2017], the <strong>Clipmap</strong> is a better
        alternative. And actually, the <strong>Clipmap</strong> is exactly what the <a
            href="https://developer.nvidia.com/vxgi">NVIDIA VXGI</a> is based on.</p>
    <h4 dir="auto" id="2-1-1-voxelization">2-1-1. Voxelization</h4>
    <p dir="auto">By [Eric 2017], there are several approaches to inject the lighting. Some approaches treat the
        geometry and the lighting separablely. The geometry is voxelized at first, and then the <strong>RSM (Reflective
            Shadow Maps)</strong> by [Dachsbacher 2005] is used to inject the lighting later. The advantage of these
        approaches is that as long as the geometry remains the same, the voxelized data of the geometry can be reused
        even if the lighting has been changed. However, we will focus on the &quot;voxelization-based&quot; approach
        which the <a href="https://developer.nvidia.com/vxgi">NVIDIA VXGI</a> is based on. The light injection is
        performed at the same time when the geometry is voxelized. The most significant advantage of this approach is
        that the <strong>RSM</strong> is no longer required. However, the voxelized data can not be reused whenever
        either the geometry or the lighting has been changed. The
        <strong>VXGI::UpdateVoxelizationParameters::invalidatedRegions</strong> is used to invalidate the voxelized data
        when the geometry has been changed in the <a href="https://developer.nvidia.com/vxgi">NVIDIA VXGI</a>. And the
        <strong>VXGI::UpdateVoxelizationParameters::invalidatedLightFrusta</strong> is used to invalidate the voxelized
        data when the lighting has been changed in the <a href="https://developer.nvidia.com/vxgi">NVIDIA VXGI</a>.
    </p>
    <h4 dir="auto" id="2-1-2-toroidal-addressing">2-1-2. Toroidal Addressing</h4>
    <p dir="auto">TODO:<br>
        By [Panteleev 2014], the <a href="https://developer.nvidia.com/vxgi">NVIDIA VXGI</a> does use the
        <strong>Toroidal Addressing</strong> to reuse the voxelized data. However, it rarely happens that both the
        geometry and the lighting remain the same. Actually, the
        <strong>VXGI::VoxelizationParameters::persistentVoxelData</strong> is always set to <strong>false</strong> in
        the <strong>NVIDIA Unreal Engine 4 Fork</strong>. And the evolution of the rendering technique tends to get
        close to the real time solution and get rid of the cache based solution. The <strong>DXR (DirectX
            Raytracing)</strong> is the a typical example for this tendency. Thus, the <strong>Toroidal
            Addressing</strong> is not involved in the current version, but perhaps will be involved in the future
        version.
    </p>
    <h4 dir="auto" id="2-1-3-clipmap-logical-structure">2-1-3. Clipmap Logical Structure</h4>
    <p dir="auto">By [Panteleev 2014], we have the logical structure of the <strong>Clipmap</strong>. The first several
        clipmap levels have only one mipmap level, and the last clipmap level is the only one which has multiple mipmap
        levels. The voxel size increases for each (clipmap or mipmap) level. The texture size (voxel count) (of the
        zeroth mipmap level) of each clipmap level is the same. The volume of each mipmap level of the same clipmap
        level is the same.</p>
    <table dir="auto">
        <thead dir="auto">
            <tr dir="auto">
                <th style="text-align:center">N/A</th>
                <th style="text-align:center">0-0</th>
                <th style="text-align:center">1-0</th>
                <th style="text-align:center">2-0</th>
                <th style="text-align:center">2-1</th>
                <th style="text-align:center">2-2</th>
            </tr>
        </thead>
        <tbody dir="auto">
            <tr dir="auto">
                <td style="text-align:center">Figure</td>
                <td style="text-align:center"><img src="Voxel-Global-Illumintaion-Clipmap-Logical-Structure-0-0.png"
                        alt="" data-src="Voxel-Global-Illumintaion-Clipmap-Logical-Structure-0-0.png"></td>
                <td style="text-align:center"><img src="Voxel-Global-Illumintaion-Clipmap-Logical-Structure-1-0.png"
                        alt="" data-src="Voxel-Global-Illumintaion-Clipmap-Logical-Structure-1-0.png"></td>
                <td style="text-align:center"><img src="Voxel-Global-Illumintaion-Clipmap-Logical-Structure-2-0.png"
                        alt="" data-src="Voxel-Global-Illumintaion-Clipmap-Logical-Structure-2-0.png"></td>
                <td style="text-align:center"><img src="Voxel-Global-Illumintaion-Clipmap-Logical-Structure-2-1.png"
                        alt="" data-src="Voxel-Global-Illumintaion-Clipmap-Logical-Structure-2-1.png"></td>
                <td style="text-align:center"><img src="Voxel-Global-Illumintaion-Clipmap-Logical-Structure-2-2.png"
                        alt="" data-src="Voxel-Global-Illumintaion-Clipmap-Logical-Structure-2-2.png"></td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">Clipmap Level Index</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">1</td>
                <td style="text-align:center">2</td>
                <td style="text-align:center">2</td>
                <td style="text-align:center">2</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">Mipmap Level Index</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">1</td>
                <td style="text-align:center">2</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">Voxel Size</td>
                <td style="text-align:center">1</td>
                <td style="text-align:center">2</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">8</td>
                <td style="text-align:center">16</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">Texture Size (Voxel Count)</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">2</td>
                <td style="text-align:center">1</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">Volume</td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <mo stretchy="false">(</mo>
                                                <mn>1</mn>
                                                <mo>×</mo>
                                                <mn>4</mn>
                                                <msup>
                                                    <mo stretchy="false">)</mo>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <mn>64</mn>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle (1 \times 4)^3 = 64
                                        </annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                        class="mopen">(</span><span class="mord">1</span><span class="mspace"
                                        style="margin-right:0.2222222222222222em;"></span><span
                                        class="mbin">×</span><span class="mspace"
                                        style="margin-right:0.2222222222222222em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span
                                        class="mord">4</span><span class="mclose"><span class="mclose">)</span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.64444em;vertical-align:0em;"></span><span
                                        class="mord">64</span></span></span></span></eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <mo stretchy="false">(</mo>
                                                <mn>2</mn>
                                                <mo>×</mo>
                                                <mn>4</mn>
                                                <msup>
                                                    <mo stretchy="false">)</mo>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <mn>512</mn>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle (2 \times 4)^3 = 512
                                        </annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                        class="mopen">(</span><span class="mord">2</span><span class="mspace"
                                        style="margin-right:0.2222222222222222em;"></span><span
                                        class="mbin">×</span><span class="mspace"
                                        style="margin-right:0.2222222222222222em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span
                                        class="mord">4</span><span class="mclose"><span class="mclose">)</span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.64444em;vertical-align:0em;"></span><span
                                        class="mord">512</span></span></span></span></eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <mo stretchy="false">(</mo>
                                                <mn>4</mn>
                                                <mo>×</mo>
                                                <mn>4</mn>
                                                <msup>
                                                    <mo stretchy="false">)</mo>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <mn>4096</mn>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle (4 \times 4)^3 = 4096
                                        </annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                        class="mopen">(</span><span class="mord">4</span><span class="mspace"
                                        style="margin-right:0.2222222222222222em;"></span><span
                                        class="mbin">×</span><span class="mspace"
                                        style="margin-right:0.2222222222222222em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span
                                        class="mord">4</span><span class="mclose"><span class="mclose">)</span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.64444em;vertical-align:0em;"></span><span
                                        class="mord">4096</span></span></span></span></eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <mo stretchy="false">(</mo>
                                                <mn>8</mn>
                                                <mo>×</mo>
                                                <mn>2</mn>
                                                <msup>
                                                    <mo stretchy="false">)</mo>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <mn>4096</mn>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle (8 \times 2)^3 = 4096
                                        </annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                        class="mopen">(</span><span class="mord">8</span><span class="mspace"
                                        style="margin-right:0.2222222222222222em;"></span><span
                                        class="mbin">×</span><span class="mspace"
                                        style="margin-right:0.2222222222222222em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span
                                        class="mord">2</span><span class="mclose"><span class="mclose">)</span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.64444em;vertical-align:0em;"></span><span
                                        class="mord">4096</span></span></span></span></eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <mo stretchy="false">(</mo>
                                                <mn>16</mn>
                                                <mo>×</mo>
                                                <mn>1</mn>
                                                <msup>
                                                    <mo stretchy="false">)</mo>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <mn>4096</mn>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle (16 \times 1)^3 = 4096
                                        </annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                                        class="mopen">(</span><span class="mord">16</span><span class="mspace"
                                        style="margin-right:0.2222222222222222em;"></span><span
                                        class="mbin">×</span><span class="mspace"
                                        style="margin-right:0.2222222222222222em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span
                                        class="mord">1</span><span class="mclose"><span class="mclose">)</span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.64444em;vertical-align:0em;"></span><span
                                        class="mord">4096</span></span></span></span></eq>
                </td>
            </tr>
        </tbody>
    </table>
    <h4 dir="auto" id="2-1-4-clipmap-physical-structure">2-1-4. Clipmap Physical Structure</h4>
    <p dir="auto">And here is the logical structure of the clipmap used in the <strong>Global Illumination</strong>
        sample of the <a href="https://developer.nvidia.com/vxgi">NVIDIA VXGI</a>. Logical Structure: clipmap level 0-3:
        only one mipmap level; clipmap level 4: mipmap 0-5 (6 levels)</p>
    <table dir="auto">
        <thead dir="auto">
            <tr dir="auto">
                <th style="text-align:center">N/A</th>
                <th style="text-align:center">0-0</th>
                <th style="text-align:center">1-0</th>
                <th style="text-align:center">2-0</th>
                <th style="text-align:center">3-0</th>
                <th style="text-align:center">4-0</th>
                <th style="text-align:center">4-1</th>
                <th style="text-align:center">4-2</th>
                <th style="text-align:center">4-3</th>
                <th style="text-align:center">4-4</th>
                <th style="text-align:center">4-5</th>
            </tr>
        </thead>
        <tbody dir="auto">
            <tr dir="auto">
                <td style="text-align:center">Clipmap Level Index</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">1</td>
                <td style="text-align:center">2</td>
                <td style="text-align:center">3</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">4</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">Mipmap Level Index</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">1</td>
                <td style="text-align:center">2</td>
                <td style="text-align:center">3</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">5</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">Voxel Size</td>
                <td style="text-align:center">8</td>
                <td style="text-align:center">16</td>
                <td style="text-align:center">32</td>
                <td style="text-align:center">64</td>
                <td style="text-align:center">128</td>
                <td style="text-align:center">256</td>
                <td style="text-align:center">512</td>
                <td style="text-align:center">1024</td>
                <td style="text-align:center">2048</td>
                <td style="text-align:center">4096</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">Texture Size (Voxel Count)</td>
                <td style="text-align:center">128</td>
                <td style="text-align:center">128</td>
                <td style="text-align:center">128</td>
                <td style="text-align:center">128</td>
                <td style="text-align:center">128</td>
                <td style="text-align:center">64</td>
                <td style="text-align:center">32</td>
                <td style="text-align:center">16</td>
                <td style="text-align:center">8</td>
                <td style="text-align:center">4</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">Volume</td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <msup>
                                                    <mrow>
                                                        <mo stretchy="false">(</mo>
                                                        <mn>8</mn>
                                                        <mo>×</mo>
                                                        <mn>128</mn>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <msup>
                                                    <mn>2</mn>
                                                    <mn>30</mn>
                                                </msup>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle {(8 \times 128)}^3 =
                                            2^{30}</annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span
                                        class="mord"><span class="mord"><span class="mopen">(</span><span
                                                class="mord">8</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mbin">×</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mord">128</span><span class="mclose">)</span></span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.954008em;"><span
                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.8641079999999999em;vertical-align:0em;"></span><span
                                        class="mord"><span class="mord">2</span><span class="msupsub"><span
                                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mtight">30</span></span></span></span></span></span></span></span></span></span></span></span>
                    </eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <msup>
                                                    <mrow>
                                                        <mo stretchy="false">(</mo>
                                                        <mn>16</mn>
                                                        <mo>×</mo>
                                                        <mn>128</mn>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <msup>
                                                    <mn>2</mn>
                                                    <mn>33</mn>
                                                </msup>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle {(16 \times 128)}^3 =
                                            2^{33}</annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span
                                        class="mord"><span class="mord"><span class="mopen">(</span><span
                                                class="mord">16</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mbin">×</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mord">128</span><span class="mclose">)</span></span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.954008em;"><span
                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.8641079999999999em;vertical-align:0em;"></span><span
                                        class="mord"><span class="mord">2</span><span class="msupsub"><span
                                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mtight">33</span></span></span></span></span></span></span></span></span></span></span></span>
                    </eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <msup>
                                                    <mrow>
                                                        <mo stretchy="false">(</mo>
                                                        <mn>32</mn>
                                                        <mo>×</mo>
                                                        <mn>128</mn>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <msup>
                                                    <mn>2</mn>
                                                    <mn>36</mn>
                                                </msup>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle {(32 \times 128)}^3 =
                                            2^{36}</annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span
                                        class="mord"><span class="mord"><span class="mopen">(</span><span
                                                class="mord">32</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mbin">×</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mord">128</span><span class="mclose">)</span></span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.954008em;"><span
                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.8641079999999999em;vertical-align:0em;"></span><span
                                        class="mord"><span class="mord">2</span><span class="msupsub"><span
                                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mtight">36</span></span></span></span></span></span></span></span></span></span></span></span>
                    </eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <msup>
                                                    <mrow>
                                                        <mo stretchy="false">(</mo>
                                                        <mn>64</mn>
                                                        <mo>×</mo>
                                                        <mn>128</mn>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <msup>
                                                    <mn>2</mn>
                                                    <mn>39</mn>
                                                </msup>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle {(64 \times 128)}^3 =
                                            2^{39}</annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span
                                        class="mord"><span class="mord"><span class="mopen">(</span><span
                                                class="mord">64</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mbin">×</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mord">128</span><span class="mclose">)</span></span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.954008em;"><span
                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.8641079999999999em;vertical-align:0em;"></span><span
                                        class="mord"><span class="mord">2</span><span class="msupsub"><span
                                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mtight">39</span></span></span></span></span></span></span></span></span></span></span></span>
                    </eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <msup>
                                                    <mrow>
                                                        <mo stretchy="false">(</mo>
                                                        <mn>128</mn>
                                                        <mo>×</mo>
                                                        <mn>128</mn>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <msup>
                                                    <mn>2</mn>
                                                    <mn>42</mn>
                                                </msup>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle {(128 \times 128)}^3 =
                                            2^{42}</annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span
                                        class="mord"><span class="mord"><span class="mopen">(</span><span
                                                class="mord">128</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mbin">×</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mord">128</span><span class="mclose">)</span></span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.954008em;"><span
                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.8641079999999999em;vertical-align:0em;"></span><span
                                        class="mord"><span class="mord">2</span><span class="msupsub"><span
                                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mtight">42</span></span></span></span></span></span></span></span></span></span></span></span>
                    </eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <msup>
                                                    <mrow>
                                                        <mo stretchy="false">(</mo>
                                                        <mn>256</mn>
                                                        <mo>×</mo>
                                                        <mn>64</mn>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <msup>
                                                    <mn>2</mn>
                                                    <mn>42</mn>
                                                </msup>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle {(256 \times 64)}^3 =
                                            2^{42}</annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span
                                        class="mord"><span class="mord"><span class="mopen">(</span><span
                                                class="mord">256</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mbin">×</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mord">64</span><span class="mclose">)</span></span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.954008em;"><span
                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.8641079999999999em;vertical-align:0em;"></span><span
                                        class="mord"><span class="mord">2</span><span class="msupsub"><span
                                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mtight">42</span></span></span></span></span></span></span></span></span></span></span></span>
                    </eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <msup>
                                                    <mrow>
                                                        <mo stretchy="false">(</mo>
                                                        <mn>512</mn>
                                                        <mo>×</mo>
                                                        <mn>32</mn>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <msup>
                                                    <mn>2</mn>
                                                    <mn>42</mn>
                                                </msup>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle {(512 \times 32)}^3 =
                                            2^{42}</annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span
                                        class="mord"><span class="mord"><span class="mopen">(</span><span
                                                class="mord">512</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mbin">×</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mord">32</span><span class="mclose">)</span></span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.954008em;"><span
                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.8641079999999999em;vertical-align:0em;"></span><span
                                        class="mord"><span class="mord">2</span><span class="msupsub"><span
                                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mtight">42</span></span></span></span></span></span></span></span></span></span></span></span>
                    </eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <msup>
                                                    <mrow>
                                                        <mo stretchy="false">(</mo>
                                                        <mn>1024</mn>
                                                        <mo>×</mo>
                                                        <mn>16</mn>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <msup>
                                                    <mn>2</mn>
                                                    <mn>42</mn>
                                                </msup>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle {(1024 \times 16)}^3 =
                                            2^{42}</annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span
                                        class="mord"><span class="mord"><span class="mopen">(</span><span
                                                class="mord">1024</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mbin">×</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mord">16</span><span class="mclose">)</span></span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.954008em;"><span
                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.8641079999999999em;vertical-align:0em;"></span><span
                                        class="mord"><span class="mord">2</span><span class="msupsub"><span
                                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mtight">42</span></span></span></span></span></span></span></span></span></span></span></span>
                    </eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <msup>
                                                    <mrow>
                                                        <mo stretchy="false">(</mo>
                                                        <mn>2048</mn>
                                                        <mo>×</mo>
                                                        <mn>8</mn>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <msup>
                                                    <mn>2</mn>
                                                    <mn>42</mn>
                                                </msup>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle {(2048 \times 8)}^3 =
                                            2^{42}</annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span
                                        class="mord"><span class="mord"><span class="mopen">(</span><span
                                                class="mord">2048</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mbin">×</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mord">8</span><span class="mclose">)</span></span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.954008em;"><span
                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.8641079999999999em;vertical-align:0em;"></span><span
                                        class="mord"><span class="mord">2</span><span class="msupsub"><span
                                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mtight">42</span></span></span></span></span></span></span></span></span></span></span></span>
                    </eq>
                </td>
                <td style="text-align:center">
                    <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                        <mrow>
                                            <mstyle scriptlevel="0" displaystyle="true">
                                                <msup>
                                                    <mrow>
                                                        <mo stretchy="false">(</mo>
                                                        <mn>4096</mn>
                                                        <mo>×</mo>
                                                        <mn>4</mn>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mn>3</mn>
                                                </msup>
                                                <mo>=</mo>
                                                <msup>
                                                    <mn>2</mn>
                                                    <mn>42</mn>
                                                </msup>
                                            </mstyle>
                                        </mrow>
                                        <annotation encoding="application/x-tex">\displaystyle {(4096 \times 4)}^3 =
                                            2^{42}</annotation>
                                    </semantics>
                                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span
                                        class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span
                                        class="mord"><span class="mord"><span class="mopen">(</span><span
                                                class="mord">4096</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mbin">×</span><span class="mspace"
                                                style="margin-right:0.2222222222222222em;"></span><span
                                                class="mord">4</span><span class="mclose">)</span></span><span
                                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span
                                                        class="vlist" style="height:0.954008em;"><span
                                                            style="top:-3.2029em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight">3</span></span></span></span></span></span></span></span><span
                                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                                        class="mrel">=</span><span class="mspace"
                                        style="margin-right:0.2777777777777778em;"></span></span><span
                                    class="base"><span class="strut"
                                        style="height:0.8641079999999999em;vertical-align:0em;"></span><span
                                        class="mord"><span class="mord">2</span><span class="msupsub"><span
                                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.8641079999999999em;"><span
                                                            style="top:-3.113em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mtight">42</span></span></span></span></span></span></span></span></span></span></span></span>
                    </eq>
                </td>
            </tr>
        </tbody>
    </table>
    <p dir="auto">And here is the physical structure of the clipmap used in the <strong>Global Illumination</strong>
        sample of the <a href="https://developer.nvidia.com/vxgi">NVIDIA VXGI</a>. The clipmap is implemented by the
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mn>128</mn>
                                    <mo>×</mo>
                                    <mn>128</mn>
                                    <mo>×</mo>
                                    <mn>785</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle 128 \times 128 \times 785
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                            class="mord">128</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                            class="mord">128</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">785</span></span></span></span></eq> 3D texture.
    </p>
    <table dir="auto">
        <thead dir="auto">
            <tr dir="auto">
                <th style="text-align:center">3D Texture Depth Index</th>
                <th style="text-align:center">Clipmap Level Index</th>
                <th style="text-align:center">Mipmap Level Index</th>
                <th style="text-align:center">3D Texture Width/Height</th>
            </tr>
        </thead>
        <tbody dir="auto">
            <tr dir="auto">
                <td style="text-align:center">1 - 128</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">128</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">131 - 258</td>
                <td style="text-align:center">1</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">128</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">261 - 388</td>
                <td style="text-align:center">2</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">128</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">391 - 518</td>
                <td style="text-align:center">3</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">128</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">521 - 648</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">0</td>
                <td style="text-align:center">128</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">651 - 714</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">1</td>
                <td style="text-align:center">64 (64 unused)</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">717 - 748</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">2</td>
                <td style="text-align:center">32 (96 unused)</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">751 - 766</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">3</td>
                <td style="text-align:center">16 (112 unused)</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">769 - 776</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">8 (120 unused)</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">779 - 782</td>
                <td style="text-align:center">4</td>
                <td style="text-align:center">5</td>
                <td style="text-align:center">4 (124 unused)</td>
            </tr>
        </tbody>
    </table>
    <table dir="auto">
        <thead dir="auto">
            <tr dir="auto">
                <th style="text-align:center">3D Texture Depth Index</th>
                <th style="text-align:center">Equivalent 3D Texture Depth Index (Toroidal Address)</th>
            </tr>
        </thead>
        <tbody dir="auto">
            <tr dir="auto">
                <td style="text-align:center">0</td>
                <td style="text-align:center">128</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">129</td>
                <td style="text-align:center">1</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">-------</td>
                <td style="text-align:center">-------</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">130</td>
                <td style="text-align:center">258</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">259</td>
                <td style="text-align:center">131</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">-------</td>
                <td style="text-align:center">-------</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">260</td>
                <td style="text-align:center">388</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">389</td>
                <td style="text-align:center">261</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">-------</td>
                <td style="text-align:center">-------</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">390</td>
                <td style="text-align:center">518</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">519</td>
                <td style="text-align:center">391</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">-------</td>
                <td style="text-align:center">-------</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">520</td>
                <td style="text-align:center">648</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">649</td>
                <td style="text-align:center">521</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">-------</td>
                <td style="text-align:center">-------</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">650</td>
                <td style="text-align:center">714</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">715</td>
                <td style="text-align:center">651</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">-------</td>
                <td style="text-align:center">-------</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">716</td>
                <td style="text-align:center">748</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">749</td>
                <td style="text-align:center">717</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">-------</td>
                <td style="text-align:center">-------</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">750</td>
                <td style="text-align:center">766</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">767</td>
                <td style="text-align:center">751</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">-------</td>
                <td style="text-align:center">-------</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">768</td>
                <td style="text-align:center">776</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">777</td>
                <td style="text-align:center">769</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">-------</td>
                <td style="text-align:center">-------</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">778</td>
                <td style="text-align:center">782</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">783</td>
                <td style="text-align:center">779</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">-------</td>
                <td style="text-align:center">-------</td>
            </tr>
            <tr dir="auto">
                <td style="text-align:center">784</td>
                <td style="text-align:center">N/A</td>
            </tr>
        </tbody>
    </table>
    <h4 dir="auto" id="2-1-4-msaa">2-1-4. MSAA</h4>
    <p dir="auto">TODO: conservative rasterization<br>
        TODO: simulate &quot;conservative rasterization&quot; by MSAA ([Takeshige 2015])</p>
    <p dir="auto">TODO: not related to &quot;ambient occlusion&quot;</p>
    <h3 dir="auto" id="2-2-filtering">2-2. Filtering</h3>
    <p dir="auto"><img src="Voxel-Global-Illumintaion-8.png" alt="" data-src="Voxel-Global-Illumintaion-8.png"></p>
    <p dir="auto">TODO: anisotropic voxel</p>
    <h3 dir="auto" id="2-3-cone-tracing">2-3. Cone Tracing</h3>
    <h4 dir="auto" id="2-3-1-monte-carlo-method">2-3-1. Monte Carlo Method</h4>
    <p dir="auto">By <a href="https://en.wikipedia.org/wiki/Integral#Conventions">Additive Interval Property</a>, the
        ambient occlusion can be calculated as <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">k</mi>
                                            <mi mathvariant="normal">A</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo>=</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <mi mathvariant="normal">Ω</mi>
                                    </msub>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mi>π</mi>
                                    </mfrac>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                    <mrow>
                                        <mo fence="true">(</mo>
                                        <msub>
                                            <mo>∫</mo>
                                            <msub>
                                                <mi mathvariant="normal">Ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                        </msub>
                                        <mi mathvariant="normal">V</mi>
                                        <mo>⁡</mo>
                                        <mo stretchy="false">(</mo>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo stretchy="false">)</mo>
                                        <mo stretchy="false">(</mo>
                                        <mi>cos</mi>
                                        <mo>⁡</mo>
                                        <msub>
                                            <mi>θ</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <msup>
                                            <mo stretchy="false">)</mo>
                                            <mo>+</mo>
                                        </msup>
                                        <mtext> </mtext>
                                        <mi>d</mi>
                                        <mover accent="true">
                                            <msub>
                                                <mi>ω</mi>
                                                <mi>i</mi>
                                            </msub>
                                            <mo stretchy="true">→</mo>
                                        </mover>
                                        <mo fence="true">)</mo>
                                    </mrow>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{k_A} = \int_\Omega
                                \frac{1}{\pi} \operatorname{V}(\overrightarrow{\omega_i}) (\cos \theta_i)^+ \, d
                                \overrightarrow{\omega_i} = \frac{1}{\pi} \sum_{i=0}^{n} \left\lparen \int_{\Omega_i}
                                \operatorname{V}(\overrightarrow{\omega_i}) (\cos \theta_i)^+ \, d
                                \overrightarrow{\omega_i} \right\rparen</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm">k</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.32833099999999993em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">A</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.27195em;vertical-align:-0.9119499999999999em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">Ω</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">π</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.6513970000000002em;"><span
                                            style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal mtight">i</span><span
                                                        class="mrel mtight">=</span><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal mtight">n</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.277669em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span
                                class="mopen delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">(</span></span><span class="mop"><span
                                    class="mop op-symbol large-op"
                                    style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:-0.433619em;"><span
                                                    style="top:-1.7880500000000004em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight"><span
                                                                    class="mord mtight">Ω</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.01205em;"><span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mop"><span class="mord mathrm"
                                    style="margin-right:0.01389em;">V</span></span><span class="mopen">(</span><span
                                class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                            class="vlist" style="height:0.95256em;"><span style="top:-3em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                        class="vlist-t"><span class="vlist-r"><span class="vlist"
                                                style="height:0.821331em;"><span
                                                    style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                        style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                class="mord mathnormal">d</span><span class="mord accent"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord mathnormal"
                                                        style="margin-right:0.03588em;">ω</span><span
                                                        class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.31166399999999994em;"><span
                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                            class="pstrut"
                                                                            style="height:2.7em;"></span><span
                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                class="mord mathnormal mtight">i</span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="hide-tail"
                                                    style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                        height='0.522em' viewBox='0 0 400000 522'
                                                        preserveAspectRatio='xMaxYMin slice'>
                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                    </svg></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span><span
                                class="mclose delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">)</span></span></span></span></span></span></eq> where
        <strong>n</strong> is the number of cones, and <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi mathvariant="normal">Ω</mi>
                                        <mi>i</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \Omega_i</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> is the solid angle subtended by the <strong>i</strong>th cone.<br>
        <img src="Voxel-Global-Illumintaion-9.png" alt="" data-src="Voxel-Global-Illumintaion-9.png">
    </p>
    <p dir="auto">By [Crassin 2011 B], the visibility <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle
                                \operatorname{V}(\overrightarrow{\omega_i})</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.20256em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span></span></span></span></eq> is assumed to be the same for all
        directions within the same cone, and the calculation of the ambient occlusion can be simplified as <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi mathvariant="normal">Ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                    </msub>
                                    <mi mathvariant="normal">V</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>≈</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">V</mi>
                                            <mi mathvariant="normal">c</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi mathvariant="normal">Ω</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi mathvariant="normal">Ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                    </msub>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_{\Omega_i}
                                \operatorname{V}(\overrightarrow{\omega_i}) (\cos \theta_i)^+ \, d
                                \overrightarrow{\omega_i} \approx \operatorname{V_c}(\Omega_i) \cdot \int_{\Omega_i}
                                (\cos \theta_i)^+ \, d \overrightarrow{\omega_i}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.3720499999999998em;vertical-align:-1.01205em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000004em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mtight">Ω</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.01205em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span
                                class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span
                            class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.95256em;"><span
                                            style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span
                                                class="mord"><span class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mopen">(</span><span class="mop">cos</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">≈</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span
                                class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">V</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.01389em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">c</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord">Ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.3720499999999998em;vertical-align:-1.01205em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000004em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mtight">Ω</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.01205em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> where <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">V</mi>
                                            <mi mathvariant="normal">c</mi>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msub>
                                        <mi mathvariant="normal">Ω</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <mo stretchy="false">)</mo>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <mi mathvariant="normal">
                                        <msub>
                                            <mi mathvariant="normal">A</mi>
                                            <mrow>
                                                <mi mathvariant="normal">F</mi>
                                                <mi mathvariant="normal">i</mi>
                                                <mi mathvariant="normal">n</mi>
                                                <mi mathvariant="normal">a</mi>
                                                <mi mathvariant="normal">l</mi>
                                            </mrow>
                                        </msub>
                                    </mi>
                                    <mo>⁡</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \operatorname{V_c}(\Omega_i) = 1 -
                                \operatorname{A_{Final}}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord"><span
                                    class="mord mathrm" style="margin-right:0.01389em;">V</span><span
                                    class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:0.151392em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:-0.01389em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mathrm mtight">c</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord"><span class="mord">Ω</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mop"><span class="mord"><span class="mord mathrm">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.33610799999999996em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathrm mtight">Final</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
        </eq> is the inverse of the final occlusion of the cone tracing.</p>
    <p dir="auto">By &quot;5.5.1 Integrals over Projected Solid Angle&quot; of <a
            href="https://pbr-book.org/3ed-2018/Color_and_Radiometry/Working_with_Radiometric_Integrals#IntegralsoverProjectedSolidAngle">PBRT-V3</a>
        and [Heitz 2017], the integral of the clamped cosine <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mo>∫</mo>
                                        <msub>
                                            <mi mathvariant="normal">Ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                    </msub>
                                    <mo stretchy="false">(</mo>
                                    <mi>cos</mi>
                                    <mo>⁡</mo>
                                    <msub>
                                        <mi>θ</mi>
                                        <mi>i</mi>
                                    </msub>
                                    <msup>
                                        <mo stretchy="false">)</mo>
                                        <mo>+</mo>
                                    </msup>
                                    <mtext> </mtext>
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \int_{\Omega_i} (\cos \theta_i)^+ \,
                                d \overrightarrow{\omega_i}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.3720499999999998em;vertical-align:-1.01205em;"></span><span
                            class="mop"><span class="mop op-symbol large-op"
                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:-0.433619em;"><span
                                                style="top:-1.7880500000000004em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span class="mord mtight"><span
                                                                class="mord mtight">Ω</span><span class="msupsub"><span
                                                                    class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.3280857142857143em;"><span
                                                                                style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.5em;"></span><span
                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.01205em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mop">cos</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.31166399999999994em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathnormal mtight">i</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mclose"><span class="mclose">)</span><span class="msupsub"><span
                                    class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.821331em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mbin mtight">+</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.31166399999999994em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight">i</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> can be calculated as the projected area on the unit disk.<br>
        <img src="Voxel-Global-Illumintaion-10.png" alt="" data-src="Voxel-Global-Illumintaion-10.png">
    </p>
    <p dir="auto">By &quot;20.4 Mipmap Filtered Samples&quot; of [Colbert 2007], we use the mip-level <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mtext>sample_mip_level</mtext>
                                <mo>=</mo>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>max</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>0</mn>
                                    <mo separator="true">,</mo>
                                    <mi>log</mi>
                                    <mo>⁡</mo>
                                    <mo stretchy="false">(</mo>
                                    <msqrt>
                                        <mfrac>
                                            <mrow>
                                                <mi>d</mi>
                                                <mover accent="true">
                                                    <msub>
                                                        <mi>ω</mi>
                                                        <mi>S</mi>
                                                    </msub>
                                                    <mo stretchy="true">→</mo>
                                                </mover>
                                            </mrow>
                                            <mrow>
                                                <mi>d</mi>
                                                <mover accent="true">
                                                    <msub>
                                                        <mi>ω</mi>
                                                        <mi>P</mi>
                                                    </msub>
                                                    <mo stretchy="true">→</mo>
                                                </mover>
                                            </mrow>
                                        </mfrac>
                                    </msqrt>
                                    <mo stretchy="false">)</mo>
                                    <mo stretchy="false">)</mo>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\text{sample\_mip\_level} = \displaystyle \max(0,
                                \log(\sqrt{\frac{d\overrightarrow{\omega_S}}{d\overrightarrow{\omega_P}}}))</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.00444em;vertical-align:-0.31em;"></span><span class="mord text"><span
                                class="mord">sample_mip_level</span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:3.04em;vertical-align:-1.087625em;"></span><span
                            class="mop">max</span><span class="mopen">(</span><span class="mord">0</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span
                                style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span
                            class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:1.952375em;"><span class="svg-align" style="top:-5em;"><span
                                                class="pstrut" style="height:5em;"></span><span class="mord"
                                                style="padding-left:1em;"><span class="mord"><span
                                                        class="mopen nulldelimiter"></span><span class="mfrac"><span
                                                            class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                    class="vlist"
                                                                    style="height:1.6295600000000001em;"><span
                                                                        style="top:-2.15744em;"><span class="pstrut"
                                                                            style="height:3em;"></span><span
                                                                            class="mord"><span
                                                                                class="mord mathnormal">d</span><span
                                                                                class="mord accent"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.95256em;"><span
                                                                                                style="top:-3em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="mord"><span
                                                                                                        class="mord mathnormal"
                                                                                                        style="margin-right:0.03588em;">ω</span><span
                                                                                                        class="msupsub"><span
                                                                                                            class="vlist-t vlist-t2"><span
                                                                                                                class="vlist-r"><span
                                                                                                                    class="vlist"
                                                                                                                    style="height:0.32833099999999993em;"><span
                                                                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                                                            class="pstrut"
                                                                                                                            style="height:2.7em;"></span><span
                                                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                                                class="mord mathnormal mtight"
                                                                                                                                style="margin-right:0.13889em;">P</span></span></span></span><span
                                                                                                                    class="vlist-s">​</span></span><span
                                                                                                                class="vlist-r"><span
                                                                                                                    class="vlist"
                                                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                                                                class="svg-align"
                                                                                                style="top:-3.43056em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="hide-tail"
                                                                                                    style="height:0.522em;min-width:0.888em;"><svg
                                                                                                        width='400em'
                                                                                                        height='0.522em'
                                                                                                        viewBox='0 0 400000 522'
                                                                                                        preserveAspectRatio='xMaxYMin slice'>
                                                                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                                                                    </svg></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                                        style="top:-3.23em;"><span class="pstrut"
                                                                            style="height:3em;"></span><span
                                                                            class="frac-line"
                                                                            style="border-bottom-width:0.04em;"></span></span><span
                                                                        style="top:-3.677em;"><span class="pstrut"
                                                                            style="height:3em;"></span><span
                                                                            class="mord"><span
                                                                                class="mord mathnormal">d</span><span
                                                                                class="mord accent"><span
                                                                                    class="vlist-t vlist-t2"><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.95256em;"><span
                                                                                                style="top:-3em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="mord"><span
                                                                                                        class="mord mathnormal"
                                                                                                        style="margin-right:0.03588em;">ω</span><span
                                                                                                        class="msupsub"><span
                                                                                                            class="vlist-t vlist-t2"><span
                                                                                                                class="vlist-r"><span
                                                                                                                    class="vlist"
                                                                                                                    style="height:0.32833099999999993em;"><span
                                                                                                                        style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                                                            class="pstrut"
                                                                                                                            style="height:2.7em;"></span><span
                                                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                                                class="mord mathnormal mtight"
                                                                                                                                style="margin-right:0.05764em;">S</span></span></span></span><span
                                                                                                                    class="vlist-s">​</span></span><span
                                                                                                                class="vlist-r"><span
                                                                                                                    class="vlist"
                                                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                                                                                class="svg-align"
                                                                                                style="top:-3.43056em;"><span
                                                                                                    class="pstrut"
                                                                                                    style="height:3em;"></span><span
                                                                                                    class="hide-tail"
                                                                                                    style="height:0.522em;min-width:0.888em;"><svg
                                                                                                        width='400em'
                                                                                                        height='0.522em'
                                                                                                        viewBox='0 0 400000 522'
                                                                                                        preserveAspectRatio='xMaxYMin slice'>
                                                                                                        <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                                                                    </svg></span></span></span><span
                                                                                            class="vlist-s">​</span></span><span
                                                                                        class="vlist-r"><span
                                                                                            class="vlist"
                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.99256em;"><span></span></span></span></span></span><span
                                                        class="mclose nulldelimiter"></span></span></span></span><span
                                            style="top:-3.912375em;"><span class="pstrut"
                                                style="height:5em;"></span><span class="hide-tail"
                                                style="min-width:1.02em;height:3.08em;"><svg width='400em'
                                                    height='3.08em' viewBox='0 0 400000 3240'
                                                    preserveAspectRatio='xMinYMin slice'>
                                                    <path d='M473,2793
c339.3,-1799.3,509.3,-2700,510,-2702 l0 -0
c3.3,-7.3,9.3,-11,18,-11 H400000v40H1017.7
s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200
c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26
s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,
606zM1001 80h400000v40H1017.7z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:1.087625em;"><span></span></span></span></span></span><span
                            class="mclose">))</span></span></span></span></eq> to sample the filtered L value from the
        distant radiance distribution to reduce the variance. The <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>S</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\overrightarrow{\omega_S}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.05764em;">S</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> is the solid angle subtended by the sample, and we have <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>S</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mtext>N</mtext>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mtext>PDF</mtext>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\overrightarrow{\omega_S} =
                                \frac{1}{\text{N}} \cdot \frac{1}{\text{PDF}}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.05764em;">S</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord text"><span
                                                            class="mord">N</span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord text"><span
                                                            class="mord">PDF</span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.686em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>. The <eq><span
                class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>P</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\overrightarrow{\omega_P}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.13889em;">P</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> is the solid angle subtended by a single texel of the zeroth mip-level of the texture, and by
        &quot;Projection from Cube Maps&quot; of [Sloan 2008], we have <eq><span class="katex"><span
                    class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>P</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                    <mo>=</mo>
                                    <mfrac>
                                        <mn>1</mn>
                                        <mrow>
                                            <mtext>cubesize_u</mtext>
                                            <mo>⋅</mo>
                                            <mtext>cubesize_v</mtext>
                                        </mrow>
                                    </mfrac>
                                    <mo>⋅</mo>
                                    <mfrac>
                                        <mn>4</mn>
                                        <mrow>
                                            <msqrt>
                                                <mrow>
                                                    <msup>
                                                        <mn>1</mn>
                                                        <mn>2</mn>
                                                    </msup>
                                                    <mo>+</mo>
                                                    <msup>
                                                        <mi>u</mi>
                                                        <mn>2</mn>
                                                    </msup>
                                                    <mo>+</mo>
                                                    <msup>
                                                        <mi>v</mi>
                                                        <mn>2</mn>
                                                    </msup>
                                                </mrow>
                                            </msqrt>
                                            <mo>⋅</mo>
                                            <mo stretchy="false">(</mo>
                                            <msup>
                                                <mn>1</mn>
                                                <mn>2</mn>
                                            </msup>
                                            <mo>+</mo>
                                            <msup>
                                                <mi>u</mi>
                                                <mn>2</mn>
                                            </msup>
                                            <mo>+</mo>
                                            <msup>
                                                <mi>v</mi>
                                                <mn>2</mn>
                                            </msup>
                                            <mo stretchy="false">)</mo>
                                        </mrow>
                                    </mfrac>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\overrightarrow{\omega_P} =
                                \frac{1}{\text{cubesize\_u} \cdot \text{cubesize\_v}} \cdot \frac{4}{\sqrt{1^2 + u^2
                                +v^2} \cdot (1^2 + u^2 +v^2)}</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.13889em;">P</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:2.31744em;vertical-align:-0.996em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord text"><span
                                                            class="mord">cubesize_u</span></span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord text"><span
                                                            class="mord">cubesize_v</span></span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">1</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.996em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.374829em;vertical-align:-1.0533890000000001em;"></span><span
                            class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:1.32144em;"><span style="top:-2.196611em;"><span
                                                    class="pstrut" style="height:3em;"></span><span class="mord"><span
                                                        class="mord sqrt"><span class="vlist-t vlist-t2"><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.913389em;"><span class="svg-align"
                                                                        style="top:-3em;"><span class="pstrut"
                                                                            style="height:3em;"></span><span
                                                                            class="mord"
                                                                            style="padding-left:0.833em;"><span
                                                                                class="mord"><span
                                                                                    class="mord">1</span><span
                                                                                    class="msupsub"><span
                                                                                        class="vlist-t"><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.740108em;"><span
                                                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                                                        class="pstrut"
                                                                                                        style="height:2.7em;"></span><span
                                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                                            class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                                                class="mspace"
                                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                                class="mbin">+</span><span
                                                                                class="mspace"
                                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                                class="mord"><span
                                                                                    class="mord mathnormal">u</span><span
                                                                                    class="msupsub"><span
                                                                                        class="vlist-t"><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.740108em;"><span
                                                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                                                        class="pstrut"
                                                                                                        style="height:2.7em;"></span><span
                                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                                            class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                                                class="mspace"
                                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                                class="mbin">+</span><span
                                                                                class="mspace"
                                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                                class="mord"><span
                                                                                    class="mord mathnormal"
                                                                                    style="margin-right:0.03588em;">v</span><span
                                                                                    class="msupsub"><span
                                                                                        class="vlist-t"><span
                                                                                            class="vlist-r"><span
                                                                                                class="vlist"
                                                                                                style="height:0.740108em;"><span
                                                                                                    style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                                                        class="pstrut"
                                                                                                        style="height:2.7em;"></span><span
                                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                                            class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                                                        style="top:-2.873389em;"><span class="pstrut"
                                                                            style="height:3em;"></span><span
                                                                            class="hide-tail"
                                                                            style="min-width:0.853em;height:1.08em;"><svg
                                                                                width='400em' height='1.08em'
                                                                                viewBox='0 0 400000 1080'
                                                                                preserveAspectRatio='xMinYMin slice'>
                                                                                <path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z' />
                                                                            </svg></span></span></span><span
                                                                    class="vlist-s">​</span></span><span
                                                                class="vlist-r"><span class="vlist"
                                                                    style="height:0.12661100000000003em;"><span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">⋅</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mopen">(</span><span class="mord"><span
                                                            class="mord">1</span><span class="msupsub"><span
                                                                class="vlist-t"><span class="vlist-r"><span
                                                                        class="vlist" style="height:0.740108em;"><span
                                                                            style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">+</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord"><span class="mord mathnormal">u</span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.740108em;"><span
                                                                            style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                        class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mbin">+</span><span class="mspace"
                                                        style="margin-right:0.2222222222222222em;"></span><span
                                                        class="mord"><span class="mord mathnormal"
                                                            style="margin-right:0.03588em;">v</span><span
                                                            class="msupsub"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.740108em;"><span
                                                                            style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                                class="pstrut"
                                                                                style="height:2.7em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                        class="mclose">)</span></span></span><span
                                                style="top:-3.23em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="frac-line"
                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                style="top:-3.677em;"><span class="pstrut"
                                                    style="height:3em;"></span><span class="mord"><span
                                                        class="mord">4</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:1.0533890000000001em;"><span></span></span></span></span></span><span
                                class="mclose nulldelimiter"></span></span></span></span></span></eq>.</p>
    <p dir="auto">The <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>S</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\overrightarrow{\omega_S}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.05764em;">S</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> is calculated by <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/ReflectionEnvironmentShaders.usf#L414">SolidAngleSample</a>
        in UE4 and <a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.core/ShaderLibrary/ImageBasedLighting.hlsl#L500">omegaS</a>
        in Unity3D. And the <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <mi>d</mi>
                                    <mover accent="true">
                                        <msub>
                                            <mi>ω</mi>
                                            <mi>P</mi>
                                        </msub>
                                        <mo stretchy="true">→</mo>
                                    </mover>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle d\overrightarrow{\omega_P}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.10256em;vertical-align:-0.15em;"></span><span
                            class="mord mathnormal">d</span><span class="mord accent"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.95256em;"><span style="top:-3em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="mord"><span
                                                    class="mord mathnormal"
                                                    style="margin-right:0.03588em;">ω</span><span class="msupsub"><span
                                                        class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                                class="vlist"
                                                                style="height:0.32833099999999993em;"><span
                                                                    style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                        class="pstrut"
                                                                        style="height:2.7em;"></span><span
                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                            class="mord mathnormal mtight"
                                                                            style="margin-right:0.13889em;">P</span></span></span></span><span
                                                                class="vlist-s">​</span></span><span
                                                            class="vlist-r"><span class="vlist"
                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span><span
                                            class="svg-align" style="top:-3.43056em;"><span class="pstrut"
                                                style="height:3em;"></span><span class="hide-tail"
                                                style="height:0.522em;min-width:0.888em;"><svg width='400em'
                                                    height='0.522em' viewBox='0 0 400000 522'
                                                    preserveAspectRatio='xMaxYMin slice'>
                                                    <path d='M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z' />
                                                </svg></span></span></span><span class="vlist-s">​</span></span><span
                                    class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span>
        </eq> is calculated by <a
            href="https://github.com/EpicGames/UnrealEngine/blob/4.27/Engine/Shaders/Private/ReflectionEnvironmentShaders.usf#L355">SolidAngleTexel</a>
        in UE4 and <a
            href="https://github.com/Unity-Technologies/Graphics/blob/v10.8.0/com.unity.render-pipelines.core/ShaderLibrary/ImageBasedLighting.hlsl#L506">invOmegaP</a>
        in Unity3D.</p>
    <p dir="auto"><img src="Voxel-Global-Illumintaion-Mipmap.png" alt=""
            data-src="Voxel-Global-Illumintaion-Mipmap.png"></p>
    <h4 dir="auto" id="2-3-2-under-operator">2-3-2. Under Operator</h4>
    <p dir="auto">By [Crassin 2011 B], the <strong>under operator</strong> is used to calculated the final color <eq>
            <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi mathvariant="normal">C</mi>
                                        <mrow>
                                            <mi mathvariant="normal">F</mi>
                                            <mi mathvariant="normal">i</mi>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">a</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </mrow>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \mathrm{C}_\mathrm{Final}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathrm">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathrm mtight">Final</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq> and the final occlusion <eq><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msub>
                                        <mi mathvariant="normal">A</mi>
                                        <mrow>
                                            <mi mathvariant="normal">F</mi>
                                            <mi mathvariant="normal">i</mi>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">a</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </mrow>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \mathrm{A}_\mathrm{Final}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span
                                class="mord mathrm">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathrm mtight">Final</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>.</p>
    <p dir="auto">By [Dunn 2014], we have the recursive form of the <strong>under operator</strong>.<br>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msubsup>
                                        <mi mathvariant="normal">C</mi>
                                        <mrow>
                                            <mi mathvariant="normal">F</mi>
                                            <mi mathvariant="normal">i</mi>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">a</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </mrow>
                                        <mn>0</mn>
                                    </msubsup>
                                    <mo>=</mo>
                                    <mn>0</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \mathrm{C}_\mathrm{Final}^{0} = 0
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord"><span
                                class="mord mathrm">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span
                                                style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathrm mtight">Final</span></span></span></span><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">0</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.247em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">0</span></span></span></span></eq><br>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msubsup>
                                        <mi mathvariant="normal">A</mi>
                                        <mrow>
                                            <mi mathvariant="normal">F</mi>
                                            <mi mathvariant="normal">i</mi>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">a</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </mrow>
                                        <mn>0</mn>
                                    </msubsup>
                                    <mo>=</mo>
                                    <mn>0</mn>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \mathrm{A}_\mathrm{Final}^{0} = 0
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.1111079999999998em;vertical-align:-0.247em;"></span><span class="mord"><span
                                class="mord mathrm">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                        class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span
                                                style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathrm mtight">Final</span></span></span></span><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">0</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.247em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.64444em;vertical-align:0em;"></span><span
                            class="mord">0</span></span></span></span></eq><br>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msubsup>
                                        <mi mathvariant="normal">C</mi>
                                        <mrow>
                                            <mi mathvariant="normal">F</mi>
                                            <mi mathvariant="normal">i</mi>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">a</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </mrow>
                                        <mrow>
                                            <mi>n</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msubsup>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mi mathvariant="normal">C</mi>
                                        <mrow>
                                            <mi mathvariant="normal">F</mi>
                                            <mi mathvariant="normal">i</mi>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">a</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </mrow>
                                        <mi>n</mi>
                                    </msubsup>
                                    <mo>+</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msubsup>
                                        <mi mathvariant="normal">A</mi>
                                        <mrow>
                                            <mi mathvariant="normal">F</mi>
                                            <mi mathvariant="normal">i</mi>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">a</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </mrow>
                                        <mi>n</mi>
                                    </msubsup>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <msub>
                                        <mi mathvariant="normal">C</mi>
                                        <mi>n</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \mathrm{C}_\mathrm{Final}^{n + 1} =
                                \mathrm{C}_\mathrm{Final}^{n} + (1 - \mathrm{A}_\mathrm{Final}^{n}) \cdot \mathrm{C}_{n}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.1555469999999999em;vertical-align:-0.2914389999999999em;"></span><span
                            class="mord"><span class="mord mathrm">C</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.8641079999999999em;"><span
                                                style="top:-2.408561em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathrm mtight">Final</span></span></span></span><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">n</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.2914389999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.9613919999999999em;vertical-align:-0.247em;"></span><span
                            class="mord"><span class="mord mathrm">C</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.7143919999999999em;"><span
                                                style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathrm mtight">Final</span></span></span></span><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.247em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathrm">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.7143919999999999em;"><span
                                                style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathrm mtight">Final</span></span></span></span><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.247em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathrm">C</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq><br>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msubsup>
                                        <mi mathvariant="normal">A</mi>
                                        <mrow>
                                            <mi mathvariant="normal">F</mi>
                                            <mi mathvariant="normal">i</mi>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">a</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </mrow>
                                        <mrow>
                                            <mi>n</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msubsup>
                                    <mo>=</mo>
                                    <msubsup>
                                        <mi mathvariant="normal">A</mi>
                                        <mrow>
                                            <mi mathvariant="normal">F</mi>
                                            <mi mathvariant="normal">i</mi>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">a</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </mrow>
                                        <mi>n</mi>
                                    </msubsup>
                                    <mo>+</mo>
                                    <mo stretchy="false">(</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <msubsup>
                                        <mi mathvariant="normal">A</mi>
                                        <mrow>
                                            <mi mathvariant="normal">F</mi>
                                            <mi mathvariant="normal">i</mi>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">a</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </mrow>
                                        <mi>n</mi>
                                    </msubsup>
                                    <mo stretchy="false">)</mo>
                                    <mo>⋅</mo>
                                    <msub>
                                        <mi mathvariant="normal">A</mi>
                                        <mi>n</mi>
                                    </msub>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \mathrm{A}_\mathrm{Final}^{n + 1} =
                                \mathrm{A}_\mathrm{Final}^{n} + (1 - \mathrm{A}_\mathrm{Final}^{n}) \cdot \mathrm{A}_{n}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.1555469999999999em;vertical-align:-0.2914389999999999em;"></span><span
                            class="mord"><span class="mord mathrm">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.8641079999999999em;"><span
                                                style="top:-2.408561em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathrm mtight">Final</span></span></span></span><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">n</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.2914389999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.9613919999999999em;vertical-align:-0.247em;"></span><span
                            class="mord"><span class="mord mathrm">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.7143919999999999em;"><span
                                                style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathrm mtight">Final</span></span></span></span><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.247em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">+</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mopen">(</span><span class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord"><span class="mord mathrm">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.7143919999999999em;"><span
                                                style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathrm mtight">Final</span></span></span></span><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.247em;"><span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span
                            class="mord"><span class="mord mathrm">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.151392em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">n</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
        </eq>
    </p>
    <p dir="auto">Actually, the explicit form of the <strong>under operator</strong> can be proved by mathematical
        induction.<br>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msubsup>
                                        <mi mathvariant="normal">A</mi>
                                        <mrow>
                                            <mi mathvariant="normal">F</mi>
                                            <mi mathvariant="normal">i</mi>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">a</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </mrow>
                                        <mrow>
                                            <mi>n</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msubsup>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                    <mo>−</mo>
                                    <munderover>
                                        <mo>∏</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                    <mrow>
                                        <mo fence="true">(</mo>
                                        <mn>1</mn>
                                        <mo>−</mo>
                                        <msub>
                                            <mi mathvariant="normal">A</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo fence="true">)</mo>
                                    </mrow>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \mathrm{A}_\mathrm{Final}^{n + 1} = 1
                                - \prod_{i = 0}^{n} \left\lparen 1 - \mathrm{A}_{i} \right\rparen</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.1555469999999999em;vertical-align:-0.2914389999999999em;"></span><span
                            class="mord"><span class="mord mathrm">A</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.8641079999999999em;"><span
                                                style="top:-2.408561em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathrm mtight">Final</span></span></span></span><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">n</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.2914389999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span
                            class="mord">1</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.929066em;vertical-align:-1.277669em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.6513970000000002em;"><span
                                            style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal mtight">i</span><span
                                                        class="mrel mtight">=</span><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∏</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal mtight">n</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.277669em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span
                                class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">−</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                                    class="mord mathrm">A</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></eq>
        <br>
        <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mstyle scriptlevel="0" displaystyle="true">
                                    <msubsup>
                                        <mi mathvariant="normal">C</mi>
                                        <mrow>
                                            <mi mathvariant="normal">F</mi>
                                            <mi mathvariant="normal">i</mi>
                                            <mi mathvariant="normal">n</mi>
                                            <mi mathvariant="normal">a</mi>
                                            <mi mathvariant="normal">l</mi>
                                        </mrow>
                                        <mrow>
                                            <mi>n</mi>
                                            <mo>+</mo>
                                            <mn>1</mn>
                                        </mrow>
                                    </msubsup>
                                    <mo>=</mo>
                                    <munderover>
                                        <mo>∑</mo>
                                        <mrow>
                                            <mi>i</mi>
                                            <mo>=</mo>
                                            <mn>0</mn>
                                        </mrow>
                                        <mi>n</mi>
                                    </munderover>
                                    <mrow>
                                        <mo fence="true">(</mo>
                                        <mrow>
                                            <mo fence="true">(</mo>
                                            <munder>
                                                <mo>∏</mo>
                                                <mrow>
                                                    <msub>
                                                        <mi mathvariant="normal">Z</mi>
                                                        <mi>j</mi>
                                                    </msub>
                                                    <mi mathvariant="normal">Nearer</mi>
                                                    <mo>⁡</mo>
                                                    <msub>
                                                        <mi mathvariant="normal">Z</mi>
                                                        <mi>i</mi>
                                                    </msub>
                                                </mrow>
                                            </munder>
                                            <mrow>
                                                <mo fence="true">(</mo>
                                                <mn>1</mn>
                                                <mo>−</mo>
                                                <msub>
                                                    <mi mathvariant="normal">A</mi>
                                                    <mi>j</mi>
                                                </msub>
                                                <mo fence="true">)</mo>
                                            </mrow>
                                            <mo fence="true">)</mo>
                                        </mrow>
                                        <mo>⋅</mo>
                                        <msub>
                                            <mi mathvariant="normal">C</mi>
                                            <mi>i</mi>
                                        </msub>
                                        <mo fence="true">)</mo>
                                    </mrow>
                                </mstyle>
                            </mrow>
                            <annotation encoding="application/x-tex">\displaystyle \mathrm{C}_\mathrm{Final}^{n + 1} =
                                \sum_{i = 0}^{n} \left\lparen \left\lparen \prod_{\mathrm{Z}_{j} \operatorname{Nearer}
                                \mathrm{Z}_{i}} \left\lparen 1 - \mathrm{A}_{j} \right\rparen \right\rparen \cdot
                                \mathrm{C}_{i} \right\rparen</annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.1555469999999999em;vertical-align:-0.2914389999999999em;"></span><span
                            class="mord"><span class="mord mathrm">C</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.8641079999999999em;"><span
                                                style="top:-2.408561em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathrm mtight">Final</span></span></span></span><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathnormal mtight">n</span><span
                                                            class="mbin mtight">+</span><span
                                                            class="mord mtight">1</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.2914389999999999em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">=</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span
                            class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                        class="vlist" style="height:1.6513970000000002em;"><span
                                            style="top:-1.872331em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal mtight">i</span><span
                                                        class="mrel mtight">=</span><span
                                                        class="mord mtight">0</span></span></span></span><span
                                            style="top:-3.050005em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span><span
                                                    class="mop op-symbol large-op">∑</span></span></span><span
                                            style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut"
                                                style="height:3.05em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathnormal mtight">n</span></span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:1.277669em;"><span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span
                                class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist" style="height:2.05002em;"><span
                                                    style="top:-2.2500000000000004em;"><span class="pstrut"
                                                        style="height:3.1550000000000002em;"></span><span
                                                        class="delimsizinginner delim-size4"><span>⎝</span></span></span><span
                                                    style="top:-3.3970000000000002em;"><span class="pstrut"
                                                        style="height:3.1550000000000002em;"></span><span
                                                        style="height:0.016em;width:0.875em;"><svg width='0.875em'
                                                            height='0.016em' style='width:0.875em' viewBox='0 0 875 16'
                                                            preserveAspectRatio='xMinYMin'>
                                                            <path d='M291 0 H417 V16 H291z M291 0 H417 V16 H291z' />
                                                        </svg></span></span><span style="top:-4.05002em;"><span
                                                        class="pstrut" style="height:3.1550000000000002em;"></span><span
                                                        class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.55002em;"><span></span></span></span></span></span></span><span
                                class="minner"><span class="mopen"><span class="delimsizing mult"><span
                                            class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                    style="height:2.05002em;"><span
                                                        style="top:-2.2500000000000004em;"><span class="pstrut"
                                                            style="height:3.1550000000000002em;"></span><span
                                                            class="delimsizinginner delim-size4"><span>⎝</span></span></span><span
                                                        style="top:-3.3970000000000002em;"><span class="pstrut"
                                                            style="height:3.1550000000000002em;"></span><span
                                                            style="height:0.016em;width:0.875em;"><svg width='0.875em'
                                                                height='0.016em' style='width:0.875em'
                                                                viewBox='0 0 875 16' preserveAspectRatio='xMinYMin'>
                                                                <path d='M291 0 H417 V16 H291z M291 0 H417 V16 H291z' />
                                                            </svg></span></span><span style="top:-4.05002em;"><span
                                                            class="pstrut"
                                                            style="height:3.1550000000000002em;"></span><span
                                                            class="delimsizinginner delim-size4"><span>⎛</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:1.55002em;"><span></span></span></span></span></span></span><span
                                    class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.050005em;"><span
                                                    style="top:-1.8556639999999998em;margin-left:0em;"><span
                                                        class="pstrut" style="height:3.05em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span class="mord mtight"><span
                                                                    class="mord mathrm mtight">Z</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight"
                                                                                                style="margin-right:0.05724em;">j</span></span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.2818857142857143em;"><span></span></span></span></span></span></span><span
                                                                class="mspace mtight"
                                                                style="margin-right:0.19516666666666668em;"></span><span
                                                                class="mop mtight"><span
                                                                    class="mord mathrm mtight">Nearer</span></span><span
                                                                class="mspace mtight"
                                                                style="margin-right:0.19516666666666668em;"></span><span
                                                                class="mord mtight"><span
                                                                    class="mord mathrm mtight">Z</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.3280857142857143em;"><span
                                                                                    style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.5em;"></span><span
                                                                                        class="sizing reset-size3 size1 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathnormal mtight">i</span></span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span
                                                    style="top:-3.0500049999999996em;"><span class="pstrut"
                                                        style="height:3.05em;"></span><span><span
                                                            class="mop op-symbol large-op">∏</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.491656em;"><span></span></span></span></span></span><span
                                    class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                                    class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span
                                        class="mord">1</span><span class="mspace"
                                        style="margin-right:0.2222222222222222em;"></span><span
                                        class="mbin">−</span><span class="mspace"
                                        style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                                            class="mord mathrm">A</span><span class="msupsub"><span
                                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                        style="height:0.311664em;"><span
                                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                class="pstrut" style="height:2.7em;"></span><span
                                                                class="sizing reset-size6 size3 mtight"><span
                                                                    class="mord mtight"><span
                                                                        class="mord mathnormal mtight"
                                                                        style="margin-right:0.05724em;">j</span></span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:0.286108em;"><span></span></span></span></span></span></span><span
                                        class="mclose delimcenter" style="top:0em;">)</span></span><span
                                    class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span
                                                class="vlist-r"><span class="vlist" style="height:2.05002em;"><span
                                                        style="top:-2.2500000000000004em;"><span class="pstrut"
                                                            style="height:3.1550000000000002em;"></span><span
                                                            class="delimsizinginner delim-size4"><span>⎠</span></span></span><span
                                                        style="top:-3.3970000000000002em;"><span class="pstrut"
                                                            style="height:3.1550000000000002em;"></span><span
                                                            style="height:0.016em;width:0.875em;"><svg width='0.875em'
                                                                height='0.016em' style='width:0.875em'
                                                                viewBox='0 0 875 16' preserveAspectRatio='xMinYMin'>
                                                                <path d='M457 0 H583 V16 H457z M457 0 H583 V16 H457z' />
                                                            </svg></span></span><span style="top:-4.05002em;"><span
                                                            class="pstrut"
                                                            style="height:3.1550000000000002em;"></span><span
                                                            class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:1.55002em;"><span></span></span></span></span></span></span></span><span
                                class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                                class="mbin">⋅</span><span class="mspace"
                                style="margin-right:0.2222222222222222em;"></span><span class="mord"><span
                                    class="mord mathrm">C</span><span class="msupsub"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:0.31166399999999994em;"><span
                                                    style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                        class="pstrut" style="height:2.7em;"></span><span
                                                        class="sizing reset-size6 size3 mtight"><span
                                                            class="mord mtight"><span
                                                                class="mord mathnormal mtight">i</span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.15em;"><span></span></span></span></span></span></span><span
                                class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist" style="height:2.05002em;"><span
                                                    style="top:-2.2500000000000004em;"><span class="pstrut"
                                                        style="height:3.1550000000000002em;"></span><span
                                                        class="delimsizinginner delim-size4"><span>⎠</span></span></span><span
                                                    style="top:-3.3970000000000002em;"><span class="pstrut"
                                                        style="height:3.1550000000000002em;"></span><span
                                                        style="height:0.016em;width:0.875em;"><svg width='0.875em'
                                                            height='0.016em' style='width:0.875em' viewBox='0 0 875 16'
                                                            preserveAspectRatio='xMinYMin'>
                                                            <path d='M457 0 H583 V16 H457z M457 0 H583 V16 H457z' />
                                                        </svg></span></span><span style="top:-4.05002em;"><span
                                                        class="pstrut" style="height:3.1550000000000002em;"></span><span
                                                        class="delimsizinginner delim-size4"><span>⎞</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span>
        </eq>
    </p>
    <p dir="auto"><img src="Voxel-Global-Illumintaion-12.png" alt="" data-src="Voxel-Global-Illumintaion-12.png"></p>
    <p dir="auto">Evidently, by [McLaren 2015], the cone tracing may NOT dectect the full occlusion which is the result
        of mutiple partial occlusions.<br>
        <img src="Voxel-Global-Illumintaion-13.png" alt="" data-src="Voxel-Global-Illumintaion-13.png">
    </p>
    <h4 dir="auto" id="2-3-3-self-intersection">2-3-3. Self Intersection</h4>
    <p dir="auto">TODO</p>
    <p dir="auto"><strong>AdjustConePosition</strong></p>
    <p dir="auto">By [Wachter 2019], &quot;3.9.5 Robust Spawned Ray Origins&quot; of <a
            href="https://pbr-book.org/3ed-2018/Shapes/Managing_Rounding_Error#RobustSpawnedRayOrigins">PBR Book V3</a>
        and &quot;6.8.6 Robust Spawned Ray Origins&quot; of <a
            href="https://pbr-book.org/4ed/Shapes/Managing_Rounding_Error#RobustSpawnedRayOrigins">PBR Book V4</a>, we
        should offset the ray origin to avoid self intersection.</p>
    <h2 dir="auto" id="references">References</h2>
    <p dir="auto">[Jensen 2001] <a href="http://www.graphics.stanford.edu/papers/jensen_book/">Henrik Jensen.
            &quot;Realistic Image Synthesis Using Photon Mapping.&quot; AK Peters 2001.</a><br>
        [Hachisuka 2005] <a
            href="https://developer.nvidia.com/gpugems/gpugems2/part-v-image-oriented-computing/chapter-38-high-quality-global-illumination">Toshiya
            Hachisuka. &quot;High-Quality Global Illumination Rendering Using Rasterization.&quot; GPU Gems 2.</a><br>
        [Dachsbacher 2005] <a href="https://cg.ivd.kit.edu/english/publikationen.php">Carsten Dachsbacher, Marc
            Stamminger. &quot;Reflective Shadow Maps.&quot; I3D 2005.</a><br>
        [Crassin 2011] <a
            href="https://research.nvidia.com/publication/interactive-indirect-illumination-using-voxel-cone-tracing">Cyril
            Crassin, Fabrice Neyret, Miguel Sainz, Simon Green, Elmar Eisemann. &quot;Interactive Indirect Illumination
            Using Voxel Cone Tracing.&quot; SIGGRAPH 2011.</a><br>
        [Dunn 2014] <a href="https://developer.nvidia.com/content/transparency-or-translucency-rendering">Alex Dunn.
            &quot;Transparency (or Translucency) Rendering.&quot; NVIDIA GameWorks Blog 2014.</a><br>
        [Panteleev 2014] <a
            href="https://on-demand.gputechconf.com/gtc/2014/presentations/S4552-rt-voxel-based-global-illumination-gpus.pdf">Alexey
            Panteleev. &quot;Practical Real-Time Voxel-Based Global Illumination for Current GPUs.&quot; GTC
            2014.</a><br>
        [McLaren 2015] <a href="http://fumufumu.q-games.com/archives/TheTechnologyOfTomorrowsChildrenFinal.pdf">James
            McLaren. &quot;The Technology of The Tomorrow Children.&quot; GDC 2015.</a><br>
        [Takeshige 2015] <a href="https://developer.nvidia.com/content/basics-gpu-voxelization">Masaya Takeshige.
            &quot;The Basics of GPU Voxelization.&quot; NVIDIA GameWorks Blog 2015.</a><br>
        [Eric 2017] <a href="https://erkaman.github.io/posts/masters_thesis.html">Eric Arneback. “Comparing a Clipmap to
            a Sparse Voxel Octree for Global Illumination.&quot; Master thesis 2017.</a><br>
        [Heitz 2017] <a href="https://hal.archives-ouvertes.fr/hal-01458129">Eric Heitz. &quot;Geometric Derivation of
            the Irradiance of Polygonal Lights.&quot; Technical report 2017.</a></p>

</body>

</html>