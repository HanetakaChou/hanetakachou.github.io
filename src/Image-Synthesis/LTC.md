### 1\.LTSD(Linearly Transformed Spherical Distribution)

#### 1-1\.Define: Linearly Transformed Spherical Distribution  
We assume that $\displaystyle \operatorname{D_o}(\omega_o)$ is the **original distribution**, M is the linear transform matrix, and $\displaystyle \omega = \operatorname{normalize}(M \omega_o)$. The **linearly transformed spherical distribution** $\displaystyle \operatorname{D}(\omega)$ is defined as $\displaystyle \operatorname{D}(\omega) = \operatorname{D_o}(\omega_o) \frac{d\omega_o}{d\omega}$. Evidently, we have $\displaystyle \omega_o = \operatorname{normalize}(M^{-1} \omega)$. Actually, the **Jacobian** $\displaystyle \frac{d\omega_o}{d\omega}$ has the closed-form expression $\displaystyle \frac{d\omega_o}{d\omega} = \frac{|M^{-1}|}{{\|M^{-1}w\|}^3}$. The proof of this closed-form expression is provided in **Appendix A** of \[Heitz 2016\]. Note that $\displaystyle \omega_o$ and $\displaystyle \omega$ are vectors which represent the **direction**, while $\displaystyle d\omega_o$ and $\displaystyle d\omega$ are steradians which represent the **area** on the sphere surface. And [the Equation (5.6) of the PBR Book](https://pbr-book.org/3ed-2018/Color_and_Radiometry/Working_with_Radiometric_Integrals#IntegralsoverArea) is applied.  

#### 1-2\.Theorem: Normalization  

#### 1-3\.Theorem: Integration over Polygons  

By [Integration by Substitution](https://en.wikipedia.org/wiki/Integration_by_substitution), we have $\displaystyle \int_{P} \operatorname{D}(\omega) \, d\omega = \int_{P} \operatorname{D_o}(\omega_o) \frac{d\omega_o}{d\omega} d\omega = \int_{P_o} \operatorname{D_o}(\omega_o) d\omega_o$ where $\displaystyle P_o = M^{-1} P$. Intuitively, $\displaystyle P_o = \operatorname{normalize}(M^{-1} P)$ is more consistent with $\displaystyle \omega_o = \operatorname{normalize}(M^{-1} \omega)$. However, even if the $\displaystyle M^{-1} P$ is **NOT** normalized, the area on the sphere surface subtended by the polygon remains the same. Thus, the normalize operator is **NOT** necessary.  

### 2\.LTC(Linearly Transformed Cosine)  

#### 2-1\.Define: Linearly Transformed Cosine  
We assume that the normal direction in the local tangent space is (0, 0, 1), which is called the **Median Vector** in \[Heitz 2016\]. The **normalized clamped cosine** $\displaystyle \operatorname{D_o}(\omega_o) = \frac{1}{\pi} |\cos \theta_o| = \frac{1}{\pi} |\operatorname{dot}(\operatorname{vec3}(0,0,1), \omega_o = (x, y, z))| = \frac{1}{\pi} \max(z)$ is used as the **original distribution** $\displaystyle \operatorname{D_o}$. And the corresponding **linearly transformed spherical distribution** is called the **linearly transformed cosine**. Evidently, by [the Figure 5.13 of the PBR Book](https://pbr-book.org/3ed-2018/Color_and_Radiometry/Working_with_Radiometric_Integrals#IntegralsoverProjectedSolidAngle), we have $\displaystyle \int_\Omega \operatorname{D_o} \, d\omega_o = \frac{1}{\pi} \int_\Omega |\cos \theta_o| \, d\omega_o = \frac{1}{\pi} \int_\Omega 1 \, d\omega^{\perp} = \frac{1}{\pi} \cdot \pi = 1$, and thus $\displaystyle \operatorname{D_o}$ is normalized. And by **1-2\.Theorem: Normalization**, the LTCs are all normalized.  
